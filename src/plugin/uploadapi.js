/* eslint-disable */

/**
 * @Name HONOROBSSDK
 * @Description 封装华为OBS桶相关SDK
 * @Time 2020-04-09 
 * @Author Bruce
 * @Version 1.0
 */

var HONOROBSSDK = {
	accessKeyId:'',		// Access Key
	secretAccessKey:'',	// Secret Key
	securityToken:'',	// Security Token
	bucketName:'',		// Bucket Name
	obsClient: null,	// OBS Client
	// 初始化
	init:function(cuepUrl,obsServer){
		this.getToken(cuepUrl);
		this.getBucketName(cuepUrl);
		
		// 创建ObsClient实例
		this.obsClient = new ObsClient({
			access_key_id: this.accessKeyId,       
			secret_access_key: this.secretAccessKey,       
			security_token:this.securityToken,
			server : obsServer
		});
		console.log("OBS:",this.obsClient);
	},
	//获取token
	getToken:function(cuepUrl){
		var that = this;
		$.ajax({
			url : cuepUrl+'/abroad/newYoutShootMatch/getUserToken',
			type : 'GET',
			async:false,
			dataType : 'json',
			success : function(info) { 
				if(info.success){
					var jsonInfo = JSON.parse(info.resultDesc);
					that.accessKeyId = jsonInfo.credential.access;
					that.secretAccessKey = jsonInfo.credential.secret;
					that.securityToken = jsonInfo.credential.securitytoken;
				}
			}
		});
	},
	//获取桶名称
	getBucketName:function(cuepUrl){
		var that = this;
		$.ajax({
			url : cuepUrl+'/abroad/newYoutShootMatch/getBucketName',
			type : 'GET',
			async:false,
			dataType : 'json',
			success : function(info) { 
				if(info.success){
					that.bucketName = info.resultDesc;
				}
			}
		});
	},
	/*
	 * 文件上传
	 * @param fileName：文件名称，需要保持唯一性
	 * @param fileData：文件数据
	 * @param successCallback：成功时的回调事件
	 * @param failCallback：失败时的回调事件
	 */
	uploadFile:function(fileName,fileData,successCallback,failCallback){
		var that = this;
		that.obsClient.putObject({
			Bucket : that.bucketName,
			Key : fileName,
			SourceFile : fileData
		}, function (err, result) {
			if(err){
				// 删除失败
				console.error('Upload Error-->' + err);
				if(typeof failCallback == 'function'){
					failCallback(); 
				}
			}else{
				console.log('Upload Success Status-->' + result.CommonMsg.Status,result);
				if(result.CommonMsg.Status=='200'){
					//删除成功
					if(typeof successCallback == 'function'){
						successCallback(); 
					}
				}
			}
		});
	},
	/*
	 * 文件删除
	 * @param fileName：文件名称，需要保持唯一性
	 * @param successCallback：成功时的回调事件
	 * @param failCallback：失败时的回调事件
	 */
	deleteFile:function(fileName,successCallback,failCallback){
		var that = this;
		that.obsClient.deleteObject({
			Bucket: that.bucketName,
			Key : fileName
		}, function (err, result) {
			if(err){
				console.log('Delete Error-->' + err);
				if(typeof failCallback == 'function'){
					failCallback(); 
				}
			}else{
				console.log('Delete Success Status-->' + result.CommonMsg.Status);
				if(result.CommonMsg.Status=='200'){
					//上传成功
					if(typeof successCallback == 'function'){
						successCallback(); 
					}
				}
			}
		});
	}
};
/*! nice-validator 1.1.4
 * (c) 2012-2018 Jony Zhang <niceue@live.com>, MIT Licensed
 * https://github.com/niceue/nice-validator
 */
!function(e){"object"==typeof module&&module.exports?module.exports=e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e,t){"use strict";function i(t,n){function s(){a.$el=e(t),a.$el.length?a._init(a.$el[0],n):W(t)&&(z[t]=n)}var a=this;return a instanceof i?void(i.pending?e(window).on("validatorready",s):s()):new i(t,n)}function n(t){function i(){var t=this.options;for(var i in t)i in K&&(this[i]=t[i]);e.extend(this,{_valHook:function(){return"true"===this.element.contentEditable?"text":"val"},getValue:function(){var t=this.element;return"number"===t.type&&t.validity&&t.validity.badInput?"NaN":e(t)[this._valHook()]()},setValue:function(t){e(this.element)[this._valHook()](this.value=t)},getRangeMsg:function(e,t,i){function n(e,t){return o?e>t:e>=t}if(t){var s,a=this,r=a.messages[a._r]||"",l=t[0].split("~"),o="false"===t[1],u=l[0],d=l[1],c="rg",f=[""],g=P(e)&&+e===+e;return 2===l.length?u&&d?(g&&n(e,+u)&&n(+d,e)&&(s=!0),f=f.concat(l),c=o?"gtlt":"rg"):u&&!d?(g&&n(e,+u)&&(s=!0),f.push(u),c=o?"gt":"gte"):!u&&d&&(g&&n(+d,e)&&(s=!0),f.push(d),c=o?"lt":"lte"):(e===+u&&(s=!0),f.push(u),c="eq"),r&&(i&&r[c+i]&&(c+=i),f[0]=r[c]),s||a._rules&&(a._rules[a._i].msg=a.renderMsg.apply(null,f))}},renderMsg:function(){var e=arguments,t=e[0],i=e.length;if(t){for(;--i;)t=t.replace("{"+i+"}",e[i]);return t}}})}function n(i,n,s){this.key=i,this.validator=t,e.extend(this,s,n)}return i.prototype=t,n.prototype=new i,n}function s(e,t){if(J(e)){var i,n=t?t===!0?this:t:s.prototype;for(i in e)g(i)&&(n[i]=r(e[i]))}}function a(e,t){if(J(e)){var i,n=t?t===!0?this:t:a.prototype;for(i in e)n[i]=e[i]}}function r(t){switch(e.type(t)){case"function":return t;case"array":var i=function(){return t[0].test(this.value)||t[1]||!1};return i.msg=t[1],i;case"regexp":return function(){return t.test(this.value)}}}function l(t){var i,n,s;if(t&&t.tagName){switch(t.tagName){case"INPUT":case"SELECT":case"TEXTAREA":case"BUTTON":case"FIELDSET":i=t.form||e(t).closest("."+k);break;case"FORM":i=t;break;default:i=e(t).closest("."+k)}for(n in z)if(e(i).is(n)){s=z[n];break}return e(i).data(p)||e(i)[p](s).data(p)}}function o(e,t){var i=P(X(e,M+"-"+t));if(i&&(i=new Function("return "+i)()))return r(i)}function u(e,t,i){var n=t.msg,s=t._r;return J(n)&&(n=n[s]),W(n)||(n=X(e,V+"-"+s)||X(e,V)||(i?W(i)?i:i[s]:"")),n}function d(e){var t;return e&&(t=D.exec(e)),t&&t[0]}function c(e){return"INPUT"===e.tagName&&"checkbox"===e.type||"radio"===e.type}function f(e){return Date.parse(e.replace(/\.|\-/g,"/"))}function g(e){return/^\w+$/.test(e)}function m(e){var t="#"===e.charAt(0);return e=e.replace(/([:.{(|)}\/\[\]])/g,"\\$1"),t?e:'[name="'+e+'"]:first'}var h,p="validator",v="."+p,_=".rule",y=".field",b=".form",k="nice-"+p,w="msg-box",x="aria-invalid",M="data-rule",V="data-msg",O="data-tip",F="data-ok",$="data-timely",E="data-target",C="data-display",A="data-must",j="novalidate",N=":verifiable",T=/(&)?(!)?\b(\w+)(?:\[\s*(.*?\]?)\s*\]|\(\s*(.*?\)?)\s*\))?\s*(;|\|)?/g,S=/(\w+)(?:\[\s*(.*?\]?)\s*\]|\(\s*(.*?\)?)\s*\))?/,R=/(?:([^:;\(\[]*):)?(.*)/,q=/[^\x00-\xff]/g,D=/top|right|bottom|left/,I=/(?:(cors|jsonp):)?(?:(post|get):)?(.+)/i,H=/[<>'"`\\]|&#x?\d+[A-F]?;?|%3[A-F]/gim,L=e.noop,B=e.proxy,P=e.trim,U=e.isFunction,W=function(e){return"string"==typeof e},J=function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},Q=document.documentMode||+(navigator.userAgent.match(/MSIE (\d+)/)&&RegExp.$1),X=function(e,i,n){return e&&e.tagName?n===t?e.getAttribute(i):void(null===n?e.removeAttribute(i):e.setAttribute(i,""+n)):null},z={},G={debug:0,theme:"default",ignore:"",focusInvalid:!0,focusCleanup:!1,stopOnError:!1,beforeSubmit:null,valid:null,invalid:null,validation:null,formClass:"n-default",validClass:"n-valid",invalidClass:"n-invalid",bindClassTo:null},K={timely:1,display:null,target:null,ignoreBlank:!1,showOk:!0,dataFilter:function(e){if(W(e)||J(e)&&("error"in e||"ok"in e))return e},msgMaker:function(t){var i;return i='<span role="alert" class="msg-wrap n-'+t.type+'">'+t.arrow,t.result?e.each(t.result,function(e,n){i+='<span class="n-'+n.type+'">'+t.icon+'<span class="n-msg">'+n.msg+"</span></span>"}):i+=t.icon+'<span class="n-msg">'+t.msg+"</span>",i+="</span>"},msgWrapper:"span",msgArrow:"",msgIcon:'<span class="n-icon"></span>',msgClass:"n-right",msgStyle:"",msgShow:null,msgHide:null},Y={};return e.fn.validator=function(t){var n=this,s=arguments;return n.is(N)?n:(n.is("form")||(n=this.find("form")),n.length||(n=this),n.each(function(){var n=e(this).data(p);if(n)if(W(t)){if("_"===t.charAt(0))return;n[t].apply(n,[].slice.call(s,1))}else t&&(n._reset(!0),n._init(this,t));else new i(this,t)}),this)},e.fn.isValid=function(e,i){var n,s,a=l(this[0]),r=U(e);return!a||(r||i!==t||(i=e),a.checkOnly=!!i,s=a.options,n=a._multiValidate(this.is(N)?this:this.find(N),function(t){t||!s.focusInvalid||a.checkOnly||a.$el.find("["+x+"]:first").focus(),r&&(e.length?e(t):t&&e()),a.checkOnly=!1}),r?this:n)},e.extend(e.expr.pseudos||e.expr[":"],{verifiable:function(e){var t=e.nodeName.toLowerCase();return("input"===t&&!{submit:1,button:1,reset:1,image:1}[e.type]||"select"===t||"textarea"===t||"true"===e.contentEditable)&&!e.disabled},filled:function(t){return!!P(e(t).val())}}),i.prototype={_init:function(t,i){var r,l,o,u=this;U(i)&&(i={valid:i}),i=u._opt=i||{},o=X(t,"data-"+p+"-option"),o=u._dataOpt=o&&"{"===o.charAt(0)?new Function("return "+o)():{},l=u._themeOpt=Y[i.theme||o.theme||G.theme],r=u.options=e.extend({},G,K,l,u.options,i,o),u.rules=new s(r.rules,(!0)),u.messages=new a(r.messages,(!0)),u.Field=n(u),u.elements=u.elements||{},u.deferred={},u.errors={},u.fields={},u._initFields(r.fields),u.$el.data(p)||(u.$el.data(p,u).addClass(k+" "+r.formClass).on("form-submit-validate",function(e,t,i,n,s){u.vetoed=s.veto=!u.isValid,u.ajaxFormOptions=n}).on("submit"+v+" validate"+v,B(u,"_submit")).on("reset"+v,B(u,"_reset")).on("showmsg"+v,B(u,"_showmsg")).on("hidemsg"+v,B(u,"_hidemsg")).on("focusin"+v+" click"+v,N,B(u,"_focusin")).on("focusout"+v+" validate"+v,N,B(u,"_focusout")).on("keyup"+v+" input"+v+" compositionstart compositionend",N,B(u,"_focusout")).on("click"+v,":radio,:checkbox","click",B(u,"_focusout")).on("change"+v,'select,input[type="file"]',"change",B(u,"_focusout")),u._NOVALIDATE=X(t,j),X(t,j,j)),W(r.target)&&u.$el.find(r.target).addClass("msg-container")},_guessAjax:function(t){function i(t,i,n){return!!(t&&t[i]&&e.map(t[i],function(e){return~e.namespace.indexOf(n)?1:null}).length)}var n=this;if(!(n.isAjaxSubmit=!!n.options.valid)){var s=(e._data||e.data)(t,"events");n.isAjaxSubmit=i(s,"valid","form")||i(s,"submit","form-plugin")}},_initFields:function(e){function t(e,t){if(null===t||r){var i=a.elements[e];i&&a._resetElement(i,!0),delete a.fields[e]}else a.fields[e]=new a.Field(e,W(t)?{rule:t}:t,a.fields[e])}var i,n,s,a=this,r=null===e;if(r&&(e=a.fields),J(e))for(i in e)if(~i.indexOf(","))for(n=i.split(","),s=n.length;s--;)t(P(n[s]),e[i]);else t(i,e[i]);a.$el.find(N).each(function(){a._parse(this)})},_parse:function(e){var t,i,n,s=this,a=e.name,r=X(e,M);return r&&X(e,M,null),e.id&&("#"+e.id in s.fields||!a||null!==r&&(t=s.fields[a])&&r!==t.rule&&e.id!==t.key)&&(a="#"+e.id),a||(a="#"+(e.id="N"+String(Math.random()).slice(-12))),t=s.getField(a,!0),t.rule=r||t.rule,(i=X(e,C))&&(t.display=i),t.rule&&((null!==X(e,A)||/\b(?:match|checked)\b/.test(t.rule))&&(t.must=!0),/\brequired\b/.test(t.rule)&&(t.required=!0),(n=X(e,$))?t.timely=+n:t.timely>3&&X(e,$,t.timely),s._parseRule(t),t.old={}),W(t.target)&&X(e,E,t.target),W(t.tip)&&X(e,O,t.tip),s.fields[a]=t},_parseRule:function(i){var n=R.exec(i.rule);n&&(i._i=0,n[1]&&(i.display=n[1]),n[2]&&(i._rules=[],n[2].replace(T,function(){var n=arguments;n[4]=n[4]||n[5],i._rules.push({and:"&"===n[1],not:"!"===n[2],or:"|"===n[6],method:n[3],params:n[4]?e.map(n[4].split(", "),P):t})})))},_multiValidate:function(i,n){var s=this,a=s.options;return s.hasError=!1,a.ignore&&(i=i.not(a.ignore)),i.each(function(){if(s._validate(this),s.hasError&&a.stopOnError)return!1}),n&&(s.validating=!0,e.when.apply(null,e.map(s.deferred,function(e){return e})).done(function(){n.call(s,!s.hasError),s.validating=!1})),e.isEmptyObject(s.deferred)?!s.hasError:t},_submit:function(i){var n=this,s=n.options,a=i.target,r="submit"===i.type&&"FORM"===a.tagName&&!i.isDefaultPrevented();i.preventDefault(),h&&~(h=!1)||n.submiting||"validate"===i.type&&n.$el[0]!==a||U(s.beforeSubmit)&&s.beforeSubmit.call(n,a)===!1||(n.isAjaxSubmit===t&&n._guessAjax(a),n._debug("log","\n<<< event: "+i.type),n._reset(),n.submiting=!0,n._multiValidate(n.$el.find(N),function(t){var i,l=t||2===s.debug?"valid":"invalid";t||(s.focusInvalid&&n.$el.find("["+x+"]:first").focus(),i=e.map(n.errors,function(e){return e})),n.submiting=!1,n.isValid=t,U(s[l])&&s[l].call(n,a,i),n.$el.trigger(l+b,[a,i]),n._debug("log",">>> "+l),t&&(n.vetoed?e(a).ajaxSubmit(n.ajaxFormOptions):r&&!n.isAjaxSubmit&&document.createElement("form").submit.call(a))}))},_reset:function(e){var t=this;t.errors={},e&&(t.reseting=!0,t.$el.find(N).each(function(){t._resetElement(this)}),delete t.reseting)},_resetElement:function(e,t){this._setClass(e,null),this.hideMsg(e)},_focusin:function(e){var t,i,n=this,s=n.options,a=e.target;n.validating||"click"===e.type&&document.activeElement===a||(s.focusCleanup&&"true"===X(a,x)&&(n._setClass(a,null),n.hideMsg(a)),i=X(a,O),i?n.showMsg(a,{type:"tip",msg:i}):(X(a,M)&&n._parse(a),(t=X(a,$))&&(8!==t&&9!==t||n._focusout(e))))},_focusout:function(t){var i,n,s,a,r,l,o,u,d,f=this,g=f.options,m=t.target,h=t.type,p="focusin"===h,v="validate"===h,_=0;if("compositionstart"===h&&(f.pauseValidate=!0),"compositionend"===h&&(f.pauseValidate=!1),!f.pauseValidate&&(n=m.name&&c(m)?f.$el.find('input[name="'+m.name+'"]').get(0):m,(s=f.getField(n))&&s.rule)){if(i=s._e,s._e=h,d=s.timely,!v){if(!d||c(m)&&"click"!==h)return;if(r=s.getValue(),s.ignoreBlank&&!r&&!p)return void f.hideMsg(m);if("focusout"===h){if("change"===i)return;if(2===d||8===d){if(a=s.old,!r||!a)return;s.isValid&&!a.showOk?f.hideMsg(m):f._makeMsg(m,s,a)}}else{if(d<2&&!t.data)return;if(l=+new Date,l-(m._ts||0)<100)return;if(m._ts=l,"keyup"===h){if("input"===i)return;if(o=t.keyCode,u={8:1,9:1,16:1,32:1,46:1},9===o&&!r)return;if(o<48&&!u[o])return}p||(_=d<100?"click"===h||"SELECT"===m.tagName?0:400:d)}}g.ignore&&e(m).is(g.ignore)||(clearTimeout(s._t),_?s._t=setTimeout(function(){f._validate(m,s)},_):(v&&(s.old={}),f._validate(m,s)))}},_setClass:function(t,i){var n=e(t),s=this.options;s.bindClassTo&&(n=n.closest(s.bindClassTo)),n.removeClass(s.invalidClass+" "+s.validClass),null!==i&&n.addClass(i?s.validClass:s.invalidClass)},_showmsg:function(e,t,i){var n=this,s=e.target;n.$el.is(s)?J(t)?n.showMsg(t):"tip"===t&&n.$el.find(N+"["+O+"]",s).each(function(){n.showMsg(this,{type:t,msg:i})}):n.showMsg(s,{type:t,msg:i})},_hidemsg:function(t){var i=e(t.target);i.is(N)&&this.hideMsg(i)},_validatedField:function(t,i,n){var s=this,a=s.options,r=i.isValid=n.isValid=!!n.isValid,l=r?"valid":"invalid";n.key=i.key,n.ruleName=i._r,n.id=t.id,n.value=i.value,s.elements[i.key]=n.element=t,s.isValid=s.$el[0].isValid=r?s.isFormValid():r,r?n.type="ok":(s.submiting&&(s.errors[i.key]=n.msg),s.hasError=!0),i.old=n,U(i[l])&&i[l].call(s,t,n),U(a.validation)&&a.validation.call(s,t,n),e(t).attr(x,!r||null).trigger(l+y,[n,s]),s.$el.triggerHandler("validation",[n,s]),s.checkOnly||(s._setClass(t,n.skip||"tip"===n.type?null:r),s._makeMsg.apply(s,arguments))},_makeMsg:function(t,i,n){i.msgMaker&&(n=e.extend({},n),"focusin"===i._e&&(n.type="tip"),this[n.showOk||n.msg||"tip"===n.type?"showMsg":"hideMsg"](t,n,i))},_validatedRule:function(i,n,s,a){n=n||c.getField(i),a=a||{};var r,l,o,d,c=this,f=n._r,g=n.timely,m=9===g||8===g,h=!1;if(null===s)return c._validatedField(i,n,{isValid:!0,skip:!0}),void(n._i=0);if(s===t?o=!0:s===!0||""===s?h=!0:W(s)?r=s:J(s)?s.error?r=s.error:(r=s.ok,h=!0):h=!!s,l=n._rules[n._i],l.not&&(r=t,h="required"===f||!h),l.or)if(h)for(;n._i<n._rules.length&&n._rules[n._i].or;)n._i++;else o=!0;else l.and&&(n.isValid||(o=!0));o?h=!0:(h&&n.showOk!==!1&&(d=X(i,F),r=null===d?W(n.ok)?n.ok:r:d,!W(r)&&W(n.showOk)&&(r=n.showOk),W(r)&&(a.showOk=h)),h&&!m||(r=(u(i,n,r||l.msg||c.messages[f])||c.messages.fallback).replace(/\{0\|?([^\}]*)\}/,function(e,t){return c._getDisplay(i,n.display)||t||c.messages[0]})),h||(n.isValid=h),a.msg=r,e(i).trigger((h?"valid":"invalid")+_,[f,r])),!m||o&&!l.and||(h||n._m||(n._m=r),n._v=n._v||[],n._v.push({type:h?o?"tip":"ok":"error",msg:r||l.msg})),c._debug("log","   "+n._i+": "+f+" => "+(h||r)),(h||m)&&n._i<n._rules.length-1?(n._i++,c._checkRule(i,n)):(n._i=0,m?(a.isValid=n.isValid,a.result=n._v,a.msg=n._m||"",n.value||"focusin"!==n._e||(a.type="tip")):a.isValid=h,c._validatedField(i,n,a),delete n._m,delete n._v)},_checkRule:function(i,n){var s,a,r,l=this,u=n.key,d=n._rules[n._i],c=d.method,f=d.params;l.submiting&&l.deferred[u]||(r=n.old,n._r=c,r&&!n.must&&!d.must&&d.result!==t&&r.ruleName===c&&r.id===i.id&&n.value&&r.value===n.value?s=d.result:(a=o(i,c)||l.rules[c]||L,s=a.call(n,i,f,n),a.msg&&(d.msg=a.msg)),J(s)&&U(s.then)?(l.deferred[u]=s,n.isValid=t,!l.checkOnly&&l.showMsg(i,{type:"loading",msg:l.messages.loading},n),s.then(function(s,a,r){var o,u=P(r.responseText),c=n.dataFilter;/jsonp?/.test(this.dataType)?u=s:"{"===u.charAt(0)&&(u=e.parseJSON(u)),o=c.call(this,u,n),o===t&&(o=c.call(this,u.data,n)),d.data=this.data,d.result=n.old?o:t,l._validatedRule(i,n,o)},function(e,t){l._validatedRule(i,n,l.messages[t]||t)}).always(function(){delete l.deferred[u]})):l._validatedRule(i,n,s))},_validate:function(e,t){var i=this;if(!e.disabled&&null===X(e,j)&&(t=t||i.getField(e),t&&(t._rules||i._parse(e),t._rules)))return i._debug("info",t.key),t.isValid=!0,t.element=e,t.value=t.getValue(),t.required||t.must||t.value||c(e)?(i._checkRule(e,t),t.isValid):(i._validatedField(e,t,{isValid:!0}),!0)},_debug:function(e,t){window.console&&this.options.debug&&console[e](t)},test:function(e,i){var n,s,a,r,l=this,o=S.exec(i);return o&&(a=o[1],a in l.rules&&(r=o[2]||o[3],r=r?r.split(", "):t,s=l.getField(e,!0),s._r=a,s.value=s.getValue(),n=l.rules[a].call(s,e,r))),n===!0||n===t||null===n},_getDisplay:function(e,t){return W(t)?t:U(t)?t.call(this,e):""},_getMsgOpt:function(t,i){var n=i?i:this.options;return e.extend({type:"error",pos:d(n.msgClass),target:n.target,wrapper:n.msgWrapper,style:n.msgStyle,cls:n.msgClass,arrow:n.msgArrow,icon:n.msgIcon},W(t)?{msg:t}:t)},_getMsgDOM:function(i,n){var s,a,r,l,o=e(i);if(o.is(N)?(r=n.target||X(i,E),r&&(r=U(r)?r.call(this,i):"#"===r.charAt(0)?e(r):this.$el.find(r),r.length&&(r.is(N)?(o=r,i=r.get(0)):r.hasClass(w)?s=r:l=r)),s||(a=c(i)&&i.name||!i.id?i.name:i.id,s=(l||this.$el).find(n.wrapper+"."+w+'[for="'+a+'"]'))):s=o,!n.hide&&!s.length)if(s=e("<"+n.wrapper+">").attr({"class":w+(n.cls?" "+n.cls:""),style:n.style||t,"for":a}),l)s.appendTo(l);else if(c(i)){var u=o.parent();s.appendTo(u.is("label")?u.parent():u)}else s[n.pos&&"right"!==n.pos?"insertBefore":"insertAfter"](o);return s},showMsg:function(t,i,n){if(t){var s,a,r,l,o=this,u=o.options;if(J(t)&&!t.jquery&&!i)return void e.each(t,function(e,t){var i=o.elements[e]||o.$el.find(m(e))[0];o.showMsg(i,t)});e(t).is(N)&&(n=n||o.getField(t)),(a=(n||u).msgMaker)&&(i=o._getMsgOpt(i,n),t=(t.name&&c(t)?o.$el.find('input[name="'+t.name+'"]'):e(t)).get(0),i.msg||"error"===i.type||(r=X(t,"data-"+i.type),null!==r&&(i.msg=r)),W(i.msg)&&(l=o._getMsgDOM(t,i),!D.test(l[0].className)&&l.addClass(i.cls),6===Q&&"bottom"===i.pos&&(l[0].style.marginTop=e(t).outerHeight()+"px"),l.html(a.call(o,i))[0].style.display="",U(s=n&&n.msgShow||u.msgShow)&&s.call(o,l,i.type)))}},hideMsg:function(t,i,n){var s,a,r=this,l=r.options;t=e(t).get(0),e(t).is(N)&&(n=n||r.getField(t),n&&(n.isValid||r.reseting)&&X(t,x,null)),i=r._getMsgOpt(i,n),i.hide=!0,a=r._getMsgDOM(t,i),a.length&&(U(s=n&&n.msgHide||l.msgHide)?s.call(r,a,i.type):(a[0].style.display="none",a[0].innerHTML=""))},getField:function(e,i){var n,s,a=this;if(W(e))n=e,e=t;else{if(X(e,M))return a._parse(e);n=e.id&&"#"+e.id in a.fields||!e.name?"#"+e.id:e.name}return((s=a.fields[n])||i&&(s=new a.Field(n)))&&(s.element=e),s},setField:function(e,t){var i={};e&&(W(e)?i[e]=t:i=e,this._initFields(i))},isFormValid:function(){var e,t,i=this.fields;for(e in i)if(t=i[e],t._rules&&(t.required||t.must||t.value)&&!t.isValid)return!1;return!0},holdSubmit:function(e){this.submiting=e===t||e},cleanUp:function(){this._reset(1)},destroy:function(){this._reset(1),this.$el.off(v).removeData(p),X(this.$el[0],j,this._NOVALIDATE)}},e(window).on("beforeunload",function(){this.focus()}),e(document).on("click",":submit",function(){var e,t=this;t.form&&(e=t.getAttributeNode("formnovalidate"),(e&&null!==e.nodeValue||null!==X(t,j))&&(h=!0))}).on("focusin submit validate","form,."+k,function(t){if(null===X(this,j)){var i,n=e(this);!n.data(p)&&(i=l(this))&&(e.isEmptyObject(i.fields)?(X(this,j,j),n.off(v).removeData(p)):"focusin"===t.type?i._focusin(t):i._submit(t))}}),new a({fallback:"This field is not valid.",loading:"Validating..."}),new s({required:function(t,i){var n=this,s=P(n.value),a=!0;if(i)if(1===i.length){if(g(i[0])){if(n.rules[i[0]]&&!s&&!n.test(t,i[0]))return null}else if(!s&&!e(i[0],n.$el).length)return null}else if("not"===i[0])e.each(i.slice(1),function(){return a=s!==P(this)});else if("from"===i[0]){var r,l=n.$el.find(i[1]),o="_validated_";return a=l.filter(function(){var e=n.getField(this);return e&&!!P(e.getValue())}).length>=(i[2]||1),a?s||(r=null):r=u(l[0],n)||!1,e(t).data(o)||l.data(o,1).each(function(){t!==this&&n._validate(this)}).removeData(o),r}return a&&!!s},integer:function(e,t){var i,n="0|",s="[1-9]\\d*",a=t?t[0]:"*";switch(a){case"+":i=s;break;case"-":i="-"+s;break;case"+0":i=n+s;break;case"-0":i=n+"-"+s;break;default:i=n+"-?"+s}return i="^(?:"+i+")$",new RegExp(i).test(this.value)||this.messages.integer&&this.messages.integer[a]},match:function(t,i){if(i){var n,s,a,r,l,o,u,d=this,c=!0,g="eq";if(1===i.length?a=i[0]:(g=i[0],a=i[1]),l=m(a),o=d.$el.find(l)[0]){if(u=d.getField(o),n=d.value,s=u.getValue(),d._match||(d.$el.on("valid"+y+v,l,function(){e(t).trigger("validate")}),d._match=u._match=1),!d.required&&""===n&&""===s)return null;if(r=i[2],r&&(/^date(time)?$/i.test(r)?(n=f(n),s=f(s)):"time"===r&&(n=+n.replace(/:/g,""),s=+s.replace(/:/g,""))),"eq"!==g&&!isNaN(+n)&&isNaN(+s))return!0;switch(g){case"lt":c=+n<+s;break;case"lte":c=+n<=+s;break;case"gte":c=+n>=+s;break;case"gt":c=+n>+s;break;case"neq":c=n!==s;break;default:c=n===s}return c||J(d.messages.match)&&d.messages.match[g].replace("{1}",d._getDisplay(o,u.display||a))}}},range:function(e,t){return this.getRangeMsg(this.value,t)},checked:function(e,t){if(c(e)){var i,n,s=this;return e.name?n=s.$el.find('input[name="'+e.name+'"]').filter(function(){var e=this;return!i&&c(e)&&(i=e),!e.disabled&&e.checked}).length:(i=e,n=i.checked),t?s.getRangeMsg(n,t):!!n||u(i,s,"")||s.messages.required||!1}},length:function(e,t){var i=this.value,n=("true"===t[1]?i.replace(q,"xx"):i).length;return this.getRangeMsg(n,t,t[1]?"_2":"")},remote:function(t,i){if(i){var n,s=this,a=I.exec(i[0]),r=s._rules[s._i],l={},o="",u=a[3],d=a[2]||"POST",c=(a[1]||"").toLowerCase();return r.must=!0,l[t.name]=s.value,i[1]&&e.map(i.slice(1),function(e){var t,i;~e.indexOf("=")?o+="&"+e:(t=e.split(":"),e=P(t[0]),i=P(t[1])||e,l[e]=s.$el.find(m(i)).val())}),l=e.param(l)+o,!s.must&&r.data&&r.data===l?r.result:("cors"!==c&&/^https?:/.test(u)&&!~u.indexOf(location.host)&&(n="jsonp"),e.ajax({url:u,type:d,data:l,dataType:n}))}},filter:function(e,t){var i=this.value,n=i.replace(t?new RegExp("["+t[0]+"]","gm"):H,"");n!==i&&this.setValue(n)}}),i.config=function(t,i){function n(e,t){"rules"===e?new s(t):"messages"===e?new a(t):e in K?K[e]=t:G[e]=t}J(t)?e.each(t,n):W(t)&&n(t,i)},i.setTheme=function(t,i){J(t)?e.extend(!0,Y,t):W(t)&&J(i)&&(Y[t]=e.extend(Y[t],i))},i.load=function(t){if(t){var n,s,a,r=document,l={},o=r.scripts[0];t.replace(/([^?=&]+)=([^&#]*)/g,function(e,t,i){l[t]=i}),n=l.dir||i.dir,i.css||""===l.css||(s=r.createElement("link"),s.rel="stylesheet",s.href=i.css=n+"jquery.validator.css",o.parentNode.insertBefore(s,o)),!i.local&&~t.indexOf("local")&&""!==l.local&&(i.local=(l.local||r.documentElement.lang||"en").replace("_","-"),i.pending=1,s=r.createElement("script"),s.src=n+"local/"+i.local+".js",a="onload"in s?"onload":"onreadystatechange",s[a]=function(){s.readyState&&!/loaded|complete/.test(s.readyState)||(s=s[a]=null,delete i.pending,e(window).triggerHandler("validatorready"))},o.parentNode.insertBefore(s,o))}},function(){for(var e,t,n=document.scripts,s=n.length,a=/(.*validator(?:\.min)?.js)(\?.*(?:local|css|dir)(?:=[\w\-]*)?)?/;s--&&!t;)e=n[s],t=(e.hasAttribute?e.src:e.getAttribute("src",4)||"").match(a);t&&(i.dir=t[1].split("/").slice(0,-1).join("/")+"/",i.load(t[2]))}(),e[p]=i});
/*********************************
 * Themes, rules, and i18n support
 * Locale: English
 *********************************/
(function(factory) {
    typeof module === "object" && module.exports ? module.exports = factory( require( "jquery" ) ) :
    typeof define === 'function' && define.amd ? define(['jquery'], factory) :
    factory(jQuery);
}(function($) {

    /* Global configuration
     */
    $.validator.config({
        //stopOnError: true,
        //focusCleanup: true,
        //theme: 'yellow_right',
        //timely: 2,

        // Custom rules
        rules: {
            digits: [/^\d+$/, "Please enter only digits."]
            ,letters: [/^[a-z]+$/i, "Please enter only letters."]
            ,date: [/^\d{4}-\d{2}-\d{2}$/, "Please enter a valid date, format: yyyy-mm-dd"]
            ,time: [/^([01]\d|2[0-3])(:[0-5]\d){1,2}$/, "Please enter a valid time, between 00:00 and 23:59"]
            ,email: [/^[\w\+\-]+(\.[\w\+\-]+)*@[a-z\d\-]+(\.[a-z\d\-]+)*\.([a-z]{2,4})$/i, "Please enter a valid email address."]
            ,url: [/^(https?|s?ftp):\/\/\S+$/i, "Please enter a valid URL."]
            ,accept: function (element, params){
                if (!params) return true;
                var ext = params[0],
                    value = $(element).val();
                return (ext === '*') ||
                       (new RegExp(".(?:" + ext + ")$", "i")).test(value) ||
                       this.renderMsg("Only accept {1} file extension.", ext.replace(/\|/g, ', '));
            }
            
        },

        // Default error messages
        messages: {
            0: "This field",
            fallback: "{0} is not valid.",
            loading: "Validating...",
            error: "Network Error.",
            timeout: "Request timed out.",
            required: "{0} is required.",
            remote: "Please try another name.",
            integer: {
                '*': "Please enter an integer.",
                '+': "Please enter a positive integer.",
                '+0': "Please enter a positive integer or 0.",
                '-': "Please enter a negative integer.",
                '-0': "Please enter a negative integer or 0."
            },
            match: {
                eq: "{0} must be equal to {1}.",
                neq: "{0} must be not equal to {1}.",
                lt: "{0} must be less than {1}.",
                gt: "{0} must be greater than {1}.",
                lte: "{0} must be less than or equal to {1}.",
                gte: "{0} must be greater than or equal to {1}."
            },
            range: {
                rg: "Please enter a number between {1} and {2}.",
                gte: "Please enter a number greater than or equal to {1}.",
                lte: "Please enter a number less than or equal to {1}.",
                gtlt: "Please fill in the number of {1} to {2}.",
                gt: "Please enter a number greater than {1}.",
                lt: "Please enter a number less than {1}."
            },
            checked: {
                eq: "Please check {1} items.",
                rg: "Please check between {1} and {2} items.",
                gte: "Please check at least {1} items.",
                lte: "Please check no more than {1} items."
            },
            length: {
                eq: "Please enter {1} characters.",
                rg: "Please enter a value between {1} and {2} characters long.",
                gte: "Please enter at least {1} characters.",
                lte: "Please enter no more than {1} characters.",
                eq_2: "",
                rg_2: "",
                gte_2: "",
                lte_2: ""
            }
        }
    });

    /* Themes
     */
    var TPL_ARROW = '<span class="n-arrow"><b>◆</b><i>◆</i></span>';
    $.validator.setTheme({
    	'default_bottom': {
            formClass: 'n-default',
            msgClass: 'n-bottom'
        },
        'simple_right': {
            formClass: 'n-simple',
            msgClass: 'n-right'
        },
        'simple_bottom': {
            formClass: 'n-simple',
            msgClass: 'n-bottom'
        },
        'yellow_top': {
            formClass: 'n-yellow',
            msgClass: 'n-top',
            msgArrow: TPL_ARROW
        },
        'yellow_right': {
            formClass: 'n-yellow',
            msgClass: 'n-right',
            msgArrow: TPL_ARROW
        },
        'yellow_right_effect': {
            formClass: 'n-yellow',
            msgClass: 'n-right',
            msgArrow: TPL_ARROW,
            msgShow: function($msgbox, type){
                var $el = $msgbox.children();
                if ($el.is(':animated')) return;
                if (type === 'error') {
                    $el.css({left: '20px', opacity: 0})
                        .delay(100).show().stop()
                        .animate({left: '-4px', opacity: 1}, 150)
                        .animate({left: '3px'}, 80)
                        .animate({left: 0}, 80);
                } else {
                    $el.css({left: 0, opacity: 1}).fadeIn(200);
                }
            },
            msgHide: function($msgbox, type){
                var $el = $msgbox.children();
                $el.stop().delay(100).show()
                    .animate({left: '20px', opacity: 0}, 300, function(){
                        $msgbox.hide();
                    });
            }
        }
    });
}));

/******cookie 协议 start******/
var cookieTip,storage,browserTip,ieVertion;
$(document).ready(function(){
    browserTip = $('#normal_nav .browser_tip')

    if(navigator.userAgent.indexOf("MSIE")>0) {
     ieVertion = navigator.appVersion.split(";")[1].replace(/[ ]/g,"").replace("MSIE","")
    }else{
     ieVertion = 11
    }

    storage =new LocalCookie();

    if(!storage.getItem('browserTip')){
        if(navigator.appName == "Microsoft Internet Explorer" && ieVertion < 10){
            browserTip.show()
        }
	}

	cookieTip = $('#normal_nav .cookie_tip');
	if(!storage.getItem('cookieview') && cookieTip){ 
		cookieTip.css('transform','translate(0px, 0px)');
	}
	
	//30s未关闭cookie时 自动消失
	setTimeout(function(){ 
		if(cookieTip){ 
			cookieTip.css('transform','translate(-4000px, 0px)');
		}
	},30000)
	
	
    $(document).on('click','#normal_nav .cookie_tip .close_btn span',function(e){
    	storage.setItem('cookieview','1');
    	document.getElementById('cookie_tip_').style.transform="translate(-4000px, 0px)";
    }).on('click','#normal_nav .cookie_tip .cookie_txt a',function(e){
    	storage.setItem('cookieview','1')
    }).on('click','#normal_nav .browser_tip .close_btn span',function(e){
    	storage.setItem('browserTip','1');
//    	browserTip.fadeOut();
    	document.getElementById('cookie_tip_').style.transform="translate(-4000px, 0px)";
    })
    
    
})

    
function setCookie(name,value){
	var Days = 13 * 30;
	var exp = new Date();
	exp.setTime(exp.getTime() + Days*24*60*60*1000);
	document.cookie = name + "="+ escape (value) + ";expires=" + exp.toGMTString() + ";path=/";
}

function getCookie(name){
	var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");
	if(arr=document.cookie.match(reg))
		return unescape(arr[2]);
	else
		return null;
}

var LocalCookie = (function () {
	function LocalCookie() {
	}
	LocalCookie.prototype.getItem = function (_name) {
		return getCookie(_name);
	}

	LocalCookie.prototype.setItem = function (_name, _value) {
		setCookie(_name,_value);
	}
	return LocalCookie;
})();
/******cookie 协议 end******/
/*!
 * 	HONOR Notice (2019-04-10T10:51:52+0800)
 * 	仅用于Honor Header中的消息通知 
 * 	Copyright 2019-2020 hihonor.com
 */
if($('.honor-notice').length>0){
	$(function(){ 
		var version = $('.header .honor-notice').data('version');
		// 消息列表显示隐藏
		var windowW = utils.windowWidth();
		if(windowW>768){
			$('.header .honor-notice .gallery-notice').stop().mouseenter(function(e){
				e.stopPropagation();
				if(e.relatedTarget !=null){
					if(version && version=='v2' || version=='cn'){
						$(this).find('.notice-wrapper').stop().slideDown();
					}else{
						$('.header .search-box').stop().slideUp();
						$(this).find('.notice-box').stop().slideDown();
					}
				}
			})
			$('.header .honor-notice .gallery-notice').stop().mouseleave(function(e){
				e.stopPropagation();
				if(e.relatedTarget !=null){
					if(version && version=='v2' || version=='cn'){
						$(this).find('.notice-wrapper').stop().slideUp();
					}else{
						$('.header .search-box').stop().slideUp();
						$(this).find('.notice-box').stop().slideUp();
					}
				}
			})
		}
		if(windowW == 1024){
			// 移动端
			var flag = true;
			$('.header .honor-notice .gallery-notice').stop().click(function(e){
				if(flag){
					e.stopPropagation();
					if(version && version=='v2' || version=='cn'){
						$(this).find('.notice-wrapper').stop().slideDown();
					}else{
						$('.header .search-box').stop().slideUp();
						$(this).find('.notice-box').stop().slideDown();
					}
				}else{
					e.stopPropagation();
					if(version && version=='v2' || version=='cn'){
						$(this).find('.notice-wrapper').stop().slideUp();
					}else{
						$('.header .search-box').stop().slideUp();
						$(this).find('.notice-box').stop().slideUp();
					}
				}
				flag =!flag;
			})
		} 
		// 切换消息tab
		$('.honor-notice .notice-tab li').stop().click(function(e){
			e.stopPropagation();
			var name = $(this).attr('data-name');
			$(this).addClass('active');
			$(this).siblings().removeClass('active');

			//查询未读消息
			if(name=="gallery-notification" && hNotificationFirst){				
				getMessageLists(name);
				hNotificationFirst=false;
			}else if(name=="gallery-message" && hMessageFirst){
				getMessageLists(name);
				hMessageFirst=false;			
			}
			$('.honor-notice .notice-content .tab-content').removeClass('active');
			$('.honor-notice .notice-content .'+name).addClass('active');
			
			//GA CODE
			var gaName=name.replace(/gallery-/, "")
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Top Function",
				"eventAction": honorConfig.pageType,
				"eventLabel": gaName
			})
		})
		//更新消息状态为已读	
		/*$(".notice-box .notice-content .tab-content li").click(function(){
			var id=$(this).data("id");
			var serviceAddr=$(this).data("serviceAddr")
			$.ajax({
				type : "post",
				url : honorApiUrl+'/abroad/userCenter/updateMessageStatusToRead',
				data : {id : id,serviceAddr:serviceAddr},
				dataType : "jsonp",
				success : function(result) {
					if(result.code==="000000"){
						var name = $(".honor-notice .notice-tab span.active").attr('data-name');
						getMessageLists(name);
						getMessageNum();
					}
				}
			})
		})*/
		
		//关闭选择国家弹窗
		$(".header .selectcountry .font-Cross").click(function(){
			$('html,body').css('overflow','auto');
			$(".header .message-country").hide();
		})
		
		//点击View All跳转
		$(".header .notice-box .btn-notice,.header .app-notice").click(function(){
			honorData.loginName = decodeURI(utils.getCookie('loginUid'));
			if (honorData.loginName === "" || honorData.loginName === null || honorData.loginName === "null") {
				var homeurl = $(".header .logo-home").attr("href");
				window.location.href = homeurl;
			}
			var isSelect=$(".header #select").val();
			if(isSelect=="true"){
				showSelectCountryModal();
			}
			
			//GA CODE
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Top Function",
				"eventAction": honorConfig.pageType,
				"eventLabel": "View All"
			})
		});
		
		//GA CODE My Profile
		$(".logined-menu .usercenter").click(function(){
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Top Function",
				"eventAction": honorConfig.pageType,
				"eventLabel": "My Profile"
			})
		})
		
		//GA CODE Logout
		$(".logined-menu .btn-logout").click(function(){
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Top Function",
				"eventAction": honorConfig.pageType,
				"eventLabel": "Logout"
			})
		})
		
		
	});
	
}

// 查询系统消息数 
function getMessageNum(){
	var version = $('.header .honor-notice').data('version');
	$.ajax({
		url: honorApiUrl+'/abroad/userCenter/isMessage',
		type: 'GET',
		dataType: 'jsonp',
		success: function(info) { 
			if(info.code=="000000"){  
				var num = Number(info.allNum);
				if(num>0){ 
					if(num>99){
						num = '99+';
					}
					if(version && version=='v2'){
						$('.honor-notice .gallery-notice>p .icon-point').show();
						$('.header-v2 .app-header-content .nav-li .icon-point').show();
					}else if(version=='cn'){
						$('.honor-notice .gallery-notice>p .icon-point').show();
						$('.header-cn .header-account .logined-menu .icon-point').show();
					}else{
						$('.honor-notice .badge').show().text(num);	
					}
					var numArr=info.pageList;
					for(var i=0;i<numArr.length;i++){
						if(numArr[i].messageType==1){
							// notification
							if(numArr[i].num>0){
								$('.header .notice-box .notice-tab li.notification .icon-point').css('display','inline-block');
							}else{
								$('.header .notice-box .notice-tab li.notification .icon-point').hide();
							}
						}
						if(numArr[i].messageType===2){
							// message
							if(numArr[i].num>0){
								$('.header .notice-box .notice-tab li.message .icon-point').css('display','inline-block');
							}else{
								$('.header .notice-box .notice-tab li.message .icon-point').hide();
							}
						}
					}
				}else{
					if(version && version=='v2'){
						$('.honor-notice .gallery-notice>p .icon-point').hide();
						$('.header-v2 .app-header-content .nav-li .icon-point').hide();
					}else if(version=='cn'){
						$('.honor-notice .gallery-notice>p .icon-point').hide();
						$('.header-cn .header-account .logined-menu .icon-point').hide();
					}else{
						$('.honor-notice .badge').hide().text(num);
					}
				} 
			}else if(info.code=="100007"){
				//用户未登录
				updataNoticeStatus();
			}
		},error:function(err){
			console.log(err);
		}
	})
} 

// 查询未读系统消息列表 
function getMessageLists(type){  
	// 默认系统通知消息
	type = type || 'gallery-notification';
	var messageType = '1';
	if(type=='gallery-message'){
		messageType = '2';
	}
	// 语言传参
	var lang = window.digitalData.page.pageInfo.siteCode2;
	if(lang=='global'){
		lang='en';
	}
	$.ajax({
		url: honorApiUrl+'/abroad/userCenter/getNotifications',
		type: 'GET',
		data:{
			messageType:messageType,
			lang:lang,
			pageIndex:"0",
			pageSize:"5",
			messageStatus:"1"
		},
		dataType: 'jsonp',
		success: function(info) { 
			if(info.success){    
				var str='',unreadNum = 0;
				var data =info.infoBean.pageList;
				var pageUrl = $('.gallery-notice .btn-notice').attr('href') || '';
				if(pageUrl.indexOf("#&inbox")==-1){
					pageUrl=pageUrl+"?msgType="+messageType+"#&inbox";
				}else{
					//消息tab 切换 替换  msgType 的值
					if(pageUrl.length>0){
						var replaceStr="msgType="+messageType;
						if(messageType=='2'){
							pageUrl=pageUrl.replace("msgType=1",replaceStr);
						}else{
							pageUrl=pageUrl.replace("msgType=2",replaceStr);
						}
						
					}
				}	
				var isSelect=$(".header #select").val();
				if(isSelect=="true"){
					pageUrl="javascript:void(0);";
				}
				
				$(".header .notice-box .btn-notice").attr("href",pageUrl);
				
				for(var i=0;i<data.length;i++){
					var title=data[i].title || '';
					if(messageType=="1"){ 
						var functionType =data[i].functionType;
						if(functionType=='1' || functionType=='2' || functionType=='5'){
							if(title && title.indexOf('{name}')!==-1){
								var userName='<b>'+data[i].senderUserName+'</b>';
								var isArabic=$("div").hasClass("__arabic__");
								if(isArabic){
									userName=data[i].senderUserName;
								}
								title=title.replace("{name}",userName);
							}
							str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'"><b>'+title+'</a></li>';
						}else{
							str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+title+'</a></li>';
						}
					}else{
						str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+title+'</a></li>';
					}
					unreadNum++;
				}  
				
				var $message=$('.gallery-notice .'+type); 
				if(unreadNum==0){
					$message.find('.no-content').show().next().hide();
				}else{
					$message.find('.no-content').hide().next().html(str).show();
					//点击右侧下拉菜单弹框
					$(".header .notice-box .notice-content ul li").click(function(){
						var isSelect=$(".header #select").val();
						if(isSelect=="true"){
							showSelectCountryModal();
						}
					})
				} 
				
			} 
		},error:function(err){
			console.log(err);
		}
	})
}

//消息 选择国家的弹框显示
function showSelectCountryModal(){
	var version = $('.header .honor-notice').data('version');
	if(version && version=='v2' || version=='cn'){
		$('.header .notice-wrapper').hide();
	}else{
		$('.header .notice-box').hide();
	}
	$('html,body').css('overflow','hidden');
	$(".header .message-country").show();
	var boxH = $('.header .selectcountry').height();
	var titleH = $('.header .message-country .selectcountry-title').height();
	var contentH = boxH-titleH;
	$('.header .selectcountry ul').height(contentH);
}
/******面板滑动关闭 start******/
var touchStartX = 0;
var touchEndX = 0;
$('.header .menu').on('touchstart', function(e) {
  var touch = e.originalEvent.touches[0];
  touchStartX = touch.clientX;
}).
on('touchmove', function(e) {
  var touch = e.originalEvent.touches[0];
  touchEndX = touch.clientX;
})

$('.header .menu').on('touchend', function(e) {
  if ((touchEndX + 50) < touchStartX && touchEndX != 0) { 
	  if ($('.nav-btn .font-Next-Page-arrow').hasClass("open")) {
		  // 关闭二级菜单
		  $('.menu .text a.has-child').removeClass('on');
		  $('.nav-btn .font-Next-Page-arrow').removeClass("open");
		  $('.sub-menu').animate({
			  left: "-100%"
		  });
   
		  openBody();
     
		  touchStartX = 0;
		  touchEndX = 0;
	  }else{
		  //关闭一级菜单
		  $('.header .menu').animate({
			  left: "-100%"
		  });
		  $('.nav-btn').children("span").addClass("font-Hamburg").removeClass("font-Next-Page-arrow");
		  touchStartX = 0;
		  touchEndX = 0;
		  openBody();
	  }
  	}
})

var openBody = function(){
	 $('body').removeClass('hidden-scroll');
     $('.content .aem-GridColumn').show();
      $('.footer').show();
}
var closeBody = function(){
	 $('body').addClass('hidden-scroll');
     $('.content .aem-GridColumn').hide();
    $('.footer').hide();
}
/******面板滑动关闭 end******/

/******当前页面选中效果开始******/
var currPageUrl = location.href;
var navUrlArr = [];
var currIndex = -1;
var itemData;
$('.nav-item .nav-link').each(function(index){
	var currUrl = $(this).attr('href');
	if(currUrl){
		 if(currUrl=='javascript:;'){
			 currUrl=$(this).siblings('.sub-menu').find('.btn-more').attr('href');
			 if(currUrl){
				 currUrl= currUrl.substring(0,currUrl.length-1);
			 }
			 itemData={'url':currUrl,'type':'subnav'};
		 }else{
			 currUrl= currUrl.substring(0,currUrl.length-1);
			 itemData={'url':currUrl,'type':'topnav'};
		 } 
		 navUrlArr.push(itemData);
	}
})  
for(var i=0;i<navUrlArr.length;i++){  
	if(currPageUrl.indexOf(navUrlArr[i].url)!=-1){ 
		currIndex = i; 
		if(navUrlArr[i].type=='topnav'){
			break;
		}
	}
}  
$('.header .row .nav-item').removeClass('active');
if(currIndex!=-1){
	$('.header .row .nav-item:nth-child('+(currIndex+2)+')').addClass('active');
}
/******当前页面选中效果结束******/

/*** 显示或隐藏support group弹窗开始 ***/
$('.header .header-support').click(function(){
	$('.support-box').fadeIn();
	var $flag = $('.support-box .countries-title .country-img img');
	  	$flag.css('background-color','transparent');
})
$('.support-box .cs-title .font-Cross').click(function(){
    $('.support-box').fadeOut();
});
/*** 显示或隐藏support group弹窗结束 ***/   


/****** 返回顶部箭头开始 ****/
var $backToTop = $('.header .go-back-top,.header .back-to-top');  
$(window).scroll(function() {
    var scrollTop = $(document).scrollTop();
    if (scrollTop > 200) {
        //显示返回顶部箭头
        $backToTop.show();
    } else {
        //隐藏返回顶部箭头
        $backToTop.hide();
    }
})

$backToTop.click(function() {
    $('body,html').animate({
        scrollTop: 0
    }, 800);
    if($("#themesHeader").length>0){
    	window.dataLayer.push({
        	"event": "uaEvent",
        	"eventCategory": "Top Button",
        	"eventAction": honorConfig.pageType,
        	"eventLabel": "return top"
    	})
    }else{
    	// GA Code
        window.dataLayer.push({
        	"event": "uaEvent",
        	"eventCategory": "Top Button",
        	"eventAction": "click",
        	"eventLabel": "return top"
    	})
    }
    
	
});
/****** 返回顶部箭头结束 ****/

/***** 第三方链接跳转弹窗提示开始 ****/
// 倒计时		
var count = 0,externalTimer = null;
function countTimeFC(url) { 
    if (count == 0) {
    	window.location.href = url;
        count = 0;
    } else {
    	$('.modal-notice .time-num').html(count + "S");
    	count--;
        externalTimer = window.setTimeout(function() {
            countTimeFC(url);
        }, 1000);
    }
}    
$('.externalLinks').click(function(){
	var $img =$('.redirect-notice .modal-title-img');
	var imgSrc= $img.data('src');
	$img.attr('src',imgSrc);
	$('.redirect-notice').show();  
	var externalUrl = $(this).attr('url');
	countTimeFC(externalUrl);
})
// 关闭跳转提示弹窗，不做跳转
$('.modal-notice .font-Cross').click(function(){
	$('.redirect-notice').hide();
	clearTimeout(externalTimer);
	count = 0;
})
// 确认跳转，关闭提示弹窗
$('.modal-notice .modal-btn').click(function(){
	$('.redirect-notice').hide();
}) 
/***** 第三方链接跳转弹窗提示结束 ****/

/*!
 * Header-public.js v2.0.0 (2019-04-08T16:50:51+0800)
 * Copyright 2019-2020 hihonor.com
 */

//默认Honor API Url
var honorApiUrl= "https://cuep-sg.hihonor.com";
//查看消息的次数标识
var hMessageFirst= true,hNotificationFirst=true;	

(function(){
	// 登录注册跳转
	var $inoutData = $('.loginout-data');
	var inoutData = {
		"loginUrl":$inoutData.attr('loginurl') || "",
		"clientId":$inoutData.attr('clientid') || "",
		"loginRedirectURL":$inoutData.attr('loginredirecturl') || "",
		"logoutRedirectURL":$inoutData.attr('logoutredirecturl') || "",
		"userCenterUrl":$inoutData.attr('usercenterurl') || "",
		"myServiceUrl":$inoutData.attr('myserviceurl') || "",
		"myMessageCN":$inoutData.attr('mymessagecn') || ""
	}  

	// 根据登录配置的API url 获取当前站点的 Honor Api Url
	if(inoutData.loginRedirectURL){
		honorApiUrl = inoutData.loginRedirectURL.split('/abroad/')[0];
	}
	
	var currPage = window.location.href;
	var redirectUri = inoutData.loginRedirectURL+"?cururl="+currPage;
	var endLoginUrl= inoutData.loginUrl+"?response_type=code&client_id="+inoutData.clientId+"&redirect_uri="+encodeURIComponent(redirectUri)+"&"+encodeURIComponent("scope=https://www.huawei.com/auth/account/base.profile")+encodeURIComponent(" https://www.huawei.com/auth/account/country")+"&access_type=offline&lang="+honorConfig.loginLang+"&sitecode="+honorConfig.siteCode+"&themeName=blue";
	honorConfig.endLoginUrl = endLoginUrl;
	
	// 登录URL
	$('.site-login .font-User,.menu .login-nav-link').attr('href',endLoginUrl);
	$('.site-login .font-User,.menu .login-nav-link').click(function(){
		window.dataLayer.push({
			"event": "accountLogin",
			"pageType": honorConfig.pageType,
			"siteLocation": "header"
		})
	})
	
	// Header v2
	// 登录GA统计
	$('.header-v2 .site-login .honorFont-user,.header-v2 .app-account .login-nav-link').click(function(){
		window.dataLayer.push({
			"event": "accountLogin",
			"pageType": honorConfig.pageType,
			"siteLocation": "header"
		})
		$('.site-login .honorFont-user,.header-v2 .app-account .login-nav-link').attr('href',endLoginUrl);
	})
	
	// 登出URL			
	var endLogoutUrl = inoutData.logoutRedirectURL +"?cururl="+encodeURIComponent(window.location.href)+"&lang="+honorConfig.loginLang; 
	$('.site-logined .btn-logout,.menu .logout-nav-link').attr('href',endLogoutUrl);

	// Header v2
	$('.header-v2 .app-account .logout-nav-link').attr('href',endLogoutUrl);
	honorConfig.endLogoutUrl =endLogoutUrl;
	
	var userCenterUrl = inoutData.userCenterUrl+"?lang="+honorConfig.loginLang; 
	$('.site-logined .usercenter,.menu .usercenter-nav-link').attr('href',userCenterUrl);
	
	var myServiceUrlUrl = inoutData.myServiceUrl.replace('/content/honor',''); 
	$('.site-logined .myservice,.menu .myservice-nav-link').attr('href',myServiceUrlUrl);
	
	// Header v2
	$('.header-v2 .app-account .usercenter-nav-link').attr('href',userCenterUrl);
	$('.header-v2 .app-account .myservice-nav-link').attr('href',myServiceUrlUrl);
	
	// Header CN Mobile
	var myMessageCN = inoutData.myMessageCN.replace('/content/honor',''); 
	$('.header-cn .mymessage-cn').attr('href',myMessageCN);

	// 登录状态切换
	loginStatus(); 
	
	$(function(){
		if($('.header').length>0){
			
			// body增加版本标识
			if($('.header-v1').length>0){
				$('body').addClass('honor-v1');
			}else if($('.header-v2').length>0){
				$('body').addClass('honor-v2');
			}
			if($('.header-cn').length>0){
				$('body').addClass('honor-cn');
			}

			//切换显示登录后信息
			$('.header .site-logined').hover(function() {
				var version = $(this).data('version');
				if(version && version=='v2' || version=='cn'){
					$('.header .logined-wrapper').stop().slideToggle(500);
				}else{
					$('.header .logined-menu').stop().slideToggle(500);
				}
			});
			
		}
	})
}());

//切换登录状态
function loginStatus(){
	// 更新通知icon显示隐藏的状态
	updataNoticeStatus();
	var currPageWidth= utils.pageWidth(); 
	if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
		// 已登录		
		if(currPageWidth>768 && $('.honor-notice').length>0){
			//获取系统消息
			getMessageNum();
			getMessageLists();
			hNotificationFirst = false;
		}
		if(currPageWidth<=768 && $('.honor-notice').length>0){
			var version = $('.header .honor-notice').data('version');
			if(version && version=='v2' || version=='cn'){
				getMessageNum();
			}
		}
		
		// 判断是否是第一次登录，进行GA统计
		var isFirst = localStorage.getItem('isFirst');
		var referrer = document.referrer;
		var loginEnd = utils.getCookie('loginEnd');
		
		if(isFirst== null){
			// 第一次登录/注册
			window.dataLayer.push({
				"event":"accountRegistersuccess",
				"pageType":honorConfig.pageType,
				"siteLocation":"header_"+honorData.nationalCode
			})
			localStorage.setItem('isFirst',true);
		}else{
			
			if(loginEnd== null && referrer!=""){
				utils.setCookie("loginEnd","true",0,0,30);
				// 曾经在该浏览器登录过
				window.dataLayer.push({
					"event":"accountLoginsuccess",
					"pageType":honorConfig.pageType,
					"siteLocation":"header_"+honorData.nationalCode
				})
			}
			localStorage.setItem('isFirst',false)
		}  
	}
}

//更新通知icon显示隐藏的状态
function updataNoticeStatus(){
	var currPageWidth= utils.pageWidth(); 
	// 是否是荣耀中国公共Header
	var isCNHeader = $('.header-cn').length>0;
	honorData.loginName = decodeURI(utils.getCookie('loginUid'));
	if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
		// 已登录		
		if(currPageWidth>768){
			$('.header .site-login,.header .mobile-nav-login,.header .mobile-nav-logined').hide();
			$('.header .site-logined,.header .honor-notice').show();
		}else{
			if(!isCNHeader){
				$('.header .site-login,.header .site-logined,.header .mobile-nav-login').hide();
				$('.header .mobile-nav-logined').show();
			}else{
				$('.header .site-login').hide();
				$('.header .site-logined').show();
			}
		}
		// Header v2
		$('.header-v2 .app-header .app-account').addClass('logined');
	}else{
		// 未登录		
		if(currPageWidth>768){
			$('.header .site-login').show();
			$('.header .site-logined,.header .honor-notice,.header .mobile-nav-login,.header .mobile-nav-logined').hide();
		}else{
			$('.header .mobile-nav-login').show();
			if(!isCNHeader){
				$('.header .site-login').hide();
			}
			$('.header .site-logined,.header .mobile-nav-logined').hide();
		}
		// Header v2
		$('.header-v2 .app-header .app-account').removeClass('logined');
	}
	
}

(function(){ 
	(function () {   
		
		// 顶部二级导航切换	
		var currWindowW = utils.windowWidth();
		if(currWindowW>768){
			// 大屏
			if (endBrowser.versions.mobile || endBrowser.versions.android || endBrowser.versions.ios) {
				// 移动端
				$('.menu .text a.has-child').click(function(){
					//懒加载
				    $(this).siblings("div.sub-menu").find("img.swiper-lazy").lazyload({
			    		"placeholder":lazyload.placeholder
			    	}).show();
				    
					if($(this).hasClass('on')){
						$(this).removeClass('on');
						$(".font-Next-Page-arrow").removeClass("open");
			            $('.sub-menu').removeClass('sub-menu-hover');
					}else{
						$('.menu .text a').removeClass("on ");
				        $(this).stop().addClass("on");
				        $('.sub-menu').removeClass('sub-menu-hover');
				        $(".font-Next-Page-arrow").stop().addClass("open");
				        $(this).next('.sub-menu').stop().addClass('sub-menu-hover');
					}
				})
			}else{
				// PC端
				$('.menu .text a.nav-link').mouseenter(function(){
					//懒加载
				    $(this).siblings("div.sub-menu").find("img.swiper-lazy").lazyload({
			    		"placeholder":lazyload.placeholder
			    	}).show();
				    
			        $('.menu .text a').removeClass("on ");
			        $(this).stop().addClass("on");
			        
				    if($(this).hasClass('has-child')){
				    	$('.sub-menu').removeClass('sub-menu-hover');
				    	$(".font-Next-Page-arrow").stop().addClass("open");
				    	$(this).next('.sub-menu').stop().addClass('sub-menu-hover');
				    }else{
			            $(".font-Next-Page-arrow").removeClass("open");
			            $('.sub-menu').removeClass('sub-menu-hover');
				    }
			    })
			    $('.sub-menu').mouseleave(function(){
			        $('.menu .text a').removeClass("on");
			        $('.sub-menu').removeClass('sub-menu-hover');
			    })
			    
			}
		}else{
			//小屏
			$('.menu .text a.nav-link').click(function(){
				$('.menu .text a').removeClass("on ");
		        $(this).stop().addClass("on");
		        
				if($(this).hasClass('has-child')){
					$('.sub-menu').removeClass('sub-menu-hover');
					$(".font-Next-Page-arrow").stop().addClass("open");
					$(this).next('.sub-menu').stop().animate({left:"0"});
				}else{
		            $(".font-Next-Page-arrow").removeClass("open");
		            $('.sub-menu').animate({left:"-100%"});
				}
			})
		}
		
	 	//ga code start
	    $("body").on("click",".sub-menu .row div a",function(){
	    	 var proName=$(this).children("span").text();
	 		 var proCategory=$(this).parents(".sub-menu").prev("a").find(".name").text();
	 		 var proPosition=$(this).parent("div").index()+1;
	         window.dataLayer.push({
	         	"event": "eeListClick",
	         	"loginStatus": honorData.loginStatus,
	         	"productAvailability": "",
	         	'products': [{
	         	"listName": "nav product list",
	         	"name": proName,
	         	"id": proName,
	         	"price": "",
	         	"brand": "Honor",
	         	"category": proCategory,
	         	"variant": "",
	         	"position": proPosition,
	         	"productAvailability":""
	         	}]
	     	})
	    })
	    //ga code end
	    
	    if($(".footer .phone .font-Phone").data("phonenum")){
	    	$('#headphonenum b').text($(".footer .phone .font-Phone").data("phonenum"));
	    }else{
	    	$('#headphonenum').hide();
	    }   
	    if($("#workdaycalltime").text()){
	    	$('#mobileworkdaycalltime').text($("#workdaycalltime").text());
	    }
	    if($("#pccalltime").text()){
	    	$('#mobilecalltime').text($("#pccalltime").text());
	    }
	    $('.nav-btn').on('click', function() {
	    	$('.search-box').hide();
	    	$("body").css({
	        	"position":"relative"
	        })
	      if ($(this).children("span").hasClass("font-Hamburg")) {
	        $('.nav-btn').children("span").addClass("font-Next-Page-arrow").removeClass("font-Hamburg");
	        var wh = $(window).height() - 60;
	        $('.menu').animate({
	          left: "0"
	        });
	        $('.sub-menu').css('height', wh);
	         
		    closeBody();
	      } else { 
	    	 openBody();
	        if ($('.nav-btn .font-Next-Page-arrow').hasClass("open")) {
	          $('.nav-btn .font-Next-Page-arrow').removeClass("open");
	          $('.sub-menu').animate({
	            left: "-100%"
	          });
	        } else {
	          $('.nav-btn').children("span").addClass("font-Hamburg").removeClass("font-Next-Page-arrow");
	          $('.menu').animate({
	            left: "-100%"
	          });
	        }
	      }
	    })
	
	    $(".header .site-search").click(function(){
	    	$('.header .notice-box').stop().slideUp();
	    	if($('.ru-header-nav').length>0){
	    		$('.header .search-box').css('top','40px')
	    	}
	    	
	    	//ga code start
	    	window.dataLayer.push({
	    		"event": "searchIntent",
	    		"pageType": honorConfig.pageType,
	    		"siteLocation":"header"
	    		})
	    	
	        $(".search-box").slideToggle();
	        // 禁止移动端滚动 搜索区域底部的内容        
	             
	        $('html,body').toggleClass('overhidden');
	        if ($('.nav-btn .font-Next-Page-arrow').hasClass("open")) {
	            $('.nav-btn .font-Next-Page-arrow').removeClass("open");
	            $('.sub-menu').animate({
	              left: "-100%"
	            });
	            
	            
	          } else {
	            $('.nav-btn').children("span").addClass("font-Hamburg").removeClass("font-Next-Page-arrow");
	            $('.menu').animate({
	              left: "-100%"
	            });
	          }
	 	     
	        openBody();
	    })
	    $(".search-box .font-Cross").click(function(){
	    	   $('body').removeClass('mobileSearch');
	        $(".search-box").slideToggle();
	        $('html,body').removeClass('overhidden');
	    })
		
	})();
	
	
}());
   var HONORCOUNTRY = window.HONORCOUNTRY || {};
   
    HONORCOUNTRY.init = function(){

          $('.cs-title .font-Cross').click(function(){
        	  $("body").removeClass("hideScrollbar");
              $('.width-container').fadeOut();
          })

          $(".country-btn").click(function(){
        	  var ww=$(window).width();
        	  var wh;
        	  if(ww>768){
        		  wh=$(window).height()-400;
        	  }else{
        		  wh=$(window).height()-250;
        	  }
        	  
        	  $("body").addClass("hideScrollbar");
        	  $(".country-selector .country-selector-popup .content").css("height",wh);
        	  $(".region-tab li").eq(0).addClass("on");
              $('.width-container.country-selector').fadeIn();
          })
          
                    
          //选项卡
          $(".region-tab li").click(function(){
        	  var i=$(this).index();
        	  var tab=$(this).text();
        	  var tabText=$('.continent-title').eq(i).attr("id");
        	  $(this).addClass("on").siblings().removeClass("on");
        	  if(tab==tabText){
        		  scrollTopToDom($('.country-selector .content'), $('.continent-title:eq(0)'), $('.continent-title').eq(i));
        	  }
        	  
          });

	      function scrollTopToDom($scrollDom, $firstDom, $scrollToDom) {
	            var topOffsetPx = $firstDom.offset().top;
	            var domOffsetPx = $scrollToDom.offset().top;
	            // 目标元素相对于文档偏移量 - 第一个元素相对于文档偏移量 就是滚动条要滚动的距离
	            var scrollTopPx = domOffsetPx - topOffsetPx;
	            $scrollDom.animate({ // 动画方式滚动过去
	                scrollTop: scrollTopPx
	            }, 800);
	      }
          $('.country-selector .countries-top .lang-link').each(function(){
    		  var itemUrl =$(this).attr('href'); 
    		  var endUrl ='';
    		  if(itemUrl){
    			  if(itemUrl.indexOf('?')==-1){
    				  //链接中没有?
    				  endUrl = itemUrl+"?fromCountry="+LOGIN_COUNTRY_CODE;
    			  }else{
    				  //链接中有?
    				  endUrl = itemUrl+"&fromCountry="+LOGIN_COUNTRY_CODE;
    			  }
    			  $(this).attr('href',endUrl);
    		  }
          })
    }
    
    $( document ).ready(function() {
       HONORCOUNTRY.init();
    });

(function () {
	  var countryCode=window.digitalData.page.pageInfo.siteCode;
	  if(countryCode=="mea"){
		  $(".width-container.buy-box .country-selector-popup .content .continent-content .countries .rows .country-common .countries-top .countries-title").addClass("left");
	  }else if(countryCode=="meaar"){
		  $(".width-container.buy-box .country-selector-popup .content .continent-content .countries .rows .country-common .countries-top .countries-title").addClass("right");
	  }
	  function locationCheck() {
		  var thisUrl = location.href;
    	  var thisIndex = thisUrl.indexOf("?buynow");
    	  var targetUrl = thisUrl.substr(0,thisIndex);
    	  location.href= targetUrl;
	  }
      $('.buy-box .font-Cross').click(function(){
    	  if($(".product-subnav").length > 0) {
    		  locationCheck();
    	  } else {
    		  $('.buy-box').fadeOut();
              $("body,html").removeClass("honor-noscroll");
              $('.new .font-Cross').fadeOut(1000);
    	  }
      });
      
      $('.width-container.new .cs-title .close-icon').click(function(){
    	  if($(".product-subnav").length > 0) {
    		  locationCheck();
    	  } else {
    		  $(this).css("position","absolute");
        	  $('.buy-box').animate({top:"1200px"},500);
        	  $("body,html").removeClass("honor-noscroll");
    	  }
      });
      
      window.onresize= function() {
    	  var pageWidth = utils.pageWidth();
    	  if(pageWidth > 768) {
    		  $('.buy-box.new').css("top","0");
    		  resetArea();
    	  } else {
    		  $('.buy-box.new').show().css("top","1200px");
    	  }
      }
    
      $(".product-subnav .btn-buy").click(function(e){
    	  var thisUrl = location.href;
    	  var targetUrl;
    	  var thisHref = $(this).attr("href");
    	  if(thisUrl.indexOf("?buynow") < 0 && !thisHref) {
    		  targetUrl = thisUrl + "?buynow";
    		  location.href = targetUrl;
    	  }
      });
      
      // 链接后添加参数      
      $('.buy-box .countries-lang .langs').each(function(){
    	  var currClass = $(this).attr('class');
    	  if(currClass.indexOf('externalLinks') == -1){
    		  // 本站链接    		  
    		  var url = $(this).attr('href');
    		  var endUrl;
    		  if(url){
	    		  if(url.indexOf('?')==-1){
	    			  //链接中没有?
	    			  endUrl = url+"?fromCountry="+LOGIN_COUNTRY_CODE;
	    		  }else{
	    			  //链接中有?
	    			  endUrl = url+"&fromCountry="+LOGIN_COUNTRY_CODE;
	    		  }
    		  }
    		  $(this).attr('href',endUrl);
    		  
    	  }else{
    		  // 第三方链接
    		  var url = $(this).attr('url'); 
    		  var endUrl;
    		  if(url){
	    		  if(url.indexOf('?')==-1){
	    			  //链接中没有?
	    			  endUrl = url+"?fromCountry="+LOGIN_COUNTRY_CODE;
	    		  }else{
	    			  //链接中有?
	    			  endUrl = url+"&fromCountry="+LOGIN_COUNTRY_CODE;
	    		  }
    		  }
    		  $(this).attr('url',endUrl);
    	  } 
      })
      
      $('.buy-box .countries-lang .langs').click(function(){
    	  // GA统计      
    	  var urlType= $(this).attr('flag'); 
		  if(urlType=='country'){  
    		  window.dataLayer.push({
    			  "event": "buyNowOnStoreSite",
    			  "productName":  window.digitalData.page.category.subCategory2,
    			  "countryCode":LOGIN_COUNTRY_CODE
    		  })
		  }else if(urlType=='mall'){
			  var platformName=$(this).find('.mall-name').text(); 
			  window.dataLayer.push({
				  "event": "buyNowOn3rdPlatform",
				  "productName": window.digitalData.page.category.subCategory2,
				  "platformName":platformName
			  })
		  }
      })
      
      //点击区域切换
       $(".width-container").on("click", ".countyr-item", function(e){
    	  var pageWidth = utils.pageWidth();
     	  if(pageWidth > 768) {
     		 $(this).addClass("on").find(".country-selector-v2-right").show();
     		 $(this).siblings(".countyr-item").removeClass("on").find(".country-selector-v2-right").hide();
     	  } else {
     		 var targetClassName = e.target.className;
     		 if(targetClassName === "country-selector-v2-left" || targetClassName === "region" || targetClassName === "app-plus-icon clicked" || targetClassName === "app-plus-icon") {
     			 $(this).addClass("on").find(".country-selector-v2-right").stop().slideToggle();
	    		 $(this).find(".app-plus-icon").toggleClass("clicked");
	    		 $(this).siblings(".countyr-item").removeClass("on").find(".country-selector-v2-right").slideUp();
	    		 $(this).siblings(".countyr-item").find(".app-plus-icon").removeClass("clicked");
     		 }
     	  }
       });
      
      //初始化区域列表
      function resetArea() {
    	  var pageWidth = utils.pageWidth();
    	  if(pageWidth <= 768) {
    		  if($(".countries").find(".country-selector-v2-content").length > 0) {
    			  $(".countries").find(".country-selector-v2-right").hide();
    			  $(".countries").find(".app-plus-icon").removeClass("clicked");
    		  }
    	  } else if(pageWidth > 768) {
    		  if($(".country-selector-popup").find(".countyr-item").length > 0) {
    			  $(".country-selector-popup").find(".countyr-item:first").trigger("click");
    		  }
    	  }
      }
      
      //区域显示版本切换
      function changeStandard() {
    	  if($("#areaModel").length > 0) {
    		  var finalData = $("#areaModel").text() || "[]";
    		  var areaModelData = JSON.parse(finalData);
    		  if(areaModelData.length > 0) {
	       		   $(".country-selector-popup .content").hide();
	   	      		var areaHtml;
	   	      		var areaHtmlArray = [];
	   	      		for(var i = 0; i < areaModelData.length; i++) {
	   	      			var liHtml='';
	   	      			var liHtmlArray = [];
	   	      			for(var k = 0; k < areaModelData[i]["countrys"].length; k++) {
	   	      				liHtml+='<li>';
			   	      			liHtml+='<div class="link-bg">';
			   	      				liHtml+='<a href="' + areaModelData[i]["countrys"][k]["targetLink"] + '" class="site-link">';
			   	      					liHtml+='<span>' + areaModelData[i]["countrys"][k]["country"] + '</span>';
			   	      					var isMallSite = areaModelData[i]["countrys"][k]["isMallSite"]=='true';
		                            	if(isMallSite){
		                            		liHtml+='<span class="hicon-cart"></span>';
		                            	}
				   	      		liHtml+='</a>';
				   	      	liHtml+='</div>';
				   	     liHtml+='</li>';
	   	      			}
	   	      			areaHtmlArray[areaHtmlArray.length] = '<div class="countyr-item">' +
	   	    			                                      '<div class="country-selector-v2-left">' +
	   					                                      '<span class="region">' + areaModelData[i]["area"] + '</span>' +
	   					                                      '<div class="app-plus-icon">' +
	   				                                      	  '<span></span>' +
	   							                              '<span></span>' +
	   						                                  '</div>' +
	   				                                          '</div>' +
	   				                                          '<div class="country-selector-v2-right">' +
	   					                                      '<ul class="country-cont">' +
	   					                                      liHtml +
	   					                                      '</ul>' +
	   				                                          '</div>' +
	   			                                              '</div>';
	   	      		}
	   	      		areaHtml = '<div class="country-selector-v2-content">' +
	   	      		           areaHtmlArray.join("") +
	   	        	           '</div>';
	   	      		$(".countriesTwo").html(areaHtml);
	       	  } else {
	       		  $(".countriesTwo").hide();
	       	  }
	       	  
	       	  var pageWidth = utils.pageWidth();
	       	  if(pageWidth <= 768 && areaModelData.length > 0) {
	       		  $(".cs-title .description-black").show();
	       		  $(".cs-title").css("padding-top","40px");
	       		  $(".country-selector-popup").find(".content").hide();
	       	  }
    	  }
      }
      
      changeStandard();
      
      //buy now 弹窗url参数设置
      function getBuyNowParameter() {
    	  var thisUrl = location.href;
    	  if(thisUrl.indexOf("?buynow") > 0) {
    		  $(".buy-box").show();
    		  $(".buy-box").find(".countyr-item").eq(0).trigger("click");
        	  
        	  var pageWidth = utils.pageWidth();
        	  if(pageWidth > 768) {
        		  $('.width-container.new .cs-title .font-Cross').fadeIn(1000);
        	  }
        	   
        	  $("body,html").addClass("honor-noscroll");
        	  //ga code start
        	  var productName=window.digitalData.page.category.subCategory2;
        	  window.dataLayer.push({"event": "buyNow","productName": productName,"pageType":honorConfig.pageType})
        	  //ga code end
        	  if(utils.pageWidth() <= 768 && $(".new").length > 0) {
        		  $('.buy-box').animate({top:"0"},500);
        	  } else {
        		  $('.buy-box').fadeIn();
        	  }
        	  var $countryflag = $('.buy-box .country-img img');
        	  var $mallflag = $('.buy-box .mall-img img');
        	  $countryflag.css('background-color','transparent');
        	  $mallflag.css('background-color','transparent');
        	  $countryflag.each(function(){
        		  var img= $(this).attr('flag');
        		  $(this).attr('src',img);
        	  })
        	  $mallflag.each(function(){
        		  var img= $(this).attr('flag');
        		  $(this).attr('src',img);
        	  });
        	  
        	  resetArea();
    	  }
      }
      
      getBuyNowParameter();
})();
(function () { 
	var productList;
	if($('.header-v1 .search-box').length>0){
		
		 $(".header .site-search").click(function(){
			var selectSiteCode = honorConfig.siteCode;
			var wordUrl = utils.getSuitedUrl("/" + selectSiteCode.toLowerCase() + "/legal/privacy-questions/search/associativeWords.json");
			$.ajax({
		    		  url: wordUrl,
		    		  type: "GET",
		    		  dataType: "json",
		    		  success: function(info) {
		    			  if (info != null && typeof(info) != undefined && Object.keys(info).length>0)
		    			  {
		    				  productList = info[0].title;
		    			  }
		    			  else
		    			  {
		    				  console.log("info is null");
		    			  }
		    			  
		    			  
		    		  },
		    		  error: function(err) {
		    			  console.log(err);
		    		  }
		    	  })
		 })
		
		
		
		var searchType=$("#isVsearch").val();
		var searchAPIUrl=$("#vsearchAPIUrl").val();
		if(searchType=="true"){
			vSearch();
		}else{
			iSearch();
		}
		//iSearch搜索方法
		function iSearch(){
			// 页面初始化数据
		    var pageData = {
		      "page": 1, // 搜索记录页码,应从第一页开始
		      "size": 4 // 每页记录数
		    }
		    
		    var placeholder = $(".suggested-title").data("alertmessage");
		    if(!placeholder){
		    	placeholder="search HONOR..."
		    }
		    
		    // 获取热词
		    getHotWords();
		
		    // 点击箭头搜索和回车搜索
		    $('.search-input .font-Previous-Page-arrow').click(function() {
		      var key = $(this).siblings('.search-val').val();
		      if (key.length < 2) {
		        alert(placeholder)
		        return;
		      } else {
		        // 调用产品关键字搜索方法，临时静态方法，当下面siteSearch方法调通后替换删掉
		      	$("li").remove(".show");
		      	pageData.page=1;
		        siteSearch(key, pageData.page, pageData.size);
		        $('.suggested,.related').hide();
		      }
		    }) // 搜索框回车搜素事件
		    $(".search-input input").keydown(function() {
		      var theEvent = window.event || arguments.callee.caller.arguments[0]; //谷歌能识别event，火狐识别不了，所以增加了这一句，chrome浏览器可以直接支持event.keyCode
			  var code = theEvent.keyCode;
		      if (code == 13) {
		        // 调用产品关键字搜索方法
		        var key = $('.search-input input').val();
		        if (key.length < 2) {
		          alert(placeholder)
		          return;
		        } else {
		        	$("li").remove(".show");
		        	pageData.page=1;
		           siteSearch(key, pageData.page, pageData.size);
		          $('.related').hide();
		        }
		      }
		    })
		
		    // 输入框内模糊匹配搜索
		    $('.search-input input').bind('input propertychange', function(that) {
		      var currVal = $.trim($(this).val());
		      if ("" != currVal && currVal.length > 1) {
		        $('.suggested').hide();
		        // 查询提示词
		        getSuggestWords(currVal);
		        $('.related').show();
		      } else {
		        $('.suggested').show();
		        $('.related,.search-result').hide();
		      }
		    });
		
		    // 产品相关搜索结果【加载更多】
		    $('.load-more').click(function() {
		        var key = $('.search-input input').val();
		        siteSearch(key, pageData.page, pageData.size);
		    })
		    
		    /** 接口：获取热词
		     * 目前该接口无法从外网访问，页面上只是显示了静态数据
		     */
		    function getHotWords() {
		      var startDate = GetDateStr(-7);
		      var endDate = GetDateStr(0);
		      var appNumber = $(".search-box .search-content").data("appid") || "A87295736";
		      var getHotWords = $(".search-box .search-input").data("gethotwords") || '';
		      if(getHotWords){
		    	  $.ajax({
		    		  url: getHotWords,
		    		  type: "GET",
		    		  data: {
		    			  "appNumber": appNumber,
		    			  "text": "*",
		    			  "startDate": "2017-06-07",
		    			  "endDate": endDate,
		    			  "size": 5
		    		  },
		    		  dataType: "jsonp",
		    		  jsonp: "jsonp",
		    		  success: function(info) {
		    			  if (info.responseCode == '200') {
		    				  var data = info.responseData.hotWords;
		    				  var hotstr = '';
		    				  
		    				  if (data) {
		    					  for (i = 0; i < data.length; i++) {
		    						  hotstr += '<li>' + data[i] + '</li>';
		    					  }
		    				  }
		    				  
		    				  $(".suggested .keywords").empty().html(hotstr)
		    				  
		    				  // 点击推荐搜索关键字
		    				  $('.suggested .keywords li').click(function() {
		    					  var key = $(this).text();
		    					  $('.search-input input').val(key);
		    					  if (key.length < 2) {
		    						  alert(placeholder)
		    						  return;
		    					  } else {
		    						  // 调用产品关键字搜索方法
		    						  siteSearch(key, pageData.page, pageData.size);
		    						  $('.suggested').hide();
		    					  }
		    				  })
		    				  
		    			  } else {
		    				  console.log('热词查询异常');
		    			  }
		    		  },
		    		  error: function(err) {
		    			  console.log(err);
		    		  }
		    	  })
		      } 
		    }

		    /** 接口：实时获取提示词
		     * 目前该接口无法从外网访问，页面上只是显示了静态数据
		     */
		    function getSuggestWords(txt) {
		      var getSuggestWords = $(".search-box .search-input").data("getsuggestwords");
		      var indexDb = $(".search-box .search-input").data("suggest-indexdb");
		      var appNumber = $(".search-box .search-content").data("appid") || "A87295736";
		      var endTxt = utils.stripscript(txt);
		      $.ajax({
		        url: getSuggestWords,
		        type: "GET",
		        data: {
		          "appNumber": appNumber,
		          "username": "",
		          "appUserID": "",
		          "indexDB": indexDb,
		          "indexDBType": indexDb,
		          "text": endTxt
		        },
		        dataType: "jsonp",
		        jsonp: "jsonp",
		        success: function(info) {
		        	
		          if (info.responseCode == '200') { 
		            var data = info.responseData.suggestQueryWords;
		            var suggstr = '';
		            
		            for (var i = 0; i < data.length; i++) {
		                suggstr += '<li class="list-item">' + data[i] + '</li>';
		            }
		            $('.related').show();
		            $('.related .related-lists').empty().html(suggstr)

		            // 提示词点击事件
		            $('.related-lists li').click(function() {
		              var key = $.trim($(this).text()); 
		              $('.search-input input').val(key);
		              if (key.length < 2) {
		                alert(placeholder)
		                return;
		              } else {
		                // 调用产品关键字搜索方法
		                 siteSearch(key, pageData.page, pageData.size);
		                $('.suggested').hide();
		                $('.related').hide();
		              }
		            })
		          } else {
		            console.log('提示词查询异常');
		          }
		        },
		        error: function(err) {
		          console.log(err);
		        }
		      })
		    }

		    /** 接口：站点顶部搜索
		     * @param key:关键词
		     * @param page:页码
		     * @param size:每页记录数
		     * @param type: first/more 用于区分首次搜索或者是加载更多
		     */
		    function siteSearch(key, page, size, type) {
		      type = type || 'first'
		      var siteSearch = $(".search-box .search-input").data("sitesearch");
		      var appNumber = $(".search-box .search-content").data("appid") || "A87295736";
		      var dbName = $(".search-box .search-input").data("search-dbname");
		      var esType = $(".search-box .search-input").data("search-estype");
		      var endKey = utils.stripscript(key);
		      $.ajax({
		        url: siteSearch,
		        type: "GET",
		        data: {         
		          "APP_NUM": appNumber,
		          "username": "GUEST%20TEST",
		          "templateType": "global",
		          "indexDB": "MCIP_SEARCH",
		          "from": page,
		          "lang": "cn",
		          "dbName": dbName,
		          "esType": esType,
		          "jsonp": "jQuery111307745580982322504_1527234216378",
		          "topMatch": "consumer_product:31,32,33,36,37",
		          "mcCurPage": page,
		          "pageSize": size,
		          "tagMatch": "same",
		          "ssUserText": endKey,
		          "queryMatch": "consumer_product:31,32,33,36,37;support:manual,software,faqs;consumer_press:consumer_news,consumer_media_coverage,consumer_awards;support_product:no;consumer_events:no;consumer_video:no_: 1527234216380"   
		        },
		        dataType: "jsonp",
		            jsonp: "jsonp",
		        success: function(info) { 
		            pageData.page = page + 1;
		            // 非加载更多搜索
		            if (type == 'first') {
		              // 搜索记录总数
		              var totalNum = info.list[0].totalNum;        
		              $('.result-title .result-num').text(totalNum);
		              
		              //ga code start
		              var gauri=window.digitalData.page.pageInfo.uri;
		              window.dataLayer.push({"event":"virtualPageview","page": gauri + "/search","res55": totalNum,"kw55": key,"cat55": "","loginStatus": honorData.loginStatus});
		              //ga code end
		              
		              // 搜索记录数据
		              var data = info.list[0];
		              // 热门产品数据
		              var hotLists = data.productlist;
		              var hotstr = '';
		              if (hotLists) {
			              for (var i = 0; i < hotLists.length; i++) {
			                hotstr += '<li>';
			                hotstr += '<a href="' + removeDomain(hotLists[i].DOC_URL) + '">';
			                /*var altString = $(hotLists[i].DRETITLE).text();*/
			                hotstr += '<img src="' + hotLists[i].RESERVE_FIELD32 + '" alt="' + hotLists[i].autn_title +'"></a>';                hotstr += '<strong>' + hotLists[i].DRETITLE + '</strong>';
			                hotstr += '<p>' + hotLists[i].DOC_DESCRIPTION + '</p > ';
			                hotstr += '</li>';
			              }
		              }
		              $('.hot-products').empty().html(hotstr)
		            }
		            // 全部结果列表数据
		            var allLists = data.alllist;
		            var allstr = '';  
		            if(allLists){
		            	for (var i = 0; i < allLists.length; i++) {
		                    var currData = allLists[i];
		                    allstr += '<li class="show">';
		                    var typeText = $('.news-lists').data("searchnewstext");
		                    if (currData.RESERVE_FIELD2 == 'consumer_product') {
		                      typeText = $('.news-lists').data("searchproducttext");
		                    } else if (currData.RESERVE_FIELD2 == 'support') {
		                      typeText = $('.news-lists').data("searchsupporttext");
		                    }
		                    allstr += '<a class="tag">' + typeText + '</a>';
		                    if (!(currData.RESERVE_FIELD22 == "manual" && currData.RESERVE_FIELD33)) {
		                  	  allstr += '<strong><a href="' + removeDomain(currData.DOC_URL) + '">' + currData.DRETITLE + '</a></strong>';
		                    } else {
		                  	  allstr += '<strong><a href="' + currData.RESERVE_FIELD33 + '">' + currData.DRETITLE + '</a></strong>';
		                    }
		                    allstr += '<p><span class="time">' + formatTime(currData.RESERVE_FIELD11) + '</span> <span class="content">' + (currData.DOC_DESCRIPTION || "") + '</span></p>';
		                    allstr += '</li>';
		                  }
		            } 
		            $('.news-lists').append(allstr);

		            // 显示搜索结果
		            $('.search-result').show();
		            var mcCurPage = info.list[0].mcCurPage;
		            if(mcCurPage >= info.list[0].totalPageNum){
		            	$('.load-more').hide();
		            }else{
		            	$('.load-more').show();
		            }

		        },
		        error: function(err) {
		          console.log(err);
		        }
		      })
		    }



		    /*======================= 站点搜索 End ====================*/
		    // 格式化日期格式    
		    function formatTime(c) {
				if (c && c != "") {
					var b = c.split("-");
					var a = formatMonth(b[1]);
					return a + " " + b[2] + ", " + b[0]
				} else {
					return ""
				}
			}

			function formatMonth(a) {
				var m = parseInt(a);
				switch (m) {
				case 1:
					return "January";
				case 2:
					return "February";
				case 3:
					return "March";
				case 4:
					return "April";
				case 5:
					return "May";
				case 6:
					return "June";
				case 7:
					return "July";
				case 8:
					return "August";
				case 9:
					return "September";
				case 10:
					return "October";
				case 11:
					return "November";
				case 12:
					return "December"
				}
			}
			
		    function GetDateStr(AddDayCount) {
		        var dd = new Date();
		        dd.setDate(dd.getDate() + AddDayCount); //获取AddDayCount天后的日期
		        var y = dd.getFullYear();
		        var m = dd.getMonth() + 1; //获取当前月份的日期
		        var d = dd.getDate();
		        if (m <= 9) {
		          m = '0' + m
		        }
		        if (d <= 9) {
		          d = '0' + d
		        }
		        return y + "-" + m + "-" + d;
		      }
		      var DOMAIN = "hihonor.cbg-app.huawei.com";
		      var DOMAIN_LEGACY = "hihonor-test.cbg-app.huawei.com";
		      function removeDomain(url){
		          var existedDomain = "";
		          if( url.indexOf(DOMAIN) > -1){
		              existedDomain = DOMAIN;
		          }else if (url.indexOf(DOMAIN_LEGACY)){
		              existedDomain = DOMAIN_LEGACY;
		          }
		        return url.substr(url.indexOf(existedDomain)+existedDomain.length);
		      }
		}
		//智能搜索方法
		function vSearch(){
			var placeholder = $(".suggested-title").data("alertmessage");
		    if(!placeholder){
		    	placeholder="search HONOR..."
		    }
		    
		    // 获取热词
		    getHotWords();
		    
		    var searchCurrPath = location.href;
			var searchPrePath = searchCurrPath.split('/content/honor/')[0];
			var searchEndPath ='';
			if(searchCurrPath.indexOf('.html')!=-1){
				//预览环境
				searchEndPath ='/content/honor/'+digitalData.page.pageInfo.siteCode2+'/search.html?wcmmode=disabled&keyword=';
			}else{
				//发布环境
				searchEndPath ='/'+digitalData.page.pageInfo.siteCode2+'/search/?keyword=';
			}
		    // 点击箭头搜索和回车搜索
		    $('.search-input .font-Previous-Page-arrow').click(function() {
		      var key = utils.stripscript($(this).siblings('.search-val').val());
		      if(key.length>1){
		        	window.location.href=searchEndPath+key;
		        }
		    }) 
		    // 搜索框回车搜素事件
		    $(".search-input input").keydown(function() {
		      var theEvent = window.event || arguments.callee.caller.arguments[0]; //谷歌能识别event，火狐识别不了，所以增加了这一句，chrome浏览器可以直接支持event.keyCode
			  var code = theEvent.keyCode;
		      if (code == 13) {
		        // 调用产品关键字搜索方法
		        var key = utils.stripscript($('.search-input input').val());
		        if(key.length>1){
		        	window.location.href=searchEndPath+key;
		        }
		      }
		    })
		    // 输入框内模糊匹配搜索
		    $('.search-input input').bind('input propertychange', function(that) {
		      var currVal = $.trim($(this).val());
		      if ("" != currVal && currVal.length > 0) {
		        $('.suggested').hide();
		        $('.related').show();
		        // 查询提示词
		        getSuggestWords(currVal);
		        
		      } else {
		        $('.suggested').show();
		        $('.related,.search-result').hide();
		      }
		    });
			/** 接口：智能搜索获取热词 **/
			function getHotWords() {
				var getHotWords=searchAPIUrl+"vofficial/hot";
					$.ajax({
			    		  url: getHotWords,
			    		  type: "GET",
			    		  data: {
			    			  "qAppName": "HonorOfficial",
			    			  "language": honorConfig.searchLang,
			    			  "site": honorConfig.siteCode
			    		  },
			    		  dataType: "jsonp",
			    		  jsonp: "jsonp",
			    		  success: function(info) {
			    			  if (info.length>0) {
			    				  var hotstr = '';
			    				  for (i = 0; i < info.length; i++) {
			    						  hotstr += '<li><a href='+searchEndPath+encodeURI(info[i].key)+'>' + info[i].key + '</a></li>';
			    				  }
			    				  
			    				  $(".suggested .keywords,.hot_word-v3 ul").empty().html(hotstr);
			    			  } else {
			    				  console.log('热词查询异常');
			    			  }
			    		  },
			    		  error: function(err) {
			    			  console.log(err);
			    		  }
			    	  })
			}
		    
		    //补全查询
		    function getSuggestWords(txt) {
			      var getSuggestWords =searchAPIUrl+"vofficial/complete";
			      var endTxt = encodeURI(txt);
			      var rl;
			      function HeightKey(txt, key, tag) {
			  	    var str = txt;
			  	    var _keys = key;
			  	    var k_index = (str && _keys) ? str.toLowerCase().indexOf(_keys.toLowerCase()) : -1;
			  	    if (k_index > -1) {
			  	        if (k_index == 0) {
			  	            var str1 = "<" + tag + ">" + str.substring(0, _keys.length) + "</" + tag + ">"
			  	            var str2 = str.substring(_keys.length, str.length)
			  	            var str3 = ''
			  	        } else {
			  	            var str1 = str.substring(0, k_index)
			  	            var str2 = "<" + tag + ">" + str.substring(k_index, _keys.length + k_index) + "</" + tag + ">"
			  	            var str3 = str.substring(_keys.length + k_index, txt.length)
			  	        }
			  	        str = str1 + str2 + str3;
			  	    }
			  	    return str
			  	  }

			      selectKey = [];
			      var lowerEndText = txt.toLowerCase();
			      if (productList!= null && typeof(productList) != undefined)
			      {
			    	  var productArr = productList.split(",");
			    	  for ( var i = 0; i <productArr.length; i++){
			    		  if (productArr[i].toLowerCase().indexOf(lowerEndText) != -1)
			    		  {
			    			  selectKey.push(productArr[i]);
			    		  }
			    	  }
			      }
			     
			      	  if (selectKey.length > 0) { 
			            var suggstr = '';
			            for (var i = 0; i < selectKey.length; i++) {
			            	rl = HeightKey(selectKey[i], txt, "strong");
			                suggstr += '<li class="list-item"><a href="'+searchEndPath+encodeURI(selectKey[i])+'">' + rl + '</a></li>';
			            }
			            $('.related ul.related-lists').empty().html(suggstr);
			          } else { 
			            $('.related').hide();
			            $('.suggested').show();
			          }
			    }
		}
	}
})();
/*!
 * 	Common Share v1.0.0 (2019-06-05T09:48:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.common-share').length>0){
			
			var currPageUrl = window.location.href;
			var shareTitle = $('#shareTitle').val();
			var shareDesc = $('#shareDesc').val();
			
			// Facebook Share
			$('.common-share .share-fb').click(function(){
				window.open ("https://www.facebook.com/sharer.php?u="+currPageUrl, "newwindow", "width=500,height=420,top=100, left=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
			})
			
			// Twitter Share
			$('.common-share .share-tw').click(function(){
				window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(shareTitle) +'  '+ encodeURIComponent(shareDesc) +' &amp;url=' + encodeURIComponent(currPageUrl),"newwindow", " width=500,height=420, top=100, left=100, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
			})
		}
	})
}());

/*!
 * 	Header v2.0.0 (2019-04-02T15:50:51+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
	if($('.header-v2').length>0){
		// 解决author环境导航不能编辑的问题
		if($('.header-v2-edit').length>0){
			$('.header-v2-edit .app-header').empty();
		}
		// 是否是荣耀中国公共Header
		var isCNHeader = $('.header-cn').length>0;
		
		//三级导航传参，去掉AEM默认'/'
		$('.header-v2 .header-subnav .view-all').each(function(index){
			var moreLink=$(this).attr("href");
			if(moreLink!=undefined && moreLink!="" && moreLink!=null){
				if(moreLink.indexOf("categories")>=0){
					if(moreLink.charAt(moreLink.length - 1) == "/") {
						$(this).attr("href",moreLink.substring(0, moreLink.length - 1));
					}
				}
			}
		});
		//二级导航传参,去掉AEM默认 '/'
		$('.header-v2 .directLink').each(function(index){
			var directUrl = $(this).attr("href");
			if(directUrl!=undefined && directUrl!="" && directUrl!=null){
				if(directUrl.indexOf("blog")>=0 || directUrl.indexOf("news")>=0 || directUrl.indexOf("event")>=0){
					if(directUrl.charAt(directUrl.length - 1) == "/") {
						$(this).attr("href",directUrl.substring(0, directUrl.length - 1));
					}
				}
			}
		})
		//一级导航传参,去掉AEM默认 '/'
		$('.subnav-title a').each(function(index){
			var directUrl = $(this).attr("href");
			if(directUrl!=undefined && directUrl!="" && directUrl!=null){
				if(directUrl.indexOf("blog")>=0 || directUrl.indexOf("news")>=0 || directUrl.indexOf("event")>=0){
					if(directUrl.charAt(directUrl.length - 1) == "/") {
						$(this).attr("href",directUrl.substring(0, directUrl.length - 1));
					}
				}
			}
		})
		// 当前页面选中效果开始
		$('.header-v2 .nav-pagetype').each(function(index){
			var that = $(this);
			var data = that.val();
			if(data.indexOf(honorConfig.pageType) != -1){
				that.parent().addClass('active');
			}
		})   
		
		// 针对屏幕分辨率高度小于三个级别菜单展开的总高度（750=67+60+623）时，做适配优化
		var optimization = (utils.windowHeight()<=750) ? true : false;
		var thirdNavH = '623px';
		if(isCNHeader){
			thirdNavH = '380px';
			$('.header .service-lists .lists-box').addClass('optimization');
		}
		if(optimization && !isCNHeader){
			thirdNavH = '455px';
			$('.header-v2 .header-nav,.header .service-lists .lists-box').addClass('optimization');
		}
		
		if(utils.windowWidth()>768){
			// 大屏设备 再判断是否移动端
			if (endBrowser.versions.mobile || endBrowser.versions.android || endBrowser.versions.ios) {
				// 一级菜单显示隐藏
				$('.header-v2 .header-nav .main-nav').click(function(e){
					utils.stopBubble(e);
					var that = $(this);
					var $siblings = that.siblings();
					hideMainNav($siblings);
					$siblings.attr('flag','hide');
					
					var flag = that.attr('flag');
					if(flag=='hide'){
						showMainNav(that);
						that.attr('flag','show');
					}else{
						hideMainNav(that);
						that.attr('flag','hide');
					}
				})
			}else{
				// 一级菜单显示隐藏
				$('.header-v2 .header-nav .main-nav').mouseenter(function(event){
					if(event.relatedTarget!=null) {
						var that = $(this);
						showMainNav(that);
					}
				})
				$('.header-v2 .header-nav .main-nav').mouseleave(function(event){
					if(event.relatedTarget!=null) {
						var that = $(this);
						hideMainNav(that);
					}
				})
			}
			// 二级菜单切换		
			$('.header-v2 .header-subnav li').click(function(e){
				utils.stopBubble(e);
				var that = $(this);
				changSubNav(that);
			})
	    	
	    	// 三级菜单 轮播图相关
			var prevElVal ='.swiper-arrow .honorFont-arr-left';
			var nextElVal='.swiper-arrow .honorFont-arr-right';
			if($('.__arabic__').length>0){
				prevElVal='.swiper-arrow .honorFont-arr-right';
				nextElVal='.swiper-arrow .honorFont-arr-left';
			}
			$('.header-v2 .header-nav .subnav-lists').each(function(index){
				var that = $(this);
				var slideNum =that.find('.swiper-slide:last-child').data('num');
				if(slideNum>4){
					that.find('.swiper-bottom').show();
					// 生成轮播图
					var mySwiper = 'swiper'+index;
					mySwiper = new Swiper(that, {
						noSwiping:true,
						slidesPerView : 'auto',
						navigation: {
							nextEl: nextElVal,
							prevEl: prevElVal,
						}
					});
					// 超出屏幕的图片按需加载
					var num = 5;
					that.find('.honorFont-arr-right').click(function(e){
						num +=1;
						var clazz = '.swiper-slide:nth-child('+(num)+') .item-img';
						var $img = that.find(clazz);
						var src = $img.data('src');
						$img.attr('src',src);
						var imgLoad = imagesLoaded($img);
						imgLoad.on('done', function(instance) {
							// 加载完成 
							$img.css('visibility','visible');
							$img.parent().parent().removeClass('honor-loading-v2');
						})
					})
				}
			})
		}else{
			// 小屏移动端
			// 隐藏一级导航超链接，防止移动端点击一级菜单展开时，跳转页面
			$('.header-cn .app-header .app-header-content .has-child.has-link').each(function(){
				$(this).attr('href','javascript:void(0);');
			})
			// 显示隐藏头部导航
			$('.header-v2 .app-bar-icon').click(function(){
				var $that = $(this);
				var scrollTop = $(document).scrollTop();
				var appNavFlag = $that.attr('flag');
				$that.toggleClass('clicked');
				if(appNavFlag=='hide'){
					if(digitalData.page.category.pageType == "brand" && $("video").length > 0) {
						$("video").hide();
					}
					
					//关闭状态，需要展开
					$that.attr('flag','show');
					$('html,body').css('overflow','hidden');
					if(isCNHeader){
						$('.header-v2 .app-header-content').addClass('active');
					}else{
						$('.header-v2 .app-header-content').stop().slideDown();
					}
					
					//修复iPhone端滚动异常bug
					if (scrollTop == 0) {
				    	$('.header .header-v2,html,body').addClass('fixed-ios');
				    }
				}else{
					if(digitalData.page.category.pageType == "brand") {
						$("video").show();
					}
					//展开状态，需要关闭
					$that.attr('flag','hide');
					$('html,body').css('overflow','auto');
					if(isCNHeader){
						$('.header-v2 .app-header-content').removeClass('active');
					}else{
						$('.header-v2 .app-header-content').stop().slideUp();
					}
					
					// 修复iPhone端滚动异常bug
					if (scrollTop == 0) {
				    	$('html,body,.header .header-v2').removeClass('fixed-ios');
				    }
				}
				// 判断app-header-content的高度
				var appHeaderContentH = utils.windowHeight()-129;
				var appSearchH =$('.header-v2 .app-header-content .app-search').height();
				var appAccountH = $('.header-v2 .app-header-content .app-account').height();
				var appNavH = $('.header-v2 .app-header-content .app-nav').height();
				var totalH = appSearchH+appAccountH+appNavH;
				if(totalH>=appHeaderContentH){
					$('.header-v2 .btn-country').css('position','relative');
				}
				
			})
			// 移动端 导航点击交互			
			$('.header-v2 .app-nav .subnav-title').stop().click(function(e){
				utils.stopBubble(e);
				var $that = $(this);
				$('.header-v2 .main-nav .header-subnav').stop().slideUp();
				$that.find('.app-plus-icon').toggleClass('clicked');
				
				var $appSubnav = $that.siblings('.header-subnav');
				$appSubnav.stop().slideToggle();
				$that.parent().siblings('.main-nav').find('.app-plus-icon').removeClass('clicked');

				//三级导航传参，去掉AEM默认'/'
				$('.app-header .header-subnav li').find(".app-subnav").each(function(index){
					var appLink=$(this).attr("href");
					if(appLink!=undefined && appLink!="" && appLink!=null){
						if(appLink.indexOf("categories")>=0){
							$(this).attr("href",appLink.substring(0, appLink.lastIndexOf("/")));
						}
					}
				});
				
				if(!isCNHeader){
					// Support 最新产品
					if($appSubnav.find('.latest-lists').length>0){
						$appSubnav.find('.latest-lists .item-img img').each(function(){
							var $curr = $(this);
							navImgLoading($curr);
						})
					}
					
					// Support 快捷服务
					if($appSubnav.find('.service-lists').length>0){
						$appSubnav.find('.service-lists .item-img img').each(function(){
							var $curr = $(this);
							navImgLoading($curr);
						})
					}
				}
			})
			
		}
		
		// 导航产品图 链接点击 GA统计
		$(".header-v2 .header-subnav .swiper-slide a").click(function(){
	    	 var proName=$(this).children(".item-title").text();
	 		 var proCategory=$(".header-subnav .active .pc-subnav").text();
	 		 var proPosition=$(this).parent().data('num');
	         window.dataLayer.push({
	         	"event": "eeListClick",
	         	"loginStatus": honorData.loginStatus,
	         	"productAvailability": "",
	         	'products': [{
	         	"listName": "nav product list",
	         	"name": proName,
	         	"id": proName,
	         	"price": "",
	         	"brand": "HONOR",
	         	"category": proCategory,
	         	"variant": "",
	         	"position": proPosition,
	         	"productAvailability":""
	         	}]
	     	})
	    })
	    
	    //一级导航点击事件 GA统计
	    $("body").on("click",".main-nav .subnav-title a,.header-v2 .header-account .btn-country,.header-v2 .logo-home",function(){
	    	var txtForGA = $.trim($(this).data('txtforga') || '');
	    	var currTxt = $.trim($(this).text() || '');
	    	var navigationNameL1 = txtForGA ? txtForGA : currTxt;
	    	if(navigationNameL1==""){
	    		navigationNameL1="HONOR LOGO";
	    	}
	    	window.dataLayer.push({
	    		"event": "uaEvent",
	    		"eventCategory": "Navigation L1",
	    		"eventAction": "click",
	    		"eventLabel": navigationNameL1
	    	})
	    })
	    
	    //二级导航点击事件 GA统计
	    $(".main-nav .header-subnav li a.pc-subnav,.main-nav .header-subnav li a.app-subnav,.main-nav .header-subnav li a.directLink").click(function(e){
	    	var txtForGA = $.trim($(this).data('txtforga') || '');
	    	var currTxt = $.trim($(this).text() || '');
	    	var navigationNameL2 = txtForGA ? txtForGA : currTxt;

	    	window.dataLayer.push({
	    		"event": "uaEvent",
	    		"eventCategory": "Navigation L2",
	    		"eventAction": "click",
	    		"eventLabel": navigationNameL2
	    	})
	    	
	    	// $当前模块名（英文传值）+国家站点
	    	var cat = navigationNameL2 +"+"+ honorConfig.countryCode +"+"+ honorConfig.lang;
	    	// $所点击内容(除动态内容外尽量使用英文传值) 
	    	var lab = navigationNameL2;
	    	ga('newhuaiweisupport.send', 'event', cat,'Click',lab);
	    })
	    // View All Products Button GA Code
	    $('.header-v2 .header-nav a.view-all').click(function(e){
	    	var buttonName = $.trim($(this).text()) || '';
	    	window.dataLayer.push({
	    		"event": "uaEvent",
				"eventCategory": "Header Navigation",
				"eventAction": "click",
				"eventLabel": buttonName
	    	})
	    	//GA Click ProductMore and SupportMore
	    	utils.stopBubble(e);
	    	var cat = $(this).attr("cat")+'+'+honorConfig.countryCode+'+'+honorConfig.lang;
	    	var lab = $(this).attr("lab");
	    	ga('newhuaiweisupport.send','event',cat,'Click',lab);
			
	    })
	    
		$(window).scroll(function() {
		    var scrollTop = $(document).scrollTop();
		    if (scrollTop > 0) {
		        // 固定头部
		    	$('.header .header-v2').css('position','fixed');
		    } else {
		    	$('.header .header-v2').css('position','relative');
		    }
		})
		
		// 快捷服务三级导航样式优化
		var $serviceLists = $('.service-lists .subnav-lists');
		var num = parseInt($('.service-lists .subnav-lists li:last-child').data('num'));
		if(num<3){
			$serviceLists.addClass('less-list');
		}else{
			$serviceLists.removeClass('less-list');
		}
		
		// Support 最新产品和快捷服务 三级导航 GA统计
		$('.latest-lists .subnav-lists .item-lists a,.service-lists .subnav-lists .lists-box a').click(function(e){
			debugger
			// 所属二级导航+国家站点+站点语言
			var category = $(this).data('category') || '';
	    	var cat = category +"+"+ honorConfig.countryCode +"+"+ honorConfig.lang;
	    	// $所点击内容(除动态内容外尽量使用英文传值) 
	    	var txtForGA = $.trim($(this).data('txtforga') || '');
	    	var currTxt = $.trim($(this).text() || '');
	    	var lab = txtForGA ? txtForGA : currTxt;
	    	ga('newhuaiweisupport.send', 'event', cat,'Click',lab);
	    	
		})
		
		// 展开一级导航
		function showMainNav(that){
			// Step1 隐藏其他一级导航下的内容
			// 隐藏其他一级导航下的三级菜单
			var $otherThirdNav = that.find('.header-subnav li').find('.subnav-lists');
			that.find('.header-subnav li').removeClass('active');
			hideNav($otherThirdNav);

			// 隐藏其他一级导航下的二级菜单
			var $otherSubnav = that.siblings().find('.header-subnav');
			hideNav($otherSubnav);
			
			// Step2 展开当前一级菜单下的内容
			that.find('.header-subnav').css('visibility','visible').stop().animate({
				'height':'60px'
			},500,function(){
				// 显示二级菜单
				var $firstLi = that.find('.header-subnav>ul>li:first-child');
				if($firstLi.find('.subnav-lists').length>0){
					//如果有三级菜单
					$firstLi.addClass('active');
					if(!isCNHeader){
						$('.header-v2 .header-overlay').stop().show();
					}
					$firstLi.find('.subnav-lists').show().css('visibility','visible').stop().animate({
						'height':thirdNavH
					},500,function(){
						// 图片懒加载
						headerNavImgLoading($firstLi);
					}); 
					//GA code start
					var navproView=[];
					$firstLi.find('.item-title').each(function(i){
							var proName=$firstLi.find('.item-title').eq(i).text();
							var proPosition=i+1;
							var navproItem={
						    			"listName": "nav product list",
						    			"name": proName,
						    			"id": proName,
						    			"price": "",
						    			"brand": "HONOR",
						    			"category": "",
						    			"variant": "",
						    			"position": proPosition,
						    			"productAvailability":""
						    };
							navproView.push(navproItem);
					})
					window.dataLayer.push({
							"event": "eeListView",
							"loginStatus": honorData.loginStatus,
							"productAvailability": "",
							'products': navproView
					})
					//GA code end
				}
			});
		}
		
		//隐藏一级导航
		function hideMainNav(that){
			// 二级导航
			var $currSubnav = that.find('.header-subnav');
			// 三级导航
			var $currThirdNav = that.find('.subnav-lists');
			if($currThirdNav.length>0){
				$currThirdNav.stop().animate({
					'height':'0'
				},500,function(){
					$('.header-v2 .header-overlay').stop().hide();
					$currThirdNav.hide().css('visibility','hidden');
					
					hideNav($currSubnav);
				})
			}else{
				hideNav($currSubnav);
			}
		}
		
		// 隐藏当前导航内容
		function hideNav(obj){
			obj.stop().animate({
				'height':'0px'
			},500,function(){
				obj.css('visibility','hidden');
			});
		}
		
		// 二级导航切换
		function changSubNav(that){
			that.siblings().removeClass('active').find('.subnav-lists').hide().stop().css({
				'height':'0',
				'visibility':'hidden'
			})
			that.addClass('active').find('.subnav-lists').show().stop().css({
				'visibility':'visible',
				'height':thirdNavH	
			})
			
			// 图片懒加载 
			headerNavImgLoading(that);
			
			//GA code start
			var navproView=[];
			that.find('.item-title').each(function(i){
					var proName=that.find('.item-title').eq(i).text();
					var proPosition=i+1;
					var navproItem={
				    			"listName": "nav product list",
				    			"name": proName,
				    			"id": proName,
				    			"price": "",
				    			"brand": "HONOR",
				    			"category": "",
				    			"variant": "",
				    			"position": proPosition,
				    			"productAvailability":""
				    };
					navproView.push(navproItem);
			})
			window.dataLayer.push({
					"event": "eeListView",
					"loginStatus": honorData.loginStatus,
					"productAvailability": "",
					'products': navproView
			})
			//GA code end
		}
		
		// 顶部导航三级导航图片懒加载
		function headerNavImgLoading(obj){
			// 带轮播图的产品列表
			if(obj.find('.default-lists').length>0){
				obj.find('.item-img').each(function(index){
					if(index<=4){
						var $curr = $(this);
						navImgLoading($curr);
					}
				})
			}
			
			// 含有产品对比的 产品列表
			if(obj.find('.normal-lists').length>0){
				obj.find('.normal-lists .item-img img').each(function(){
					var $curr = $(this);
					navImgLoading($curr);
				})
			}
			
			// Support 最新产品
			if(obj.find('.latest-lists').length>0){
				obj.find('.latest-lists .item-img img').each(function(){
					var $curr = $(this);
					navImgLoading($curr);
				})
			}
			
			// Support 快捷服务
			if(obj.find('.service-lists').length>0){
				obj.find('.service-lists .item-img img').each(function(){
					var $curr = $(this);
					navImgLoading($curr);
				})
			}
		}
		
		// 三级导航图片懒加载
		function navImgLoading(that){
			that.attr('src',that.data('src'));
			var imgLoad = imagesLoaded(that);
			imgLoad.on('done', function(instance) {
				that.parent().removeClass('honor-loading-v2');
				that.css('visibility','visible').show();
			})
		}
		
	}
	})
}());

	var HONORCOUNTRYV2 = window.HONORCOUNTRYV2 || {};
	HONORCOUNTRYV2.init = function(){
		if(utils.windowWidth()>768){
			var ch;
			if(utils.windowHeight() <= 768){
				ch=utils.windowHeight()-300;
			}else{
				ch=utils.windowHeight()-400;
			}
			
			$(".country-selector-v2-right").css("height",ch);

		}else{
			var ch=utils.windowHeight()-120;
			$(".country-selector-v2-content").css("height",ch);
		}
		
    	//国家或区域选项卡切换
		$(".country-selector-v2").on("click",".countyr-item .country-selector-v2-left",function(){
			if(utils.windowWidth()>768){
				$(".country-selector-v2-right").hide();
    			$(this).parent().addClass("on").siblings().removeClass("on");
    			$(this).next(".country-selector-v2-right").show();
			}else{
				$("div.app-plus-icon").removeClass("clicked");
				$("div.app-plus-icon").removeClass("clicked");
	    		if($(this).parent().hasClass("on")){
	    			$(this).parent().removeClass("on");
	    			$(this).children("div.app-plus-icon").removeClass("clicked");
	    		}else{
	    			$(".country-selector-v2-right").stop().slideUp();
	    			$(this).parent().addClass("on").siblings().removeClass("on");
	    			$(this).children("div.app-plus-icon").addClass("clicked");
	    		}
	    		$(this).next(".country-selector-v2-right").stop().slideToggle();
			}
			
		})
    	
    	//国家选择添加GA传参
    	$('.countyr-item .country-selector-v2-right .country-cont li .site-link').each(function(){
  		  var itemUrl =$(this).attr('href'); 
  		  var endUrl ='';
  		  if(itemUrl){
  			  if(itemUrl.indexOf('?')==-1){
  				  //链接中没有?
  				  endUrl = itemUrl+"?fromCountry="+LOGIN_COUNTRY_CODE;
  			  }else{
  				  //链接中有?
  				  endUrl = itemUrl+"&fromCountry="+LOGIN_COUNTRY_CODE;
  			  }
  			  $(this).attr('href',endUrl);
  		  }
        })
    	
    	//关闭国家选择弹窗
    	$(".country-selector-v2 .honorFont-close").click(function(){
    		$(".country-selector-wrapper").hide();
    		if(utils.windowWidth()>768){
    			$(this).parent().animate({top:'-1000px'},500);
    		}else{
    			$(this).parent().animate({bottom:'-1000px'},500);
    			$("span.honorFont-minus").removeClass("honorFont-minus").addClass("honorFont-plus");
    		}
    		$(".country-selector-v2-right").hide();
    		$(".countyr-item").removeClass("on");
    		setTimeout(function(){ 
    			$("body").removeClass("hideScrollbar");
    			$(this).parent().hide();
    		}, 300);
    	})
    	
    	//打开国家选择弹窗
    	$(".btn-country").click(function(){
    		$("body").addClass("hideScrollbar");
    		if(utils.windowWidth()>768){
        		$(".country-selector-v2").show().animate({top:'0px'},500);
        		$(".countyr-item").removeClass("on");
    			$(".countyr-item .country-selector-v2-right .country-cont li .link-bg.on").parents(".countyr-item").addClass("on");
    			$(".countyr-item .country-selector-v2-right .country-cont li .link-bg.on").parents(".country-selector-v2-right").show();
    		}else{
    			$(".country-selector-v2").show().animate({bottom:'0px'},500);
    		}
    		$(".country-selector-wrapper").fadeIn(1000);
        })
        
    }

    $( document ).ready(function() {
       HONORCOUNTRYV2.init();
    });

(function () { 
	var productList;
	if($('.header-v2 .search-box').length>0){
		var searchType=$("#isVsearch").val();
    	var searchAPIUrl=$("#vsearchAPIUrl").val();
		
		//Open search
    	$(".header-v2 .header-account li .honorFont-search,.header-v2 .app-search").click(function(){
			$("body").addClass("hideScrollbar");
			$(".search-box").show().animate({top:'0'},500);
			setTimeout(function(){ 
				$(".search-wrapper").fadeIn();
			}, 300);
			//ga code start
	    	window.dataLayer.push({
	    		"event": "searchIntent",
	    		"pageType": honorConfig.pageType,
	    		"siteLocation":"header"
    		})
    		
    		var selectSiteCode = honorConfig.siteCode;
    		var wordUrl = utils.getSuitedUrl("/" + selectSiteCode.toLowerCase() + "/legal/privacy-questions/search/associativeWords.json");
    		$.ajax({
		    		  url: wordUrl,
		    		  type: "GET",
		    		  dataType: "json",
		    		  success: function(info) {
		    			  if (info != null && typeof(info) != undefined && Object.keys(info).length>0)
		    			  {
		    				  productList = info[0].title;
		    			  }
		    			  else
		    			  {
		    				  console.log("info is null");
		    			  }
		    			  
		    			  
		    		  },
		    		  error: function(err) {
		    			  console.log(err);
		    		  }
		    })
		    
		    if(searchType=="true"){
				vSearch();
			}else{
				iSearch();
			}
		    //热词GA统计
		    $("body").on("click",".header-v2 .search-box .suggested .keywords a",function(){
				var keyWords = $(this).text();
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Site Search",
					"eventAction": "click",
					"eventLabel": "hotword "+keyWords
				})
			})
		    
		})
		//close search
		$(".header-v2 .search-box .honorFont-close").click(function(){
			$(this).parents(".search-box").animate({top:'-1000px'},300);
			setTimeout(function(){ 
    			$("body").removeClass("hideScrollbar");
    			$(".search-box,.search-wrapper").hide();
    		}, 300);
		})
		
		
		
		//iSearch搜索方法
		function iSearch(){
			// 页面初始化数据
		    var pageData = {
		      "page": 1, // 搜索记录页码,应从第一页开始
		      "size": 4 // 每页记录数
		    }
		    var placeholder = $(".suggested-title").data("alertmessage");
		    if(!placeholder){
		    	placeholder="search HONOR..."
		    }
		    
		    // 获取热词
		    getHotWords();
		
		    // 点击箭头搜索和回车搜索
		    $('.search-input .btn-search').click(function() {
		      var key = $(this).siblings('.search-val').val();
		      if (key.length < 2) {
		        alert(placeholder)
		        return;
		      } else {
		        // 调用产品关键字搜索方法，临时静态方法，当下面siteSearch方法调通后替换删掉
		      	$("li").remove(".show");
		      	pageData.page=1;
		        siteSearch(key, pageData.page, pageData.size);
		        $('.suggested,.related').hide();
		        //搜索GA统计
		        window.dataLayer.push({
		        	"event": "uaEvent",
		        	"eventCategory": "Site Search",
		        	"eventAction": "submit",
		        	"eventLabel": key
		        })
		        
		      }
		    }) 
		    // 搜索框回车搜素事件
		    $(".search-input input").keydown(function() {
		      var theEvent = window.event || arguments.callee.caller.arguments[0]; //谷歌能识别event，火狐识别不了，所以增加了这一句，chrome浏览器可以直接支持event.keyCode
			  var code = theEvent.keyCode;
		      if (code == 13) {
		        // 调用产品关键字搜索方法
		        var key = $('.search-input input').val();
		        if (key.length < 2) {
		          alert(placeholder)
		          return;
		        } else {
		        	$("li").remove(".show");
		        	pageData.page=1;
		            siteSearch(key, pageData.page, pageData.size);
		            $('.related').hide();
		            //搜索GA统计
			        window.dataLayer.push({
			        	"event": "uaEvent",
			        	"eventCategory": "Site Search",
			        	"eventAction": "submit",
			        	"eventLabel": key
			        })
		        }
		      }
		    })
		    
		    // 输入框内模糊匹配搜索
		    $('.search-input input').bind('input propertychange', function(that) {
		      var currVal = $.trim($(this).val());
		      if ("" != currVal && currVal.length > 1) {
		        $('.suggested').hide();
		        // 查询提示词
		        getSuggestWords(currVal);
		        $('.related').show();
		      } else {
		        $('.suggested').show();
		        $('.related,.search-result').hide();
		      }
		    });
		
		    // 产品相关搜索结果【加载更多】
		    $('.load-more').click(function() {
		        var key = $('.search-input input').val();
		        siteSearch(key, pageData.page, pageData.size);
		    })
		    
		    /** 接口：获取热词
		     * 目前该接口无法从外网访问，页面上只是显示了静态数据
		     */
		    function getHotWords() {
		      var startDate = GetDateStr(-7);
		      var endDate = GetDateStr(0);
		      var appNumber = $(".search-box .search-content").data("appid") || "A87295736";
		      var getHotWords = $(".search-box .search-input").data("gethotwords") || '';
		      if(getHotWords){
		    	  $.ajax({
		    		  url: getHotWords,
		    		  type: "GET",
		    		  data: {
		    			  "appNumber": appNumber,
		    			  "text": "*",
		    			  "startDate": "2017-06-07",
		    			  "endDate": endDate,
		    			  "size": 5
		    		  },
		    		  dataType: "jsonp",
		    		  jsonp: "jsonp",
		    		  success: function(info) {
		    			  if (info.responseCode == '200') {
		    				  var data = info.responseData.hotWords;
		    				  var hotstr = '';
		    				  
		    				  if (data) {
		    					  for (i = 0; i < data.length; i++) {
		    						  hotstr += '<li>' + data[i] + '</li>';
		    					  }
		    				  }
		    				  
		    				  $(".suggested .keywords").empty().html(hotstr)
		    				  
		    				  // 点击推荐搜索关键字
		    				  $('.suggested .keywords li').click(function() {
		    					  var key = $(this).text();
		    					  $('.search-input input').val(key);
		    					  if (key.length < 2) {
		    						  alert(placeholder)
		    						  return;
		    					  } else {
		    						  // 调用产品关键字搜索方法
		    						  siteSearch(key, pageData.page, pageData.size);
		    						  $('.suggested').hide();
		    					  }
		    				  })
		    				  
		    			  } else {
		    				  console.log('热词查询异常');
		    			  }
		    		  },
		    		  error: function(err) {
		    			  console.log(err);
		    		  }
		    	  })
		      } 
		    }

		    /** 接口：实时获取提示词
		     * 目前该接口无法从外网访问，页面上只是显示了静态数据
		     */
		    function getSuggestWords(txt) {
		      var getSuggestWords = $(".search-box .search-input").data("getsuggestwords");
		      var indexDb = $(".search-box .search-input").data("suggest-indexdb");
		      var appNumber = $(".search-box .search-content").data("appid") || "A87295736";
		      var endTxt = utils.stripscript(txt);
		      $.ajax({
		        url: getSuggestWords,
		        type: "GET",
		        data: {
		          "appNumber": appNumber,
		          "username": "",
		          "appUserID": "",
		          "indexDB": indexDb,
		          "indexDBType": indexDb,
		          "text": endTxt
		        },
		        dataType: "jsonp",
		        jsonp: "jsonp",
		        success: function(info) {
		        	
		          if (info.responseCode == '200') { 
		            var data = info.responseData.suggestQueryWords;
		            var suggstr = '';
		            
		            for (var i = 0; i < data.length; i++) {
		                suggstr += '<li class="list-item">' + data[i] + '</li>';
		            }
		            $('.related').show();
		            $('.related .related-lists').empty().html(suggstr)

		            // 提示词点击事件
		            $('.related-lists li').click(function() {
		              var key = $.trim($(this).text()); 
		              $('.search-input input').val(key);
		              if (key.length < 2) {
		                return;
		              } else {
		                // 调用产品关键字搜索方法
		                 siteSearch(key, pageData.page, pageData.size);
		                $('.suggested').hide();
		                $('.related').hide();
		              }
		            })
		          } else {
		            console.log('提示词查询异常');
		          }
		        },
		        error: function(err) {
		          console.log(err);
		        }
		      })
		    }

		    /** 接口：站点顶部搜索
		     * @param key:关键词
		     * @param page:页码
		     * @param size:每页记录数
		     * @param type: first/more 用于区分首次搜索或者是加载更多
		     */
		    function siteSearch(key, page, size, type) {
		      type = type || 'first'
		      var siteSearch = $(".search-box .search-input").data("sitesearch");
		      var appNumber = $(".search-box .search-content").data("appid") || "A87295736";
		      var dbName = $(".search-box .search-input").data("search-dbname");
		      var esType = $(".search-box .search-input").data("search-estype");
		      var endKey = utils.stripscript(key);
		      $.ajax({
		        url: siteSearch,
		        type: "GET",
		        data: {         
		          "APP_NUM": appNumber,
		          "username": "GUEST%20TEST",
		          "templateType": "global",
		          "indexDB": "MCIP_SEARCH",
		          "from": page,
		          "lang": "cn",
		          "dbName": dbName,
		          "esType": esType,
		          "jsonp": "jQuery111307745580982322504_1527234216378",
		          "topMatch": "consumer_product:31,32,33,36,37",
		          "mcCurPage": page,
		          "pageSize": size,
		          "tagMatch": "same",
		          "ssUserText": endKey,
		          "queryMatch": "consumer_product:31,32,33,36,37;support:manual,software,faqs;consumer_press:consumer_news,consumer_media_coverage,consumer_awards;support_product:no;consumer_events:no;consumer_video:no_: 1527234216380"   
		        },
		        dataType: "jsonp",
		            jsonp: "jsonp",
		        success: function(info) { 
		            pageData.page = page + 1;
		            // 非加载更多搜索
		            if (type == 'first') {
		              // 搜索记录总数
		              var totalNum = info.list[0].totalNum;        
		              $('.result-title .result-num').text(totalNum);
		              
		              //ga code start
		              var gauri=window.digitalData.page.pageInfo.uri;
		              window.dataLayer.push({"event":"virtualPageview","page": gauri + "/search","res55": totalNum,"kw55": key,"cat55": "","loginStatus": honorData.loginStatus});
		              //ga code end
		              
		              // 搜索记录数据
		              var data = info.list[0];
		              // 热门产品数据
		              var hotLists = data.productlist;
		              var hotstr = '';
		              if (hotLists) {
			              for (var i = 0; i < hotLists.length; i++) {
			                hotstr += '<li>';
			                hotstr += '<a href="' + removeDomain(hotLists[i].DOC_URL) + '">';
			                /*var altString = $(hotLists[i].DRETITLE).text();*/
			                hotstr += '<img src="' + hotLists[i].RESERVE_FIELD32 + '" alt="' + hotLists[i].autn_title +'"></a>';                hotstr += '<strong>' + hotLists[i].DRETITLE + '</strong>';
			                hotstr += '<p>' + hotLists[i].DOC_DESCRIPTION + '</p > ';
			                hotstr += '</li>';
			              }
		              }
		              $('.hot-products').empty().html(hotstr)
		            }
		            // 全部结果列表数据
		            var allLists = data.alllist;
		            var allstr = '';  
		            if(allLists){
		            	for (var i = 0; i < allLists.length; i++) {
		                    var currData = allLists[i];
		                    allstr += '<li class="show">';
		                    var typeText = $('.news-lists').data("searchnewstext");
		                    if (currData.RESERVE_FIELD2 == 'consumer_product') {
		                      typeText = $('.news-lists').data("searchproducttext");
		                    } else if (currData.RESERVE_FIELD2 == 'support') {
		                      typeText = $('.news-lists').data("searchsupporttext");
		                    }
		                    allstr += '<a class="tag">' + typeText + '</a>';
		                    if (!(currData.RESERVE_FIELD22 == "manual" && currData.RESERVE_FIELD33)) {
		                  	  allstr += '<strong><a href="' + removeDomain(currData.DOC_URL) + '">' + currData.DRETITLE + '</a></strong>';
		                    } else {
		                  	  allstr += '<strong><a href="' + currData.RESERVE_FIELD33 + '">' + currData.DRETITLE + '</a></strong>';
		                    }
		                    allstr += '<p><span class="time">' + formatTime(currData.RESERVE_FIELD11) + '</span> <span class="content">' + (currData.DOC_DESCRIPTION || "") + '</span></p>';
		                    allstr += '</li>';
		                  }
		            } 
		            $('.news-lists').append(allstr);

		            // 显示搜索结果
		            $('.search-result').show();
		            var mcCurPage = info.list[0].mcCurPage;
		            if(mcCurPage >= info.list[0].totalPageNum){
		            	$('.load-more').hide();
		            }else{
		            	$('.load-more').show();
		            }

		        },
		        error: function(err) {
		          console.log(err);
		        }
		      })
		    }



		    /*======================= 站点搜索 End ====================*/
		    // 格式化日期格式    
		    function formatTime(c) {
				if (c && c != "") {
					var b = c.split("-");
					var a = formatMonth(b[1]);
					return a + " " + b[2] + ", " + b[0]
				} else {
					return ""
				}
			}

			function formatMonth(a) {
				var m = parseInt(a);
				switch (m) {
				case 1:
					return "January";
				case 2:
					return "February";
				case 3:
					return "March";
				case 4:
					return "April";
				case 5:
					return "May";
				case 6:
					return "June";
				case 7:
					return "July";
				case 8:
					return "August";
				case 9:
					return "September";
				case 10:
					return "October";
				case 11:
					return "November";
				case 12:
					return "December"
				}
			}
			
		    function GetDateStr(AddDayCount) {
		        var dd = new Date();
		        dd.setDate(dd.getDate() + AddDayCount); //获取AddDayCount天后的日期
		        var y = dd.getFullYear();
		        var m = dd.getMonth() + 1; //获取当前月份的日期
		        var d = dd.getDate();
		        if (m <= 9) {
		          m = '0' + m
		        }
		        if (d <= 9) {
		          d = '0' + d
		        }
		        return y + "-" + m + "-" + d;
		      }
		      var DOMAIN = "hihonor.cbg-app.huawei.com";
		      var DOMAIN_LEGACY = "hihonor-test.cbg-app.huawei.com";
		      function removeDomain(url){
		          var existedDomain = "";
		          if( url.indexOf(DOMAIN) > -1){
		              existedDomain = DOMAIN;
		          }else if (url.indexOf(DOMAIN_LEGACY)){
		              existedDomain = DOMAIN_LEGACY;
		          }
		        return url.substr(url.indexOf(existedDomain)+existedDomain.length);
		      }
		}
		//智能搜索方法
		function vSearch(){
			var placeholder = $(".suggested-title").data("alertmessage");
		    if(!placeholder){
		    	placeholder="search HONOR..."
		    }
		    
		    // 获取热词
		    getHotWords();
		    
		    var searchCurrPath = location.href;
			var searchPrePath = searchCurrPath.split('/content/honor/')[0];
			var searchEndPath ='';
			if(searchCurrPath.indexOf('.html')!=-1){
				//预览环境
				searchEndPath ='/content/honor/'+digitalData.page.pageInfo.siteCode2+'/search.html?wcmmode=disabled&keyword=';
			}else{
				//发布环境
				searchEndPath ='/'+digitalData.page.pageInfo.siteCode2+'/search/?keyword=';
			}
			searchEndPath=utils.getSuitedUrl(searchEndPath);
		    // 点击箭头搜索和回车搜索
		    $('.search-input .btn-search').click(function() {
		      var key = utils.stripscript($(this).siblings('.search-val').val());
		      if(key.length>1){
		        	window.location.href=searchEndPath+key;
		        	//搜索GA统计
			        window.dataLayer.push({
			        	"event": "uaEvent",
			        	"eventCategory": "Site Search",
			        	"eventAction": "submit",
			        	"eventLabel": key
			        })
		        }
		    }) 
		    // 搜索框回车搜素事件
		    $(".search-input input").keydown(function() {
		      var theEvent = window.event || arguments.callee.caller.arguments[0]; //谷歌能识别event，火狐识别不了，所以增加了这一句，chrome浏览器可以直接支持event.keyCode
			  var code = theEvent.keyCode;
		      if (code == 13) {
		        // 调用产品关键字搜索方法
		        var key = utils.stripscript($('.search-input input').val());
		        if(key.length>1){
		        	window.location.href=searchEndPath+key;
		        	//搜索GA统计
			        window.dataLayer.push({
			        	"event": "uaEvent",
			        	"eventCategory": "Site Search",
			        	"eventAction": "submit",
			        	"eventLabel": key
			        })
		        }
		      }
		    })
		    // 输入框内模糊匹配搜索
		    $('.search-input input').bind('input propertychange', function(that) {
		    	var currVal = $.trim($(this).val());
		    	if(currVal){
		    		getSuggestWords(currVal);
		    	}else{
		    		$('.related').hide();
		    		$('.suggested').show();
		    	}
		      
		    });
			/** 接口：智能搜索获取热词 **/
			function getHotWords() {
				var getHotWords=searchAPIUrl+"vofficial/hot";
					$.ajax({
			    		  url: getHotWords,
			    		  type: "GET",
			    		  data: {
			    			  "qAppName": "HonorOfficial",
			    			  "language": honorConfig.searchLang,
			    			  "site": honorConfig.siteCode
			    		  },
			    		  dataType: "jsonp",
			    		  jsonp: "jsonp",
			    		  success: function(info) {
			    			  if (info.length>0) {
			    				  var hotstr = '';
			    				  for (i = 0; i < info.length; i++) {
			    						  hotstr += '<li><a href='+searchEndPath+encodeURI(info[i].key)+'>' + info[i].key + '</a></li>';
			    				  }
			    				  
			    				  $(".suggested .keywords").empty().html(hotstr);
			    			  } else {
			    				  console.log('热词查询异常');
			    			  }
			    		  },
			    		  error: function(err) {
			    			  console.log(err);
			    		  }
			    	  })
			}
			 var selectKey = [];
		    //补全查询
		    function getSuggestWords(txt) {
			      var getSuggestWords =searchAPIUrl+"vofficial/complete";
			      var endTxt = encodeURI(txt);
			      var rl;
			      function HeightKey(txt, key, tag) {
			  	    var str = txt;
			  	    var _keys = key;
			  	    var k_index = (str && _keys) ? str.toLowerCase().indexOf(_keys.toLowerCase()) : -1;
			  	    if (k_index > -1) {
			  	        if (k_index == 0) {
			  	            var str1 = "<" + tag + ">" + str.substring(0, _keys.length) + "</" + tag + ">"
			  	            var str2 = str.substring(_keys.length, str.length)
			  	            var str3 = ''
			  	        } else {
			  	            var str1 = str.substring(0, k_index)
			  	            var str2 = "<" + tag + ">" + str.substring(k_index, _keys.length + k_index) + "</" + tag + ">"
			  	            var str3 = str.substring(_keys.length + k_index, txt.length)
			  	        }
			  	        str = str1 + str2 + str3;
			  	    }
			  	    return str
			  	  }
			      selectKey = [];
			      var lowerEndText = txt.toLowerCase();
			      if (productList!= null && typeof(productList) != undefined)
			      {
			    	  var productArr = productList.split(",");
			    	  for ( var i = 0; i <productArr.length; i++){
			    		  if (productArr[i].toLowerCase().indexOf(lowerEndText) != -1)
			    		  {
			    			  selectKey.push(productArr[i]);
			    		  }
			    	  }
			      }
			      	  if (selectKey.length > 0) { 
			            var suggstr = '';
			            for (var i = 0; i < selectKey.length; i++) {
			            	rl = HeightKey(selectKey[i], txt, "strong");
			                suggstr += '<li class="list-item"><a href="'+searchEndPath+encodeURI(selectKey[i])+'">' + rl + '</a></li>';
			            }
			            $('.related ul.related-lists').empty().html(suggstr);
			            $('.suggested').hide();
			            $('.related').show();
			          } else { 
			        	  $('.related ul.related-lists').empty();
			            $('.related').hide();
			            $('.suggested').show();
			          }
			    }
		}
	}
})();
/*！
 * CN Header v1.0.0(2019-10-23T11:30:51+0800)
 * Copyright 2019-2020 hihonor.com
 */
(function () { 
	$(function(){
		if($('.header-cn').length>0){
			// 移动端全局搜素
			var searchCurrPath = location.href;
			var searchEndPath ='';
			if(searchCurrPath.indexOf('.html')!=-1){
				//预览环境
				searchEndPath ='/content/honor/'+digitalData.page.pageInfo.siteCode2+'/search.html?wcmmode=disabled&keyword=';
			}else{
				//发布环境
				searchEndPath = utils.getSuitedUrl('/'+digitalData.page.pageInfo.siteCode2+'/search/?keyword=');
			}
			$(".app-search-cn .inp-search").focus(function(e){
				getHotWords();
				$(".header-cn .white-box .suggested").show();
			});
			$(".app-search-cn .inp-search").on("click",function(e){
				e.stopPropagation();    //  阻止事件冒泡
			})
			$(document).on("click", function(){
				$(".header-cn .white-box .suggested").hide();
			});
			// 输入框内模糊匹配搜索
		    $('.app-search-cn .inp-search').bind('input propertychange', function(that) {
		      var currVal = $.trim($(this).val());
		      getSuggestWords(currVal);
		      if(currVal.length>0){
				  $(".header-cn .white-box .suggested").hide();
				  $(".header-cn .white-box .related").show();
			  }else{
				  $(".header-cn .white-box .related").hide();
				  $(".header-cn .white-box .suggested").show();
			  }
		    });
		    //回车查询
		    $(".app-search-cn .inp-search").keydown(function() {
		      var theEvent = window.event || arguments.callee.caller.arguments[0]; //谷歌能识别event，火狐识别不了，所以增加了这一句，chrome浏览器可以直接支持event.keyCode
			  var code = theEvent.keyCode;
			  var that = $(this);
			  var key = utils.stripscript(that.val());
		      if (code == 13) {
		        // 调用产品关键字搜索方法
		        if(key.length>1){
		        	window.location.href=searchEndPath+key;
		        	//搜索GA统计
			        window.dataLayer.push({
			        	"event": "uaEvent",
			        	"eventCategory": "Site Search",
			        	"eventAction": "submit",
			        	"eventLabel": key
			        })
		        }
		      }
		    })
		    //产品列表
		    var productList;
		    //API接口地址
		    var searchAPIUrl=$("#vsearchAPIUrl").val();
		    //站点信息
		    var selectSiteCode = honorConfig.siteCode;
		    
		    //Open search
  			$(".header-cn .app-search-cn").click(function(){
  				getAssociativeWords();	
  			})

  			/** 接口：智能搜索获取联想词 **/
  		    function getAssociativeWords(){
  				//站点信息
  				var selectSiteCode = honorConfig.siteCode;
  		    	var wordUrl = utils.getSuitedUrl("/" + selectSiteCode.toLowerCase() + "/legal/privacy-questions/search/associativeWords.json");
  		    	$.ajax({
  		    		url: wordUrl,
  		    		type: "GET",
  		    		dataType: "json",
  		    		success: function(info) {
  		    			if (info != null && typeof(info) != undefined && Object.keys(info).length>0){
  		    				productList = info[0].title;
  		    			}else{
  		    				console.log("info is null");
  		    			}
	    			},
		    		error: function(err) {
		    			console.log(err);
		    		}
  		    	})
  			}
		    
		    /** 接口：智能搜索获取热词 **/
			function getHotWords() {
				var getHotWords=searchAPIUrl+"vofficial/hot";
					$.ajax({
			    		  url: getHotWords,
			    		  type: "GET",
			    		  data: {
			    			  "qAppName": "HonorOfficial",
			    			  "language": honorConfig.searchLang,
			    			  "site": honorConfig.siteCode
			    		  },
			    		  dataType: "jsonp",
			    		  jsonp: "jsonp",
			    		  success: function(info) {
			    			  if (info.length>0) {
			    				  var hotstr = '';
			    				  for (i = 0; i < info.length; i++) {
			    						  hotstr += '<li><a href='+searchEndPath+encodeURI(info[i].key)+'>' + info[i].key + '</a></li>';
			    				  }
			    				  
			    				  $(".header-cn .white-box .suggested .keywords,.hot_word-v3 ul").empty().html(hotstr);
			    			  } else {
			    				  console.log('热词查询异常');
			    			  }
			    		  },
			    		  error: function(err) {
			    			  console.log(err);
			    		  }
			    	  })
		    	  $(".keywords").on("click", "a", function(e) {
		    		  e.stopPropagation();    //  阻止事件冒泡
		    	  });
			}
		    
			//补全查询
		    function getSuggestWords(txt) {
			      var getSuggestWords =searchAPIUrl+"vofficial/complete";
			      var endTxt = encodeURI(txt);
			      var rl;
			      function HeightKey(txt, key, tag) {
			  	    var str = txt;
			  	    var _keys = key;
			  	    var k_index = (str && _keys) ? str.toLowerCase().indexOf(_keys.toLowerCase()) : -1;
			  	    if (k_index > -1) {
			  	        if (k_index == 0) {
			  	            var str1 = "<" + tag + ">" + str.substring(0, _keys.length) + "</" + tag + ">"
			  	            var str2 = str.substring(_keys.length, str.length)
			  	            var str3 = ''
			  	        } else {
			  	            var str1 = str.substring(0, k_index)
			  	            var str2 = "<" + tag + ">" + str.substring(k_index, _keys.length + k_index) + "</" + tag + ">"
			  	            var str3 = str.substring(_keys.length + k_index, txt.length)
			  	        }
			  	        str = str1 + str2 + str3;
			  	    }
			  	    return str
			  	  }

			      selectKey = [];
			      var lowerEndText = txt.toLowerCase();
			      if (productList!= null && typeof(productList) != undefined)
			      {
			    	  var productArr = productList.split(",");
			    	  for ( var i = 0; i <productArr.length; i++){
			    		  if (productArr[i].toLowerCase().indexOf(lowerEndText) != -1)
			    		  {
			    			  selectKey.push(productArr[i]);
			    		  }
			    	  }
			      }
			     
			      	  if (selectKey.length > 0) { 
			            var suggstr = '';
			            for (var i = 0; i < selectKey.length; i++) {
			            	rl = HeightKey(selectKey[i], txt, "strong");
			                suggstr += '<li class="list-item"><a href="'+searchEndPath+encodeURI(selectKey[i])+'">' + rl + '</a></li>';
			            }
			            $('.header-cn .white-box .related ul.related-lists').empty().html(suggstr);
			          } else { 
			            $('.header-cn .white-box .related').hide();
			            $('.header-cn .white-box .suggested').show();
			          }
			    }
		    
		    // 页面加载校验是否登录
		    var loginedUserInfo = null;
		    $.ajax({
		    	url: honorApiUrl+"/abroad/shootMatch/getUserDisplayName",
				  type: "POST",
				  dataType: "json",
				  xhrFields: {
				      withCredentials: true
				  },
			      crossDomain: true,
				  success: function(info) {
					  if(info.success){
						  loginedUserInfo = info;
						  //登录成功，设置honor.cn对应域名的相关cookie
						  for(var key in info){
							  if(key=='success'){
								  continue;
							  }
							  utils.setCookie(key,info[key],0,5,0,'.honor.cn');
						  }
					  }else{
						  clearCNLoginCookie();
					  }
					  // 登录状态切换
					  loginStatus();
				  }
		    })
		    
		    // 登出
		    $('.header-cn .header-account .logined-menu a.btn-logout').click(function(){
		    	clearCNLoginCookie();
		    	loginStatus(); 
		    })
		}
		
	})
}());

//清除 已设置的对应cookie
function clearCNLoginCookie(){
	var arr = ['nationalCode','siteCode','displayName','authToken','loginUid','loginGid','localHeadURL','loginHeadURL','paramValueByJsId'];
	arr.forEach(function(item){
		utils.clearCookie(item,'.honor.cn');
	})
};
// Gallery Public Data
var galleryPublicData={
	overlayHeight:utils.overlayHeight(),
	windowW:utils.windowWidth(),
	windowH:utils.windowHeight(),
	apiUrl:"https://cuep-sg.hihonor.com",
	loginUrl:"",
	lang:window.digitalData.page.category.primaryCategory || 'en'
}; 
(function(){
	$(function(){
		if($('#galleryHeader').length>0){
			// 顶部子导航 传参设置
			$('.nav-li .site-subnav li a').each(function(){
				var txt = $.trim($(this).data('value'));
				var currUrl = $(this).attr('href');
				var endUrl ='';
				if(currUrl){
					if(currUrl.indexOf('?')!=-1){
						endUrl = currUrl+'&type='+txt;
					}else{
						endUrl = currUrl+'?type='+txt;
					}
					$(this).attr('href',endUrl);
				}
			})
			
			$('.nav-li .site-subnav li a').click(function(){
				//GA CODE START
				var txt = $.trim($(this).text());
				var uri=window.digitalData.page.pageInfo.uri;
				window.dataLayer.push({
					"event": "topNavigationClick",
					"pageType": honorConfig.pageType,
					"siteLocation": "header",
					"page": uri,
					"eventName":txt
				})
				//GA CODE END
			})
			
			// 查看消息的次数标识
			var messageFirst= true,notificationFirst=true;
			
			// 登录配置
			var $inoutData = $('.loginout-data');
			var inoutData = {
				"loginUrl":$inoutData.attr('data-loginurl') || "",
				"clientId":$inoutData.attr('data-clientid') || "",
				"loginRedirectURL":$inoutData.attr('data-loginredirecturl') || "",
				"logoutRedirectURL":$inoutData.attr('data-logoutredirecturl') || ""
			}  
			var currPage = window.location.href;
			var redirectUri = inoutData.loginRedirectURL+"?cururl="+currPage;
			//gallery登录传递语言参数
			var galleryLoginLang = galleryLangConfig[galleryPublicData.lang]?galleryLangConfig[galleryPublicData.lang].loginLang :"en-gb";
			var endLoginUrl= inoutData.loginUrl+"?response_type=code&client_id="+inoutData.clientId+"&redirect_uri="+encodeURIComponent(redirectUri)+"&"+encodeURIComponent("scope=https://www.huawei.com/auth/account/base.profile")+encodeURIComponent(" https://www.huawei.com/auth/account/country")+"&access_type=offline&lang="+galleryLoginLang+"&sitecode="+ honorConfig.siteCode+"&themeName=blue";
			$('.gallery-header .gallery-user').attr('href',endLoginUrl);
			galleryPublicData.loginUrl=endLoginUrl;
				
			var endLogoutUrl = inoutData.logoutRedirectURL +"?cururl="+encodeURIComponent(window.location.href)+"&lang="+honorConfig.loginLang; 
			$('.gallery-header .logout').attr('href',endLogoutUrl);
			
			$('.gallery-header .gallery-user').click(function(){
				window.dataLayer.push({
					"event": "accountLogin",
					"pageType": honorConfig.pageType,
					"siteLocation": "header"
				})
			})
			
			// 根据登录配置的API url 获取当前站点的 Honor Api Url
			if(inoutData.loginRedirectURL){
				galleryPublicData.apiUrl = inoutData.loginRedirectURL.split('/abroad/')[0];
			}
			
			// 登录状态切换
			galleryLoginStatus(); 
			
			//消息选择国家的弹框居中
			function showSelectCountryModal(){
				$('html,body').css('overflow','hidden');
				$(".gallery-header .message-country").show();
				var boxH = $('.gallery-header .selectcountry').height();
				var titleH = $('.gallery-header .message-country .selectcountry-title').height();
				var contentH = boxH-titleH;
				$('.gallery-header .selectcountry ul').height(contentH);
			}

			//关闭选择国家弹窗
			$(".gallery-header .selectcountry .font-Cross").click(function(){
				$('html,body').css('overflow','auto');
				$(".gallery-header .message-country").hide();
			})
			//点击View All或移动端消息icon
			$(".gallery-header .notice-box .btn-notice,.gallery-header .gallery-notice-box.gallery-mb,.gallery-header .site-setting .choose-country,.gallery-header .site-topnav .gallery-account .choose-country").click(function(e){
				e.stopPropagation();
				honorData.loginName = decodeURI(utils.getCookie('loginUid'));
				if (honorData.loginName === "" || honorData.loginName === null || honorData.loginName === "null") {
					var homeurl = $(".header .logo-home").attr("href");
					window.location.href = homeurl;
				}
				var isSelect=$(".header #select").val();
				if(isSelect=="true"){
					showSelectCountryModal();
				}
			});
		    
			// 自定义菜单文案的颜色
			var textColor=$('.site-topnav').attr('data-color');
			$('.gallery-header,.site-topnav>li>a').css('color',textColor);
			
			if(galleryPublicData.windowW>768){
				// 大屏设备 再判断是否移动端
				if (endBrowser.versions.mobile || endBrowser.versions.android || endBrowser.versions.ios) {
					$('body').click(function(){
						$('.gallery-header .site-topnav>li,.gallery-header .change-lang').removeClass('hover');
						$('.gallery-header .down-box').stop().slideUp();
					})
					$('.gallery-header .site-topnav>li').click(function(e){ 
						e.stopPropagation();
						$('.gallery-header .change-lang').removeClass('hover');
						$(this).toggleClass('hover').siblings('li').removeClass('hover');
						$('.gallery-header .down-box').stop().slideUp();
						$(this).find('.site-subnav').stop().slideToggle();
					})
					$('.gallery-header .change-lang').click(function(e){
						e.stopPropagation();
						$('.gallery-header .site-topnav>li').removeClass('hover');
						$(this).stop().toggleClass('hover');
						
						$('.gallery-header .down-box').stop().slideUp();
						$(this).find('.site-lang').stop().slideToggle();
					})
					$('.gallery-header .gallery-logined .gallery-account').click(function(e){ 
						e.stopPropagation();
						$('.gallery-header .site-topnav>li,.gallery-header .change-lang').removeClass('hover');
						$('.gallery-header .down-box').stop().slideUp();
						$(this).find('.account-list').stop().slideToggle();
					})
					
					$('.gallery-header .gallery-notice-box').stop().click(function(e){
						$('.gallery-header .site-topnav>li,.gallery-header .change-lang').removeClass('hover');
						$('.gallery-header .down-box').stop().slideUp();
						e.stopPropagation();
						$(this).find('.notice-box').stop().slideToggle();
					})
				}else{ 
					$('.gallery-header .site-topnav>li').hover(function(){ 
						$(this).toggleClass('hover');
						$(this).find('.site-subnav').stop().slideToggle();
					})
					$('.gallery-header .change-lang').hover(function(){
						$(this).toggleClass('hover');
						
						$(this).find('.site-lang').stop().slideToggle();
					})
					$('.gallery-header .gallery-logined .icon-user2').stop().mouseenter(function(e){
						e.stopPropagation();
						$(this).siblings('.account-list').stop().slideDown();
					})
					$('.gallery-header .gallery-logined .gallery-account').stop().mouseleave(function(e){
						e.stopPropagation();
						$(this).find('.account-list').stop().slideUp();
					}) 
					
					$('.gallery-header .gallery-notice-box').stop().mouseenter(function(e){
						e.stopPropagation();
						
						if(e.relatedTarget !=null){
							$(this).find('.notice-box').stop().slideDown();
						}
					})
					$('.gallery-header .gallery-notice-box').stop().mouseleave(function(e){
						if(e.relatedTarget != null){
							$(this).find('.notice-box').stop().slideUp();
						}
					})
				}
			}else{
				$('.gallery-header .site-topnav>li').click(function(){ 
					var that = $(this);
					utils.stopBubble();				
					if(!that.hasClass('unlogin')){
						// 非登录icon点击展示二级导航
						that.siblings().removeClass('hover');
						that.toggleClass('hover');
						
						var flag= that.hasClass('hover');
						$('.gallery-header .site-topnav .site-subnav').hide();
						if(flag){
							that.find('.site-subnav').stop().slideDown();
						}else{
							that.find('.site-subnav').stop().slideUp();
						}
					}
				})
				$('.gallery-header .change-lang').click(function(){
					$(this).toggleClass('hover');
					$(this).find('.site-lang').stop().slideToggle();
				}) 
				$('.gallery-header .site-navbox,.gallery-header .account-list-mb').click(function(e){
					e.stopPropagation();
					$(this).hide();
				})
				$('.gallery-header .gallery-menu').click(function(e){
					e.stopPropagation();
					$(this).toggleClass('gallery-over');
					$('.site-navbox').toggle();
					$('html,body').toggleClass('honor-noscroll');
					
					$('.gallery-header .site-topnav>li').removeClass('hover');
					$('.gallery-header .site-topnav .site-subnav').hide();
					
				})
				$('.gallery-header .gallery-logined .gallery-account').click(function(e){
					e.stopPropagation();
					$('html,body').toggleClass('honor-noscroll');
					$(this).toggleClass('gallery-over');
					$('.account-list-mb').toggle();
				})
			}
			
			// 切换消息tab
			$('.gallery-notice-box .notice-tab li').stop().click(function(e){
				e.stopPropagation();
				var name = $(this).attr('data-name');
				$(this).addClass('active');
				$(this).siblings().removeClass('active');
				
				//查询未读消息
				if(name=="gallery-notification" && notificationFirst){
					getMessageLists();
					notificationFirst=false;
				}else if(name=="gallery-message" && messageFirst){
					getMessageLists(name);
					messageFirst=false;
				}
				$('.gallery-notice-box .notice-content .tab-content').removeClass('active');
				$('.gallery-notice-box .notice-content .'+name).addClass('active');
			})
			
			var scrollTop = $(document).scrollTop();
			if(scrollTop>0){
				$('.gallery-header').css('background','#0f0f0f');
			}
			
			$(window).scroll(function() {
		        var scrollTop = $(document).scrollTop();
		        if (scrollTop > 0) {
		            $('.gallery-header').css({
		            	'position':'fixed',
		            	'background':'#0f0f0f',
		            	'z-index':'102'
		            });
		        } else {
		        	if($('.gallery-howto-detail').length>0){
		        		return;
		        	}
		        	if(galleryPublicData.windowW>768){
		        		$('.gallery-header').css({
			        		'background':'transparent',
			        	});
		        	}else{
		        		$('.gallery-header').css({
			        		'position':'absolute',
			        		'background':'transparent',
			        		'z-index':'inherit'
			        	});
		        	}
		        	
		        }
		    }) 
		    
		    
		// 切换登录状态
		function galleryLoginStatus(){ 
			if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
				//获取系统消息
				getMessageNum();
				getMessageLists();
				notificationFirst = false;
			}
			//Gallery Header 更新通知icon显示隐藏的状态
			updataGalleryNoticeStatus();
		} 	
		// 查询系统消息数 
		function getMessageNum(){
		 	$.ajax({
		 	    url: galleryPublicData.apiUrl+'/abroad/userCenter/isMessage',
			    type: 'GET',
			    dataType: 'jsonp',
			    success: function(info) { 
			    	if(info.code=="000000"){  
			    		var num = Number(info.allNum);
			    		if(num>0){ 
				    		if(num>99){
				    			num = '99+';
				    		}
				    		$('.gallery-header .gallery-logined .gallery-notice-box.gallery-pc').css('margin-right','2px');
				    		$('.gallery-notice-box .badge').css('visibility','visible').text(num);
				    		var numArr=info.pageList;
				    		for(var i=0;i<numArr.length;i++){
				    			if(numArr[i].messageType==1){
				    				// notification
				    				if(numArr[i].num>0){
	                            		$('.header .notice-box .notice-tab li.notification .icon-point').css('display','inline-block');
	                            	}else{
	                            		$('.header .notice-box .notice-tab li.notification .icon-point').hide();
	                            	}
				    			}
	                            if(numArr[i].messageType===2){
	                            	// message
	                            	if(numArr[i].num>0){
	                            		$('.header .notice-box .notice-tab li.message .icon-point').css('display','inline-block');
	                            	}else{
	                            		$('.header .notice-box .notice-tab li.message .icon-point').hide();
	                            	}
				    			}
				    		}
			    		}else{
			    			$('.honor-notice .badge').hide().text(num);
			    		}
			    		
		 	    	}else if(info.code=="100007"){
			    		//用户未登录
		 	    		updataGalleryNoticeStatus();
			    	}
		 	    },error:function(err){
		 	    	console.log(err);
		 	    }
		 	})
		}
		
		// 查询未读系统消息列表 
		function getMessageLists(type){
			// 默认系统通知消息
			type = type || 'gallery-notification';
			var messageType = '1';
			if(type=='gallery-message'){
				messageType = '2';
			}
		 	$.ajax({
		 	    url: galleryPublicData.apiUrl+'/abroad/userCenter/getNotifications',
		 	    type: 'GET',
		 	    data:{
		 	    	"messageType":messageType,
		 	    	"pageIndex":"0",
		 	    	"lang":galleryPublicData.lang,
		 	    	"pageSize":"5",
		 	    	"messageStatus":"1"
		 	    },
		 	    dataType: 'jsonp',
		 	    success: function(info) { 
		 	    	if(info.success){  
		 	    		var data =info.infoBean.pageList;
	 	    			var str='',unreadNum = 0;
	 	    			var pageUrl = $('.gallery-notice-box .btn-notice').attr('href') || '';
	 	    			if(pageUrl.indexOf("#&inbox")==-1){
			    			pageUrl=pageUrl+"?msgType="+messageType+"#&inbox";
			    		}else{
			    			//消息tab 切换 替换  msgType 的值
				    		if(pageUrl.length>0){
				    			var replaceStr="msgType="+messageType;
				    			if(messageType=='2'){
				    				pageUrl=pageUrl.replace("msgType=1",replaceStr);
				    			}else{
				    				pageUrl=pageUrl.replace("msgType=2",replaceStr);
				    			}
				    			
				    		}
			    		}	
	 	    			var isSelect=$(".gallery-header #select").val();
			    		if(isSelect=="true"){
			    			pageUrl="javascript:void(0);";
			    		}
			    		
			    		$(".gallery-header .gallery-notice-box .notice-box .btn-notice").attr("href",pageUrl);
	 	    			for(var i=0;i<data.length;i++){
	 	    				if(messageType=="1"){ 
	 	    					var functionType =data[i].functionType;
	 	    					if(functionType=='1' || functionType=='2' || functionType=='5'){
	    							var title=data[i].title;
	     							if(title.indexOf('{name}')!==-1){
	     								var userName='<b>'+data[i].senderUserName+'</b>';
	     								var isArabic = $("div").hasClass("__arabic__");
	     								if(isArabic){
	     									userName=data[i].senderUserName;
	     								}
	     								title=title.replace("{name}",userName);
	     								
	     							}
	    							str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+title+'</a></li>';
	    						}else{
	    							str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+data[i].title+'</a></li>';
	    						}
	 	    				}else{
	 	    					str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+data[i].title+'</a></li>';
	 	    				}
	    					unreadNum++;
	 	    			} 
	 	    			
	 	    			var $message=$('.gallery-notice-box .'+type); 
	 	    			if(unreadNum==0){
	 	    				$message.find('.no-content').show().next().hide();
	 	    			}else{
	 	    				$message.find('.no-content').hide().next().html(str).show();
	 	    				//点击右侧下拉菜单弹框
	 	    			    $(".gallery-header .notice-box .notice-content ul li").click(function(e){
	 	    			      	e.stopPropagation();
	 	    			      	isSelect=$(".gallery-header #select").val();
	 	    			      	if(isSelect=="true"){
	 	    			  		   showSelectCountryModal();
	 	    			  	    }
	 	    			    })
	 	    			} 
	 	    			
		 	    	} 
		 	    },error:function(err){
		 	    	console.log(err);
		 	    }
		 	})
		 } 
		//Gallery Header 更新通知icon显示隐藏的状态
		function updataGalleryNoticeStatus(){
			honorData.loginName = decodeURI(utils.getCookie('loginUid'));
			if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
				// 已登录		 
				$('.gallery-header .gallery-login').addClass('gallery-logined');
				$('.gallery-header .site-navbox .gallery-account').removeClass('unlogin').addClass('gallery-logined');
			}else{
				// 未登录		
				$('.gallery-header .gallery-login').removeClass('gallery-logined');
				$('.gallery-header .site-navbox .gallery-account').removeClass('gallery-logined').addClass('unlogin');
			}
		}
		}
		
	})
})();

(function(){
	$(function(){
		if($('.gallery-header').length>0){
			
			// 顶部导航匹配当前页，切换选中效果
			if(galleryPublicData.windowW>768){
				isActive();
			}
			function isActive(){
				// 当前页面路径
				var pathname = location.pathname;
				var endUrl ='';
				var url ='';
				if(pathname.indexOf('/content/honor') != -1){
					//编辑环境
					url = pathname.split('/content/honor')[1];
					endUrl = url.split('.html')[0]+'/';
				}else{
					endUrl = pathname;
				}
				
				// 顶部导航汇总			
				var navUrlArr = [];
				$('.gallery-header .site-topnav .nav-li .nav-link').each(function(index){
					var itemData=null;
					var currUrl = $(this).attr('href') || '';
					var title= $.trim($(this).text()) || '';
					if(currUrl=='javascript:void(0);'){
						 var subData=[];
						 $(this).siblings('.site-subnav').find('.subnav-link').each(function(){
							 url= $(this).attr('href') || '';
							 if(url){
								 url = url.split('?type=')[0];
							 }
							 subData.push({'url':url});
						 })
						 itemData={'title':title,'type':'subnav','subdata':subData};
					 }else{
						 itemData={'title':title,'url':currUrl,'type':'topnav'};
					 } 
					 navUrlArr.push(itemData);
				})  
				// 顶部导航匹配当前页，切换选中效果
				for(var i=0;i < navUrlArr.length;i++){
					if(navUrlArr[i].type=='topnav'){
						// 一级导航
						if(navUrlArr[i].url==endUrl){
							$('.site-topnav .nav-li:nth-child('+(i+1)+')').addClass('active');
						}
					}else{
						// 二级导航
						var subdata = navUrlArr[i].subdata;
						for(var x=0;x<subdata.length;x++){
							if(subdata[x].url==endUrl){
								$('.site-topnav .nav-li:nth-child('+(i+1)+')').addClass('active');
								$('.site-topnav .nav-li:nth-child('+(i+1)+') .site-subnav li:nth-child('+(x+1)+')').addClass('active');
							}
						}
						
					}
				}
			}
		}
		
	})
})();

(function(){
	$(function(){
		if($('.common-share').length>0){
			var currUrl = location.protocol+"//"+location.host;
			var currPageUrl = encodeURIComponent(window.location.href);
			var shareTitle = encodeURIComponent($('#shareTitle').val());
			var shareDesc = encodeURIComponent($('#shareDesc').val());
			var shareImg = encodeURIComponent(currUrl+$('.fbshare').attr("src"));
			// Facebook Share
			$('.common-share .fa-facebook').click(function(){
				window.open ("https://www.facebook.com/sharer.php?u="+currPageUrl, "newwindow", "width=500,height=420,top=100, left=200, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
			})
			
			// Twitter Share
			$('.common-share .fa-twitter').click(function(){
				window.open('https://twitter.com/intent/tweet?text=' + shareTitle +'  '+ shareDesc +' &amp;url=' + currPageUrl,"newwindow", " width=500,height=420, top=100, left=100, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
			})
			
			//分享到qq
		    $(".common-share .fa-qq").click(function() {
		    	  window.open('//connect.qq.com/widget/shareqq/index.html?url=' + currPageUrl +'&title=' + shareTitle +'&desc=' + shareDesc +'&amp;pics=' + shareImg +'','newwindow','height=680, width=700, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no');
		    });
		      //分享到qzone
		    $(".common-share .fa-qzone").click(function() {
		    	  window.open('//sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=' + currPageUrl +'&title=' + shareTitle +'&summary=' + shareDesc +'&pics=' + shareImg +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		    });
		      //分享到weibo
		    $(".common-share .fa-weibo").click(function() {
		    	  window.open('//service.weibo.com/share/share.php?url=' + currPageUrl +'&title=' + shareTitle +'&pic=' + shareImg +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		    });
		      //分享到VK
		    $(".common-share .fa-vk").click(function() {
		    	  window.open('//vk.com/share.php?url =' + currPageUrl +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		    });
		      //分享到WhatsApp
		    $(".common-share .fa-whatsapp").click(function() {
		    	  window.open('//api.whatsapp.com/send?text=' + currPageUrl +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		    });
			
		}
	})
}());

(function(){
	$(function(){ 
		if($('.themes-upload-wallpapers').length>0){
			var bodyHeight = window.screen.availHeight;
			$("body").css({"background-color":"#000","min-height": bodyHeight + "px"});
			var api = themesBaseData.apiUrl;
			if($('#themesHeader .loginout-data').length > 0) {
				api = $('#themesHeader .loginout-data').attr("data-loginredirecturl").split('/abroad/')[0] || themesBaseData.apiUrl;
			}
			//填充国家
			$.ajax({
				type: "GET",
				url: api + "/abroad/shootMatch/galleryCountriesList?activityName=global_all_gallery",
				success: function(data) {
					var data = data.infoBean;
					var countryHtml;
					var countryArray = [];
					for(var i = 0; i < data.length; ++i) {
						countryHtml = '<option value="' + data[i].value + '">' + data[i].nodeName + '</option>';
						countryArray[countryArray.length] = countryHtml;
					}
					$("#userCountry").append(countryArray.join(""));
				}
			});
			
			function getLength(val) {
				var str = new String(val);
				var bytesCount = 0;
				for (var i = 0 ,n = str.length; i < n; i++) {
					var c = str.charCodeAt(i);
					if(c <= 0x007f) {
						bytesCount += 1;
	                }else if(c <= 0x07ff){
	                	bytesCount += 2;
	                }else if(c <= 0xffff){
	                	bytesCount += 3;
	                }else{
	                	bytesCount += 4;
	                }
				}
				return bytesCount;
			}
			
			//判断表单是否能够提交
			function checkForm() {
				if($(".imgFormatTips:visible").length == 0 && $(".widthLimit3061Tips:visible").length == 0 && $(".widthLimit2160Tips:visible").length == 0 && $(".sizeLimitTips:visible").length == 0 && $("#file")[0].files.length > 0 && $("#file2")[0].files.length > 0 && $("#title").val() && $("#workDescription").val() && $("#authorIntroduction").val() && $("#userCountry").val() && $(".confirmCheck").hasClass("fa-check")) {
					$("#uploadButton").removeAttr("disabled");
				} else {
					$("#uploadButton").attr("disabled");
				}
			}
			
			$("#uploadButton").on("click", function() {
				if($(".emptyTip:visible").length == 0) {
					var formData = new FormData($('#uploadForm')[0]);
					formData.append("activityName","wallpaper_design_contest");
					formData.append("imgCountries","gallery");
					formData.append("authorName","00000000000");
					formData.append("category","");
					$.ajax({
			            type: "POST",
			            url: api + "/abroad/wallpaper/uploadWallpaper",
			            data:formData,
			            contentType: false,
			            processData: false,
			            xhrFields: {
							withCredentials: true
						},
						crossDomain: true,
						beforeSend: function() {
							$(".loading").show();
						},
			            success: function(data) {
			                if(data.code == 200) {
			                	$(".successTips").show();
			                	$(".loading").hide();
			                	
			                	//GA CODE
			                	window.dataLayer.push({
			                		"event": "uaEvent",
			                		"eventCategory": honorConfig.pageType,
			                		"eventAction": "uploadWallpaper",
			                		"eventLabel": "upload + success"
			                	})
			                	
			                }
			            }
			        });
				}
			});
			
			//触发文件选择
			$(".fileButton,.previewImgWapper").on("click", function() {
				$(".uploadFile").trigger("click");
			});
			
			$(".fileButton-right,.previewImgWapper-right").on("click", function() {
				$(".uploadFile-right").trigger("click");
			});
			
			//文件选择 change事件
			$("#file").on("change", function() {
				//检测文件是否存在
				var file = $("#file")[0].files;
				if(file.length > 0) {
					//检测文件类型
					var picFormat = file[0].type;
					if(picFormat === "image/jpeg" || picFormat === "image/jpg" || picFormat === "image/png") {
						//检测文件大小不能超过20M
						var fileSize = file[0].size;
						if(fileSize <= 1024*1024*20) {
							//检测图片尺寸 为 3061*1531
							var reader = new FileReader();
							reader.readAsDataURL(file[0]);
							reader.onload = function(theFile) {
								var image = new Image();
								image.src = theFile.target.result;
							    image.onload = function() {
								   if(this.width === 3061 && this.height === 1531) {
									   	$("#file").siblings(".emptyTip").hide();
									   	$("#file").siblings(".sizeLimitTips").hide();
									   	$("#file").siblings(".widthLimit3061Tips").hide();
										var src = window.URL.createObjectURL($("#file")[0].files[0]);
										$(".previewImgWapper").show();
										$(".previewImg").attr("src", src)
										$(".imgName").show().find(".imgValue").text($("#file")[0].files[0].name);
										$(".fileButton").hide();
								   } else {
									    $(".previewImgWapper").hide();
										$(".imgName").hide().find(".imgValue").text("");
										$(".fileButton").show();
										$("#file").siblings(".widthLimit3061Tips").show();
										$("#file").siblings(".sizeLimitTips").hide();
										$("#file").siblings(".imgFormatTips").hide();
										$("#file").siblings(".emptyTip").hide();
								   }
							    };
							};
						} else {
							$(".previewImgWapper").hide();
							$(".imgName").hide().find(".imgValue").text("");
							$(".fileButton").show();
							$(this).siblings(".sizeLimitTips").show();
							$(this).siblings(".widthLimit3061Tips").hide();
							$(this).siblings(".imgFormatTips").hide();
							$(this).siblings(".emptyTip").hide();
						}
					} else {
						$(".previewImgWapper").hide();
						$(".imgName").hide().find(".imgValue").text("");
						$(".fileButton").show();
						$(this).siblings(".imgFormatTips").show();
						$(this).siblings(".widthLimit3061Tips").hide();
						$(this).siblings(".emptyTip").hide();
						$(this).siblings(".sizeLimitTips").hide();
					}
				} else {
					$(".previewImgWapper").hide();
					$(".imgName").hide().find(".imgValue").text("");
					$(".fileButton").show();
					$(this).siblings(".emptyTip").show();
					$(this).siblings(".widthLimit3061Tips").hide();
					$(this).siblings(".imgFormatTips").hide();
					$(this).siblings(".sizeLimitTips").hide();
				}
				checkForm();
			});
			
			$("#file2").on("change", function() {
				//检测文件是否存在
				var file = $("#file2")[0].files;
				if(file.length > 0) {
					//检测文件类型
					var picFormat = file[0].type;
					if(picFormat === "image/jpeg" || picFormat === "image/jpg" || picFormat === "image/png") {
						//检测文件大小不能超过20M
						var fileSize = file[0].size;
						if(fileSize <= 1024*1024*20) {
							//检测图片尺寸 为 2160*1920
							var reader = new FileReader();
							reader.readAsDataURL(file[0]);
							reader.onload = function(theFile) {
								var image = new Image();
								image.src = theFile.target.result;
							    image.onload = function() {
								   if(this.width === 2160 && this.height === 1920) {
									   	$("#file2").siblings(".emptyTip").hide();
									   	$("#file2").siblings(".sizeLimitTips").hide();
									   	$("#file2").siblings(".widthLimit2160Tips").hide();
										var src = window.URL.createObjectURL($("#file2")[0].files[0]);
										$(".previewImgWapper-right").show();
										$(".previewImg-right").attr("src", src)
										$(".imgName-right").show().find(".imgValue-right").text($("#file2")[0].files[0].name);
										$(".fileButton-right").hide();
								   } else {
									    $(".previewImgWapper-right").hide();
										$(".imgName-right").hide().find(".imgValue-right").text("");
										$(".fileButton-right").show();
										$("#file2").siblings(".widthLimit2160Tips").show();
										$("#file2").siblings(".sizeLimitTips").hide();
										$("#file2").siblings(".imgFormatTips").hide();
										$("#file2").siblings(".emptyTip").hide();
								   }
							    };
							};
						} else {
							$(".previewImgWapper-right").hide();
							$(".imgName-right").hide().find(".imgValue-right").text("");
							$(".fileButton-right").show();
							$(this).siblings(".sizeLimitTips").show();
							$(this).siblings(".imgFormatTips").hide();
							$(this).siblings(".emptyTip").hide();
							$(this).siblings(".widthLimit2160Tips").hide();
						}
					} else {
						$(".previewImgWapper-right").hide();
						$(".imgName-right").hide().find(".imgValue-right").text("");
						$(".fileButton-right").show();
						$(this).siblings(".imgFormatTips").show();
						$(this).siblings(".emptyTip").hide();
						$(this).siblings(".widthLimit2160Tips").hide();
						$(this).siblings(".sizeLimitTips").hide();
					}
				} else {
					$(".previewImgWapper-right").hide();
					$(".imgName-right").hide().find(".imgValue-right").text("");
					$(".fileButton-right").show();
					$(this).siblings(".emptyTip").show();
					$(this).siblings(".widthLimit2160Tips").hide();
					$(this).siblings(".sizeLimitTips").hide();
					$(this).siblings(".imgFormatTips").hide();
				}
				checkForm();
			});
			
			//select change 事件
			$("#uploadForm").on("change", "select", function() {
				if($(this).val()) {
					$(this).siblings(".emptyTip").hide();
					$(this).css("border-color","#979797");
				} else {
					$(this).siblings(".emptyTip").show();
				}
				checkForm();
			});
			
			//input 输入 事件
			$("#uploadForm").on("keyup", "input[type='text']", function() {
				var thisVal = $.trim($(this).val());
				var overLength = parseInt($(this).attr("data-length"));
				if(!thisVal) {
					$(this).siblings(".emptyTip").show();
					$(this).css("border-color","#ff00d0");
				} else {
					$(this).siblings(".emptyTip").hide();
					$(this).css("border-color","#979797");
				}
				
				var bytesCount = getLength(thisVal);
				if(bytesCount > overLength) {
					$(this).siblings(".overlengthTip").show();
					$(this).css("border-color","#ff00d0");
				} else {
					$(this).siblings(".overlengthTip").hide();
					$(this).css("border-color","#979797");
				}
				
				checkForm();
			});
			
			//复选框点击事件
			$(".confirmCheck").on("click", function() {
				$(this).toggleClass("fa fa-check");
				if($(this).hasClass("fa-check")) {
					$(".agreeTips").hide();
				} else {
					$(".agreeTips").show();
				}
				
				checkForm();
			});
			
			//清除图片
			$(".closeImg").on("click", function() {
				$("#file").val("");
				$(".imgName").hide();
				$(".previewImgWapper").hide();
				$(".fileButton").show();
				$("#file").siblings(".emptyTip").show();
				checkForm();
				return false;
			});
			
			$(".closeImg-right").on("click", function() {
				$("#file2").val("");
				$(".imgName-right").hide();
				$(".previewImgWapper-right").hide();
				$(".fileButton-right").show();
				$("#file2").siblings(".emptyTip").show();
				checkForm();
				return false;
			});
			
			//成功提示按钮 点击事件
			$(".closeSuccess").on("click", function() {
				$(".successTips").hide();
				$('#uploadForm')[0].reset();
				$(".emptyTip").hide();
				$(".confirmCheck").removeClass("fa").removeClass("fa-check");
				$(".previewImgWapper").hide();
				$(".previewImgWapper-right").hide();
				$(".fileButton").show();
				$(".fileButton-right").show();
				$("#uploadButton").prop("disabled",true);
			});
			
			//取消按钮添加跳转链接
			$(".cancelBtn").attr("href",$(".site-logo").attr("href"));
		}
	})
}());

/**
 * Themes-Rules组件
 */ 
(function(){
	$(function(){ 
		if($('.themes-rules-box').length>0){
			//判断是否IE标题文字非渐变
			if(!!window.ActiveXObject || "ActiveXObject" in window){
				$(".themes-rules-box .themes-rules-title").css({"color":"#bd00fe","background-image":"none"});
			}
			
			//GA CODE
			$(".themes-rules-box .rules-item a").click(function(){
				var linkName=$(this).attr("href");
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Rules Page",
					"eventAction": "drainage link",
					"eventLabel": linkName
				})
			})
		}
	})
}());

/*!
 *	Themes List Templates By Xudongming
 * 	themes-list-templates - v1.0.0 (2019-09-12T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-wallpapers-template').length>0){
			
		}
	})
}());

/*!
 *	Themes List Remarks By Xudongming
 * 	themes-list-remarks - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-wallpapers-template').length>0){
			
		}
	})
}());

/*!
 *	Themes Lists Layout Details By Xudongming
 * 	themes-lists-layout-details - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-wallpapers-template').length>0){
			var ww = $("body").width();
			if(ww <= 768) {
				$(".themes-list-wallpapers-template").find(".layout-mb.lazy").lazyload({effect: "fadeIn"});
			} else {
				$(".themes-list-wallpapers-template").find(".layout-pc.lazy").lazyload({effect: "fadeIn"});
			}
			
			//GA CODE
			$(".themesListsLayoutDetails .download-box .btn-download").click(function(){
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "Template",
					"eventLabel": "Download Templates"
				})
			})
		}
	})
}());

/*!
 *	Themes List Future Instructions By Xudongming
 * 	themes-list-future-instructions - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-wallpapers-template').length>0){
			
		}
	})
}());

/*!
 *	Themes List Templates By Xudongming
 * 	themes-list-templates - v1.0.0 (2019-09-12T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-template').length>0){
			
		}
	})
}());

/*!
 *	Themes List Remarks By Xudongming
 * 	themes-list-remarks - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-template').length>0){
			
		}
	})
}());

/*!
 *	Themes Lists Layout Details By Xudongming
 * 	themes-lists-layout-details - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-template').length>0){
			var ww = utils.pageWidth();
			if(ww <= 768) {
				$(".themes-list-template").find(".layout-mb.lazy").lazyload({effect: "fadeIn"});
			} else {
				$(".themes-list-template").find(".layout-pc.lazy").lazyload({effect: "fadeIn"});
			}
			
		}
	})
}());

/*!
 *	Themes List Future Instructions By Xudongming
 * 	themes-list-future-instructions - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-template').length>0){
			
		}
	})
}());

/**
 * Themes-Rules组件
 */ 
(function(){
	$(function(){ 
		if($('.themes-list-rules-box').length>0){
			//判断是否IE标题文字非渐变
			if(!!window.ActiveXObject || "ActiveXObject" in window){
				$(".themes-list-rules-box .themes-rules-title").css({"color":"#bd00fe","background-image":"none"});
			}
			
			//GA CODE
			$(".themes-list-rules-box .rules-item a").click(function(){
				var linkName=$(this).attr("href");
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Rules Page",
					"eventAction": "drainage link",
					"eventLabel": linkName
				})
			})
			
		}
	})
}());

/*!
 *	Themes List Future Instructions By Xudongming
 * 	themes-list-future-instructions - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.recommendli').length>0){
			var api = themesBaseData.apiUrl;
			if($('#themesHeader .loginout-data').length > 0) {
				api = $('#themesHeader .loginout-data').attr("data-loginredirecturl").split('/abroad/')[0] || themesBaseData.apiUrl;
			}
			//获取推荐的主题数据
			function recommendHeight() {
				setTimeout(function() {
					var recommendBoxratio = 1230/380;
					var recommendBoxWidth = $(".recommendedTheme").width();
					var recommendBoxHeight = recommendBoxWidth/recommendBoxratio;
					var rightHeight = $(".recommendedTheme").find(".right").height();
					if(rightHeight > recommendBoxHeight) {
						$(".recommendedTheme").css("height", rightHeight + 30 + "px");
					} else {
						$(".recommendedTheme").css("height", recommendBoxHeight + 30 + "px");
					}
				},100);
			}
			function getRecommendData() {
				$.ajax({
					type: "GET",
					url: api + "/abroad/wallpaper/listWallpaperDesignImageInfo? &activityName=wallpaper_design_contest&isRecommend=1",
					success: function(data) {
						var data = JSON.parse(data);
						if(data.infoBean.pageList.length > 0) {
							$(".themeAllWorks").find(".total").text(data.infoBean.total);
							var recommendData = data.infoBean.pageList;
							var dataArray = [];
							var dataHtml;
							var swiperHtml;
							var swiperArray = [];
							for(var i = 0; i < recommendData.length; ++i) {
								dataHtml = '<span class="' + i + '">' + JSON.stringify(recommendData[i]) + '</span>';
								dataArray[dataArray.length] = dataHtml;
								swiperHtml = '<div class="swiper-slide">' +
											'<img class="recommendedPic" src="' + recommendData[i].imgSrc + '"/>' +
								            '</div>';
								swiperArray[swiperArray.length] = swiperHtml;
							}
							$("#recommendedData").html(dataArray.join(""));
							$("#recommendSwiper").html(swiperArray.join(""));
							
							var bodyWidth = $("body").width();
							if(bodyWidth > 768) {
								var recommendedWallpaperRadio = 687/1920;
								var recommendedWallpaperWidth = bodyWidth*recommendedWallpaperRadio;
								$(".recommendedTheme").find(".recommended-swiper").css("width",recommendedWallpaperWidth + "px");
								var rightRadio = 562/1920;
								var rightWidth = bodyWidth*rightRadio;
								$(".recommendedTheme").find(".right").css("width", rightWidth + "px");
									
								var ratio = 1.99;
								var picWidth = $(".recommendedTheme").find(".recommended-swiper").width();
								var picHeight = picWidth/ratio;
								
								$(".recommendedTheme").find(".recommended-swiper").css("height", picHeight + "px");
								recommendHeight();
								
								var swiper = new Swiper('.swiper-container', {
									on: {
								     slideChange: function() {
								    	var currentNum = $(".swiper-pagination-current").eq(0).text() - 1;
								    	getPageData(currentNum);
								    	recommendHeight();
							         }
								  },
							      pagination: {
							        el: '.swiper-pagination',
							        type: 'fraction',
							      },
							      navigation: {
							        nextEl: '.pageRight',
							        prevEl: '.pageLeft',
							      },
							    });
							} else {
								var swiper = new Swiper('.swiper-container', {
								  autoHeight: true,
								  on: {
								    slideChange: function() {
								    	var currentNum = $(".swiper-pagination-bullet.swiper-pagination-bullet-active").index();
								    	getPageData(currentNum);
								    }
								  },
							      pagination: {
							        el: '.swiper-pagination'
							      }
							    });
							}
							getPageData(0);
						} else {
							$(".recommendli").html("<span class='nodata'>No Data</span>")
						}
					}
				});
			}
			
			getRecommendData();
			
			$(".themes-list-all-works").on("click",".themeAllWorks .pageLeft",function(){
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "All Works",
					"eventLabel": "wallpapers switch+prev"
				})
			})
			
			$(".themes-list-all-works").on("click",".themeAllWorks .pageRight",function(){
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "All Works",
					"eventLabel": "wallpapers switch+next"
				})
			})
			
			$(".themes-list-all-works").on("click",".themeAllWorks .viewBtn",function(){
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "All Works",
					"eventLabel": "View"
				})
			})
			
			
			
			//分页获取推荐数据
			function getPageData(num) {
				var recommendli = $(".recommendli");
				var data = JSON.parse(recommendli.find("." + num).text());
				recommendli.find(".viewBtn").attr("href", $("#allWorks").data("source") + "." + data.id);
				recommendli.find(".titleDesc").text(data.title);
				recommendli.find(".description").text(data.workDescription);
				recommendli.find(".nameDesc").text(data.nickNameAct);
				recommendli.find(".bioDesc").text(data.authorIntroduction);
				recommendli.find(".designerPic").attr("src", data.upHeadUrl);
			}
			
			//推荐切换主题按钮
			$(".pageArrow").on("click", function() {
				var arrowType = $(this).attr("class").split(" ")[1];
				var totalNum = parseInt($(".page").find(".total").text());
				var nowNum = parseInt($(".page").find(".now").text());
				var preNum = parseInt($(".page").find(".pageLeft").attr("data-prev"));
				var nextNum = parseInt($(".page").find(".pageRight").attr("data-next"));
				if(arrowType == "pageLeft") {
					if(preNum - 1 >= 0) {
						nowNum = nowNum - 1;
						$(".page").find(".pageLeft").attr("data-prev", preNum - 1);
						$(".page").find(".pageRight").attr("data-next", nextNum - 1);
						getPageData(preNum - 1);
					}
				} else {
					if(nowNum < totalNum) {
						nowNum = nowNum + 1;
						$(".page").find(".pageLeft").attr("data-prev", preNum + 1);
						$(".page").find(".pageRight").attr("data-next", nextNum + 1);
						getPageData(nextNum);
					}
					
				}
				$(".page").find(".now").text(nowNum);
			});
		}
	})
}());

/*!
 *	Themes Lists Layout Details By Xudongming
 * 	themes-lists-layout-details - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.themes-list-all-works').length>0){
			//判断是否IE标题文字非渐变
			if(!!window.ActiveXObject || "ActiveXObject" in window){
				$(".themes-list-all-works .themesAll").find("h1").css({"color":"#bd00fe","background-image":"none"});
			}
			var api = themesBaseData.apiUrl;
			if($('#themesHeader .loginout-data').length > 0) {
				api = $('#themesHeader .loginout-data').attr("data-loginredirecturl").split('/abroad/')[0] || themesBaseData.apiUrl;
			}
			var designer = $(".designerText").text();
			var likes = $(".likesText").text();
			var downloads = $(".downloadsText").text();
			var category = $(".category").text();
			var bodyWidth = $("body").width();
			var pageSize;
			if(bodyWidth > 1024) {
				maskHeight = 114;
				pageSize = 9;
			} else {
				maskHeight = 180;
				pageSize = 6;
			}
			//分页获取壁纸列表数据
			function getDataList() {
				var category = $("#category").text();
				var obj;
				if(category) {
					obj = {
						pageIndex: $(".contentAll").find("li.active").attr("data-num") || 0,
						pageSize: pageSize,
						category: category,
						activityName: 'wallpaper_design_contest',
						queryConditions: $("#wallpaperText").val().trim(),
						SortingOtions: $(".menuSearch").find("li.active").attr("data-SortingOtions")
					}
				} else {
					obj = {
						pageIndex: $(".contentAll").find("li.active").attr("data-num") || 0,
						pageSize: pageSize,
						activityName: 'wallpaper_design_contest',
						queryConditions: $("#wallpaperText").val().trim(),
						SortingOtions: $(".menuSearch").find("li.active").attr("data-SortingOtions")
					}
				}
				$.ajax({
					type: "POST",
					data: obj,
					url: api + "/abroad/wallpaper/listWallpaperDesignImageInfo",
					dataType: 'json',
					xhrFields: {
			            withCredentials: true
			        },
					success: function(data) {
						if(data.infoBean.pageList.length > 0) {
							var totalNum = data.infoBean.totalPage;
							var pageIndex = data.infoBean.pageIndex;
							var sortingOtions = data.infoBean.sortingOtions;
							var data = data.infoBean.pageList;
							var liHtml;
							var liArray = [];
							var lovedClass;
							var lovedStatus;
							for(var i = 0; i < data.length; ++i) {
								if(data[i].isPraised == 1) {
									lovedClass = "love fa fa-heart-o";
									lovedStatus = 1;
								} else {
									lovedClass = "love fa fa-heart loved";
									lovedStatus = 0;
								}
								liHtml = '<li data-id="' + data[i].id + '">' +
										'<div class="main-box-bg"></div>' +
										'<div class="liContent">' +
										'<a href="' + $("#allWorks").data("source") + "." + data[i].id + '">' +
										'<div class="rg-content">' +
										'<div class="imgWapper">' +
										'<img src="' + data[i].imgSrc + '"/>' +
										'</div>' +
										'</div>' +
										'</a>' +
										'<div class="mask">' +
										'<div class="introduce">' +
										'<span class="themeTitle">' + data[i].title + '</span>' +
										'<span class="themeDesigner">' + designer + ': ' + data[i].nickNameAct + '</span>' +
										'</div>' +
										'<div class="configer">' +
										'<div class="likesShow">' +
										'<span class="likesIcon data-icon icon-love ' + lovedClass + '" data-checked="' + lovedStatus + '"></span>' +
										'<div class="likesInfo">' +
										'<span class="likesNum">' + data[i].liked + '</span>' +
										'<span class="likesText">' + likes + '</span>' +
										'</div>' +
										'</div>' +
										'<div class="downloadShow">' +
										'<a href="' + $("#allWorks").data("source") + "." + data[i].id + '"><span class="downloadIcon data-icon icon-download honorFont-download"></span></a>' +
										'<div class="downLoadInfo">' +
										'<span class="downloadNum">' + data[i].downloadTimes + '</span>' +
										'<span class="downloadText">' + downloads + '</span>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'</li>';
								liArray[liArray.length] = liHtml;
							}
							
							$(".themesAll").find(".themeUl").html(liArray.join(""));
							if(bodyWidth <= 768) {
								$(".themeAll-pagination").hide();
							} else {
								$(".themeAll-pagination").show();
							}
							
							if(bodyWidth <= 768 && parseInt(totalNum) > 1) {
								$(".load-more").show();
							}
							
							//确定列表item高度
							var ratio = 1.99;
							var maskHeight;
							if(bodyWidth > 768) {
								maskHeight = 114;
							} else {
								maskHeight = 180;
							}
							var liWidth = $(".contentAll").find("li").width();
							var liHeight = liWidth/ratio;
							$(".contentAll").find("li").css("height",liHeight + maskHeight -3 + "px");
							
							//分页
							var pageHtml;
							var pageArray = [];
							for(var k = 0; k < totalNum; ++k) {
								var showNum = parseInt(k) + 1;
								var activeClass;
								if(k == pageIndex) {
									activeClass = "active";
								} else {
									activeClass = "";
								}
								pageHtml = '<li class="' + activeClass + '" data-num="' + k + '">' +
										'<span>' + showNum + '</span>' +
										'</li>';
								pageArray[pageArray.length] = pageHtml;
							}
							$(".themeAll-pagination").find(".theme-page").html(pageArray.join(""));
							
							$(".screenBtn").find("li").removeClass("active");
							$(".screenBtn").find("li[data-sortingotions='" + sortingOtions + "']").addClass("active");
							
							//列表hover事件
							var ww = $("body").width();
							if(ww >=1024) {
								$(".contentAll .liContent").hover(function(){
								    var arabicLength = $(".__arabic__").length;
									if(arabicLength > 0) {
										$(this).css({"transform":"translate(16px,-16px)"}).css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
									} else {
										$(this).css({"transform":"translate(-16px,-16px)"}).css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
									}
					    	    }).mouseleave(function(){
					    	    	$(this).css({"transform":"translate(0,0)","transition":"transform 1.5s cubic-bezier(.22, .89, .57, 1)"});
					    	    });
							}
						} else {
							$(".themesAll").find(".contentAll .themeUl").html("<span class='nodata'>No Data</span>");
							$(".themeAll-pagination,.load-more").hide();
						}
					}
				})
			}
			
			if($(".themes-list-tabs .themesTabs").length === 0) {
				getDataList();
			} else {
				$("#category").on("click", function() {
					getDataList();
				});
			}
			
			
			//移动端分页 view more按钮点击
			$(".load-more").on("click", function() {
				var thisPage = $(this).attr("data-page");
				var category = $("#category").text();
				var obj;
				if(category) {
					obj = {
						pageIndex: thisPage,
						pageSize: 6,
						category: $("#category").text(),
						activityName: 'wallpaper_design_contest',
						queryConditions: $("#wallpaperText").val().trim(),
						SortingOtions: $(".menuSearch").find("li.active").attr("data-SortingOtions")
					}
				} else {
					obj = {
						pageIndex: thisPage,
						pageSize: 6,
						activityName: 'wallpaper_design_contest',
						queryConditions: $("#wallpaperText").val().trim(),
						SortingOtions: $(".menuSearch").find("li.active").attr("data-SortingOtions")
					}
				} 
				$.ajax({
					type: "POST",
					data: obj,
					url: api + "/abroad/wallpaper/listWallpaperDesignImageInfo",
					dataType: 'json',
					xhrFields: {
			            withCredentials: true
			        },
					success: function(data) {
						var totalNum = parseInt(data.infoBean.totalPage);
						var pageIndex = parseInt(data.infoBean.pageIndex);
						var sortingOtions = data.infoBean.sortingOtions;
						var data = data.infoBean.pageList;
						var liHtml;
						var liArray = [];
						var lovedClass;
						var lovedStatus;
						for(var i = 0; i < data.length; ++i) {
							if(data[i].isPraised == 1) {
								lovedClass = "love fa fa-heart-o";
								lovedStatus = 1;
							} else {
								lovedClass = "love fa fa-heart loved";
								lovedStatus = 0;
							}
							liHtml = '<li data-id="' + data[i].id + '">' +
									'<div class="main-box-bg"></div>' +
									'<div class="liContent">' +
									'<a href="' + $("#allWorks").data("source") + "." + data[i].id + '">' +
									'<div class="rg-content">' +
									'<div class="imgWapper">' +
									'<img src="' + data[i].imgSrc + '"/>' +
									'</div>' +
									'</div>' +
									'</a>' +
									'<div class="mask">' +
									'<div class="introduce">' +
									'<span class="themeTitle">' + data[i].title + '</span>' +
									'<span class="themeDesigner">' + designer + ': ' + data[i].nickNameAct + '</span>' +
									'</div>' +
									'<div class="configer">' +
									'<div class="likesShow">' +
									'<span class="likesIcon data-icon icon-love ' + lovedClass + '" data-checked="' + lovedStatus + '"></span>' +
									'<div class="likesInfo">' +
									'<span class="likesNum">' + data[i].liked + '</span>' +
									'<span class="likesText">' + likes + '</span>' +
									'</div>' +
									'</div>' +
									'<div class="downloadShow">' +
									'<a href="' + $("#allWorks").data("source") + "." + data[i].id + '"><span class="downloadIcon data-icon icon-download honorFont-download"></span></a>' +
									'<div class="downLoadInfo">' +
									'<span class="downloadNum">' + data[i].downloadTimes + '</span>' +
									'<span class="downloadText">' + downloads + '</span>' +
									'</div>' +
									'</div>' +
									'</div>' +
									'</div>' +
									'</div>' +
									'</li>';
							liArray[liArray.length] = liHtml;
						}
						
						$(".themesAll").find(".contentAll ul").append(liArray.join(""));
						
						if(pageIndex + 1 === totalNum) {
							$(".load-more").hide();
						} else {
							$(".load-more").attr("data-page", pageIndex + 1);
						}
						
						//确定列表item高度
						var ratio = 1.99;
						var maskHeight = 180;
						var liWidth = $(".contentAll").find("li").width();
						var liHeight = liWidth/ratio;
						$(".contentAll").find("li").css("height",liHeight + maskHeight -3 + "px");
					}
				})
			});
			
			//按条件排序 按钮
			$(".screenBtn").on("click", "li", function() {
				if(!$(this).hasClass("active")) {
					$(this).siblings("li").removeClass("active");
					$(this).addClass("active");
					getDataList();
					
					//GA CODE
					var categoryName=$(this).children("span").text();
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Categories Page+"+honorConfig.pageType,
						"eventAction": "All Works",
						"eventLabel": "wallpapers category+"+categoryName
					})
				}
			});
			
			//搜索框 回车搜索
			$("#wallpaperText").on("keypress", function(event) {
				if(event.keyCode == '13') {
					getDataList();
				}
			});
			
			//搜索按钮 事件
			$(".searchicon").on("click", function() {
				getDataList();
				
				//GA CODE
				var searchContent=$("#wallpaperText").val();
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "All Works",
					"eventLabel": "search+"+searchContent
				})
			});
			
			$(".themeAllWorks").on("click",".themesAll .contentAll ul li .liContent a",function() {
				//GA CODE
				var wallpapersName=$(this).next(".mask").find(".themeTitle").text();
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "All Works",
					"eventLabel": "wallpapers entry+"+wallpapersName
				})
			})
			 
			
			//分页按钮点击事件
			$(".theme-page").on("click", "li", function() {
				if(!$(this).hasClass("active")) {
					$(this).siblings("li").removeClass("active");
					$(this).addClass("active");
					getDataList();
					
					//GA CODE
					var pageNumber=$(this).children("span").text();
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Categories Page+"+honorConfig.pageType,
						"eventAction": "All Works",
						"eventLabel": "page turning+"+pageNumber
					})
				}
			});
			
			//上一页 按钮点击事件
			$(".themeAll-pagination").on("click", ".honorFont-arr-left", function() {
				var thisIndex = $(".theme-page").find("li.active").attr("data-num");
				if(thisIndex != 0) {
					var currentNode = $(".theme-page").find("li.active");
					currentNode.prev("li").addClass("active");
					currentNode.removeClass("active");
					getDataList();
					
					//GA CODE
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Categories Page+"+honorConfig.pageType,
						"eventAction": "All Works",
						"eventLabel": "page turning+prev"
					})
				}
			});
			
			//下一页 按钮点击事件
			$(".themeAll-pagination").on("click", ".honorFont-arr-right", function() {
				var thisIndex = $(".theme-page").find("li.active").attr("data-num");
				var lastIndex = $(".theme-page").find("li:last").index();
				if(thisIndex != lastIndex) {
					var currentNode = $(".theme-page").find("li.active");
					currentNode.next("li").addClass("active");
					currentNode.removeClass("active");
					getDataList();
				}
				
				//GA CODE
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "All Works",
					"eventLabel": "page turning+next"
				})
			});
			
			//点赞按钮
			$(".themesAll").on("click", ".love", function(event) {
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					var thisId = $(this).parents("li").attr("data-id");
					var thisChecked = $(this).attr("data-checked");
					var obj = {
						imgId: 	thisId,
						activityName: "wallpaper_design_contest"
					}
					var url;
					
					if(thisChecked == "1") {
						url = "/abroad/wallpaper/addWallpaperPraise";
					} else {
						url = "/abroad/wallpaper/delWallpaperPraise";
					}
					$.ajax({
						type: "POST",
						data: obj,
						url: api + url,
						dataType: 'json',
						xhrFields: {
				            withCredentials: true
				        },
						success: function(data) {
							if(data.resultDesc == "success") {
								getDataList();
							}
						}
					});
					
					//GA CODE
					var wallpapersName=$(this).parents(".mask").find(".themeTitle").text();
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Categories Page+"+honorConfig.pageType,
						"eventAction": "All Works",
						"eventLabel": "like+"+wallpapersName
					})
					
				} else {
					$("#themesAlert").show();
				}
			});
		}
	})
}());

/*!
 *	Themes Header Component By Bruce
 * 	v1.0.0 (2019-09-09T10:29:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
var themesBaseData = {
	apiUrl:"https://cuep-sg.hihonor.com",
	loginUrl:"",
	logoutUrl:"",
	lang:window.digitalData.page.category.primaryCategory || 'en'
};
(function(){
	$(function(){
		if($('#themesHeader').length>0){
			// 查看消息的次数标识
			var messageFirst= true,notificationFirst=true;
			
			// 登录配置
			var $inoutData = $('#themesHeader .loginout-data');
			var inoutData = {
				"loginUrl":$inoutData.attr('data-loginurl') || "",
				"clientId":$inoutData.attr('data-clientid') || "",
				"loginRedirectURL":$inoutData.attr('data-loginredirecturl') || "",
				"logoutRedirectURL":$inoutData.attr('data-logoutredirecturl') || ""
			}  
			var currPage = window.location.href;
			var redirectUri = inoutData.loginRedirectURL+"?cururl="+currPage;
			//登录传递语言参数
			var galleryLoginLang = galleryLangConfig[themesBaseData.lang]?galleryLangConfig[themesBaseData.lang].loginLang :"en-gb";
			var endLoginUrl= inoutData.loginUrl+"?response_type=code&client_id="+inoutData.clientId+"&redirect_uri="+encodeURIComponent(redirectUri)+"&"+encodeURIComponent("scope=https://www.huawei.com/auth/account/base.profile")+encodeURIComponent(" https://www.huawei.com/auth/account/country")+"&access_type=offline&lang="+galleryLoginLang+"&sitecode="+ honorConfig.siteCode+"&themeName=blue";
			$('#themesHeader .gallery-user').attr('href',endLoginUrl);
			themesBaseData.loginUrl = endLoginUrl;
				
			var endLogoutUrl = inoutData.logoutRedirectURL +"?cururl="+encodeURIComponent(window.location.href)+"&lang="+honorConfig.loginLang; 
			$('#themesHeader .logout').attr('href',endLogoutUrl);
			themesBaseData.logoutUrl = endLogoutUrl;
			//GA Code
			$(".gallery-header .site-setting a.gallery-user").click(function(){
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Top Function",
					"eventAction": honorConfig.pageType,
					"eventLabel": "login"
				})
			})
			
			var gaPublicData ={
				scroll25:false,
				scroll50:false,
				scroll75:false,
				scroll100:false
			};
			
			$(window).scroll(function() {
			    var scrollTop = $(document).scrollTop();
			    var percent = (scrollTop/utils.pageHeight())*100;
			    var endPercent = '';
			    if(percent>24 && percent <50 && !gaPublicData.scroll25){
			    	endPercent = 25;
			    	gaPublicData.scroll25  = true;
			    }
			    if(percent>49 && percent <75 && !gaPublicData.scroll50){
			    	endPercent = 50;
			    	gaPublicData.scroll50  = true;
			    }
			    if(percent>74 && percent <100 && !gaPublicData.scroll75){
			    	endPercent = 75;
			    	gaPublicData.scroll75  = true;
			    }
			    
			    var flag = utils.pageHeight()==utils.windowHeight()+scrollTop ;
			    if(flag && !gaPublicData.scroll100){
			    	endPercent = 100;
			    	gaPublicData.scroll100 = true;   
			    }
			    
			    if(endPercent){
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Scroll Depth",
						"eventAction": honorConfig.pageType,
						"eventLabel": endPercent+"%"
					})
			    }
			})
			
			$(".gallery-header .site-setting .site-lang li a").click(function(){
				var href=$(this).attr("href");
				var lang=href.split("/");
				var num=lang.length-2;
				
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Top Function",
					"eventAction": honorConfig.pageType,
					"eventLabel": "switch language+"+lang[num]
				})
			})
		
			$(".themes-header .site-topnav li a.nav-link").click(function(){
				var navName=$(this).children("span").text();
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Top Navigation",
					"eventAction": honorConfig.pageType,
					"eventLabel": "Nav L1+"+navName
				})
			})
			
			$(".themes-header .site-topnav .site-subnav li a.subnav-link").click(function(){
				var navName=$(this).text();
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Top Navigation",
					"eventAction": honorConfig.pageType,
					"eventLabel": "Nav L2+"+navName
				})
			})
			
			// 根据登录配置的API url 获取当前站点的 Honor Api Url
			if(inoutData.loginRedirectURL){
				themesBaseData.apiUrl = inoutData.loginRedirectURL.split('/abroad/')[0];
			}
			
			// 登录状态切换
			updateLoginStatus();
			
			// 导航随页面滚动悬浮效果
			var scrollTop = $(document).scrollTop();
	        if (scrollTop > 0) {
	            $('#themesHeader').addClass('fixed');
	        } 
			$(window).scroll(function() {
		        var scrollTop = $(document).scrollTop();
		        if (scrollTop > 0) {
		            $('#themesHeader').addClass('fixed');
		        } else {
		        	$('#themesHeader').removeClass('fixed');
		        }
		    })
		    
			// Click Upload Nav
			$('#themesHeader .join-now').click(function(){
				honorData.loginName = decodeURI(utils.getCookie('loginUid'));
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					// 已登录		 
					var uploadPage = $(this).data('url') || '';
					window.location.href= uploadPage;
				}else{
					// 未登录
					themesAlert.show();
				}
			})
			// 含有语言列表
			var hasLang = true;
			if($('#themesHeader .site-lang').has('li').length==0){
				hasLang = false;
				$('.themes-header .icon-ra').hide();
			}
			
			if(utils.isMobileEnd()){
				// 移动端
				$('#themesHeader .change-lang').click(function(e){
					// 语言列表					
					e.stopPropagation();
					if(hasLang){
						$('#themesHeader .site-topnav>li').removeClass('hover');
						$(this).stop().toggleClass('hover');
						
						$('#themesHeader .down-box').stop().slideUp();
						$(this).find('.site-lang').stop().slideToggle();
					}
				})
				if(utils.windowWidth()>768){
					// 大屏移动端
					$('body').click(function(){
						// 点击页面其他区域收缩下拉菜单
						$('#themesHeader .site-topnav>li,#themesHeader .change-lang').removeClass('hover');
						$('#themesHeader .down-box').stop().slideUp();
					})
					$('#themesHeader .gallery-logined .gallery-account').click(function(e){ 
						e.stopPropagation();
						$('#themesHeader .site-topnav>li,#themesHeader .change-lang').removeClass('hover');
						$('#themesHeader .down-box').stop().slideUp();
						$(this).find('.account-list').stop().slideToggle();
					})
					// 导航元素交互效果
					$('#themesHeader .site-topnav .nav-li').click(function(e){ 
						e.stopPropagation();
						$('#themesHeader .change-lang').removeClass('hover');
						$(this).toggleClass('hover').siblings('li').removeClass('hover');
						$('#themesHeader .down-box').stop().slideUp();
						$(this).find('.site-subnav').stop().slideToggle();
					})
					//消息
					$('#themesHeader .gallery-notice-box').stop().click(function(e){
						$('#themesHeader .site-topnav>li,#themesHeader .change-lang').removeClass('hover');
						$('#themesHeader .down-box').stop().slideUp();
						e.stopPropagation();
						$(this).find('.notice-box').stop().slideToggle();
					})
				}else{
					$('#themesHeader .gallery-menu').click(function(e){
						e.stopPropagation();
						$(this).toggleClass('gallery-over');
						$('.site-navbox').toggle();
						$('html,body').toggleClass('honor-noscroll');
						$('#themesHeader').toggleClass('mb-over');
						
						$('#themesHeader .site-topnav>li').removeClass('hover');
						$('#themesHeader .site-topnav .site-subnav').hide();
					})
					$('#themesHeader .gallery-logined .gallery-account').click(function(e){
						e.stopPropagation();
						$('html,body').toggleClass('honor-noscroll');
						$(this).toggleClass('gallery-over');
						$('#themesHeader').toggleClass('mb-over');
						$('#themesHeader .account-list-mb').toggle();
					})
					$('#themesHeader .site-topnav>li').click(function(){ 
						var that = $(this);
						utils.stopBubble();				
						if(!that.hasClass('unlogin')){
							// 非登录icon点击展示二级导航
							that.siblings().removeClass('hover');
							that.toggleClass('hover');
							
							var flag= that.hasClass('hover');
							$('.gallery-header .site-topnav .site-subnav').hide();
							if(flag){
								that.find('.site-subnav').stop().slideDown();
							}else{
								that.find('.site-subnav').stop().slideUp();
							}
						}
					})
				}
			}else{
				// PC端
				$('#themesHeader .site-topnav>li').hover(function(){ 
					$(this).toggleClass('hover');
					$(this).find('.site-subnav').stop().slideToggle();
				})
				
				$('#themesHeader .change-lang').hover(function(){
					if(hasLang){
						$(this).toggleClass('hover');
						$(this).find('.site-lang').stop().slideToggle();
					}
				})
				$('#themesHeader .gallery-logined .icon-user2').stop().mouseenter(function(e){
					e.stopPropagation();
					$(this).siblings('.account-list').stop().slideDown();
				})
				$('#themesHeader .gallery-logined .gallery-account').stop().mouseleave(function(e){
					e.stopPropagation();
					$(this).find('.account-list').stop().slideUp();
				}) 
				
				$('#themesHeader .gallery-notice-box').stop().mouseenter(function(e){
					e.stopPropagation();
					
					if(e.relatedTarget !=null){
						$(this).find('.notice-box').stop().slideDown();
					}
				})
				$('#themesHeader .gallery-notice-box').stop().mouseleave(function(e){
					if(e.relatedTarget != null){
						$(this).find('.notice-box').stop().slideUp();
					}
				})
			}
			
			// 切换消息tab
			$('#themesHeader .gallery-notice-box .notice-tab li').stop().click(function(e){
				e.stopPropagation();
				var name = $(this).attr('data-name');
				$(this).addClass('active');
				$(this).siblings().removeClass('active');
				
				//查询未读消息
				if(name=="gallery-notification" && notificationFirst){
					getMessageLists();
					notificationFirst=false;
				}else if(name=="gallery-message" && messageFirst){
					getMessageLists(name);
					messageFirst=false;
				}
				$('#themesHeader .gallery-notice-box .notice-content .tab-content').removeClass('active');
				$('#themesHeader .gallery-notice-box .notice-content .'+name).addClass('active');
			})
			
			//Themes Header 切换登录状态的状态
			function updateLoginStatus(){
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					//获取系统消息
					getMessageNum();
					getMessageLists();
					notificationFirst = false;
				}
				//Themes Header 更新icon的状态
				updateIconStatus();
			}
			// Themes Header 依据是否登录更新 icon状态
			function updateIconStatus(){
				honorData.loginName = decodeURI(utils.getCookie('loginUid'));
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					// 已登录		 
					$('#themesHeader .gallery-login').addClass('gallery-logined');
					$('#themesHeader .site-navbox .gallery-account').removeClass('unlogin').addClass('gallery-logined');
				}else{
					// 未登录		
					$('#themesHeader .gallery-login').removeClass('gallery-logined');
					$('#themesHeader .site-navbox .gallery-account').removeClass('gallery-logined').addClass('unlogin');
				}
			}
			// 查询系统消息数 
			function getMessageNum(){
			 	$.ajax({
			 	    url: themesBaseData.apiUrl+'/abroad/userCenter/isMessage',
				    type: 'GET',
				    dataType: 'jsonp',
				    success: function(info) { 
				    	if(info.code=="000000"){  
				    		var num = Number(info.allNum);
				    		if(num>0){ 
					    		if(num>99){
					    			num = '99+';
					    		}
					    		$('.gallery-header .gallery-logined .gallery-notice-box.gallery-pc').css('margin-right','2px');
					    		$('.gallery-notice-box .badge').css('visibility','visible');
					    		var numArr=info.pageList;
					    		for(var i=0;i<numArr.length;i++){
					    			if(numArr[i].messageType==1){
					    				// notification
					    				if(numArr[i].num>0){
		                            		$('.header .notice-box .notice-tab li.notification .icon-point').css('display','inline-block');
		                            	}else{
		                            		$('.header .notice-box .notice-tab li.notification .icon-point').hide();
		                            	}
					    			}
		                            if(numArr[i].messageType===2){
		                            	// message
		                            	if(numArr[i].num>0){
		                            		$('.header .notice-box .notice-tab li.message .icon-point').css('display','inline-block');
		                            	}else{
		                            		$('.header .notice-box .notice-tab li.message .icon-point').hide();
		                            	}
					    			}
					    		}
				    		}else{
				    			$('.honor-notice .badge').hide().text(num);
				    		}
				    		
			 	    	}else if(info.code=="100007"){
				    		//用户未登录
			 	    		updateIconStatus();
				    	}
			 	    },error:function(err){
			 	    	console.log(err);
			 	    }
			 	})
			}
			
			// 查询未读系统消息列表 
			function getMessageLists(type){
				// 默认系统通知消息
				type = type || 'gallery-notification';
				var messageType = '1';
				if(type=='gallery-message'){
					messageType = '2';
				}
			 	$.ajax({
			 	    url: themesBaseData.apiUrl+'/abroad/userCenter/getNotifications',
			 	    type: 'GET',
			 	    data:{
			 	    	"messageType":messageType,
			 	    	"pageIndex":"0",
			 	    	"lang":themesBaseData.lang,
			 	    	"pageSize":"5",
			 	    	"messageStatus":"1"
			 	    },
			 	    dataType: 'jsonp',
			 	    success: function(info) { 
			 	    	if(info.success){  
			 	    		var data =info.infoBean.pageList;
		 	    			var str='',unreadNum = 0;
		 	    			var pageUrl = $('.gallery-notice-box .btn-notice').attr('href') || '';
		 	    			if(pageUrl.indexOf("#&inbox")==-1){
				    			pageUrl=pageUrl+"?msgType="+messageType+"#&inbox";
				    		}else{
				    			//消息tab 切换 替换  msgType 的值
					    		if(pageUrl.length>0){
					    			var replaceStr="msgType="+messageType;
					    			if(messageType=='2'){
					    				pageUrl=pageUrl.replace("msgType=1",replaceStr);
					    			}else{
					    				pageUrl=pageUrl.replace("msgType=2",replaceStr);
					    			}
					    			
					    		}
				    		}	
		 	    			var isSelect=$(".gallery-header #select").val();
				    		if(isSelect=="true"){
				    			pageUrl="javascript:void(0);";
				    		}
				    		
				    		$(".gallery-header .gallery-notice-box .notice-box .btn-notice").attr("href",pageUrl);
		 	    			for(var i=0;i<data.length;i++){
		 	    				if(messageType=="1"){ 
		 	    					var functionType =data[i].functionType;
		 	    					if(functionType=='1' || functionType=='2' || functionType=='5'){
		    							var title=data[i].title;
		     							if(title.indexOf('{name}')!==-1){
		     								var userName='<b>'+data[i].senderUserName+'</b>';
		     								var isArabic = $("div").hasClass("__arabic__");
		     								if(isArabic){
		     									userName=data[i].senderUserName;
		     								}
		     								title=title.replace("{name}",userName);
		     								
		     							}
		    							str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+title+'</a></li>';
		    						}else{
		    							str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+data[i].title+'</a></li>';
		    						}
		 	    				}else{
		 	    					str+='<li data-id='+data[i].id+' data-serviceAddr='+data[i].serviceAddr+'><a href="'+pageUrl+'">'+data[i].title+'</a></li>';
		 	    				}
		    					unreadNum++;
		 	    			} 
		 	    			
		 	    			var $message=$('.gallery-notice-box .'+type); 
		 	    			if(unreadNum==0){
		 	    				$message.find('.no-content').show().next().hide();
		 	    			}else{
		 	    				$message.find('.no-content').hide().next().html(str).show();
		 	    				//点击右侧下拉菜单弹框
		 	    			    $(".gallery-header .notice-box .notice-content ul li").click(function(e){
		 	    			      	e.stopPropagation();
		 	    			      	isSelect=$(".gallery-header #select").val();
		 	    			      	if(isSelect=="true"){
		 	    			  		   showSelectCountryModal();
		 	    			  	    }
		 	    			    })
		 	    			} 
		 	    			
			 	    	} 
			 	    },error:function(err){
			 	    	console.log(err);
			 	    }
			 	})
			 }
		}
		
		//GA Code
		$(".gallery-header .site-logo").click(function(){
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Top Function",
				"eventAction": honorConfig.pageType,
				"eventLabel": "Honor logo"
			})
		})
		
	})
}());

/*
 *  Themes Public Alert
 *  showAlert：显示提示弹窗
 *  hideAlert：隐藏提示弹窗
 *  
 */ 

var themesAlert={
	show:function(type,content){
		type= type || 'login'; 
		if(type!='login'){  
			// 替换文案
			$('#themesAlert .alert-content').text(content);
			var btnOK= $('.imgupload-data').data('btnok');
			$('#themesAlert  .btn-confirm').text(btnOK);
		}
		$('html,body').addClass('overhidden');
		$('#themesAlert').attr('data-type',type).show();
	},
	hide:function(type){
		$('html,body').removeClass('overhidden');
		$('#themesAlert').hide();
	}
}; 

(function(){ 
	$(function(){ 
		if($('#themesAlert').length>0){
			// 关闭alert
			$('#themesAlert .font-Cross').click(function(){
				var type=$('#themesAlert').attr('data-type');
				themesAlert.hide(type);
			})
			
			$('#themesAlert .btn-confirm').click(function(){
				var type=$('#themesAlert').attr('data-type');
				if(type=="login"){
					//跳转登录
					window.location.href=themesBaseData.loginUrl;
				}else{
					//关闭
					themesAlert.hide(type);
				}
			})
		}
	}) 
}());
(function() {
  var ww = utils.windowWidth();
  var wh = utils.windowHeight();
  var isArabic = $("div").hasClass("__arabic__");
  var isHasHomebannerV2 = $("div").hasClass("homebanner-v2");
  //判断是移动端 替换 data-src 路径
  $(".homebanner .swiper-slide img").each(function(i, $this) {
    if (ww <= 768) {
      var src = $($this).attr("data-mb");
      $($this).attr("data-src", src);
    }
  })

  $('.homebanner .homebanner-logo').each(function() {
    var that = $(this);
    var src = that.data('src');
    that.attr('src', src);
    that.imagesLoaded().done(function() {
      // 图片加载完成 
      that.show();
    })
  })

  $('.homebanner .swiper-container').attr("class", "swiper-container");
  $('.homebanner .swiper-container').addClass('vertical');

  
  //判断轮播图 有几张图片
  var slideNum = $('.homebanner .swiper-slide').length;
  if (slideNum <= 1 && isHasHomebannerV2) {
    $(".homebanner-v2 .prev-box").hide();
    $(".homebanner-v2 .next-box").hide();
    $(".homebanner-v2 .swiperpage-box").css("background", "none");
    $(".homebanner-v2 .save-date-pc").css("bottom", "70px");
  }
  //判断是移动端 替换 data-src 路径
  $(".homebanner-v2 .swiper-slide img").each(function(i, el) {
	  var mbsrc = $(el).attr("data-mb");
	  var pcsrc = $(el).attr("data-pc");
    if (slideNum <= 1) {
    	$(el).attr("src", pcsrc);
	    if (ww <= 768 && mbsrc) {
	        $(el).attr("src", mbsrc);
	    }
    }else {
    	$(el).attr("data-src", pcsrc);
	    if (ww <= 768 && mbsrc) {
	        $(el).attr("data-src", mbsrc);
	    }
    }
  })
  if (slideNum > 1) {
    // 多张图片
    var bannerspeed = $(".homebanner").data("bannerspeed");
    bannerspeed = bannerspeed * 1000;
    var speedTime = bannerspeed > 1000 ? 1000 : bannerspeed;
    if (!isHasHomebannerV2) {
      var homebanner = new Swiper('.vertical', {
        autoHeight: true,
        pagination: {
          el: '.swiper-pagination',
          clickable: true,
        },
        navigation: {
          nextEl: '.homebanner .next-box',
          prevEl: '.homebanner .prev-box',
        },
        lazy: {
        	loadPrevNext: true,
        },
        loop: true,
        observer: true,
        observeParents: true,
        autoplay: {
          delay: bannerspeed,
          disableOnInteraction: false
        },
        on: {
          lazyImageReady: function(slideEl, imageEl) {
            $(slideEl).find('img.swiper-lazy').show();
          }
        },
        speed: speedTime
      });
    }
    else {
    	if(ww<=768){
    		 var headerH = $(".header").outerHeight();
    		 wh=wh+headerH;
    		 $(".homebanner-v2").css("height",wh).css("overflow","hidden");
    	}
      var bannerspeedv2 = $(".homebanner-v2").data("bannerspeedv2");
          bannerspeedv2 = bannerspeedv2 * 1000;
      var speedTime2 = bannerspeedv2 > 1000 ? 1000 : bannerspeedv2;
      var homebanner = new Swiper('.homebanner-v2 .vertical', {
        autoHeight: true,
        pagination: {
          el: '.swiper-pagination',
          clickable: true,
        },
        navigation: {
          nextEl: '.homebanner-v2 .next-box',
          prevEl: '.homebanner-v2 .prev-box',
        },
        effect:'fade',
        fadeEffect: {
            crossFade: true,
        },
        lazy: {
            loadPrevNext: true,
        },
        loop: true,
        observer: true,
        observeParents: true,
        autoplay: {
          delay: bannerspeedv2,
          disableOnInteraction: false
        },
        on: {
          lazyImageReady: function(slideEl, imageEl) {
        	  if(ww<=768){
        	    $(".homebanner-v2").css("height","auto").css("overflow","initial");
        	  }
        	  $(slideEl).find('img.swiper-lazy').show();
        	  
        	  // 轮播图最后一张图片加载完成，去掉loading效果
        	  if(slideNum == homebanner.activeIndex){
        		  $('.homebanner-v2').removeClass('honor-loading-v2');
        	  }
          },
          slideNextTransitionStart:function(){
        	  if(ww>768){
        		  var index=this.activeIndex;
             	 for(var i=1;i<index;i++ ){
             		 $('.homebanner-v2 .swiper-pagination-bullet:nth-child('+i+') .item-line').css("background","#fff").css("opacity","0.7");             		
             	 }
        	  }
          }
        },
        speed: speedTime2
      });
      //获取分页的宽度
      var pageW = $(".swiper-pagination-bullets").width() + 80;
      var arrLeftCalc = 'calc((100% - ' + pageW + 'px)/2)';
      $('.homebanner .prev-box').css("left", arrLeftCalc);
      $('.homebanner .next-box').css("right", arrLeftCalc);
      if (isArabic) {
        $('.homebanner-v2 .prev-box').css("right", arrLeftCalc).css("left", "auto").css("transform", "rotate(180deg)");
        $('.homebanner-v2 .next-box').css("left", arrLeftCalc).css("right", "auto").css("transform", "rotate(180deg)");
        if (ww > 768 && isArabic) {
          var $bullets = $('.homebanner-v2 .vertical .swiper-pagination-bullets');
          var bulletWidth = $bullets.outerWidth();
          var leftW = -(bulletWidth / 2);
          $bullets.css({"left":"50%","margin-left":leftW + "px"});
        }

      }
    }

    $('.homebanner .swiper-pagination').css('display','inline-block');
    if (!isHasHomebannerV2) {
      $('.homebanner .next-box,.homebanner .prev-box').show();
    }
    var itemHtml = '<span class="item-line"><span class="line-progress"></span></span>';
    for (var i = 0; i < slideNum; i++) {
      $(".vertical .swiper-pagination .swiper-pagination-bullet").eq(i).html(itemHtml);
    }
    // bullet 宽度设置    	
    var currPageWidth = utils.pageWidth();
    var $bullets = $('.homebanner .vertical .swiper-pagination-bullets');
    if (currPageWidth > 768) {
      var bulletWidth = $bullets.outerWidth();
      var leftW = -(bulletWidth / 2);
      $bullets.css({"left":"50%","margin-left":leftW + "px"});
    } else {
      if (slideNum < 4) {
        $bullets.css({
          'width': '60%',
          'left': '20%'
        })
      }
      var $bullet = $bullets.find(".swiper-pagination-bullet");
      var itemW = (1 - Number(slideNum - 1) * 0.05) / slideNum;
      var itemWPercent = utils.toPercent(itemW, '3')
      $bullet.css('width', itemWPercent)
	  $bullets.css({
          'width':'auto',
          'left':'auto'
       })
	    $(".homebanner-v2 .next-box, .homebanner-v2 .prev-box").css("display", "none");
	    $(".homebanner-v2 .vertical .swiper-pagination-bullet").css("width", "8px");
	    $(".homebanner .next-box, .homebanner .prev-box").css("display", "none");
	    $(".homebanner .vertical .swiper-pagination-bullet").css("width", "8px");
    }
  } else {
    //只有一张图片
    var $item = $('.homebanner .swiper-slide').find("img.swiper-lazy");
    var imgSrc = $item.data("src");
    if (ww <= 768 && $item.data("mb")) {
      imgSrc = $item.data("mb");
    }
    $item.css('transform', 'scale(1)').attr('src', imgSrc);
    $item.imagesLoaded().done(function() {
      // 加载完成 
      $item.show();
    })
  }
  
  // Learn More Button GA Code
  $('.homebanner-v2 .swiper-slide .btn-group a.learn-more').click(function(){
	  var buttonName = $(this).text() || '';
	  window.dataLayer.push({
		  "event": "uaEvent",
		  "eventCategory": "Banner",
		  "eventAction": "click",
		  "eventLabel": buttonName
	  })
  })
  // Save the date Button GA Code
  $('.homebanner-v2 .save-date-pc,.homebanner-v2 .swiper-slide .btn-group a.save-date-mb').click(function(){
	  var buttonName = $.trim($(this).text()) || '';
	  window.dataLayer.push({
		  "event": "uaEvent",
		  "eventCategory": "Banner",
		  "eventAction": "click",
		  "eventLabel": buttonName
	  })
  })
  
  
})();


(function() {

  //***********倒计时图片改成img start*********** /
  var countDownPcImg = $('.kv-img-data').attr('data-img-pc'); //pc
  var countDownMobileImg = $('.kv-img-data').attr('data-img-mobile');//mobile
  var ww = $(window).width();
  if (ww < 767) {
    $('img[name="countDownImg"]').attr('src', countDownMobileImg);

  }
  else {
    $('img[name="countDownImg"]').attr('src', countDownPcImg);
  }

  //***********倒计时图片改成img end*********** /
  //计算出结束时间的时区，并将所在地当前时间统一为结束时间的时区，以达到倒计时一致
  var countDownTime = $("[data-countdown-time]").attr("data-countdown-time");
  var offsetEndTime = $("[data-countdown-time]").attr("data-offset-time");
  
  var offsetEndHour = offsetEndTime ? offsetEndTime.substring(3, 6) * 3600000 : 0;
  var offsetEndMin = offsetEndTime ? offsetEndTime.substring(7, 9) * 60000 : 0;
  if (!countDownTime) {
    return;
  } else {
    countDownTime = countDownTime.replace(" ", "T");

  }
  var endTime = new Date(countDownTime).getTime();
  var nowTime = new Date().getTime();
  var localOffset = new Date().getTimezoneOffset() * 60000;
  //nowTime + localOffset得到标准时间， + offsetEndHour + offsetEndMin得到结束时间的时区
  nowTime = nowTime + localOffset + offsetEndHour + offsetEndMin;
  var timer = setInterval(show_time, 1000);
  function show_time() {
    nowTime = nowTime + 1000;
    var time_distance = endTime - nowTime;
    if (time_distance > 0) {
      var int_day = Math.floor(time_distance / 86400000)
      time_distance -= int_day * 86400000;
      var int_hour = Math.floor(time_distance / 3600000)
      time_distance -= int_hour * 3600000;
      var int_minute = Math.floor(time_distance / 60000)
      time_distance -= int_minute * 60000;
      var int_second = Math.floor(time_distance / 1000)
      if (int_day < 10)
        int_day = "0" + int_day;
      if (int_hour < 10)
        int_hour = "0" + int_hour;
      if (int_minute < 10)
        int_minute = "0" + int_minute;
      if (int_second < 10)
        int_second = "0" + int_second;
      $('.timer-box .days').text(int_day);
      $('.timer-box .hours').text(int_hour);
      $('.timer-box .minutes').text(int_minute);
      $('.timer-box .seconds').text(int_second);
    } else {
      clearInterval(timer);
    }
  }


})();
/**
 * Gallery Home Banner
 */
(function(){
	$(function(){
		if($('.gallery-home-banner').length>0){
			// 懒加载
			var $video = $('.gallery-home-banner .Vidage__video');
			if(galleryPublicData.windowW>768){
				$(".gallery-home-banner .mb-img").removeClass('swiper-lazy');
				
				var bgpcimg=$video.data('pcimg'); 
				var pcvideo = $video.data('pcvideo');
				$('.gallery-home-banner .Vidage__video').attr('poster',bgpcimg).attr('src',pcvideo);
				
			}else{
				$(".gallery-home-banner .pc-img").removeClass('swiper-lazy');

				var bgmbimg=$video.data('mbimg'); 
				var mbvideo = $video.data('mbvideo');
				
				$('.gallery-home-banner .Vidage__video').attr('poster',bgmbimg).attr('src',mbvideo);
			}
			
			// 是否隐藏Gallery数据
			var flag = $("#isHiddenGalleryData").val() || 'false';
			if(flag=='false'){
				//获取摄影栏目上线的国家和作品数
				getUserCountriesAndGalleryCount();
			}
			
			var item=$(".gallery-home-banner .gallery-data li").length;
			if(item==1){
				$(".gallery-home-banner .gallery-data li").css("border-right","0px");
			}
			
			var editStatus= $('.edit-status').val();
			var videoLength= $('.gallery-home-banner .swiper-container video').length;

			// 显示图片上传弹窗
			$('.gallery-home-banner .join-now').click(function() {
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					galleryAlert.showUpload();
				}else{
					galleryAlert.showAlert();
				}
			})
			
			var slideNum =$('.gallery-home-banner .swiper-slide:last-child').data('num');
			if(slideNum>1){
				var bannerspeed=$(".gallery-home-banner").data("bannerspeed");
				bannerspeed=bannerspeed * 1000; 
				var speedTime =bannerspeed>1000 ? 1000 : bannerspeed; 
				
				var galleryHomeBanner = new Swiper ('.gallery-home-banner .swiper-container', {
					loop: true, // 循环模式选项
					autoHeight: true,
					// 如果需要分页器
					pagination: {
						el: '.gallery-home-banner .swiper-pagination',
						clickable: true,
					},
					lazy:true,
					// 如果需要前进后退按钮
					navigation: {
						nextEl: '.gallery-home-banner .next-box',
						prevEl: '.gallery-home-banner .prev-box',
					},
					observer:true,
					observeParents:true,  
					autoplay:{
						delay:bannerspeed,
						disableOnInteraction: false
					},
					speed:speedTime,
					on:{
					    lazyImageReady: function(slideEl, imageEl){
					    	if(galleryPublicData.windowW>768){
								$(slideEl).find('.pc-img').show();
							}else{
								$(slideEl).find('.mb-img').show();
							}
					    }
					}
				}) 
				$('.gallery-home-banner .swiper-pagination .swiper-pagination-bullet').each(function(){
					$(this).append('<div class="line-progress"></div>');
				})
				
				// bullet 宽度设置    	
				var currPageWidth = utils.pageWidth();
				var $bullets = $('.gallery-home-banner .swiper-pagination-bullets');
				if(currPageWidth>768){ 
					var bulletWidth = $bullets.outerWidth();
					var lfwidth= (utils.pageWidth()-$bullets.outerWidth())/2;
					var leftW = -(bulletWidth/2);
					$bullets.css('margin-left',lfwidth)
				}else{ 
					if(slideNum < 4){
						$bullets.css({
							'width':'60%',
							'left':'20%'
						})
					}
					var $bullet = $bullets.find(".swiper-pagination-bullet");
					var itemW = (1- Number(slideNum-1) * 0.07)/slideNum; 
					var itemWPercent = utils.toPercent(itemW,'3')
					$bullet.css('width',itemWPercent)
				}
			}else{
				$('.gallery-home-banner .next-box,.gallery-home-banner .prev-box').hide();
				
				var $item = null;
				if(galleryPublicData.windowW>768){
					$item=$('.gallery-home-banner .swiper-slide img.pc-img.swiper-lazy');
				}else{
					$item=$('.gallery-home-banner .swiper-slide img.mb-img.swiper-lazy');
				}
				var imgSrc = $item.data('src');
				$item.css('transform','scale(1)').attr('src',imgSrc);
				$item.imagesLoaded().done(function(){
					// 加载完成 
					$item.show();
				})
			}
			// content 垂直居中
			$('.gallery-home-banner .swiper-slide .slide-content').each(function(){
				var thisH= $(this).height();
				var top =-Math.floor(thisH/2);
				$(this).css('margin-top',top);
			})
	    	
		}
	})
	//获取摄影栏目上线的国家和作品数
	function getUserCountriesAndGalleryCount(){
		// 只有gallery中才会调用
		if($('.gallery-header').length>0){
			$.ajax({
				url :  galleryPublicData.apiUrl+'/abroad/shootMatch/getUserCountriesAndGalleryCount',
				type : 'GET',
				async : false,
				dataType : 'json',
				success : function(info) { 
					if(info.success){
						var data = info.infoBean;
						var galleryCount = data.galleryCount;
						var galleryCountriesCount = data.galleryCountriesCount;
						$('.gallery-home-banner .gallery-total .gallery-num').text(galleryCount);
						$('.gallery-home-banner .gallery-country .gallery-num').text(galleryCountriesCount);
						$('.gallery-home-banner .gallery-data').show();
					}
				},
				error : function(err) {
					console.log(err);
				}
			})
		}
	}
}());
/*!
 *	Image Banner V2 By Bruce
 * 	imgbannerv2 - v1.0.0 (2019-07-29T16:30:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.kv-banner-component .homebanner-v2').length>0){
			$('.homebanner-v2 .btn-buy').click(function(e){
			    var pageWidth = utils.pageWidth();
		    	  if(pageWidth > 768) {
		    		  $('.width-container.new .cs-title .font-Cross').fadeIn(1000);
		    	  }
				$('.kv-banner-component .buy-box .countries').html("");
				$("body,html").addClass("honor-noscroll");
		    	if(utils.pageWidth() <= 768 && $(".new").length > 0) {
		    		$('.buy-box').animate({top:"0"},500);
		    	} else {
		    		$('.buy-box').fadeIn();
		    	}
		    	
		    	var that = $(this);

		    	//ga code start
		    	var productName = that.data('imgbannertitle') || '';
		    	window.dataLayer.push({"event": "buyNow","productName": productName,"pageType":honorConfig.pageType})
		    	//ga code end
		    	
		    	var adminpath = that.data('adminpath') || '';
				if(adminpath){
					$.ajax({
						 url : utils.getCurrPageUrl()+'/services/server/getBuynowListInfo/?productAdminPagePath='+adminpath,
					     type : 'GET',
					     processData: false,
					     dataType:'json', 
					     success: function(info) {
					    	 var data = info.detailMode;
					    	 var anData = info.showList;
					    	 if(!$.isEmptyObject(data)){
						    	$('.kv-banner-component .buy-box .selector-heading').text(data.buyNowDialogTitle);
						    	var str = '';
						    	var countryTotal = 0;
						    	if(data.countryBuynowMapping){
						    		// country list
						    		var countryList = data.countryBuynowMapping;
						    		countryTotal = countryList.length;
						    		for(var i=0;i<countryTotal;i++){
							    		str+='<div class="algerian country-common">';
							    			str+='<div class="countries-top">';
							    				str+='<div class="countries-lang">';
							    				var isCurrSiteLink = countryList[i].isCurrSiteLink;
						    					if(isCurrSiteLink=='yes'){
							    					str+='<a class="langs" flag="country" href="'+(countryList[i].targetLink ? countryList[i].targetLink : "#")+'" target="_blank">';
						    					}else{
						    						str+='<a class="langs externalLinks" flag="country" href="javascript:void(0)" url="'+(countryList[i].targetLink ? countryList[i].targetLink : "#")+'">';
						    					}
							    						str+='<div class="countries-title">';
							    							str+='<span class="country-img">';
							    								str+='<img class="lazy" data-original="'+countryList[i].countryFlag+'" src="" title="'+(countryList[i].imgTitle ? countryList[i].imgTitle :"") +'" alt="'+(countryList[i].imgAlt ? countryList[i].imgAlt : "")+'" />';
					    									str+='</span>';
				    										str+='<span class="country-name">'+countryList[i].country+'</span>';
		    											str+='</div>';
													str+='</a>';
												str+='</div>';
											str+='</div>';
										str+='</div>';
						    		  }
						    		  $(".countriesTwo").hide();
					    		 }
						    	 var mallTotal = 0;
						    	 if(data.mallBuynowMapping){
						    		 var pageWidth = utils.pageWidth();
						    		 if(pageWidth > 768) {
						          		 $(".selector-heading").show();
						    		 } else {
						    			 $(".selector-heading").hide();
						    		 }
					    		    $(".country-selector-popup").find(".content").show();
						    		// mall list
						    		var mallList = data.mallBuynowMapping;
						    		mallTotal = mallList.length;
						    		for(var i=0;i<mallTotal;i++){
							    		str+='<div class="algerian country-common">';
							    			str+='<div class="countries-top">';
							    				str+='<div class="countries-lang">';
							    					var isCurrSiteLink = mallList[i].isCurrSiteLink;
							    					if(isCurrSiteLink=='yes'){
							    						str+='<a class="langs '+(mallList[i].isCurrSiteLink)+'" flag="mall" href="'+(mallList[i].targetLink ? mallList[i].targetLink : "#")+'" target="_blank">';
							    					}else{
							    						str+='<a class="langs externalLinks" flag="mall" href="javascript:void(0)" url="'+(mallList[i].targetLink ? mallList[i].targetLink : "#")+'">';
							    					}
							    						str+='<div class="mall-title">';
							    							str+='<span class="mall-img">';
							    								str+='<img class="lazy" data-original="'+(mallList[i].logoPicture ? mallList[i].logoPicture :"") +'" title="'+(mallList[i].imgTitle ? mallList[i].imgTitle : "")+'" alt="'+(mallList[i].imgAlt ? mallList[i].imgAlt : "")+'" />';
					    									str+='</span>';
				    										str+='<span class="mall-name">'+(mallList[i].mallName ? mallList[i].mallName : "")+'</span>';
		    											str+='</div>';
													str+='</a>';
												str+='</div>';
											str+='</div>';
										str+='</div>';
						    		}
						    		$(".countriesTwo").hide();
						    	  }
					    		$('.kv-banner-component .buy-box .countries').empty().html(str);
					    		
					    		var $countryflag = $('.buy-box .country-img img');
						      	var $mallflag = $('.buy-box .mall-img img');
						      	$countryflag.css('background-color','transparent');
						      	$mallflag.css('background-color','transparent');

						    	// 图片懒加载
						    	var imgTotal = countryTotal + mallTotal;
						    	if(imgTotal<=2){
						    		$(".kv-banner-component .buy-box img.lazy").each(function(){
						    			var img= $(this).data('original');
						    			$(this).attr('src',img);
						    		})	
						    	}else{
						    		$(".kv-banner-component .buy-box img.lazy").lazyload({         
						    			effect : "fadeIn",
						    			placeholder:lazyload.placeholder,
						    			container: $(".kv-banner-component .buy-box .content")
						    		});
						    	}
						    	
						        // 链接后添加参数      
						    	$('.kv-banner-component .buy-box .countries-lang .langs').each(function() {
						    		var currClass = $(this).attr('class');
						    		if (currClass.indexOf('externalLinks') == -1) {
						    			// 本站链接    		  
						    			var url = $(this).attr('href');
						    			var endUrl;
						    			if (url) {
						    				if (url.indexOf('?') == -1) {
						    					//链接中没有?
						    					endUrl = url + "?fromCountry=" + LOGIN_COUNTRY_CODE;
						    				} else {
						    					//链接中有?
						    					endUrl = url + "&fromCountry=" + LOGIN_COUNTRY_CODE;
						    				}
						    			}
						    			$(this).attr('href', endUrl);

						    		} else {
						    			// 第三方链接
						    			var url = $(this).attr('url');
						    			var endUrl;
						    			if (url) {
						    				if (url.indexOf('?') == -1) {
						    					//链接中没有?
						    					endUrl = url + "?fromCountry=" + LOGIN_COUNTRY_CODE;
						    				} else {
						    					//链接中有?
						    					endUrl = url + "&fromCountry=" + LOGIN_COUNTRY_CODE;
						    				}
						    			}
						    			$(this).attr('url', endUrl);
						    		}
						    	})
						        $('.kv-banner-component .buy-box .externalLinks').click(function(){
									var $img =$('.redirect-notice .modal-title-img');
									var imgSrc= $img.data('src');
									$img.attr('src',imgSrc);
									$('.redirect-notice').show();  
									var externalUrl = $(this).attr('url');
									countTimeFC(externalUrl);
								})
								
								var productName = data.productName || '';
						        $('.kv-banner-component .buy-box .countries-lang .langs').click(function() {
									// GA统计      
									var urlType = $(this).attr('flag');
									if (urlType == 'country') {
										window.dataLayer.push({
											"event": "buyNowOnStoreSite",
											"productName": productName,
											"countryCode": LOGIN_COUNTRY_CODE
										})
									} else if (urlType == 'mall') {
										var platformName = $(this).find('.mall-name').text();
										window.dataLayer.push({
											"event": "buyNowOn3rdPlatform",
											"productName": productName,
											"platformName": platformName
										})
									}
								})
						    } else if(!$.isEmptyObject(anData)){
						    	$(".country-selector-popup .content").hide();
						    	$(".countriesTwo").show();
						    	$(".selector-heading").show();
						    	$('.kv-banner-component .buy-box .selector-heading').text(info.buyNowDialogTitle);
					    		var areaModelData = info.showList;
					      		var areaHtml;
					      		var areaHtmlArray = [];
					      		for(var i = 0; i < areaModelData.length; i++) {
					      			var liHtml;
					      			var liHtmlArray = [];
					      			for(var k = 0; k < areaModelData[i]["countrys"].length; k++) {
					      				var isMallSite = areaModelData[i]["countrys"][k]["isMallSite"]=='true';
					      				var mallHtml;
		                            	if(isMallSite){
		                            		mallHtml ='<span class="hicon-cart"></span>';
		                            	} else {
		                            		mallHtml = "";
		                            	}
					      				liHtmlArray[liHtmlArray.length] = '<li>' +
																		'<div class="link-bg">' +
											                            '<a href="' + areaModelData[i]["countrys"][k]["targetLink"] + '" class="site-link"><span>' + areaModelData[i]["countrys"][k]["country"] + '</span>' +
											                            mallHtml +
											                            '</a>' +
				                        								'</div>' +
				                										'</li>';
					      			}
					      			liHtml = liHtmlArray.join("");
					      			areaHtmlArray[areaHtmlArray.length] = '<div class="countyr-item">' +
				        			                                      '<div class="country-selector-v2-left">' +
				    				                                      '<span class="region">' + areaModelData[i]["area"] + '</span>' +
				    				                                      '<div class="app-plus-icon">' +
								                                      	  '<span></span>' +
											                              '<span></span>' +
										                                  '</div>' +
				    			                                          '</div>' +
				    			                                          '<div class="country-selector-v2-right">' +
				    				                                      '<ul class="country-cont">' +
				    				                                      liHtml +
				    				                                      '</ul>' +
				    			                                          '</div>' +
				    		                                              '</div>';
					      		}
					      		areaHtml = '<div class="country-selector-v2-content">' +
					      		           areaHtmlArray.join("") +
				            	           '</div>';
					      		$(".countriesTwo").html(areaHtml);
					      		
					      		var $countryflag = $('.buy-box .country-img img');
						      	$countryflag.css('background-color','transparent');
					      		
						      	var pageWidth = utils.pageWidth();
					      		if(pageWidth > 768) {
					      			$(".country-selector-popup").find(".countyr-item:first").trigger("click");
					      			var ch;
					    			if(utils.windowHeight() <= 768){
					    				ch=utils.windowHeight()-300;
					    			}else{
					    				ch=utils.windowHeight()-400;
					    			}
					    			
					    			$(".country-selector-v2-right").css("height",ch);
					    			$(".countyr-item").eq(0).children(".country-selector-v2-right").show();
					      		} else if(pageWidth <= 768) {
				          		    $(".cs-title .description-black").show();
				          		    $(".cs-title").css("padding-top","40px");
				          		    $(".country-selector-popup").find(".content").hide();
					      		}
					      		
					      	//点击区域切换
					            $(".width-container.new").off("click").on("click", ".countyr-item", function(e){
					         	  var pageWidth = utils.pageWidth();
					          	  if(pageWidth > 768) {
					          		 $(this).addClass("on").find(".country-selector-v2-right").show();
					          		 $(this).siblings(".countyr-item").removeClass("on").find(".country-selector-v2-right").hide();
					          	  } else {
					          		 var targetClassName = e.target.className;
					          		 if(targetClassName === "country-selector-v2-left" || targetClassName === "region" || targetClassName === "app-plus-icon clicked" || targetClassName === "app-plus-icon") {
					          			$(this).addClass("on").find(".country-selector-v2-right").stop().slideToggle();
						          		$(this).find(".app-plus-icon").toggleClass("clicked");
						          		$(this).siblings(".countyr-item").removeClass("on").find(".country-selector-v2-right").slideUp();
						          		$(this).siblings(".countyr-item").find(".app-plus-icon").removeClass("clicked");
					          		 }
					          	  }
					            });
						    }
					     }
					})
				}
			})
			
		}
	})
}());
/*!
 *	Find A Store Component By Bruce
 * 	findAStore - v1.0.0 (2019-08-02T16:28:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
	
(function(){
	$(function(){
		if($('.find-a-store').length>0){
			var pageW = utils.pageWidth();
			
			// Current city code
			var areaCode = '';
			
			var chosenCountry = honorConfig.countryCode;
			if(chosenCountry=='GLOBAL'){
				// Global Site
				getCountry(chosenCountry);
				$('.find-a-store .choose-position>li.country').css('display','block');
			}else{
				// Other Site
				getProvince(chosenCountry);
			}
			
			var $bannerImg = $('.find-a-store .banner-img');
			if(pageW>768){
				var img = $bannerImg.data('pc') || '';
				$bannerImg.attr('src',img);
			}else{
				var img = $bannerImg.data('mb') || '';
				$bannerImg.attr('src',img);
			}
			var imgLoad = imagesLoaded($bannerImg);
			imgLoad.on('done', function(instance) {
				// 加载完成 
				$bannerImg.show();
			})
			
			// choose province
			var isMobile = endBrowser.versions.mobile || endBrowser.versions.android || endBrowser.versions.ios;
			if(isMobile){
				// Mobile
				$('.find-a-store .choose-position .position-type').click(function(e){
					utils.stopBubble(e);
					
					var flag = $(this).hasClass('nodata');
					var isClicked = $(this).attr('data-clicked') == 'true' ? true : false;
					if(!flag){
						if(!isClicked){
							$('.find-a-store .icon-down').removeClass('flipy');
							$('.find-a-store .choose-lists').stop().hide();
							
							$(this).attr('data-clicked','true');
							$(this).find('.icon-down').addClass('flipy');
							$(this).find('.choose-lists').stop().slideDown();	
						}else{
							$(this).attr('data-clicked','false');
							$(this).find('.icon-down').removeClass('flipy');
							$(this).find('.choose-lists').stop().slideUp();
						}	
					}
					
				})
				// 点击下拉框外的区域收缩下拉框
				$('html,body').click(function(){
					$('.find-a-store .choose-position .position-type').attr('data-clicked','false');
					$('.find-a-store .icon-down').removeClass('flipy');
					$('.find-a-store .choose-lists').stop().hide();
				})
				
			}else{
				// PC
				$('.find-a-store .choose-position .position-type').hover(function(){
					var flag = $(this).hasClass('nodata');
					if(!flag){
						$(this).find('.icon-down').addClass('flipy');
						$(this).find('.choose-lists').stop().slideDown();
					}
				},function(){
					var flag = $(this).hasClass('nodata');
					if(!flag){
						$(this).find('.icon-down').removeClass('flipy');
						$(this).find('.choose-lists').stop().slideUp();
					}
				})
			}
			// Show tips
			$('.find-a-store .choose-position .position-type').click(function(){
				var flag = $(this).hasClass('nodata');
				var type = $(this).data('type');
				if(flag){
					var errorMsg ='';
					if(type=='province'){
						errorMsg = $('.find-a-store .banner-box').data('provinceerrormsg');
					}else if(type=='city'){
						errorMsg = $('.find-a-store .banner-box').data('cityerrormsg');
					}else{
						return;
					}
					alert(errorMsg);
				}
			})
			
		
			// Choose position
			$('.find-a-store .choose-lists ul').on('click','li',function(){
				var name = $.trim($(this).text());
				var $chooseList = $(this).parent().parent();
				$chooseList.slideUp();
				$chooseList.parent().find('.li-name').text(name);
				$chooseList.parent().find('.icon-down').removeClass('flipy');
			})
			
			// Mobile Submit Button Click
			$('.find-a-store .btn-submit').click(function(){
				getStores(areaCode);
			})
			
			// Get Country For Global
			function getCountry(){
				$.ajax({
				     url : honorSupport.apiBaseUrl+'/ccpc/queryRegionList/1000',
				     type : 'GET',
				     dataType:'jsonp',
        			 jsonp: 'jsonp',
				     data : {
				    	 lang : honorConfig.lang,
				    	 scopeGrade : 'country',
				    	 curpage : '1',
				    	 pagesize : '100'
				     },
				     success: function(info) {
				    	 if(info.responseCode=='200' && !$.isEmptyObject(info.responseData)){
			    			 var data = info.responseData.list;
			    			 if(data.length>0){
			    				 var listr ='';
			    				 for(var i=0;i<data.length;i++){
			    					 listr+='<li data-code="'+data[i].alpha_2_code+'">'+data[i].multi_lang_name+'</li>';
			    				 }
			    				 $('.find-a-store .country .choose-lists ul').empty().html(listr);
			    				 $('.find-a-store .country').removeClass('nodata');
			    				 
			    				 // choose country
			    				 $('.find-a-store .country .choose-lists ul li').click(function(){
			    					 $(this).addClass('active').siblings().removeClass('active');
			    					 
			    					 $('.find-a-store .choose-lists').css('height','auto');
			    					 $('.find-a-store .province,.find-a-store .city').addClass('nodata');
			    					 
			    					 // change province and city tip
									 var provinceTip = $('.find-a-store .banner-box').data('provincetip');
									 $('.find-a-store .province .li-name').text(provinceTip);
									 var cityTip = $('.find-a-store .banner-box').data('citytip');
									 $('.find-a-store .city .li-name').text(cityTip);
			    					 
			    					 var code = $(this).data('code');
			    					 chosenCountry = code;
			    					 $('.find-a-store .province .choose-lists ul,.find-a-store .city .choose-lists ul').empty();
			    					 getProvince(code);
			    				 })
			    			 }
			    			 
				    	 }
				     }
			    });
			}
			
			// Get Province
			function getProvince(code){
				$.ajax({
					url : honorSupport.apiBaseUrl+'/ccpc/queryRegionList/1000',
					type : 'GET',
					dataType:'jsonp',
					jsonp: 'jsonp',
					data : {
						lang: honorConfig.lang,
						parent_alpha_2_code: code,
						scopeGrade: 'province',
						curpage: '1',
						pagesize: '100'
					},
					success: function(info) {
						if(info.responseCode=='200' && !$.isEmptyObject(info.responseData)){
							var data = info.responseData.list;
							if(data.length>0){
								var listr ='';
								for(var i=0;i<data.length;i++){
									listr+='<li data-code="'+data[i].alpha_2_code+'">'+data[i].multi_lang_name+'</li>';
								}
								$('.find-a-store .province').removeClass('nodata');
								$('.find-a-store .province .choose-lists ul').empty().html(listr);
								
								// choose province
								$('.find-a-store .province .choose-lists ul li').click(function(){
									$(this).addClass('active').siblings().removeClass('active');
									$('.find-a-store .choose-lists').css('height','auto');
			    					$('.find-a-store .city').addClass('nodata');
									// change city tip
									var cityTip = $('.find-a-store .banner-box').data('citytip');
									$('.find-a-store .choose-position>li.city .chosen-one .li-name').text(cityTip);

									var code = $(this).data('code');
									$('.find-a-store .city .choose-lists ul').empty();
									getCity(code);
								})
							}
				    	 }
					}
				});
			}
			
			// Get City
			function getCity(code){
				$.ajax({
					url : honorSupport.apiBaseUrl+'/ccpc/queryRegionList/1000',
					type : 'GET',
					dataType:'jsonp',
					jsonp: 'jsonp',
					data : {
						lang: 'en',
						parent_alpha_2_code: code,
						scopeGrade: 'city',
						curpage: '1',
						pagesize: '100'
					},
					success: function(info) {
						if(info.responseCode=='200' && !$.isEmptyObject(info.responseData)){
							var data = info.responseData.list;
							if(data.length>0){
								var listr ='';
								for(var i=0;i<data.length;i++){
									var name= data[i].multi_lang_name;
			    					if(honorConfig.siteCode=='CN'){
			    						name = data[i].alias_short_name_cn;
			    					}
			    					listr+='<li data-code="'+data[i].name+'">'+name+'</li>';
								}
								$('.find-a-store .city').removeClass('nodata');
								$('.find-a-store .city .choose-lists ul').empty().html(listr);
								
								// choose city
								$('.find-a-store .city .choose-lists ul li').click(function(){
									$(this).addClass('active').siblings().removeClass('active');
									areaCode = $(this).data('code');
									
									if(pageW>768){
										getStores(areaCode);
									}
								})
							}
				    	 }
					}
				});
			}
			
			var getStoresAPI = $('.find-a-store .banner-box').data('api') || 'https://consumer-api-sg.huawei.com/cuepf/publicservices/service/store/query';
			// Get Stores
			function getStores(areaCode){
				$.ajax({
					url : getStoresAPI,
					type : 'GET',
					dataType:'jsonp',
					jsonp:'jsonp',
					data : {
						country_code: chosenCountry,
						areaCode: areaCode,
						brand: '荣耀',
						pageno: '1',
						pagesize: '199'
					},
					beforeSend: function () {
						$('html,body').addClass('honor-noscroll');
				        $(".find-a-store .loading").show();
				    },
					success: function(data) {
						var info = new Array();
						// 门店名称/经纬度信息/地址 必填
						$.each(data, function(key, value) {
							if(honorConfig.siteCode=='MY'){
								// 马来站点  过滤掉 没有维护门店名称/经纬度信息/地址/电话号码/营业时间的门店
								if(value.store_name && value.latitude && value.longitude && value.store_addr && value.fixed_line_phone_number && value.workinghour){
									info.push(value);
								}
							}else{
								// 非马来站点 过滤掉 没有维护门店名称/经纬度信息/地址的门店
								if(value.store_name && value.latitude && value.longitude && value.store_addr){
									info.push(value);
								}
							}
						});
						
						var str = '';
						if(info && info.length>0){
							for(var i=0;i<info.length;i++){
								str+='<li class="store-info" data-storecode="'+info[i].store_code+'" data-level="'+info[i].regional_image_level+'" data-latitude="'+info[i].latitude+'" data-longitude="'+info[i].longitude+'">';
									str+='<div class="num-name">';
										str+='<span class="item-num">'+(i+1)+'</span>';
										str+='<div class="item-name item-content">'+info[i].store_name+'</div>';
									str+='</div>';
									str+='<div class="location">';
										str+='<span class="font-location item-icon"></span>';
										str+='<div class="item-content item-addr">'+info[i].store_addr+'</div>';
									str+='</div>';
									var phone = $.trim(info[i].fixed_line_phone_number);
									if(phone){
										str+='<div class="phone">';
											str+='<span class="font-Phone item-icon"></span>';
											if(pageW>768){
												str+='<div class="item-content">'+phone+'</div>';
											}else{
												str+='<a href="tel:'+phone+'" class="item-content">'+phone+'</a>';
											}
										str+='</div>';
									}
									var workinghour = info[i].workinghour;
									if(workinghour){
										str+='<div class="time">';
											str+='<span class="fa fa-clock-o item-icon"></span>';
											str+='<div class="item-content item-time">'+workinghour+'</div>';
										str+='</div>';
									}
								str+='</li>';
							}
							$('.find-a-store .store-lists .nodata').hide();
							$('.find-a-store .store-map').addClass('show');
							$('.find-a-store .store-lists ul').show().empty().html(str);
							
							if(pageW>768){
								// Rendering Stores Maker
								deleteMarkers();
								$('.find-a-store .store-lists ul li').each(function(i){
									// Get current store content
									var contentStr = getStoreInfoContent($(this));
									
									var lat = $(this).data('latitude');
									var long = $(this).data('longitude');
									var latLng = new google.maps.LatLng(lat,long);
									if(i==0){
										honorStoreMap.setCenter(latLng);
									}
									var label = ""+(i+1);
									addMarker(latLng,label,contentStr);
								})
								
								// Location Current Store
								$('.find-a-store .store-lists ul li').click(function(){
									$(this).addClass('active').siblings().removeClass('active');
									
									var lat = $(this).data('latitude');
									var long = $(this).data('longitude');
									var latLng = new google.maps.LatLng(lat,long);
									honorStoreMap.setCenter(latLng);
									honorStoreMap.setZoom(15);
									
									// Get current store content
									var contentStr = getStoreInfoContent($(this));
									var label = $(this).find('.item-num').text();
									addMarker(latLng,label,contentStr,true);
									 
								})
							}else{
								if(info.length<=3){
									$('.find-a-store .store-lists ul').css('max-height','none')
								}
								
								// Go to this Store
								$('.find-a-store .location .item-addr').click(function(){
									var obj = $(this).parent().parent();
									var lat = obj.data('latitude');
									var lng = obj.data('longitude');
									var destinationVal = lat+','+lng;
									var url = 'https://www.google.com/maps/dir/?api=1&origin=&destination='+encodeURIComponent(destinationVal);
									window.location.href= url;
								})	
								
							}
							
						}else{
							deleteMarkers();
							$('.find-a-store .store-map').addClass('show');
							$('.find-a-store .store-lists ul').hide();
							$('.find-a-store .store-lists .nodata').show();
						}
					},
					complete: function () {
						$('html,body').removeClass('honor-noscroll');
				        $(".find-a-store .loading").hide();
				    }
				});
			}
			
			// Get Current Store Google Info Window 
			function getStoreInfoContent(obj){
				var lat= obj.data('latitude') || '0';
				var lng= obj.data('longitude') || '0';
				var fromTxt = $('.find-a-store .store-map').data('from') || 'FROM';
				var goTxt = $('.find-a-store .store-map').data('btngo') || 'Go';

				var contentStr = '<div class="store-info">';
					contentStr += obj.html();
					contentStr += '<div class="go-there">';
							contentStr 	+= '<input class="go-inp" placeholder="'+fromTxt+'" />';
							contentStr 	+= '<button class="btn-go" type="button" onclick="gothere($(this));" data-lat="'+lat+'" data-lng="'+lng+'">'+goTxt+'</button>';
					contentStr +='</div>';
				contentStr += '</div>';
				
				return contentStr;
			}

		}
	})
}());
/*!
 *	零售门店 Google Map By Bruce
 * 	2019-08-07 15:29:30+0800
 * 	Copyright 2019-2020 hihonor.com
 */

var honorStoreMap = null;
var prevInfowindow = false; 
var storeMakers = [];

// Load Google Maps JavaScript API V3
function loadGgoogleMap() {
	var s = document.createElement('script');
	s.type = 'text/javascript';
	s.async = true;
	s.src = "//maps.googleapis.com/maps/api/js?key=AIzaSyBTDXLsgnTZ86vA2Ryu0bJ3ATp6Ya8jEFw&language="+ honorConfig.lang +"&libraries=places&callback=initStoreMap";
	var x = document.getElementsByTagName('script')[0];
	x.parentNode.insertBefore(s, x);
}

/* Adds a marker to the map and push to the array.
 * @param	location: 当前门店经纬度
 * @param	label:标记上问label文案
 * @param	contentStr: InfoWindow面板的Html内容
 * @param	showInfo：是否显示InfoWindow面板
 */
function addMarker(location,label,contentStr,showInfo) {
	label = label || '';
	var icon = {
		url:'/etc/designs/honor-site/assets/icon-location.png',
		size: new google.maps.Size(36, 55),
        origin: new google.maps.Point(0, -8),
        anchor: new google.maps.Point(0, 55)
	}
	// 针对阿语样式调整 icon位置
	if($('body>div').hasClass('__arabic__')){
		icon.size= new google.maps.Size(44, 55);
        icon.origin= new google.maps.Point(-8, -8);
	}
	var label ={
		text: label, 
		color: '#fff',
		fontSize:'16px',
		fontWeight:'bold'
	}
	var marker = new google.maps.Marker({
		position: location,
		map: honorStoreMap,
		icon:icon,
		label:label
	});
	var maxWidth = 480;
	var pageW = utils.pageWidth();
	if(pageW<=1280 && pageW>768){
		maxWidth = 420;
	}
	var infowindow = new google.maps.InfoWindow({
	    content: contentStr,
	    maxWidth: maxWidth,
	    pixelOffset: new google.maps.Size(0,-30)
	});
	
	if(showInfo){
		if(prevInfowindow) {
			prevInfowindow.close();
	    }

		prevInfowindow = infowindow;
        infowindow.open(honorStoreMap, marker);
	}
	marker.addListener('click', function() {
		if(prevInfowindow) {
			prevInfowindow.close();
	    }

		prevInfowindow = infowindow;
        infowindow.open(honorStoreMap, marker);
	});
	storeMakers.push(marker);
}

//Sets the map on all markers in the array.
function setMapOnAll(map) {
  for (var i = 0; i < storeMakers.length; i++) {
	  storeMakers[i].setMap(map);
  }
}

// Deletes all markers in the array by removing references to them.
function deleteMarkers() {
	setMapOnAll(null);
	storeMakers = [];
}

// Click Go button to navigation 
function gothere(obj){
	var lat = obj.data('lat');
	var lng = obj.data('lng');
	var originVal = obj.siblings('.go-inp').val().substring(0,50) || '';
	var destinationVal = lat+','+lng;
	var url = 'https://www.google.com/maps/dir/?api=1&origin='+ encodeURIComponent(originVal)+'&destination='+encodeURIComponent(destinationVal);
	window.open(url,'_blank');
}

(function(){
	$(function(){
		if($('.find-a-store').length>0){
			var pageW = utils.pageWidth();
			if(pageW>768){
				
				loadGgoogleMap();
				
				var defaultCity= $('.find-a-store #storeMap').data('default') || 'beijing';
				
				window.initStoreMap = function () {
					honorGeocoder = new google.maps.Geocoder();
					honorGeocoder.geocode({'address': defaultCity,'region':honorConfig.countryCode},function(results, status) {
						if(status == google.maps.GeocoderStatus.OK){
							// Set Default City
							var mapOptions={
								zoom: 10,
								center: results[0].geometry.location
							}
							honorStoreMap = new google.maps.Map(document.getElementById('storeMap'), mapOptions);
						}
						
					})
					
				}
			}
			
		}
	})
}());
$(function() {
	if($(".news-list-component-cn").length > 0) {
		function addData() {
			var data = JSON.parse($(".dataJson").text());
			var viewMoreText = $(".readMore").text();
			var dataArray = [];
			var dataHtml;
			var showImg;
			var windowWidth = $(window).width();
			var initDate;
			var title;
			var desc;
			var url;
			var originDate;
			var isNewHtml;
			var newText;
			if(windowWidth <= 768) {
				showImg = 'imgMB';
			} else {
				showImg = 'img';
			}
			if(!viewMoreText) {
				viewMoreText = "";
			}
			for(var i = 0; i < data.length; ++i) {
				if(data[i].isNew) {
					if(data[i].newText) {
						newText = data[i].newText;
					} else {
						newText = "NEW";
					}
					
					isNewHtml = '<span class="campaign__new">' + newText + '</span>';
				} else {
					isNewHtml = "";
				}
				
				if(data[i].hideDate) {
					initDate = "";
				} else {
					if(data[i].initDate) {
						originDate = data[i].initDate.split("-");
						var newArray = [originDate[0], originDate[1]];
						initDate = newArray.join("/");
					} else {
						initDate = "1900/01";
					}
				}
				
				if(data[i].title) {
					title = data[i].title;
				} else {
					title = "";
				}
				
				if(data[i].desc) {
					desc = data[i].desc;
				} else {
					desc = "";
				}
				
				if(data[i].url) {
					url = data[i].url;
				} else {
					url = "javascript:void(0);";
				}
				
				var wrapHtml;
				var cardVideo = data[i].video;
				var campaignHasVideo;
				if(cardVideo) {
					wrapHtml = '<div class="campaign__video-wrap">' +
								'<a href="' + url + '"><div class="campaign__image" style="background-image: url(' + data[i][showImg] + ')"></div></a>' +
								'<span class="campaign__video-button hicon-play"></span>' +
								'</div>';
					campaignHasVideo = ' campaign__box-link--has-video';
				} else {
					wrapHtml = '<a href="' + url + '"><div class="campaign__image" style="background-image: url(' + data[i][showImg] + ')"></div></a>';
					campaignHasVideo = '';
				}
				dataHtml = '<div class="col-md-12 col-lg-6 campaign__column gradient-shadow">' +
							'<a class="campaign__box-link' + campaignHasVideo + '" href="' + url + '"><span class="sr-only">' + viewMoreText + '</span></a>' +
							wrapHtml +
							'<div class="campaign__box">' +
							'<div class="campaign__content">' +
							'<span class="campaign__date">' + initDate +
							isNewHtml +
							'</span>' +
							'<h2 class="campaign__title campaign__title--margin">' + title + '</h2>' +
							'<p class="campaign__text">' + desc + '</p>' +
							'<div class="campaign__link-wrap">' +
							'<a class="campaign__link campaign__link--plus ie__link" href="' + url + '">' + viewMoreText + '</a>' +
							'</div>' +
							'</div>' +
							'</div>' +
							'<div class="gradient-shadow__hover"></div>' +
							'</div>';
				dataArray[dataArray.length] = dataHtml;
			}
			
			$("#dataAdd").html(dataArray.join(""));
		}
		
		addData();
		
		var c03PcCampaignListSection = {
			$selector: $('.c03-pc-campaign-list-section'),
			$window: $(window),
			$box: $('.campaign__box'),

			init: function() {
				if(this.$selector.length) {
					this.$spinner = this.$selector.find('.c03-spinner');
					this.$videoTrigger = this.$selector.find('.campaign__box-link--has-video');
					this.$videos = this.$videoTrigger.find('.campaign__video');

					this.isLoading = false;

					var ua = window.navigator.userAgent;
					var isIE = /MSIE|Trident/.test(ua);
					if ( isIE ) {
						$('body').addClass('ie');
					}

					if (this.$box) this.$box.hover(this.openBoxContent, this.closeBoxContent);
					if (this.$selector.find('.swiper-container').length && innerWidth < 992) this.initSwiper();

					this.$articles = this.$selector.find('.campaign__column');
					this.$articles.slice(0, -4).addClass('campaign__column--is-loaded');
					if($(".editModal").length == 0) {
						this.$articles.slice(-4).addClass('campaign__column--is-hidden').hide();
					}
					this.$window.on('scroll', this.loadMoreItem.bind(this));
				}
			},
			isInWindow:function(){
			    // 是否进入视窗区域
			    var windowH = utils.windowHeight();
			    var scrollTop = $(document).scrollTop();
			    var listsTop = this.$selector.position().top;
	
			    var flag = (windowH+scrollTop) > listsTop;
			    return flag;
		    },
		    originCheck: function(){
		    	var flag = this.isInWindow();
		        if(flag){
		        	this.loadMoreItem();
		        }
		    },
			// This function is for DEMO only
			loadMoreItem: function() {
				if ($('.campaign__column--is-loaded').length === this.$articles.length) return null;

				var SELECTOR_BOTTOM = this.$selector.offset().top + this.$selector.outerHeight();
				var LOADMORE_ITEMS_OFFSET = window.innerHeight + window.innerHeight * 0.3; // 30%
				if(this.$window.scrollTop() >= SELECTOR_BOTTOM - LOADMORE_ITEMS_OFFSET) {
					if (this.isLoading) return null;
					this.isLoading = true;

					var _self = this;
					var $hiddenArticles = $('.campaign__column--is-hidden');
					this.$spinner.fadeIn();

					// Mock data fatching
					setTimeout(function() {
						_self.$spinner.fadeOut();
						$hiddenArticles.slice(0, 2).removeClass('campaign__column--is-hidden').addClass('campaign__column--is-loaded').fadeIn();
						_self.isLoading = false;
					}, 1000);
				}
			},

			openBoxContent: function() {
				var box = event.currentTarget;
				var height = box.scrollHeight;
				
				box.style.maxHeight = height + 15 + 'px';
				var windowWidth = $(window).width();
				if(windowWidth <= 768) {
					var campaignText = box.getElementsByClassName("campaign__text");
					campaignText[0].style.height = "auto";
				}
			},
			
			closeBoxContent: function() {
				var box = event.currentTarget;
				
				box.style.maxHeight = '168px';
				var windowWidth = $(window).width();
				if(windowWidth <= 768) {
					setTimeout(function() {
						var campaignText = box.getElementsByClassName("campaign__text");
						campaignText[0].style.height = "20px";
					},100);
				}
			},

			initSwiper: function() {
				var mySwiper = new Swiper('.c03-pc-campaign-list-section .swiper-container', {
					spaceBetween: 0,
					speed: 800,
					loop: false,
					pagination: {
						el: '.c03-pc-campaign-list-section .swiper-pagination',
						type: 'bullets',
						clickable: true,
					},
				});
			}
		};
		
		c03PcCampaignListSection.init();
		c03PcCampaignListSection.originCheck();
	}
});
$(function() {
	if($(".kv-banner-component-cn").length > 0) {
		var c01PcHero = {
				$selector: $('.c01-pc-hero'),
				$slide: $('.swiper-slide'),

				init: function() {
					if(this.$selector.length) {
						if($('.swiper-slide').length > 1) {
							this.changeImages();
							this.bannerSlider();
						} else {
							var w = window.innerWidth ? window.innerWidth : $(window).width();
							var desktopImage =  $('.swiper-slide').find(".home-banner__slide").data('desktop');
							var mobileImage = $('.swiper-slide').find(".home-banner__slide").data('mobile');
							if (w > 768) {
								$('.swiper-slide').find(".home-banner__slide").attr('src', desktopImage);
							} else {
								$('.swiper-slide').find(".home-banner__slide").attr('src', mobileImage);
							}
							$('.swiper-slide').find(".swiper-lazy-preloader").hide();
							$('.home-banner').find('.home-banner__wrap').removeClass('home-banner__wrap');
						}
					}
				},
				changeImages: function() {
					var w = window.innerWidth ? window.innerWidth : $(window).width();
					this.$slide.each(function() {
						var desktopImage =  $(this).find(".home-banner__slide").data('desktop');
						var mobileImage = $(this).find(".home-banner__slide").data('mobile');
						if (w > 768) {
							$(this).find(".home-banner__slide").attr("data-src",desktopImage);
						} else {
							$(this).find(".home-banner__slide").attr("data-src",mobileImage);
						}
					});
				},
				bannerSlider: function() {
					var mySwiper = new Swiper('.swiper-container', {
						spaceBetween: 0,
						speed: 800,
						effect: 'fade',
						lazy: {
						    loadPrevNext: true,
					    },
						autoplay: {
							disableOnInteraction: false
						},
						pagination: {
							el: '.swiper-pagination',
							type: 'bullets',
							clickable: true,
						},
					});
				}
			};
		
		c01PcHero.init();	
	}
});
$(function() {
	if($(".diy-kv-banner-cn").length > 0) {
		var c01PcHero = {
				$selector: $('.c01-pc-hero'),
				$slide: $('.swiper-slide'),

				init: function() {
					if(this.$selector.length) {
						if($('.swiper-slide').length > 1) {
							this.changeImages();
							this.bannerSlider();
						} else {
							var w = window.innerWidth ? window.innerWidth : $(window).width();
							var desktopImage =  $('.swiper-slide').find(".home-banner__slide").data('desktop');
							var mobileImage = $('.swiper-slide').find(".home-banner__slide").data('mobile');
							if (w > 768) {
								$('.swiper-slide').find(".home-banner__slide").attr('src', desktopImage);
							} else {
								$('.swiper-slide').find(".home-banner__slide").attr('src', mobileImage);
							}
							$('.swiper-slide').find(".swiper-lazy-preloader").hide();
							$('.home-banner').find('.home-banner__wrap').removeClass('home-banner__wrap');
						}
					}
				},
				changeImages: function() {
					var w = window.innerWidth ? window.innerWidth : $(window).width();
					this.$slide.each(function() {
						var desktopImage =  $(this).find(".home-banner__slide").data('desktop');
						var mobileImage = $(this).find(".home-banner__slide").data('mobile');
						if (w > 768) {
							$(this).find(".home-banner__slide").attr("src",desktopImage);
						} else {
							$(this).find(".home-banner__slide").attr("src",mobileImage);
						}
					});
				},
				bannerSlider: function() {
					var mySwiper = new Swiper('.swiper-container', {
						spaceBetween: 0,
						speed: 800,
						effect: 'fade',
						lazy: {
						    loadPrevNext: true,
					    },
						autoplay: {
							disableOnInteraction: false
						},
						pagination: {
							el: '.swiper-pagination',
							type: 'bullets',
							clickable: true,
						},
					});
				}
			};
		
		c01PcHero.init();	
	}
});
$(function(){
	// process flag
	if ($(".banner .banner-navPc").length == 0) return;
	
	var $body = $('html, body');
	$body.animate({scrollTop:0}, 1);

	// get nav components
	var $navComps = $(".honor-nav-control");
	var compCount = $navComps.length;
	
	// append nav items
	var $pcWrapper = $(".banner .banner-navPc .wrapper");
	var $mbWrapper = $(".banner .banner-navM .swiper-container .swiper-wrapper");

	$navComps.each(function(i){
		var compTitle = $(this).data("nav-title") || "NO TITLE";
		$pcWrapper.append('<li class="w11">'+(i==0?'<h1>':'')+'<a' + (i == 0 ? ' class="active"' : '') + '>' + compTitle + '</a>'+(i==0?'</h1></li>':'</li>'));
		//$pcWrapper.append('<li class="w11"><a' + (i == 0 ? ' class="active"' : '') + '>' + compTitle + '</a></li>');
		$mbWrapper.append('<div class="swiper-slide' + (i == 0 ? ' selected' : '') + '">' + compTitle + '</div>');
	});
	
	// init mobile nav items
	var swiperMb = undefined;
	
	initPc();
	initMobile();
		              
	$.fn.capacityFixed = function(options) {
		var opts = $.extend({}, $.fn.capacityFixed.deflunt,options);
		
		var FixedFun = function(element) {
			var top = opts.top;
			element.css({"top":top});
			$(window).scroll(function() {
			    var scrolls = $(this).scrollTop();
				if (scrolls > top) {
					 // debugger;
					if (window.XMLHttpRequest) {
						var num = 0;
						if($('body').hasClass('honor-v2')){
							num = top;
						}
						element.css({
							position: "fixed",
							top: num							
						});
					} else {
						element.css({
							top: scrolls
						});
					}
				}else {
					element.css({
						position: "absolute",
						top: top
					});
				}
			});
			element.find(".close-ico").click(function(event){
				element.remove();
				event.preventDefault();
			});
		};
		
		return $(this).each(function(){ FixedFun($(this)); });
	};
	
	$.fn.capacityFixed.deflunt={
		right:0,
		top:$('.header').height(),
		"z-index":200
	};
	
	$(window).scroll(function() {
		if($('body').hasClass('hidden-scroll')){return false;}
		var bodyWidth = document.body.scrollWidth;
		var scrollTop = $(document).scrollTop();
		var nav = bodyWidth > 600 ? $(".banner-navPc")[0] : $(".banner-navM")[0];
		
		if (bodyWidth > 768) {
			$(".banner-navPc").capacityFixed();
		} else if (nav && scrollTop > nav.offsetTop) {
			var num=0;
			if($('body').hasClass('honor-v2')){
				num = 69;
			}
			$(".banner-navM").css("top", num);
			$(".banner-navM").css("z-index", "1000");
		} else if (nav && scrollTop < nav.offsetTop || scrollTop == nav.offsetTop) {
			var num = $('.header').height();
			$(".banner-navM").css("top", num);
			$(".banner-navM").css("z-index", "2");
		}
		
		if (bodyWidth <= 768) {
			if ($(".banner .banner-navM .swiper-slide[c='click']").length > 0) return;
			var top = $('.header').height();
			$navComps.each(function(i){
				var $this = $(this);
				var heightMb = $this.data("height-mb") || 0;
				var $mb = $this.find(".honor-nav-scroll-mb");
				if ($mb.length == 0) $mb = $this;
				heightMb = heightMb || $mb.outerHeight();
				if (scrollTop >= top && scrollTop < top + heightMb) {
					swiperMb.slideTo(i);
					$(swiperMb.slides[i]).addClass("selected").siblings().removeClass("selected");
					return false;
				}
				top += heightMb;
			});
		} else {
			if ($(".banner .banner-navPc li[c='click']").length > 0) return;
			var top = $('.header').height();
			$navComps.each(function(i){
				var $this = $(this);
				var heightPc = $this.data("height-pc") || 0;
				var $pc = $this.find(".honor-nav-scroll-pc");
				if ($pc.length == 0) $pc = $this;
				heightPc = heightPc || $pc.outerHeight();
				if (scrollTop >= top && scrollTop < top + heightPc) {
					var $currentNavItem = $($(".banner .banner-navPc li")[i]);
					$currentNavItem.find("a").addClass("active");
					$currentNavItem.siblings().find("a").removeClass("active");	
					return false;
				}
				top += heightPc;
			});
		}
	})
	
	function initPc() {
		var $pcNavItems = $pcWrapper.find("li");
		var top = $('.header').height();
		$pcNavItems.each(function(i){
			var $this = $(this);
			var $navComp = $($navComps[i]);
			var heightPc = $navComp.data("height-pc") || 0;
			var $pc = $navComp.find(".honor-nav-scroll-pc");
			if ($pc.length == 0) $pc = $navComp;
			heightPc = heightPc || $pc.outerHeight();
			var scrollTo = top + 1; // note: plus 1 to reduce the computing error of browsers
			$this.on("click", function(){
				$this.attr("c", "click");
				$this.siblings().removeAttr("c").find("a").removeClass("active");
				$this.find("a").addClass("active");
				$body.stop().animate({scrollTop:scrollTo}, 800, function(){
					$this.removeAttr("c");
				});
			});
			top += heightPc;
		});
	}
                 
	function initMobile() {
		swiperMb = new Swiper('.banner .banner-navM .swiper-container', {
			slidesPerView:3.5, paginationClickable:false, spaceBetween:10, freeMode:true, loop:false
		});

		var top = $('.header').height();
		swiperMb.slides.each(function(i, val){
				var $this = $(this);
				var $navComp = $($navComps[i]);
				var heightMb = $navComp.data("height-mb") || 0;
				var $mb = $navComp.find(".honor-nav-scroll-mb");
				if ($mb.length == 0) $mb = $navComp;
				heightMb = heightMb || $mb.outerHeight();
				var scrollTo = top + 1; // note: plus 1 to reduce the computing error of browsers
				$this.on("click", function(e){
					e.preventDefault();
					if ($this.hasClass("selected")) return;
					$this.siblings().removeClass("selected");
					$this.addClass("selected");
					$this.attr("c", "click");
					swiperMb.slideTo(i, 800, false);
					$body.stop().animate({scrollTop:scrollTo}, 800, function(){
						$this.removeAttr("c");
					});
				});
				top += heightMb;
		});
	}
});
(function(){
	$(function(){
		if($('.brand-banner-v2').length>0){
			var bgImg ='',videoSrc='',isExternal = '';
			var $box = $('.brand-banner-v2 .video-box');
			if(utils.windowWidth()>768){
				bgImg = $box.data('pcbg');
				videoSrc = $box.data('pcvideo');
				isExternal = $box.data('ispcexternal');
			}else{
				bgImg = $box.data('mbbg');
				videoSrc = $box.data('mbvideo');
				isExternal = $box.data('ismbexternal');
			}
			if(bgImg){
				$box.css('background-image','url('+bgImg+')');
			}
			if(videoSrc){
				// has video
				if(isExternal){
					var last = videoSrc.lastIndexOf('/')+1;
					var videoId = videoSrc.slice(last,videoSrc.length);
					videoSrc = videoSrc.split('?')[0]+'?autoplay=1&loop=1&muted=1&playlist='+videoId;
					$('.brand-banner-v2 .video-frame').attr('src',videoSrc).show();
				}else{
					$('.brand-banner-v2 .video-content').attr('src',videoSrc);
					
					$('.brand-banner-v2 .video-content')[0].addEventListener('loadedmetadata',function(){
						var that = $('.brand-banner-v2 .video-content')[0];
						var videoH = that.videoHeight;
						var videoW = that.videoWidth;
						var pageW = utils.pageWidth();
						var endH = Number(pageW*videoH/videoW);
						if(endH<885){
							$('.brand-banner-v2 .video-box, .brand-banner-v2 .video-box .video-content').css('min-height',endH);
						}
					})
					$('.brand-banner-v2 .video-content')[0].addEventListener('canplay',function(){
						$(this).css('display','block')
					});
				}
			}
			
		}
	})
}());
/*!
 *	Brand About Component By Bruce
 * 	brand-about-component - v2.0.0 (2019-05-16T14:19:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){ 
		if($('.brand-about-v2').length>0){
			if(!!window.ActiveXObject || "ActiveXObject" in window){
				$(".brand-about-v2 .about-title h2").css({"color":"#bd00fe","background-image":"none"});
			}
			
			var brandData= $('.brand-about-v2 .ho-middle-v2');
			var lessTxt = brandData.data('less');
			var moreTxt = brandData.data('more');
			$('.brand-about-v2 .read-more').attr('data-less',lessTxt).attr('data-more',moreTxt).text('+ '+moreTxt+' +');
			
			var windowW = utils.windowWidth();
			if(windowW>768){
				// 渐变圆环懒加载
				$(".brand-about-v2 .lazyload").lazyload().show();
			}else{
				// 移动端 item-img 按照设计比例计算高度
				var imgH = windowW*0.86*248/280;
				$('.brand-about-v2 .item-box .item-img').css('height',imgH);
			}
			// 图片懒加载
			$('.brand-about-v2 .item-box .lazy').each(function(){
				var that = $(this);
				if(windowW>768){
					var img = that.data('pc');
					that.attr('data-original',img);
				}else{
					var img = that.data('mb');
					that.attr('data-original',img);
				}
			});
			$(".brand-about-v2 .item-box .lazy").lazyload().show().parent().removeClass('honor-loading-v2');
			$('.brand-about-v2 .read-more').click(function(){
				var $that = $(this);
				var $content = $that.prev();
				var flag = $that.attr('data-flag');
				var type= $that.data('type');
				if(flag=='more'){
					if(type=='about'){
						$content.css({
							height:'auto',
							overflow:'auto'
						})
					}else{
						$content.css({
							height:'auto',
							overflow:'auto'
						})
						$content.parent().css({
							top:'0',
							marginTop:'0'
						})
					}
					$that.attr('data-flag','less').text('- '+lessTxt+' -');
					// Read More Click GA Code
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Brand Story",
						"eventAction": "click",
						"eventLabel": moreTxt
					})
				}else{
					// 盒子滚动条，恢复原位
					$content.animate({
				        scrollTop: 0
				    },0)
				    
					if(type=='about'){
						if(windowW>768){
							$content.css({
								height:'78px',
								overflow:'hidden'
							})
						}else{
							$content.css({
								height:'239px',
								overflow:'hidden'
							})
						}
					}else{
						$content.css({
							height:'98px',
							overflow:'hidden'
						})
						if(windowW>768){
							$content.parent().css({
								top:'50%',
								marginTop:'-136px'
							})
						}
					}
					
					$that.attr('data-flag','more').text('+ '+moreTxt+' +');
					
					// Read Less Click GA Code
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Brand Story",
						"eventAction": "click",
						"eventLabel": lessTxt
					})
				}
			})
			
			// 判断页面上下滚动方向
			var scrollData = {
				y: 'undefined',
				diffY:0,
				scrollDirection:'down'
			}
			function scrollFunc() {
			    if (typeof scrollData.y == 'undefined') {
			    	scrollData.y = window.pageYOffset;
			    }
			    scrollData.diffY = window.pageYOffset-scrollData.y;
			    if (scrollData.diffY > 0) {
			        // Scroll down
			    	scrollData.scrollDirection = 'down';
			    } else if (scrollData.diffY < 0) {
			        // Scroll up
			    	scrollData.scrollDirection = 'up';
			    }
			    scrollData.y = window.pageYOffset;
			}

			//元素盒子对象
			function box(obj){
				this.obj = obj;
				this.top = this.obj.offset().top;
				this.height = this.obj.height();
				this.bottom = this.top+this.height;
				this.opacity = parseFloat(this.obj.css('opacity'));
			}
			
			var aboutObj = null,purposeObj = null,cultureObj = null,valuesObj = null;
			function getBoxObj(){
				aboutObj = new box($('.brand-about-v2 .item-about'));
				purposeObj = new box($('.brand-about-v2 .item-purpose'));
				cultureObj = new box($('.brand-about-v2 .item-culture'));
				valuesObj = new box($('.brand-about-v2 .item-values'));
			}

			// 页面滚动监听
			window.onscroll = function(e){
				// 重新获取各区域数据
				getBoxObj();
				// 实时获取滚动方向
				scrollFunc();
				var scrollTop = $(document).scrollTop();
		        var windowH = utils.windowHeight();
		        var srollBoxTop = scrollTop+windowH;
		        
		        // about盒子 未进入可视区域
		        if(srollBoxTop<aboutObj.top){
		        	aboutObj.opacity=0.2;
		        	aboutObj.obj.css('opacity',0.2);
		        	$('.brand-about-v2 .item-timeline').css('opacity',0.2);
		        }
		        // about盒子 进入可视区域
		        if(srollBoxTop>=(aboutObj.top+250) && srollBoxTop<=(aboutObj.bottom+250)){
		        	if(scrollData.scrollDirection == 'down'){
		        		aboutObj.opacity = changeOpacity(aboutObj.opacity,scrollData.diffY,aboutObj.height);
		        		aboutObj.obj.css('opacity',aboutObj.opacity);
		        		$('.brand-about-v2 .item-timeline').css('opacity',aboutObj.opacity);
		        	}else if(scrollData.scrollDirection == 'up'){
		        		//当看到内容的一半时
		        		if(srollBoxTop<=(aboutObj.top+(aboutObj.height/2)+250)){
			        		aboutObj.opacity = changeOpacity(aboutObj.opacity,scrollData.diffY,aboutObj.height);
			        		aboutObj.obj.css('opacity',aboutObj.opacity);
			        		$('.brand-about-v2 .item-timeline').css('opacity',aboutObj.opacity);
		        		}
		        	}
		        	
		        	// 圆圈跟随页面上下滚动效果
		        	smCircleMove(scrollData.scrollDirection);
		        	bgCircleMove(scrollData.scrollDirection);
		        }
		        // purpose盒子 未进入可视区域
		        if(srollBoxTop<purposeObj.top){
		        	purposeObj.opacity=0.2;
		        	purposeObj.obj.css('opacity',0.2);
		        }
		        // purpose盒子 进入可视区域
		        if(srollBoxTop>=purposeObj.top && srollBoxTop<=purposeObj.bottom){
		        	if(scrollData.scrollDirection == 'down'){
		        		purposeObj.opacity = changeOpacity(purposeObj.opacity,scrollData.diffY,purposeObj.height);
		        		purposeObj.obj.css('opacity',purposeObj.opacity);
		        		//当看到内容的一半时
		        		if(srollBoxTop>=(purposeObj.top+(purposeObj.height/2))){
		        			purposeObj.obj.addClass('active');
		        		}
		        	}else if(scrollData.scrollDirection == 'up'){
		        		if(srollBoxTop<=(purposeObj.top+(purposeObj.height/2))){
			        		purposeObj.opacity = changeOpacity(purposeObj.opacity,scrollData.diffY,purposeObj.height);
			        		purposeObj.obj.css('opacity',purposeObj.opacity);

		        			purposeObj.obj.removeClass('active');
		        		}
		        	}
		        }
		        // culture盒子 未进入可视区域
		        if(srollBoxTop<cultureObj.top){
		        	cultureObj.opacity=0.2;
		        	cultureObj.obj.css('opacity',0.2);
		        }
		        // culture盒子 进入可视区域
		        if(srollBoxTop>=cultureObj.top && srollBoxTop<=cultureObj.bottom){
		        	if(scrollData.scrollDirection == 'down'){
		        		cultureObj.opacity = changeOpacity(cultureObj.opacity,scrollData.diffY,cultureObj.height);
		        		cultureObj.obj.css('opacity',cultureObj.opacity);
		        		//当看到内容的一半时
		        		if(srollBoxTop>=(cultureObj.top+(cultureObj.height/2))){
		        			cultureObj.obj.addClass('active');
		        		}
		        		
		        	}else if(scrollData.scrollDirection == 'up'){
		        		if(srollBoxTop<=(cultureObj.top+(cultureObj.height/2))){
			        		cultureObj.opacity = changeOpacity(cultureObj.opacity,scrollData.diffY,cultureObj.height);
			        		cultureObj.obj.css('opacity',cultureObj.opacity);

		        			cultureObj.obj.removeClass('active');
		        		}
		        	}
		        }
		        // values盒子 未进入可视区域
		        if(srollBoxTop<valuesObj.top){
		        	valuesObj.opacity=0.2;
		        	valuesObj.obj.css('opacity',0.2);
		        }
		        // values盒子 进入可视区域
		        if(srollBoxTop>=valuesObj.top && srollBoxTop<=valuesObj.bottom){
		        	if(scrollData.scrollDirection == 'down'){
		        		valuesObj.opacity = changeOpacity(valuesObj.opacity,scrollData.diffY,valuesObj.height);
		        		valuesObj.obj.css('opacity',valuesObj.opacity);
		        		//当看到内容的一半时
		        		if(srollBoxTop>=(valuesObj.top+(valuesObj.height/2))){
		        			valuesObj.obj.addClass('active');
		        		}
		        		
		        	}else if(scrollData.scrollDirection == 'up'){
		        		if(srollBoxTop<=(valuesObj.top+(valuesObj.height/2))){
			        		valuesObj.opacity = changeOpacity(valuesObj.opacity,scrollData.diffY,valuesObj.height);
			        		valuesObj.obj.css('opacity',valuesObj.opacity);

		        			valuesObj.obj.removeClass('active');
		        		}
		        	}
		        }
			}
			// 改变不透明度
			function changeOpacity(opacity,diffY,boxH){
				diffY = diffY || 0;
				var percent = diffY/boxH;
				opacity+=percent;
        		if(opacity>1){
        			opacity=1;
        		}else if(opacity<0.4){
        			opacity=0.4;
        		}
        		return opacity;
			}
			
			// 圆圈跟随页面滚动特效
			var m=4,a=0,x=-114,y=110;
			var n=2,b=0,h=-233,i=209;
			function smCircleMove(type){
				if(type=='down'){
					$(".brand-about-v2 .circle-sm").animate({
						left:(x+=m*Math.cos((a++)/200))+'px',
						top:(y+=m*Math.sin((a++)/200))+'px'
					},5,function(){
						smCircleMove(type);
						if(a>=148){
							$(".brand-about-v2 .circle-sm").stop();
						}
					});
				}else{
					$(".brand-about-v2 .circle-sm").animate({
						left:(x+=-m*Math.cos((a--)/200))+'px',
						top:(y+=-m*Math.sin((a--)/200))+'px'
					},5,function(){
						smCircleMove(type);
						if(a<=-2){
							m=4,a=0,x=-110,y=110;
							$(".brand-about-v2 .circle-sm").stop();
						}
					});
				}
			}	
			function bgCircleMove(type){
				if(type=='down'){
					$(".brand-about-v2 .circle-bg").animate({
						left:(h+=n*Math.cos((b++)/100))+'px',
						top:(i+=-n*Math.sin((b++)/100))+'px'
					},5,function(){
						bgCircleMove(type);
						if(b>=148){
							$(".brand-about-v2 .circle-bg").stop();
						}
					});
				}else{
					$(".brand-about-v2 .circle-bg").animate({
						left:(h+=-n*Math.cos((b--)/100))+'px',
						top:(i+=+n*Math.sin((b--)/100))+'px'
					},5,function(){
						bgCircleMove(type);
						if(b<=-2){
							n=2,b=0,h=-235,i=210;
							$(".brand-about-v2 .circle-bg").stop();
						}
					});
				}
			}
			
		}
	})
	
}());
/*!
 *	HONOR TimeLine Component By Bruce
 * 	timeline - v2.0.0 (2019-05-16T14:19:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.brand-about-v2 .timeline-v2').length>0){
			var timeSwiper;
			var windowW = utils.windowWidth();
			
			$('.brand-about-v2 .timeline-title .title-linear').click(function(){
				var flag = $('.brand-about-v2 .item-timeline').hasClass('edit');
				if(!flag){
					$('html,body').css('overflow','hidden');
					$('.brand-about-v2 .timeline-box').css("visibility","visible");
					getData();
				}
				// See The Time line Button GA Code
				var buttonName = $.trim($(this).text()) || '';
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Brand Story",
					"eventAction": "click",
					"eventLabel": buttonName
				})
			})
			// 关闭时间轴弹窗
			$('.brand-about-v2 .timeline-box .honorFont-close').click(function(){
				$('html,body').css('overflow','auto');
				$('.brand-about-v2 .timeline-box').css("visibility","hidden");
				$('.brand-about-v2 .history-swiper').removeClass('clicked');
				$('.brand-about-v2 .timeline-v2 .timeline-box').removeClass('upper');
			})
				
			// 当前数据长度
			var currDataLength =0;
			// 获取数据
			function getData(){
				// 获取数据
				var result = JSON.parse($('.timeline-v2 .data-history').text() || "[]");
				if(result.length > 0) {
					var timeList ='';
					var date =new Date();
					for(var i=0;i<result.length;i++){
						// 时间节点
						if(i==0){
							timeList+='<li class="active" data-year="'+result[i].year+'">';
						}else{
							timeList+='<li data-year="'+result[i].year+'">';
						}
						timeList+='<p class="icon-circle"></p>';
						timeList+='<p class="year">'+result[i].year+'</p>';
						timeList+='</li>';
					}
					$('.brand-about-v2 .time-lists ul').html(timeList);
					var wPercent = utils.toPercent(1/result.length,4);
					$('.timeline-v2 .timeline-box li').css('width',wPercent);
					
					// 默认，显示最新年份
					var currYearData = result[0].list;
					currDataLength=currYearData.length;
					swiperDom(currYearData);
					
					// 切换年份
					$('.timeline-v2 .timeline-box li').click(function(){
						var that = $(this);
						var currYear = that.data('year');
						for(var i in result){
							if(result[i].year==currYear){
								currYearData = result[i].list;
							}
						}
						that.addClass('active').siblings().removeClass('active');
						timeSwiper.destroy();
						currDataLength=currYearData.length;
						swiperDom(currYearData);
						$('.timeline-v2 .history-swiper').removeClass('clicked');
					})
				}
			}
			
			// 渲染并生成swiper轮播
			function swiperDom(currYearData){
				var learnMoreTxt = $('.brand-about-v2 .timeline-title').data('learnmore') || 'Learn More';
				var swiperArr=[];
				for(var j=(currYearData.length-1);j>=0;j--){
					var swiperStr = '';
					swiperStr+='<div class="swiper-slide slide'+j+'" flag="unactive">';
						swiperStr+='<div class="slide-box">';
							swiperStr+='<div class="img-box honor-loading-v2">';
							if(windowW>768){
								// PC端
								swiperStr+='<img class="swiper-lazy" data-pcimg="'+currYearData[j].pcImg+'" data-mbimg="'+currYearData[j].mbImg+'" data-src="'+currYearData[j].mbImg+'" alt="'+currYearData[j].title+'" title="'+currYearData[j].title+'" />';
							}else{
								// 移动端
								swiperStr+='<img class="swiper-lazy" data-src="'+currYearData[j].mbImg+'" alt="'+currYearData[j].title+'" title="'+currYearData[j].title+'" />';
							}
							swiperStr+='</div>';
							swiperStr+='<div class="content-box">';
								swiperStr+='<div class="event-content">';
									swiperStr+='<div class="box-animate">';
										swiperStr+='<div class="honor-plus-icon" data-index="'+j+'"><span></span><span></span></div>';
										swiperStr+='<h3 class="event-title">'+currYearData[j].title+'</h3>';
										swiperStr+='<div class="title-line"></div>';
										swiperStr+='<div class="event-detail">';
											swiperStr+='<div class="detail-box">'+currYearData[j].descList+'</div>';
											if(currYearData[j].newsLink!='.html'){
												swiperStr+='<a href="'+currYearData[j].newsLink+'" target="_blank" class="learn-more">'+learnMoreTxt+'</a>';
											}
										swiperStr+='</div>';
										swiperStr+='<div class="event-other">';
											swiperStr+='<p class="month">'+currYearData[j].dateText+'</p>';
											swiperStr+='<p class="linear-line"></p>';
											swiperStr+='<div class="swiper-operate">';
												var disClass='',lastDisClass='';
												if(j==0){
													disClass='swiper-button-disabled';
												}
												if(j==(currYearData.length-1)){
													lastDisClass='swiper-button-disabled';
												}
												swiperStr+='<span class="honorFont-arr-left '+disClass+'"></span>';
												swiperStr+='<span class="honorFont-arr-right '+lastDisClass+'"></span>';
											swiperStr+='</div>';
										swiperStr+='</div>';
									swiperStr+='</div>';
								swiperStr+='</div>';
							swiperStr+='</div>';
						swiperStr+='</div>';
					swiperStr+='</div>';
					
					swiperArr.push(swiperStr);
				}
				$('.brand-about-v2 .history-swiper .swiper-wrapper').empty();
				var prevNextAmount = 2;
				var centeredSlidesVal = true;
				var spaceBetweenVal = 30;
				if(windowW>768){
					prevNextAmount = 4;
					centeredSlidesVal = false;
					spaceBetweenVal = 0;
				}else if(windowW==768){
					prevNextAmount = 3;
				}
				if(swiperArr.length>0){
					timeSwiper = new Swiper('.brand-about-v2 .history-swiper', {
						centeredSlides: centeredSlidesVal,
						spaceBetween: spaceBetweenVal,
						slidesPerView : 'auto',
						lazy: {
						    loadPrevNext: true,
						    loadPrevNextAmount: prevNextAmount,
						},
						keyboard: {
						    enabled: true,
						},
						navigation: {
							nextEl: '.brand-about-v2 .honorFont-arr-right',
							prevEl: '.brand-about-v2 .honorFont-arr-left',
						},
						on:{
						    lazyImageReady: function(slideEl, imageEl){
						    	$(slideEl).find('.img-box').removeClass('honor-loading-v2');
						    	$(slideEl).find('.img-box img').show();
						    }
						}
					});
					timeSwiper.appendSlide(swiperArr);
					timeSwiper.lazy.load();
					
					// 图片少于4张隐藏切换箭头
					if(windowW>768){
						if(swiperArr.length<4){
							$('.brand-about-v2 .history-swiper .swiper-bottom').hide();
						}else{
							$('.brand-about-v2 .history-swiper .swiper-bottom').show();
						}
					}
					
					var clickedIndex = 0;
					// slide缩放
					$('.brand-about-v2 .honor-plus-icon').click(function(e){
						utils.stopBubble(e);
						var that = $(this);
						clickedIndex = that.data('index');
						slideChange(clickedIndex,swiperArr.length,'scale');
					})
					
					// 前一个
					$('.timeline-v2 .honorFont-arr-left').click(function(){
						var flag = $('.brand-about-v2 .history-swiper').hasClass('clicked') && !$(this).hasClass('swiper-button-disabled');
						if(flag){
							clickedIndex=clickedIndex+1;
							slideChange(clickedIndex,swiperArr.length);
						}
					})
					// 后一个
					$('.timeline-v2 .honorFont-arr-right').click(function(){
						var flag = $('.brand-about-v2 .history-swiper').hasClass('clicked') && !$(this).hasClass('swiper-button-disabled');
						if(flag){
							clickedIndex=clickedIndex-1;
							slideChange(clickedIndex,swiperArr.length);
						}
					})
				}
			}
			
			// slide盒子缩放
			function slideChange(clickedIndex,slideTotal,type){
				
				var $currSlide = $('.brand-about-v2 .slide'+clickedIndex);

				// slide状态切换
				var flag = $currSlide.attr('flag');
				if(flag=='active'){
					$currSlide.attr('flag','unactive').removeClass('active');
				}else{
					$currSlide.attr('flag','active').addClass('active');
				}
				$currSlide.siblings().attr('flag','unactive').removeClass('active');

				// 加减号icon变化
				$currSlide.find('.honor-plus-icon').toggleClass('active');
				$currSlide.siblings().find('.honor-plus-icon').removeClass('active');
				
				var slidesPerViewVal=1,slidesPerViewPCVal=3;
				if($currSlide.find('.honor-plus-icon').hasClass('active')){
					// slide放大
					if(windowW>768){
						var that = $currSlide.find('.swiper-lazy');
						var pcImg = that.data('pcimg');
						that.attr('src',pcImg);
						$('.brand-about-v2 .swiper-slide').addClass('swiper-no-swiping');
					}
					$('.brand-about-v2 .history-swiper .swiper-bottom').hide();
					$('.brand-about-v2 .history-swiper').addClass('clicked');
					$('.brand-about-v2 .timeline-v2 .timeline-box').addClass('upper');
				}else{
					// slide缩小
					slidesPerViewVal='auto';
					slidesPerViewPCVal='auto';
					if(windowW>768){
						var that = $currSlide.find('.swiper-lazy');
						var mbImg = that.data('mbimg');
						that.attr('src',mbImg);
						$('.brand-about-v2 .swiper-slide').removeClass('swiper-no-swiping');

						// 图片少于4张隐藏切换箭头
						if(currDataLength<4){
							$('.brand-about-v2 .history-swiper .swiper-bottom').hide();
						}else{
							$('.brand-about-v2 .history-swiper .swiper-bottom').show();
						}
						
					}
					$('.brand-about-v2 .history-swiper').removeClass('clicked');
					$('.brand-about-v2 .timeline-v2 .timeline-box').removeClass('upper');
				}
				
				if(clickedIndex>=0){
					timeSwiper.destroy();
					// PC端
					if(windowW>768){
						if(slidesPerViewPCVal=='auto'){
							// 缩小效果							
							timeSwiper = new Swiper('.brand-about-v2 .history-swiper', {
								slidesPerView: slidesPerViewPCVal,
								centeredSlides: true,
								lazy: {
									loadOnTransitionStart: true,
									loadPrevNext: true,
									loadPrevNextAmount: 4,
								},
								keyboard: {
									enabled: true,
								},
								navigation: {
									nextEl: '.brand-about-v2 .honorFont-arr-right',
									prevEl: '.brand-about-v2 .honorFont-arr-left',
								},
								on:{
								    lazyImageReady: function(slideEl, imageEl){
								    	$(slideEl).find('.img-box').removeClass('honor-loading-v2');
								    	$(slideEl).find('.img-box img').show();
								    }
								}
							});
							if(!!window.ActiveXObject || "ActiveXObject" in window){
	 							$('.timeline-v2 .clicked .swiper-slide.active').css('width','27%');
	 						}
						}else{
							// 放大效果
							timeSwiper = new Swiper('.brand-about-v2 .history-swiper', {
								effect : 'coverflow',
								slidesPerView: slidesPerViewPCVal,
								centeredSlides: true,
								coverflowEffect: {
									rotate: 0,
									stretch: -160,
									depth: 0,
									modifier: 2,
									slideShadows : true
								},
								lazy: {
									loadOnTransitionStart: true,
									loadPrevNext: true,
									loadPrevNextAmount: 4,
								},
								navigation: {
									nextEl: '.brand-about-v2 .honorFont-arr-right',
									prevEl: '.brand-about-v2 .honorFont-arr-left',
								},
								on:{
								    lazyImageReady: function(slideEl, imageEl){
								    	$(slideEl).find('.img-box').removeClass('honor-loading-v2');
								    	$(slideEl).find('.img-box img').show();
								    }
								}
							});
							var locationVal='-10%';
							if(clickedIndex==0 && type=='scale'){
								if(windowW>=1600){
									locationVal='4%';
								}else if(windowW>=1500){
									locationVal ='-18%'
								}else if(windowW>=1366){
									locationVal='-23%';
								}else if(windowW>=1280){
									locationVal='-26%';
								}
								if($('.__arabic__').length>0){
									$('.timeline-v2 .clicked .swiper-slide.active').css({
										'width':'auto',
										'margin-right':locationVal,
										'margin-left':'-10%'
									});
								}else{
									$('.timeline-v2 .clicked .swiper-slide.active').css({
										'width':'auto',
										'margin-left':locationVal,
										'margin-right':'-10%'
									});
								}
							}
							if(!!window.ActiveXObject || "ActiveXObject" in window){
								if($('.__arabic__').length>0){
									$('.timeline-v2 .clicked .swiper-slide.active').css({
										'width':'auto',
										'margin-right':locationVal,
										'margin-left':'-10%'
									});
								}else{
									$('.timeline-v2 .clicked .swiper-slide.active').css({
										'width':'auto',
										'margin-left':locationVal,
										'margin-right':'-10%'
									});
								}
							}
							
						}
						timeSwiper.slideTo((slideTotal-clickedIndex-1),0);
					}else{
						// 移动端 轮播图缩放
						if(slidesPerViewVal=='auto'){
							// 缩小
							timeSwiper = new Swiper('.brand-about-v2 .history-swiper', {
								slidesPerView : 'auto',
								centeredSlides: true,
								spaceBetween: 30,
								lazy: {
								    loadPrevNext: true,
								    loadPrevNextAmount: 2,
								},
								on:{
								    lazyImageReady: function(slideEl, imageEl){
								    	$(slideEl).find('.img-box').removeClass('honor-loading-v2');
								    	$(slideEl).find('.img-box img').show();
								    }
								}
							});
						}else{
							// 放大
							timeSwiper = new Swiper('.brand-about-v2 .history-swiper', {
								slidesPerView: slidesPerViewVal,
								centeredSlides: true,
								lazy: {
									loadPrevNext: true,
									loadPrevNextAmount: 1,
								},
								on:{
								    lazyImageReady: function(slideEl, imageEl){
								    	$(slideEl).find('.img-box').removeClass('honor-loading-v2');
								    	$(slideEl).find('.img-box img').show();
								    }
								}
							});
						}
						timeSwiper.slideTo((slideTotal-clickedIndex-1),0);
					}
				}
				
				$currSlide.find('.box-animate').fadeOut(0).delay(250).fadeIn(500);
			}
		}
	})
}());
(function(){



    var bodyWidth = document.body.offsetWidth;

    var bindClick = function(){
      
            //导航栏点击事件
      /*$('#banner-nav li').on('click',function(e){
      $(this).attr('c','click');
      $(this).siblings().removeAttr('c');
      $(this).siblings().find('a').removeClass('active');
        $(this).find('a').addClass('active');
                   
        $('html,body').animate({scrollTop:$('#'+$(this).attr('name')).offset().top-70}, 800);
        var o = $(this); 
        setTimeout(function(){
                  o.removeAttr('c');
        },800)
      })
*/
 
      }

            //页面事件绑定
      bindClick(); 

      setTimeout(function(){ //页面头部轮播初始化
  		var brandData = JSON.parse($('div[name="list-brand-data"]').text() || "[]");
			if(bodyWidth<=768){ //手机上导航初始化
	                     brandData.map(function(item){
	                       item.img = item.imgMobile;
	                    })
			}

  		var temp  = '';
                  	if($('#list-brand-temp').text()){
                  		temp = template('list-brand-temp', {list:brandData});
                 	 }
  		 
  		 $('div[name="ABOUTUSContainer"]').html(temp);
  		 if(brandData.length>1){
  			var swiper = new Swiper('.banner-top .swiper-container', {
  				pagination: {
  					el: '.swiper-pagination',
  					clickable: true
  					},
  				autoplay: true,
  				loop : true,
  			 });	
  		 }
  	    	
  	  })




})();

$(function() {
	if($(".themes-footer").length > 0) {
		//二维码显示隐藏
	   $(".customLink").hover(function(){
		   $(this).find(".qrCode").stop().show();
		   $(this).siblings(".customLink").find(".qrCode").hide();
		   event.stopPropagation();
	   },function(){
		   $(this).find(".qrCode").stop().hide();
	   });
	   
//	   $(".themes-footer .footer-box-v2 .social-media-lists .customLink").click(function(){
//		   var socialNetwork,socialName;
//			var shareNetwork=$(this).children("span").attr("class");
//			if(shareNetwork.indexOf("fa-facebook") != -1){
//				socialName="Facebook";
//			}else if(shareNetwork.indexOf("fa-twitter") != -1){
//				socialName="Twitter";
//			}else if(shareNetwork.indexOf("fa-instagram") != -1){
//				socialName="Instagram";
//			}else if(shareNetwork.indexOf("fa-youtube") != -1){
//				socialName="Youtube";
//			}else if(shareNetwork.indexOf("fa-whatsapp") != -1){
//				socialName="Whatsapp";
//			}else if(shareNetwork.indexOf("fa-vk") != -1){
//				socialName="VK";
//			}else if(shareNetwork.indexOf("fa-linkedin") != -1){
//				socialName="Linkedin";
//			}else{
//				socialName="";
//			}
//			window.dataLayer.push({
//				"event": "uaEvent",
//				"eventCategory": "Bottom Function",
//				"eventAction": honorConfig.pageType,
//				"eventLabel": "social+"+socialName
//			})
//	   })
	   $(".themes-footer .footer-box-v2 .social-media-lists .customLink").mouseover(function(e){
		   // 阻止冒泡事件
		   utils.stopBubble(e);
		   var href=$(this).attr("href");
		   if(href=="javascript:void(0);"){
			   window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Bottom Function",
					"eventAction": honorConfig.pageType,
					"eventLabel": "social+wechat"
				})
		   }
		   
	   })
	}
})
$(function() {
	var ww=$(window).width();
    if(ww<=768){
  	  if($('.footer .footer-box-v2').length>0){
  		  if($('.footer-box .np li').length  == 0) {
  			  $(".footer-box-v2").find("ul").css("border-bottom","none");
  		  } else {
  			  $('.footer-box .np li').click(function(){
        			  	var $that = $(this);
        			  	$that.find('.item-link').stop().slideToggle();
        			  	$that.find('.app-plus-icon').toggleClass('clicked');
        			  	$that.siblings().find('.item-link').stop().slideUp();
  						$that.siblings().find('.app-plus-icon').removeClass('clicked');
        		  })
  		  }
  	  }else if($(".footer-cn").length > 0) {
  		  $('.footer-box .np li').click(function(){
    			  	var $that = $(this);
    			  	$that.find('.item-link').stop().slideToggle();
    			  	$that.siblings().find('.item-link').stop().slideUp();
    			  	$that.find(".cnplus").toggleClass("cnplus-active");
    			    $that.siblings().find(".cnplus").removeClass("cnplus-active");
    		  });
  	  }else{
  		  $('.footer').on('click','.footer-box li h3',function(){
  			  if($(this).hasClass("open")){
  				  $(this).removeClass("open");
  				  $(this).children("span").addClass("font-Plus").removeClass("font-Minus");
  				  $(this).next(".item-link").hide();
  			  }else{
  				  $(this).addClass("open");
  				  $(this).children("span").addClass("font-Minus").removeClass("font-Plus");
  				  $(this).next(".item-link").show();
  			  }
  		  })
  	  }
    } else {
  	  if($('.footer-box .np li').length  == 0) {
  		  $(".footer-box-v2").css("padding-top","0");
  	  }
  	  
  	  if($(".productManual").length > 0) {
  		  $(".productManual").parents("a").hide();
  	  }
    }
});

(function(){
		//ga code start
		$('.footer').on('click','.share-cont .share-icon a',function(){
			var socialNetwork;
			var shareNetwork=$(this).attr("class");
			if(shareNetwork=="font-Facebook"){
				socialNetwork="Facebook";
			}else if(shareNetwork=="font-Twitter"){
				socialNetwork="Twitter";
			}else if(shareNetwork=="font-Instagram"){
				socialNetwork="Instagram";
			}else if(shareNetwork=="font-You-tube"){
				socialNetwork="Youtube";
			}else if(shareNetwork=="font-google-plus"){
				socialNetwork="Google";
			}else{
				socialNetwork="";
			}
			window.dataLayer.push({"event": "social","socialNetwork": socialNetwork})
		});
		//footerV2 GA
		$('.footer').on('click','.social-media-lists a.customLink',function(){
			var socialNetwork,socialName;
			var shareNetwork=$(this).children("span").attr("class");
			if(shareNetwork.indexOf("fa-facebook") != -1){
				socialName="Facebook";
			}else if(shareNetwork.indexOf("fa-twitter") != -1){
				socialName="Twitter";
			}else if(shareNetwork.indexOf("fa-instagram") != -1){
				socialName="Instagram";
			}else if(shareNetwork.indexOf("fa-youtube") != -1){
				socialName="Youtube";
			}else if(shareNetwork.indexOf("fa-whatsapp") != -1){
				socialName="Whatsapp";
			}else if(shareNetwork.indexOf("fa-vk") != -1){
				socialName="VK";
			}else if(shareNetwork.indexOf("fa-linkedin") != -1){
				socialName="Linkedin";
			}else{
				socialName="";
			}
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Bottom Function",
				"eventAction": honorConfig.pageType,
				"eventLabel": "social+"+socialName
			})
		});
		
		//footerV2 GA
		$(".footer-box-v2 .footer-bottom a.btn-country").click(function(){
			var country=$(this).children("span").eq(1).text();
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Bottom Function",
				"eventAction": honorConfig.pageType,
				"eventLabel": "select country+"+country
			})
		})
		
        $("body").on("click",".footer .item-link a",function(){
        	 var proName=$(this).text();
     		 var proCategory=$(this).parent(".item-link ").prev("h3").text();
     		 var proPosition=$(this).index()+1;
             window.dataLayer.push({
             	"event": "eeListClick",
             	"loginStatus": honorData.loginStatus,
             	"productAvailability": "",
             	'products': [{
             	"listName": "footer product list",
             	"name": proName,
             	"id": proName,
             	"price": "",
             	"brand": "Honor",
             	"category": proCategory,
             	"variant": "",
             	"position": proPosition,
             	"productAvailability":""
             	}]
             	})
        })
        //ga code end
        $('.footer').on('click','.footer-subscription-arrow',function(){
        	//ga code start
        	window.dataLayer.push({"event": "newsletterSubscription","siteLocation": "footer","pageType":honorConfig.pageType})
        	//ga code end
        	
        	$("#privacy-policy").hide();
            var mail = $('.footer #footer-subscription').val();
            var webpowerPath = $("#webpower-path-holder").data("webpowerpath");
            var tip = $(".footer .tips") ;            
            if(mail && isMail(mail)){
                $.post("/bin/subscript.html",{email:mail, webpowerPath:webpowerPath}).success(function(result){
                        tip.text(tip.data('success'));
                        tip.removeClass("hide");
                        if(result&&result=="DUPLICATE"){
                        	tip.text(tip.data('duplicate'));
                        }
                        //for analytics
                        if(typeof(analyticsSubmit)=="function"){
                            analyticsSubmit("Subscription","Email","Email Success - <page name>","commonClick");
                        }
                        subTips();
                    })

            }else{
                tip.text(tip.data('invalidmail'));
                tip.removeClass("hide");
                subTips();
            }

        });

        var isMail = function(email){
           var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,30})+$/;
            return filter.test(email);
        }
        
       var subTips = function(){
    	 //tips 超出长度隐藏   75
           var tipsTxt = $(".footer .tips").text();
           if(tipsTxt.length>75){
           	 $(".footer .tips").attr('title',tipsTxt);
           	 $(".footer .tips").text(tipsTxt.substring(0,75)+'...');
           }
       } 
        
        
       //解决缅甸字体title乱码问题
       $('.footer').on('mouseover','.title h2',function(e){
		   showTitles(e, $(this));
       })
       
        $('.footer').on('mouseout','.title h2',function(e){
        	$(this).find('div[name="title"]').remove();
        })
        
        
         $('.footer').on('mouseover','.title p',function(e){
		   showTitles(e, $(this));
         })
         
          $('.footer').on('mouseout','.title p',function(e){
        	$(this).find('div[name="title"]').remove();
          })
       
       
        $('.footer').on('mouseover','.share-title h2',function(e){
		   showTitles(e, $(this));
       })
       
        $('.footer').on('mouseout','.share-title h2',function(e){
        	$(this).find('div[name="title"]').remove();
        })
        
        $('.footer').on('mouseover','.share-title p',function(e){
		   showTitles(e, $(this));
       })
       
        $('.footer').on('mouseout','.share-title p',function(e){
        	$(this).find('div[name="title"]').remove();
        })
       
       var showTitles = function(o,_this){
    	   var temp = '<div name="title" @context="unsafe" class="ctitles" style="position:fixed;left:'+(o.clientX+20)+'px;top:'+(o.clientY+10)+'px;">'+_this.text()+'</div>';
    	   _this.append(temp);
       }
       
       // Footer V2导航样式优化
       $('.footer-box-v2 .np ul li').each(function(){
    	   var $currLi = $(this);
    	   var flag = $(this).children('h3').hasClass('hide-Mobile');
    	   if(flag){
    		   $currLi.remove();
    	   }
       })
       
       // Bottom Navigation Click GA Code
       $('.footer-box-v2 .np .item-link a').click(function(){
    	   var navigationName = $(this).text() || '';
    	   window.dataLayer.push({
    		   "event": "uaEvent",
    		   "eventCategory": "Bottom Navigation",
    		   "eventAction": "click",
    		   "eventLabel": navigationName
		   })
       })
       
       // Footer Link：site map/terms of use/privacy/cookie/legal GA Code
       $('.footer-box-v2 .footer-bottom .link a').click(function(){
    	   var navigationName = $(this).text() || '';
    	   window.dataLayer.push({
    		   "event": "uaEvent",
    		   "eventCategory": "Footer Navigation",
    		   "eventAction": "click",
    		   "eventLabel": navigationName
    	   })
    	   
    	   window.dataLayer.push({
   			"event": "uaEvent",
   			"eventCategory": "Bottom Function",
   			"eventAction": honorConfig.pageType,
   			"eventLabel": "footnote+"+navigationName
       	   })
       })
       
       
       //替换中文站点plus button 按钮 , 交换底部链接和版权声明位置
       if($(".footer-cn").length > 0) {
    	   $(".footer-cn").find(".font-Plus").addClass("cnplus").removeClass("font-Plus");
    	   
    	   var ww=$(window).width();
    	   if(ww <= 768) {
    		   var linkColne = $(".footer-cn").find(".link").clone();
        	   $(".footer-cn").find(".link").remove();
        	   $(".footer-cn").find(".copyright").after(linkColne);
        	   $('.footer-cn .np ul li').each(function(){
            	   var $currLi = $(this);
            	   var flag = $(this).children('h3').hasClass('hide-Mobile');
            	   if(flag){
            		   $currLi.remove();
            	   }
               });
    	   }
    	   
    	   //二维码显示隐藏
    	   $(".customLink").on("click", function(event) {
    		   $(this).find(".qrCode").stop().toggle();
    		   $(this).siblings(".customLink").find(".qrCode").hide();
    		   event.stopPropagation();
    	   });
    	   
    	   $(document).on("click", function() {
    		   $(".customLink").find(".qrCode").hide();
    	   });
    	   
    	   //隐藏面包屑导航首页
    	   $(".footer-cn .honor-breadcrumb").find(".prePage").eq(0).hide();
       }
       //判断footer底部列表个数
       if($(".footer").find(".wrapper li").length >= 5) {
    	   $(".footer").find(".wrapper ul").addClass("more5");
       }
})();
/*!
 *	Themes List Banner By Xudongming
 * 	themes-list-banner - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	if($('.themes-list-banner').length>0){
		var ww = $("body").width();
		// 分移动端和PC，按需加载banner图片
		changeImg();
		
		$(window).resize(function(){
			changeImg();
			setBannerType();
		})
		
		function changeImg(){
			var $img = null;
			if(ww > 768){
				$img = $(".themes-list-banner .themes-pc");
				$img.removeClass('album-hide');
			}else{  
				$img = $(".themes-list-banner .themes-mb");
				$img.removeClass('album-hide');
			}
			if($img){
				$img.each(function(){
					var imgsrc = $(this).data('src');
					$(this).attr('src',imgsrc);
				});
				$img.imagesLoaded().done(function(){
					$img.show();
					setBannerType();
				})
			}
		}
		
		//设置banner显示样式
		function setBannerType() {
			$(".themes-list-banner").find(".themes-banner:first").find(".item-overlay").hide();
			if(ww > 768) {
				var themesBannerLength = $(".themes-list-banner").find(".themes-banner").length;
				if(themesBannerLength > 1) {
					$(".themes-list-banner").on("mouseenter", ".themes-banner", function() {
						$(this).find(".item-overlay").hide();
						$(this).siblings(".themes-banner").find(".item-overlay").show();
						$(this).siblings(".themes-banner").find("img").css("width","auto");
						$(this).siblings(".themes-banner").css("width", "20%");
						$(this).css("width", "60%");
					})
					//图片加载完毕，执行高度渲染
					var $firstPc = $(".themes-list-banner").find(".themes-banner:first .themes-pc");
					$firstPc.imagesLoaded().done(function(){
						var itemH = $firstPc.height();
						$(".themes-list-banner").find('.themes-banner').height(itemH);
					})
				}
			}
		}
		
		//GA Code
		$(".themes-list-banner .themes-banner a").click(function(){
			var imgName=$(this).children("img").attr("title") || "BannerImg";
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Categories Page+"+honorConfig.pageType,
				"eventAction": "Public Module",
				"eventLabel": "Top img+"+imgName
			})
		})
		
	}
})();
(function(){
    if($('.product-album-slides-component').length>0){
    	// 本地已点赞数组
    	var lovedArr =[]; 
    	// 懒加载
		if(galleryPublicData.windowW>768){
			$(".product-album-slides-component .album-mb").removeClass('swiper-lazy');
		}else{
			$(".product-album-slides-component .album-pc").removeClass('swiper-lazy');
		}
    	
    	// 获取当前轮播图下标
		var currUrl = window.location.href;
		var slideIndex = 0;
		if(currUrl.indexOf('.html') != -1){
			currUrl = currUrl.split('.html')[0];
		}else{
			currUrl = currUrl.substring(0,currUrl.length-1);
		}
		var endIndex = currUrl.lastIndexOf('.');
		slideIndex = parseInt(currUrl.substring(endIndex+1,currUrl.length)) || 0;
    	
    	// V2版本下标处理
    	if($(".album-listsec").length > 0) {
    		slideIndex = parseInt(slideIndex) + 1;
    	}
    	
    	var pageW = utils.pageWidth();
    	if(pageW<=768){
    		$('.product-album-banner-component').hide();
    	}
    	
    	// 轮播图总数
    	var slideNum =0;
    	$('.gallery-thumbs .swiper-wrapper .swiper-slide').each(function(){
    		slideNum++
    	})
		setTimeout(function() {
			var galleryTop = new Swiper('.gallery-top', {
				spaceBetween : 12, 
				loop : true,
				navigation : {
					nextEl : '.top-next',
					prevEl : '.top-prev',
				}, 
				lazy:true,
				centeredSlides : true,
				loopedSlides: slideNum,  
				delay : 8000,
				on:{
				    lazyImageReady: function(slideEl, imageEl){
				    	if(galleryPublicData.windowW>768){
							$(slideEl).find('.album-pc').show();
						}else{
							$(slideEl).find('.album-mb').show();
						}
				    }
				}
			});
			
			var galleryThumbs = new Swiper('.gallery-thumbs', {
				spaceBetween : 12,
				loop : true,
				navigation : {
					nextEl : '.next-box',
					prevEl : '.prev-box',
				}, 
				loopedSlides: slideNum, 
				slidesPerView : 'auto',
				centeredSlides : true, 
				touchRatio : 0.2,
				slideToClickedSlide : true,
				lazy:true,
				on:{
				    lazyImageReady: function(slideEl, imageEl){
				    	var $curr = $('.product-album-slides-component .gallery-thumbs .swiper-slide-active img');
				    	var currImg = $curr.data('src');
					    $curr.attr('src',currImg);
					    var imgLoad = imagesLoaded($curr);
				    	imgLoad.on('done', function(instance) {
				    		// 加载完成 
				    		$curr.show();
				    	})
					      
					    var $prev = $('.product-album-slides-component .gallery-thumbs .swiper-slide-prev img');
					    var prevImg = $prev.data('src');
					    $prev.attr('src',prevImg);
					    var prevImgLoad = imagesLoaded($prev);
					    prevImgLoad.on('done', function(instance) {
				    		// 加载完成 
					    	$prev.show();
				    	})
					      
					    var $next = $('.product-album-slides-component .gallery-thumbs .swiper-slide-next img');
					    var imgsrc = $next.data('src');
					    $next.attr('src',imgsrc);
					    var nextImgLoad = imagesLoaded($next);
					    nextImgLoad.on('done', function(instance) {
				    		// 加载完成 
					    	$next.show();
				    	})
					      
					 },
					 slideChange:function(){
						 var num = this.realIndex, 
						 pre = this.previousIndex,
						 active = this.activeIndex,
						 total=this.slides.length;
						 if(pre!=num){
							 if(num==0 && (pre+active)!=total){
								 // GA Code Start
								 window.dataLayer.push({
						    		"event": "virtualPageview",
						    		"page": honorConfig.uri+"photo_"+num
								 })
								 // GA Code End
							 }else if(num!=0){
								 // GA Code Start
								 window.dataLayer.push({
						    		"event": "virtualPageview",
						    		"page": honorConfig.uri+"photo_"+num
								 })
								 // GA Code End
							 }
						 }
							
					 }
				 }
			});
			
			$(".gallery-thumbs").on("click", ".swiper-slide", function(){
				galleryTop.autoplay.stop();
			}); 
			
			if (galleryTop && galleryTop.controller) {
				galleryTop.controller.control = galleryThumbs;
				galleryThumbs.controller.control = galleryTop;
			}

			// 跳转到对应轮播图
			if(slideIndex>0 && $(".album-listsec").length <= 0){
				galleryTop.slideTo(slideIndex,0);
				galleryThumbs.slideTo(slideIndex,0);
			}
			// 下载高清图片
			$('.download-hd').on('click',function(){
				// GA Code Start
				var photoName = $(this).parent().parent().data('swiper-slide-index');
				window.dataLayer.push({
					"event": "albumDownload",
					"photoName":photoName,
					"albumCategory":honorConfig.subCategory1
				})
				// GA Code End
				if (honorData.loginName!= "" && null != honorData.loginName && honorData.loginName !="null") {
					// 已登录，直接下载		
					var url = $(this).attr('data-url');
					$(this).attr('href',url);
				}else{
					//登录提示
					$('.login-tip,.album-bg').show();
					
					$('body').addClass("hideScrollbar");
					
					
					// GA Code Start
					window.dataLayer.push({
						"event": "virtualPageview",
						"page": honorConfig.uri+"login_popup_"+honorConfig.pageType+"_login_popup"
					})
					// GA Code End
				}
			})
			
			// 点赞 
			$('.icon-love').on('click',function(){
				var imgId = $(this).siblings('.love-num').attr('id');
				var hasLoved = currImgStatus($(this)); 
				if(!hasLoved){
					lovedArr.push(imgId);
					var clazz = $(this).attr('class');
					var $num =$(this).siblings('.love-num');
					var num = parseInt($.trim($num.text())) || 0;  
					if(clazz.indexOf('icon-loved') ==-1){
						$(this).addClass('icon-loved');
						++num; 
						$num.text(num);
						
						// GA Code Start
						var photoName = $(this).parent().parent().data('swiper-slide-index');
						window.dataLayer.push({
							"event": "albumLike",
							"photoName":photoName,
							"albumCategory":honorConfig.subCategory1
						})
						// GA Code End
						
						localStorage.setItem('lovedArr',lovedArr);
						
						var currUrl = location.protocol+location.port+"//"+location.host; 
						var pcImg =currUrl+ $(this).parent().siblings('.album-pc').data('id');
						var mbImg = currUrl+$(this).parent().siblings('.album-mb').data('id'); 
						//调用点赞接口
						addLoveNum(imgId,pcImg,mbImg);
					}
					
				}
	 
			})
			 
		}, 500);
		
		// 生成md5
		function md5Create(ClassName) {
			$(ClassName).each(function(i){
				var currUrl = location.protocol+location.port+"//"+location.host; 
				var pcImg = $(this).find('.album-pc').data('id');
				var mbImg = $(this).find('.album-mb').data('id'); 
				var start = currUrl+pcImg+currUrl+mbImg;
				var end = hex_md5(start); 
				$(this).find('.love-num').attr('id',end);
				if($(".album-listsec").length > 0) {
					if(i == slideNum){
						//调用查询点赞接口
						setTimeout(function() {
	    					getLovedStatus();
	    				},500);
						getLoveNum();
					}
				} else {
					if(i==(slideNum-1)){
						//调用查询点赞接口
						setTimeout(function() {
	    					getLovedStatus();
	    				},500);
						getLoveNum();
					}
				}
			})
		}
		
		if($(".album-listsec").length > 0) {
			md5Create('.album-listsec .swiper-slide');
		} else {
			md5Create('.gallery-top .swiper-slide');
		}
		
		
		// 关闭登录提示
		$('.tip-cancel').on('click',function(){
			$('.login-tip,.album-bg').hide();
			$('body').removeClass("hideScrollbar");
		})
		// 跳转登录
		$('.tip-login').on('click',function(){
			// GA Code Start
			window.dataLayer.push({
				"event": "accountLogin",
				"pageType": honorConfig.pageType,
				"siteLocation": "login_popup"
			})
			
			// GA Code End			
			window.location.href = honorConfig.endLoginUrl;
		});
		
	    // 循环列表判断图片点赞状态
	    function getLovedStatus(){
	    	var lovedString = localStorage.getItem('lovedArr') || ""; 
	    	if(lovedString){
	    		lovedArr = lovedString.split(',');
	    		$('.love-num').each(function(index){
	    			var currId = $(this).attr('id');
	    			if(lovedArr.indexOf(currId) !== -1) {
	    				$(this).siblings('.icon-love').addClass('icon-loved');
	    			}
	    		})
	    	}
	    }
	    // 判断当前图片是否已经点赞
	    function currImgStatus(obj){
	    	var flag = false;
	    	var lovedString = localStorage.getItem('lovedArr') || "";
	    	if(lovedString){
		    	lovedArr = lovedString.split(',');  
				var currId = $(obj).siblings('.love-num').attr('id');
				for(var i=0;i<lovedArr.length;i++){
					if(currId==lovedArr[i]){
						flag = true;
					}
				}
			}
			return flag;
	    }
	    // 获取点赞数
	    function getLoveNum(){
	    	$.ajax({
	    		url:honorApiUrl+'/abroad/shootMatch/getAEMImgPraiseAndCommentNum', 
	    		data:{
	    			'imgCountries':'global',
	    			'activityName':'product_album'
	    		},
	    		dataType:'jsonp',
	    		success:function(info){
	    			if(info.success){
	    				var data = info.infoBean.pageList;
	    				for(var i=0;i<data.length;i++){
	    					$('.love-num').each(function(){
	    						var currId = $(this).attr('id');
	    						if(currId==data[i].imgIdSrc){
	    							$(this).text(data[i].praiseNum);
	    						}
	    					})
	    					
	    				}
	    			}
	    		},
	    		error:function(err){
	    			console.log('error')
	    		}
	    	})
	    }
	    // 点赞
	    function addLoveNum(imgId,pcImg,mbImg){
	    	$.ajax({
	    		url:honorApiUrl+'/abroad/shootMatch/addAEMPraise',  
	    		data:{
	    			'imgCountries':'global',
	    			'activityName':'product_album',
	    			'imgId':imgId,
	    			'pcImgSrc':pcImg,
	    			'mpImgSrc':mbImg
	    		},
	    		dataType:'jsonp',
	    		success:function(info){
	    			if(info.success){
	    				setTimeout(function() {
	    					getLovedStatus();
	    					
	    				},500);
	    			}
	    		},
	    		error:function(err){
	    			console.log('error')
	    		}
	    	})
	    }
	    
	    //轮播图点赞判断
	    function iconLoveStatus(lovedArr) {
	    	var currentId = $(".album-listsec").find(".swiper-slide-active").find(".love-num").attr("id");
		    if(lovedArr.indexOf(currentId) !== -1) {
			  $(".album-listsec").find(".swiper-slide-active").find(".icon-love").addClass('icon-loved');
			}
	    }
	    
	   
	    //版本2轮播图
	    function galleryTopsec() {
	    	var ww = $(window).width();
	    	var nextArrow =  $('.albumArrowLeft');
    		var preArrow = $('.albumArrowRight');
    		if($(".__arabic__").length > 0) {
    			nextArrow = $('.albumArrowRight');
    			preArrow = $('.albumArrowLeft');
    		}
    		
    		var lovedString = localStorage.getItem('lovedArr') || ""; 
	    	if(lovedString){
	    		lovedArr = lovedString.split(',');
	    	}
	    	
	    	if(ww <= 768) {
	    		var swiper = new Swiper('.gallery-topsec', {
	    		  loop: true,
	    		  lazy: {
				    loadPrevNext: true,
				    loadPrevNextAmount: 1,
				  },
				  navigation: {
	  				  nextEl: preArrow,
	  				  prevEl: nextArrow
	  			  },
	  			  on: {
	  				  lazyImageReady: function(slideEl, imageEl) {
	  					$(slideEl).find("img.album-mb").show();
	  				  },
	  				  slidePrevTransitionEnd: function() {
	  					iconLoveStatus(lovedArr);
	  				  },
	  				  slideNextTransitionEnd: function() {
	  					iconLoveStatus(lovedArr);
	  				  }
	  			   }
	    		})
	    		
			    swiper.slideTo(slideIndex,0);
	    	} else {
			  var swiper = new Swiper('.gallery-topsec', {
				  autoHeight: true,
			      slidesPerView: 1,
			      spaceBetween: 30,
				  loop: true,
				  lazy: {
				    loadPrevNext: true,
				    loadPrevNextAmount: 1,
				  },
				  pagination: {
					  el: '.swiper-pagination',
					  type: 'fraction',
					  formatFractionCurrent: function(currnumber) {
						  var myNum = parseInt(currnumber);
						  if(myNum < 10) {
							  myNum = "0" + myNum;
						  }
						  return myNum; 
					  },
					  formatFractionTotal: function(number) {
						  var myNum = parseInt(number);
						  if(myNum < 10) {
							  myNum = "0" + myNum;
						  }
						  return myNum; 
					  }
				  },
				  navigation: {
					  nextEl: preArrow,
					  prevEl: nextArrow
				  },
				  on: {
					  init: function(slideEl) {
						  var thisWidth = parseInt($(".album-listsec").find(".swiper-slide-active").width());
                          $(".ablumSet").width(thisWidth - 255 + "px");
					  },
					  lazyImageReady: function(slideEl, imageEl) {
						 $(slideEl).find("img.album-pc").show();
					  },
					  resize: function() {
						  setTimeout(function() {
						      var thisWidth = parseInt($(".album-listsec").find(".swiper-slide-active").width());
	                          $(".ablumSet").width(thisWidth - 250 + "px");
						  },100);
					  },
					  slideChangeTransitionEnd: function(){
						 setTimeout(function(){
							 var finalHeight = $(".album-listsec .swiper-slide-active").find(".album-pc").height();
							 $(".album-listsec").find(".swiper-wrapper").css("height", finalHeight + 60 + "px");
						 },1000);
					  },
					  reachBeginning: function() {
						  setTimeout(function(){
							 var finalHeight = $(".album-listsec .swiper-slide").eq(0).find(".album-pc").height();
							 $(".album-listsec").find(".swiper-wrapper").animate({"height": finalHeight + 60 + "px"});
						 },1000);
					  }
				  }
			    });
			    swiper.slideTo(slideIndex,0);
	    	}
	    }
	    
	    if($(".album-listsec").length > 0) {
    	    setTimeout(galleryTopsec,100);
			accessoriedetail();
	    }
	    
	    window.onresize = function() {
	    	 if($(".album-listsec").length > 0) {
    		    setTimeout(galleryTopsec,100);
	 			accessoriedetail();
	 	    }
	    }
	    
	  //accessorie 轮播
		function accessoriedetail() {
			var ww = $(window).width();
			var spaceBetween;
			if(ww<= 768) {
				spaceBetween = 0;
			} else {
				spaceBetween = 30;
			}
			var slidesPerView;
			if(ww <= 414) {
				slidesPerView = "auto";
			} else {
				slidesPerView = 3;
			}
			var nextArrow;
			var preArrow;
			if($(".__arabic__").length > 0) {
				nextArrow = '.accessoriedetail .prev';
				preArrow = '.accessoriedetail .next';
			} else {
				nextArrow = '.accessoriedetail .next';
				preArrow = '.accessoriedetail .prev';
			}
			var swiperAccessorie = new Swiper('.accessorieContent', {
			  slidesPerView: slidesPerView,
		      spaceBetween: spaceBetween,
			  lazy: {
			    loadPrevNext: true,
			    loadPrevNextAmount: 3,
			  },
			  on: {
			    lazyImageReady: function(slideEl, imageEl) {
					if(ww > 768) {
						setTimeout(function() {
							$(slideEl).find("img.album-pc").show();
						},100);
					} else {
						$(slideEl).find("img.album-mb").show();
					}
				}
			  },
	  	      navigation: {
	  	        nextEl: nextArrow,
	  	        prevEl: preArrow,
	  	      },
	  	    });
		}
		
		setTimeout(function(){
			$(".accessorieContent").css("overflow","hidden");
		});
		
		//遮罩点击事件
//		$(".album-listsec").on("click", ".shadeLeft", function() {
//			$(".album-listsec").find(".albumArrowLeft").trigger("click");
//		});
//		
//		$(".album-listsec").on("click", ".shadeRight", function() {
//			$(".album-listsec").find(".albumArrowRight").trigger("click");	
//		});
    }
})();
(function(){
	
    if($('.product-album-desc-component').length>0){  
    	// 懒加载
    	$("img.lazy").lazyload({
			"placeholder":lazyload.placeholder
		}).show().parent().parent().addClass('loaded');
    	// 列表链接优化
    	$('.album-item,.album-itemsec').each(function(index){
    		var $a = $(this).find('a');
    		var currUrl = $a.attr('href');
    		if(currUrl.indexOf('.html') != -1){
    			currUrl = currUrl.split('.html')[0]+'.'+index+currUrl.split('.html')[1];
    		}else{
    			var endIndex = currUrl.lastIndexOf('/');
    			currUrl = currUrl.substring(0,endIndex)+'.'+index+'/';
    		}
    		$a.attr('href',currUrl);
    	})
    	
    	//图片动画效果
    	var ww = utils.pageWidth(); 
    	if(ww >=1024) {
			$(".album-listsec .wrapper").hover(function(){
			    var arabicLength = $(".__arabic__").length;
				if(arabicLength > 0) {
					$(this).find(".album-link").css({"transform":"translate(10px,-10px)"}).css("transition","transform 1s cubic-bezier(.22, .89, .57, 1)");
				} else {
					$(this).find(".album-link").css({"transform":"translate(-10px,-10px)"}).css("transition","transform 1s cubic-bezier(.22, .89, .57, 1)");
				}
		    }).mouseleave(function(){
		    	$(this).find(".album-link").css({"transform":"translate(0,0)","transition":"transform 1s cubic-bezier(.22, .89, .57, 1)"});
		    });
		}
	}
    
})();
(function(){
	
    if($('.product-album-component').length>0){ 
    	var albumData={
    		pageW:utils.pageWidth(),
    		currImg:''
    	}  
    	if(galleryPublicData.windowW>768){
    		$(".product-album-component .album-mb").removeClass('lazy');
		}else{
			$(".product-album-component .album-pc").removeClass('lazy');
		}
    	// 懒加载
    	function lazy() {
        	$(".product-album-component img.lazy").lazyload({
    			"placeholder":lazyload.placeholder
    		}).show().parent().addClass('loaded');
    	}
    	
    	lazy();
    	
    	if($(".album2").length > 0) {
    		$(".album-lists").find("img.lazy").lazyload({effect: "fadeIn"});
    		//tables 数据填充
        	function tablesDataAdd() {
        		var tablesData = $("#tabletsData").text();
        		if(tablesData) {
        			var data = JSON.parse(tablesData);
        			var tablesArray = [];
        			var tablesHtml;
        			for(var i = 0; i < data.length; ++i) {
        				var tableArray = [];
        				var tableHtml;
        				var loopArray = data[i]['tableList'];
        				for(var k = 0; k < loopArray.length; ++k) {
        					var itemLink;
        					var itemImgAlt;
        					var itemPcImgPath;
        					var itemMbImgPath;
        					var itemImgTitle;
        					var itemName;

        					if(loopArray[k].itemLink) {
        						itemLink = loopArray[k].itemLink;
        					} else {
        						itemLink = "";
        					}
        					if(loopArray[k].itemImgAlt) {
        						itemImgAlt = loopArray[k].itemImgAlt;
        					} else {
        						itemImgAlt = "";
        					}
        					if(loopArray[k].itemPcImgPath) {
        						itemPcImgPath = loopArray[k].itemPcImgPath;
        					} else {
        						itemPcImgPath = "";
        					}
        					if(loopArray[k].itemMbImgPath) {
        						itemMbImgPath = loopArray[k].itemMbImgPath;
        					} else {
        						itemMbImgPath = "";
        					}
        					if(loopArray[k].itemImgTitle) {
        						itemImgTitle = loopArray[k].itemImgTitle;
        					} else {
        						itemImgTitle = "";
        					}
        					if(loopArray[k].itemName) {
        						itemName = loopArray[k].itemName;
        					} else {
        						itemName = "";
        					}
        					if(albumData.pageW <= 768) {
        						itemPcImgPath = "";
        					} else {
        						itemMbImgPath = "";
        					}
        					tableHtml = '<div class="swiper-slide honor-loading-v2">' +
			    						'<a href="' + itemLink + '">' +
										'<img src="" class="album-pc swiper-lazy" alt="' + itemImgAlt + '" data-src="' + itemPcImgPath + '" title="' + itemImgTitle + '"/>' +
										'<img src="" class="album-mb swiper-lazy" alt="' + itemImgAlt + '" data-src="' + itemMbImgPath + '" title="' + itemImgTitle + '"/>' +
										'<div class=""></div>' +
										'</a>' +
										'<div class="tabletname">' + itemName + '</div>' +
										'</div>';
    						tableArray[tableArray.length] = tableHtml;
        				}
        				
        				var tableTitle;
        				if(data[i]['tableTitle'] !== "null") {
        					tableTitle = data[i]['tableTitle'];
    					} else {
    						tableTitle = "";
    					}
        				
        				tablesHtml = '<div class="tableLi">' +
									'<div class="tabletsTitle">' +
			    					'<h3>' + tableTitle + '</h3>' +
									'</div>' +
									'<div class="album-arrow-tablets">' +
									'<span class="honorFont-arr-left pre"></span>' +
									'<span class="honorFont-arr-right next"></span>' +
									'</div>' +
									'<div class="tabletsContent swiper-container swiper-container-initialized swiper-container-horizontal tableWiper' + i + '">' +
									'<div class="swiper-wrapper">' +
									tableArray.join("") +
									'</div>' +
									'</div>' +
									'</div>';
						tablesArray[tablesArray.length] = tablesHtml;
        			}
        			
        			$(".tablets").html(tablesArray.join(""));
        			
        			tablets();
        			
        			$(".tablets").find("a").each(function() {
        				var thisLink = $(this).attr('href');
        				if(!thisLink) {
        					$(this).attr("href","javascript:void(0);").find("img").css("cursor","default");
        				}
        			});
        		}
        	}
        	
        	tablesDataAdd();
        	
        	if($(".checkEdit").length == 0) {
        		window.onresize = function(){
                	tablesDataAdd();
            	}
        	} else {
        		//默认显示6张首页展示图片
        		function showSixPic() {
        			var itemBoxLength = $(".albumCarousel").find(".item-box").length;
        			if(itemBoxLength <= 6) {
        				$(".product-album-component").find(".readMoreBox").hide();
        			} else {
        				for(var i = 6; i <= itemBoxLength - 1; ++i) {
        					$(".albumCarousel").find(".item-box").eq(i).hide();
        				}
        			}
        		}
        		
        		showSixPic();
        		
        		//点击load more按钮显示剩余图片
        		function showMorePic() {
        			$(".product-album-component").on("click", ".readMoreContent", function() {
        				var lastVisibleIndex = parseInt($(".albumCarousel").find(".item-box:visible:last").index());
        				var originIndex = lastVisibleIndex + 1;
        				for(var k = originIndex; k <= lastVisibleIndex + 4; ++k) {
        					$(".albumCarousel").find(".item-box").eq(k).show();
        				}
        				
        				lazy();
        				
        				var itemBoxLength = $(".albumCarousel").find(".item-box").length;
        				var itemBoxVisibleLength = $(".albumCarousel").find(".item-box:visible").length;
        				if(itemBoxVisibleLength == itemBoxLength) {
        					$(".product-album-component").find(".readMoreBox").hide();
        				}
        			});
        		}
        		
        		showMorePic();
        	}
        	
        	//tablets 轮播
        	function tablets() {
        		$(".tablets").find(".tableLi").each(function() {
            		var slidesPerView;
            		var _this = $(this);
            		var swiper = _this.find(".tabletsContent").attr("class").split(" ")[4];
            		var nextArrow =  _this.find('.honorFont-arr-right');
            		var preArrow = _this.find('.honorFont-arr-left');
            		if($(".__arabic__").length > 0) {
            			nextArrow = _this.find('.honorFont-arr-left');
            			preArrow = _this.find('.honorFont-arr-right');
            		}
            		if(albumData.pageW > 768) {
            			var swiper = new Swiper("." + swiper, {
        				  slidesPerView: 4,
            			  spaceBetween: 20,
            			  lazy: {
  	      				    loadPrevNext: true,
  	      				    loadPrevNextAmount: 1,
  	      				  },
          	      	      navigation: {
          	      	        nextEl: nextArrow,
          	      	        prevEl: preArrow,
          	      	      },
        	      	      on: {
        	      	    	lazyImageReady: function(slideEl, imageEl) {
    	      	    		    $(slideEl).find("img.album-pc").show();
        	      	    	  }
          		  	      }
          	      	    });
            		} else {
            			var swiper = new Swiper('.' + swiper, {
        				  navigation: {
    					    nextEl: nextArrow,
        	      	        prevEl: preArrow,
          	      	      },
	          	      	  lazy: {
	      				    loadPrevNext: true,
	      				    loadPrevNextAmount: 1,
	      				  },
        		      	  on: {
        		      		lazyImageReady: function(slideEl, imageEl) {
        		      			  $(slideEl).find("img.album-mb").show();
        		      		  }
        		  	      }
        	      	    });
            		}
        		});
        	}
    	}
    }
})();
(function(){
	if($('.product-album-banner-component').length>0){
		if(galleryPublicData.windowW<=768 && $('.product-subnav').length>0){
			$('.product-album-banner-component .album-banner').css('margin-top','0');
		}
		
		// 分移动端和PC，按需加载banner图片
		changeImg();
		
		$('.product-album-banner-component .showmore').click(function(){
			var top= $('.album-lists')[0].offsetTop-68;
			$('html,body').animate({
				scrollTop: top
			},800)
		})
		$(window).resize(function(){
			changeImg();
		})
		
		function changeImg(){
			var $img = null;
			if(galleryPublicData.windowW>768){
				$img = $(".product-album-banner-component .album-pc");
				$img.removeClass('album-hide');
			}else{
				if($('.product-album-slides-component').length<=0){  
					$img = $(".product-album-banner-component .album-mb");
					$img.removeClass('album-hide');
				}
				
				
				$('.product-album-banner-component .album-banner .showmore').show();
			}
			if($img){
				var imgsrc = $img.data('src');
				$img.attr('src',imgsrc);
				$img.imagesLoaded().done(function(){
					$img.show();
				})
			}
		}
	}
})();
window.WALL = {
        init: function() { 
            if ($('a.video-item-box[name="videoPlayContainer"]').length > 0) {
                this.initVideoBox();
                this.initVideoButton();
            }
        },
		initVideoBox: function(videoType, videoRatio, videoURL, videoWebmURL, videoOggURL) {
            var videoHTML;
            if (videoType == 'embed') {
                videoHTML = '<video id="div_video" class="video-js vjs-default-skin vjs-big-play-centered" controls autoplay="false" preload="auto" width="100%"><source src="' + videoURL + '" type="video/mp4" /><source src="' + videoWebmURL + '" type="video/webm" /><source src="' + videoOggURL + '" type="video/ogg" /></video>';
            } else if (videoType == 'youtube') {
                videoHTML = '<div class="embed-responsive embed-responsive-' + videoRatio + '"><iframe class="embed-responsive-item"  src="https://www.youtube.com/embed/' + videoURL + '?rel=0&amp;autoplay=1&amp;showinfo=0&amp;loop=1&amp;playlist='+videoRatio+'" allowfullscreen></iframe></div>';
            } else if (videoType == 'youku') {
                videoHTML = '<div class="embed-responsive embed-responsive-' + videoRatio + '"><iframe src="http://player.youku.com/embed/' + videoURL + '" allowfullscreen></iframe></div>';
            }

            return videoHTML;
        },

        initVideoButton: function() {

            var videoPlayer = null;
            var isBlur = false;
            var isIE = true;

            if (BrowserDetect.init() == 'Chrome' || BrowserDetect.init() == 'Safari') {
                isIE = false;
            }

            $('a.video-item-box[name="videoPlayContainer"]').click(function() {
            	//ga code start
            	var videoURL=$(this).attr("data-video-source");
            	window.dataLayer.push({"event": "video","videoStep":"play","videoURL":videoURL})
            	//ga code end
                if (WALL.checkScreen() == 'x-small' || isIE == true) {
                    isBlur = false;
                } else {
                    isBlur = true;
                }

                if (isBlur != false) {
                }

                $('.honor-wall-component #video-dialog').modal('show');

                if ($(this).data('video-type') != 'embed') {
                	var temp = WALL.initVideoBox($(this).data('video-type'), $(this).data('ratio'), $(this).data('video-source'));
                	setTimeout(function(){
                		$('.honor-wall-component #video-dialog').find('.video-content').empty().html(temp);
                	},500)
                	
                } else {
                	var temp = WALL.initVideoBox($(this).data('video-type'), $(this).data('ratio'), $(this).data('video-source-mp4'), $(this).data('video-source-webm'), $(this).data('video-source-ogg'));
                	setTimeout(function(){
                	   $('.honor-wall-component #video-dialog').find('.video-content').empty().html(temp);
                	},500)
                }

                return false;
            });

            $('.honor-wall-component #video-dialog .close-video-btn').click(function() {
            	
            	try{
    				if (videoPlayer != null) {
    					videoPlayer.dispose();
    				}
    			}catch(e){}finally{
    				$('.honor-wall-component #video-dialog').find('.video-content').empty();
    			}
    			
                $('.honor-wall-component #video-dialog').modal('hide');

                return false;
            });

            $('.honor-wall-component #video-dialog').on('shown.bs.modal', function(e) {
                if (videoPlayer != null) {
                    $('#div_video').css('height', $('.honor-wall-component #video-dialog .modal-body').height());
                }
                if (!isBlur) {
                    $('.modal-backdrop').css({
                        'background-color': '#000'
                    });
                }
            });
            $('.honor-wall-component #video-dialog').on('hidden.bs.modal', function(e) {
                if (videoPlayer != null) {
                    videoPlayer.dispose();
                }
                $('.honor-wall-component #video-dialog').find('.video-content').empty();

                if (isBlur) {
                   // $('#main, #sideNav, header, footer').foggy(false);
                } else {
                    $('.modal-backdrop').css({
                        'background-color': 'transparent'
                    });
                }
            });

            $(window).bind('resizeEnd', function() {
                if (videoPlayer != null) {
                    $('#div_video').css('height', $('.honor-wall-component #video-dialog .modal-body').height());
                }
            });
        },
        checkScreen: function() {
            if ($('.visible-xs').css('display') == 'block') {
                return 'x-small';
            } else if ($('.visible-sm').css('display') == 'block') {
                return 'small';
            } else if ($('.visible-md').css('display') == 'block') {
                return 'medium';
            } else if ($('.visible-lg').css('display') == 'block') {
                return 'large';
            }
        }
    }

var BrowserDetect = window.BrowserDetect || {};

BrowserDetect.init = function(){
        this.browser = this.searchString(this.dataBrowser) || "Other";
        this.version = this.searchVersion(navigator.userAgent) || this.searchVersion(navigator.appVersion) || "Unknown";
        return this.browser;
};

BrowserDetect.searchString = function(data){
        for (var i = 0; i < data.length; i++) {
            var dataString = data[i].string;
            this.versionSearchString = data[i].subString;
            if (dataString.indexOf(data[i].subString) != -1) {
                return data[i].identity;
            }
        }
};

BrowserDetect.searchVersion = function(dataString){
        var index = dataString.indexOf(this.versionSearchString);
        if (index == -1) return;
        return parseFloat(dataString.substring(index + this.versionSearchString.length + 1));
};

BrowserDetect.dataBrowser = [{
        string: navigator.userAgent
        , subString: "Chrome"
        , identity: "Chrome"
    }, {
        string: navigator.userAgent
        , subString: "MSIE"
        , identity: "Explorer"
    }, {
        string: navigator.userAgent
        , subString: "Firefox"
        , identity: "Firefox"
    }, {
        string: navigator.userAgent
        , subString: "Safari"
        , identity: "Safari"
    }, {
        string: navigator.userAgent
        , subString: "Opera"
        , identity: "Opera"
    }];

(function($){
	//懒加载
	$(".wall-box img.swiper-lazy").lazyload({
		placeholder:lazyload.placeholder,
		failure_limit : 20
	});
})(jQuery);

(function(){
    WALL.init();
    
    if($('.honor-wall-component').length>0){
    	$('.item-box h2').each(function(){
    		var label =$(this).attr('label');
    		var pageW = utils.pageWidth();
    		if(label && pageW<769){
    			$(this).css('background','rgba(0, 178, 230, 0.8)')
    		}
    	})
    }
    
})();
(function() {
	$(document).ready(function () {
			//页面是否加载ourpartners组件
			if ($('.partners-box').length > 0) {
				var ww=$(window).width();
				//滚动执行方法
				var scrolltop = new Array();
			    var i = 0;
			    scrolltop[0] = 0;
			    if(ww > 768){
			    	$(".partners-box .swiper-wrapper .swiper-slide img").each(function(i, $this) {
			    	      var src = $($this).data('original');
			    	      $($this).attr("data-src", src);
			    	})
					$(document).scroll(function() {
						var DmpaClient=getDmpaClient();
						var sTop=$(window).scrollTop();
						var wHeight=$(window).height();
						var elMove = $(".partners-box").offset().top;
						//组件可视区域为true
						var isInView = elMove >= sTop && elMove < (sTop + wHeight);
						//即将进入组件可视区域为true
						var isInView2 = elMove >= sTop && elMove < (sTop + wHeight/2);
						var isInView3 = elMove >= sTop && elMove < (sTop + wHeight/1.2);
						i++
						scrolltop[i] = sTop;
						//滚动条向下滚动
						if (scrolltop[i] > scrolltop[i-1] && isInView3) {
							$(".partners-box .partners-title").animate({"top":"0px","opacity":"1"},1500);
						}
						if (scrolltop[i] > scrolltop[i-1] && isInView2) {
							$(".partners-box .partners-bg").stop().animate({"width":"100%"},1000);
							if($(".partners-swiper .swiper-slide").length > 1){
								partnerSwiper.autoplay.start();
							}
						}
						//滚动条向上滚动
						if (scrolltop[i] < scrolltop[i-1] && isInView2) {
							$(".partners-box .partners-bg").stop().animate({"left":"0px","width":"200%"},1000);
							if($(".partners-swiper .swiper-slide").length > 1){
								partnerSwiper.autoplay.stop();
							}
						}
					});
			    }else{
			    	$(".partners-box .swiper-wrapper .swiper-slide img").each(function(i, $this) {
			    	      var src = $($this).data('mb');
			    	      $($this).attr("data-src", src);
			    	})
			    }
			    
				//判断是否IE标题文字非渐变
				if(!!window.ActiveXObject || "ActiveXObject" in window){
					$(".partners-box .partners-title").css({"color":"#bd00fe","background-image":"none"});
				}
				if($(".partners-swiper .swiper-slide").length<=1){
					$('.partners-box img.swiper-lazy').show();
					$(".partners-box .swiper-lazy-preloader,.partners-box .bottom-box").hide();
					$(".partners-box .swiper-wrapper .swiper-slide img").each(function(i, $this) {
			    	      var src = $($this).data('original');
			    	      $($this).attr("src", src);
			    	})
				}else{
					var partnerSwiper = new Swiper ('.partners-swiper', {
						noSwiping:true,
						speed:1000,
						slidesPerView : 'auto',
					    pagination: {
					      el: '.swiper-pagination',
					      type: 'fraction',
					    },
					    navigation: {
					      nextEl: '.partners-box .honorFont-arr-right',
					      prevEl: '.partners-box .honorFont-arr-left',
					    },
					    lazy: {
					        loadPrevNext: true,
					    },
				        loop: true,
				        on: {
				            lazyImageReady: function(slideEl, imageEl) {
				              $(slideEl).find('img.swiper-lazy').show();
				            }
				        }
					 });
				}
			};
	});
})();
(function(){
	//联想词过滤的数据查询
    var selectSiteCode = honorConfig.siteCode;
	var wordUrl = utils.getSuitedUrl("/" + selectSiteCode.toLowerCase() + "/legal/privacy-questions/search/associativeWords.json");
	var productList;
	
if($('#search-result').length>0){
	
	var SUPPORT_URL = utils.getSuitedUrl($("#searchResultUrl").val());
	if(utils.isAuthor()){
		SUPPORT_URL +='&';
    }else{
    	SUPPORT_URL +='?';
    }
	var CORRECT_TEXT = $("#correctKeywords").val();
	var ERROR_TEXT = $("#errorKeywords").val();
	var searchAPIUrl=$("#vsearchAPIUrl").val();
	var lastkey = ""
	var k = ""
	var nowPage = "1"
	var lmtxt = $(".result_model .learn-v3").text();
	var site = honorConfig.siteCode;
	//var pre_url = "//consumer.huawei.com/support/services/service/";
	var pre_url = searchAPIUrl;
	
	$(document).ready(function () {
		var kwords = utils.getRequest().keyword;

		if(!kwords){
	        $(".search-input input").val("");
	    }else{
	    	if(kwords.length > 1){
	    		k = kwords;
		        $(".search-input input").val(decodeURI(kwords));
		        getSearchData(0, kwords, 1);
	    	}
	    }
	})

	window.onload = function () {
	    setHotKeys();
	}


	$(document).on('click', ".tabs-tit li", function () {
	    if (!k) return
	    var index = $(".tabs-tit li").index($(this))
	    var $reslut = $("#search-result .tabs-con .result-list").eq(index);
	    $(".result-list").hide()
	    if ($(this).find("a").hasClass("active")) {
	        return
	    } else {
	        $(this).siblings().find("a").removeClass("active")
	        $(this).find("a").addClass("active")
	        if ($reslut.find(".text-result-list>li").length > 0) {
	            $("#search-result .no-reslut").hide()
	            $reslut.show();
	            $('#search-result .tabs-con').show();
	        } else {
	            getSearchData(index, k, 1)
	        }
	    }
	}).on("click", "#search-result .search-shade .icon-query", function () {
	    if ($(this).hasClass("icon-disabled")){return}
	    k = utils.stripscript($(this).siblings("input").val());
	    clearSearchResults(k);
	    getSearchData(0, k, 1);
	    //搜索GA统计
	    window.dataLayer.push({
	        "event": "uaEvent",
	        "eventCategory": "Site Search",
	        "eventAction": "submit",
	        "eventLabel": k
	    })
	}).on("click", "#search-result .search-input input", function () {
		var _top = $(".search-head .search-input").offset().top;
	    $('.search-masking').css({
	        "margin-top": _top
	    })
	    var key=utils.stripscript($(this).val());
	    if (key.length < 2) {
	    	$(".search-input-v3 .icon-query").addClass("icon-disabled")
	    } else {
	    	$(".search-input-v3 .icon-query").removeClass("icon-disabled")
	    }
	    $(this).parent().css("opacity", "0");
	    $('.search-shade').show().find('input').focus().val('').val($(this).val());
	    $('html').addClass('noscroll');
	    getHotWords();
	}).on("click", ".hot_word-v3 li>a", function () {
	    k = $(this).text();
	    clearSearchResults($(this).text())
	    getSearchData(0, k, 1);
	    //搜索GA统计
	    window.dataLayer.push({
	        "event": "uaEvent",
	        "eventCategory": "Site Search",
	        "eventAction": "click",
	        "eventLabel":"hotword "+k
	    })
	}).on("click", "#search-result .suggested-v3 li a", function () {
	    k = $(this).find("span").text();
	    clearSearchResults($(this).find("span").text())
	    getSearchData(0, k, 1)
	}).on("click", "#search-result .page-count-box i", function () {
	    var index = $("#search-result .tabs-con .result-list").index($(this).parent().parent())
	    scrollResults($(this), index)
	}).on("keyup", "#search-result .search-input-v3 input", function (event) {
	    event = event || window.event;
	    event.stopPropagation();
	    $('#search-result .search-input input').val($(this).val())
	    if (event.keyCode == '13') {
	        var key = utils.stripscript($(this).val());
	        if (key.length > 1) {
	            k = key;
	            clearSearchResults(k)
	            getSearchData(0, k, 1)
	            //搜索GA统计
			    window.dataLayer.push({
			        "event": "uaEvent",
			        "eventCategory": "Site Search",
			        "eventAction": "submit",
			        "eventLabel": key
			    })
	        } else {
	            $(".hot_word-v3,.suggested-v3").hide()
	            $('#search-result .search-toast').fadeIn('slow', function () {
	                setTimeout(function () {
	                    $('.search-toast').fadeOut('slow');
	                }, 1000)
	            });
	        }
	    } else {
	        searchPageAssociated($(this))
	    }
	}).on('click', '.search-shade', function (event) {
	    event = event || window.event;
	    event.stopPropagation();
	    if (event.target == this) {
	        $('#search-result .search-input').css("opacity", "1")
	        $(this).hide();
	        $('html').removeClass('noscroll');
	    }
	}).on('click', ' #correct .correct-keywords', function () {
	    k = $(this).find('b').text();
	    $('.search-input input').val(k)
	    getSearchData(0, k, 1)
	})
	var searchAPIUrl=$("#vsearchAPIUrl").val();
	var searchCurrPath = location.href;
	var searchEndPath ='';
	if(searchCurrPath.indexOf('.html')!=-1){
		//预览环境
		searchEndPath ='/content/honor/'+digitalData.page.pageInfo.siteCode2+'/search.html?wcmmode=disabled&keyword=';
	}else{
		//发布环境
		searchEndPath ='/'+digitalData.page.pageInfo.siteCode2+'/search/?keyword=';
	}
	searchEndPath=utils.getSuitedUrl(searchEndPath);
	/** 接口：智能搜索获取热词 **/
	function getHotWords() {
				var getHotWords=searchAPIUrl+"vofficial/hot";
					$.ajax({
			    		  url: getHotWords,
			    		  type: "GET",
			    		  data: {
			    			  "qAppName": "HonorOfficial",
			    			  "language": honorConfig.searchLang,
			    			  "site": honorConfig.siteCode
			    		  },
			    		  dataType: "jsonp",
			    		  jsonp: "jsonp",
			    		  success: function(info) {
			    			  if (info.length>0) {
			    				  var hotstr = '';
			    				  for (i = 0; i < info.length; i++) {
			    						  hotstr += '<li><a href='+searchEndPath+encodeURI(info[i].key)+'>' + info[i].key + '</a></li>';
			    				  }
			    				  
			    				  $(".hot_word-v3 ul").empty().html(hotstr);
			    			  } else {
			    				  console.log('热词查询异常');
			    			  }
			    		  },
			    		  error: function(err) {
			    			  console.log(err);
			    		  }
			    	  })
	}
	
	// 设置热词
	function setHotKeys() {
	    var $cl = $("#header-v3 #search_area .hot_word ul").clone()
	    $(".hot_word-v3").append($cl).find("a").attr("href", "javascript:;")
	}


	// 搜索
	function getSearchData(index, key, curpage) {
	    var $s = $(".tabs-tit li>a");
	    nowPage = curpage;
	    $s.removeClass("active").eq(index).addClass("active")
	    if (index == 1) {
	        searchSupport(key, curpage, index)
	    } else {
	        searchProductOrPress(index, key, curpage)
	    }
	}

	// 搜索产品或新闻
	function searchProductOrPress(index, key, curpage) {
		var docCategory ='';
	    if (index == 0) {
	        docCategory = "consumer_product,support_product"
	        showCorrectKey(key)
	        setTopProducts(key)
	    } else {
	        docCategory = "consumer_press"
	    }
	    var _obj = {
	        q: utils.stripscript(key),
	        qAppName: "HonorOfficial",
	        language: getSiteLanguage(),
	        site: honorConfig.siteCode,
	        pageNo: curpage,
	        pageSize: "10",
	        docCategory: docCategory
	    }
	    $.ajax({
	        url: pre_url + "vofficial/crawler",
	        type: "GET",
	        data: _obj,
	        dataType: "jsonp",
	        jsonp: "jsonp",
	        success: function (data) {
	            addCcpcDmpaAnalytics("searchClick", "HonorOfficial", _obj, data, dmpa_sid);
	            var $count = $("#search-result .result-list").eq(index).find(".result-count");
	            if (data.hits.total == 0) {
	                $('#search-result .tabs-con').hide();
	                $('#search-result .no-reslut').show();
	            } else {
	                $('#search-result .no-reslut').hide();
	                $('#search-result .tabs-con').show();
	                $count.text($count.attr("txt").replace("{0}", data.hits.total)).show();
	                
	                setSearchList(data.hits.hits, index, data.sid, curpage)
	                setPages(data.hits.total, $("#search-result .result-list").eq(index).find(".page-count-box"))
	            }
	        }
	    })

	}

	// 搜索服务
	function searchSupport(key, curpage, index) {
	    var _data = {
	        q: utils.stripscript(key),
	        qAppName: "HonorServiceOfficial",
	        language: getSiteLanguage(),
	        site: honorConfig.siteCode,
	        applicable_region: honorConfig.countryCode,
	        pageNo: curpage,
	        pageSize: "10",
	       
	    }

	    $.ajax({
	        url: pre_url + "vofficial/search",
	        type: "GET",
	        data: _data,
	        dataType: "jsonp",
	        jsonp: "jsonp",
	        success: function (data) {
	            addCcpcDmpaAnalytics("searchClick", "HonorOfficial", _data, data, dmpa_sid);
	            var $count = $("#search-result .result-list").eq(index).find(".result-count")
	            if (data.hits.total == 0) {
	                $('#search-result .tabs-con').hide();
	                $('#search-result .no-reslut').show();
	            } else {
	                $('#search-result .no-reslut').hide();
	                $('#search-result .tabs-con').show();
	                $count.text($count.attr("txt").replace("{0}", data.hits.total)).show();
	                setSearchSupportList(data.hits.hits, index, data.sid, curpage)
	                setPages(data.hits.total, $("#search-result .result-list").eq(index).find(".page-count-box"))
	            }
	        }
	    })
	}

	// 设置推荐产品
	function setTopProducts(keys) {
	    $("#search-result .pic-result-list").hide()
	    $("#search-result .pic-result-list.search-top3").empty()
	    var recProdParams = {
	        q: utils.stripscript(keys),
	        language: getSiteLanguage(),
	        site: honorConfig.siteCode,
	        qAppName: "HonorOfficial",
	        docCategory: "consumer_product"
	    };
	    $.ajax({
	        url: pre_url + "vofficial/recProd",
	        type: "GET",
	        data: recProdParams,
	        dataType: "jsonp",
	        jsonp: "jsonp",
	        success: function (data) {             
	            if (data.relatedProds != null) {
	                for (var i = 0; i < data.relatedProds.length; i++) {
	                    var _li = "<li class='clearfix' onclick='trackCcpcSearchClick(\"" + dmpa_sid + "\",\"" + data.relatedProds[i].docId + "\", \"" + encodeURIComponent(data.relatedProds[i].dretitle) + "\" , \"" + i + "\", \"" + 1 + "\", \"product\", \"" + data.relatedProds[i].interventions + "\", \"HonorOfficial\")'>" +
	                        "<div class='left-con'>" +
	                        "<img src='" + data.relatedProds[i].docImage + "' alt='" + data.relatedProds[i].dretitle + "' title='" + data.relatedProds[i].dretitle + "'>" +
	                        "</div><div class='right-con'>" +
	                        "<h4 class='con-tit'><a href='" + data.relatedProds[i].docUrl + "'>" + data.relatedProds[i].dretitle + "</a></h4>" +
	                        "<p class='result-describe'>" + data.relatedProds[i].docDescription + "</p>" +
	                        "<div class='link-v3'><a class='learn-v3' href='" + utils.getSuitedUrl(data.relatedProds[i].docUrl) + "'>" + lmtxt + "</a><a class='bag-v3'>Add to Bag</a></div>" +
	                        "</div></li>";
	                    $("#search-result .pic-result-list.search-top3").append(_li).show()
	                }
	            }
	        }
	    })
	}
	
	// 设置产品与新闻搜索结果列表
	function setSearchList(datas, index, sid, pageNo) {
	    var $r = $("#search-result .tabs-con .result-list").hide();
	    var $u = $r.eq(index).show().find(".text-result-list").empty();
	    for (var i = 0; i < datas.length; i++) {
	        var _li = $($(".result_model").clone().html());
	        var _url = utils.getSuitedUrl(datas[i]._source.docUrl);
	        var _time = datas[i]._source.dredate.split(" ");
	        var _source = datas[i]._source;
	        _li.attr("sid", sid).attr("docId", _source.docId).attr("dretitle", _source.dretitle).attr("pageNo", pageNo).attr("index", i).attr("docCategory", _source.docCategory).attr("interventions", _source.interventions).addClass("vsearch-li");
	        _li.find(".press-time").text(utils.formatTime(_time[0]), honorConfig.siteCode);
	        _li.find(".con-tit a").append(datas[i].highlight.dretitle).attr('href', _url);
	        _li.find(".result-describe").append(datas[i].highlight.docDescription);
	        _li.find(".learn-v3").attr("href", _url);
	        $u.append(_li);
	    }
	    
	    $u.find(".vsearch-li").click(function () {
	        var sid = $(this).attr("sid");
	        var docId = $(this).attr("docId");
	        var dretitle = $(this).attr("dretitle");
	        var pageNo = $(this).attr("pageNo");
	        var docCategory = $(this).attr("docCategory");
	        var index = $(this).attr("index");
	        var interventions = $(this).attr("interventions");
	        trackCcpcSearchClick(sid, docId, dretitle, index, pageNo, docCategory == 'consumer_press' ? 'doc' : 'product', interventions, 'HonorOfficial');
	    })
	    //搜索结果GA统计
	   	var gauri = window.digitalData.page.pageInfo.uri;
	   	var searchKey = $("#search-result .search-head .search-input input").val();
	   	var totalNum;
	   	var type=$(".tabs-tit .a-common.active").attr("act");
	   	var searchType="";
	   	if(type){
	   		typeArr=type.split(" ");
	   	}
	   	if(typeArr){
		   	if(typeArr[2]=="Product"){
		   		totalNum = parseFloat($(".result-list").eq(0).children(".result-count").text());
		   	}else if(typeArr[2]=="Support"){
		   		totalNum = parseFloat($(".result-list").eq(1).children(".result-count").text());
		   	}else if(typeArr[2]=="Press"){
		   		totalNum = parseFloat($(".result-list").eq(2).children(".result-count").text());
		   	}else{
		   		totalNum = 0;
		   	}
		   	searchType=typeArr[2];
	   	}
	   	window.dataLayer.push({
	  		 "event":"virtualPageview",
	  		 "page": gauri,
	  		 "res55": totalNum,
	  		 "kw55": searchKey,
	  		 "cat55": searchType,
	  		 "loginStatus": honorData.loginStatus
	  	})
	    
	}
	// 设置服务搜索结果列表
	function setSearchSupportList(datas, index, sid, pageNo) {
		var $r = $("#search-result .tabs-con .result-list").hide()
	    var $u = $r.eq(index).show().find(".text-result-list").empty()
	    var attachmentUrl = $("#attachmentUrl").val() || "https://consumer-tkb.huawei.com/weknow/servlet/show/knowAttachmentServlet?knowId=";
		var softPath = $("#softPath").val() || "https://consumer-tkb.huawei.com/weknow/servlet/download/public?contextNo=";
	    for (var i = 0; i < datas.length; i++) {
	        var path = '';
	        var _source = datas[i]._source;
	        // 用户手册下载链接
	        //var attachment = "https://consumer-tkb.huawei.com/ccpgw/dsa/TKB/app_0000000000011227-CcpTKBKnowledge/ctkbknow/servlet/download/knowDownloadServlet?fileName=" + encodeURIComponent("\"" + _source.file_name + "\"") + "&path=" + _source.attachment
	        var attachment = attachmentUrl + datas[i]._id;
	        // 软件下载链接
	        var soft_path = softPath + datas[i]._id;
	        // 普通跳转链接
	        var _url = SUPPORT_URL + "resourceId=" + datas[i]._id
	        if (!_source.file_name) {
	            path = _url;
	        } else {
	            path = attachment
	            try {
	                if (_source.knowledge_type[0] == "4") {
	                    path = soft_path
	                }
	            } catch (error) {

	            }
	        }
	        var _li = $($(".result_model").clone().html());
	        var _time = datas[i]._source.create_date.split(" ");
	        _li.attr("sid", sid).attr("kowledgeId", datas[i]._id).attr("dretitle", datas[i].highlight.title[0]).attr("pageNo", pageNo).attr("index", i).attr("interventions", _source.interventions).addClass("vsearch-li");
	        _li.find(".press-time").text(utils.formatTime(_time[0], honorConfig.siteCode));
	        if(datas[i].highlight.title){
	        	_li.find(".con-tit a").append(datas[i].highlight.title[0]).attr('href', path);
	        }
	        if(datas[i].highlight.content){
	        	_li.find(".result-describe").append(datas[i].highlight.content[0]);
	        }
	        _li.find(".learn-v3").attr("href", path);
	        $u.append(_li)
	    }

	    $u.find(".vsearch-li").click(function () {
	        var sid = $(this).attr("sid");
	        var docId = $(this).attr("kowledgeId");
	        var dretitle = $(this).attr("dretitle");
	        var pageNo = $(this).attr("pageNo");
	        var index = $(this).attr("index");
	        var interventions = $(this).attr("interventions");
	        trackCcpcSearchClick(sid, docId, dretitle, index, pageNo, 'support', interventions, 'HonorOfficial');
	    })
	    //搜索结果GA统计
	   	var gauri = window.digitalData.page.pageInfo.uri;
	   	var searchKey = $("#search-result .search-head .search-input input").val();
	   	var totalNum;
	   	var type=$(".tabs-tit .a-common.active").attr("act");
	   	var searchType="";
	   	if(type){
	   		typeArr=type.split(" ");
	   	}
	   	if(typeArr){
		   	if(typeArr[2]=="Product"){
		   		totalNum = parseFloat($(".result-list").eq(0).children(".result-count").text());
		   	}else if(typeArr[2]=="Support"){
		   		totalNum = parseFloat($(".result-list").eq(1).children(".result-count").text());
		   	}else if(typeArr[2]=="Press"){
		   		totalNum = parseFloat($(".result-list").eq(2).children(".result-count").text());
		   	}else{
		   		totalNum = 0;
		   	}
		   	searchType=typeArr[2];
	   	}
	   	window.dataLayer.push({
	  		 "event":"virtualPageview",
	  		 "page": gauri,
	  		 "res55": totalNum,
	  		 "kw55": searchKey,
	  		 "cat55": searchType,
	  		 "loginStatus": honorData.loginStatus
	  	})
	}
	
	// 纠错
	function showCorrectKey(key) {
		key = encodeURIComponent(utils.stripscript(key));
	    $.ajax({
	        url: pre_url + "vofficial/correct",
	        type: "GET",
	        data: {
	            q: key,
	            site: honorConfig.siteCode,
	            language: getSiteLanguage(),
	            qAppName: "HonorOfficial"
	        },
	        dataType: "jsonp",
	        jsonp: "jsonp",
	        success: function (data) {
	            if (data != "") {
	                var searchKeyCon = ERROR_TEXT.replace("{key}", "<b>" + decodeURIComponent(key) + "</b>");
	                    var _k = data[0].key;
	                        _k = _k.replace(/[\u4e00-\u9fa5]+/g,"");
	                    if(_k.length == 0) {
	                        $('#correct').hide();
	                        return;
	                    }
	                var correctKeyCon = CORRECT_TEXT.replace("{key}", "<b>" + _k + "</b>");
	                $("#correct .search-keywords").html(searchKeyCon);
	                $("#correct .correct-keywords").html(correctKeyCon);
	                $("#correct").show();
	            } else {
	                $("#correct").hide()
	            }
	        }
	    })
	}


	function searchPageAssociated($obj) {
		if (productList == null)
		{
			$.ajax({
		  		  url: wordUrl,
		  		  type: "GET",
		  		  dataType: "json",
		  		  success: function(info) {
		  			  if (info != null && typeof(info) != undefined && Object.keys(info).length>0)
		  			  {
		  				  productList = info[0].title;
			  			  var key = $.trim($obj.val());
			  			  var $rs = $('.suggested-v3 ul').empty().scrollTop(0);
			  			  if (key.length < 2) {
			  			      $obj.siblings(".icon-query").addClass("icon-disabled")
			  			  } else {
			  			      $obj.siblings(".icon-query").removeClass("icon-disabled")
			  			  }
			  			  if (key.length > 1) {
			  			      $('.hot_word-v3').hide();
			  			  } else {
			  			      $('.hot_word-v3').show();
			  			  }
			  			    
	
			  				setSearchPageAssociated(key, productList, $rs);
		  			  }
		  			  else
		  			  {
		  				  console.log("info is null");
		  			  }
		  			  
		  			  
		  		  },
		  		  error: function(err) {
		  			  console.log(err);
		  		  }
		  	  })
		}
		else
		{
			var key = $.trim($obj.val());
			var $rs = $('.suggested-v3 ul').empty().scrollTop(0);
			if (key.length < 2) {
		        $obj.siblings(".icon-query").addClass("icon-disabled")
		    } else {
		        $obj.siblings(".icon-query").removeClass("icon-disabled")
		    }
		    if (key.length > 1) {
		        $('.hot_word-v3').hide();
		    } else {
		        $('.hot_word-v3').show();
		    }
		    

			setSearchPageAssociated(key, productList, $rs);
		}
		
		
	}
	function HeightKey(txt, key, tag) {
	    var str = txt;
	    var _keys = key;
	    var k_index = (str && _keys) ? str.toLowerCase().indexOf(_keys.toLowerCase()) : -1;
	    if (k_index > -1) {
	        if (k_index == 0) {
	            var str1 = "<" + tag + ">" + str.substring(0, _keys.length) + "</" + tag + ">"
	            var str2 = str.substring(_keys.length, str.length)
	            var str3 = ''
	        } else {
	            var str1 = str.substring(0, k_index)
	            var str2 = "<" + tag + ">" + str.substring(k_index, _keys.length + k_index) + "</" + tag + ">"
	            var str3 = str.substring(_keys.length + k_index, txt.length)
	        }
	        str = str1 + str2 + str3;
	    }
	    return str
	}
	function setSearchPageAssociated(key, productList, $obj) {
	    if (key.length > 0) {
	        var searchnum = parseInt($('.suggested_result').attr('search_num')-1);
	        var num = 0;
	        var lowerEndText = key.toLowerCase();
	        var productArr = productList.split(",");
	        for (var i = 0; i < productArr.length; i++) {
	            rl = HeightKey(productArr[i], key, "strong")
	            if (productArr[i].toLowerCase().indexOf(lowerEndText) != -1)
	            {
	                num++;
	            	$obj.append("<li><a href='javascript:;'><i class='icon_search'></i><span>" + rl + "</span></a></li>")
	                $obj.parent().prev().hide();
	            	$obj.parent().show();
	                if (num > searchnum) break
	            }
	        }
	        $obj.find("li").eq(0).addClass('default-pro')
	        $obj.find("li").length == 0 ? $('.suggested-v3').hide() : $obj.parent().show();
	    } else {
	    	$obj.parent().prev().show();
	        $(".suggested-v3").hide()
	    }
	}

	function setPages(counts, $obj) {
	    var pages = Math.ceil(counts / 10);
	    if (pages > 1) {
	        $obj.show().find(".current-page").text(nowPage)
	        $obj.find(".total-page").text(pages)
	        var mcCurPage = parseInt(nowPage)
	        mcCurPage == 1 ? $obj.find(".prev-page").addClass("icon-disabled") : $obj.find(".prev-page").removeClass("icon-disabled")
	        mcCurPage == pages ? $obj.find(".next-page").addClass("icon-disabled") : $obj.find(".next-page").removeClass("icon-disabled")
	    } else {
	        $obj.hide()
	    }
	}

	function scrollResults($obj, index) {
	    if ($obj.hasClass("icon-disabled")) {
	        return
	    } else {
	        var cpage = parseInt($obj.siblings(".page-count").find(".current-page").text()) + 1
	        if ($obj.hasClass("prev-page")) cpage = parseInt($obj.siblings(".page-count").find(".current-page").text()) - 1
	        getSearchData(index, k, cpage)
	        var $p = $obj.parent().siblings(".text-result-list")
	        var _top = 0 || parseInt($p.offset().top)
	        $(window).scrollTop(_top - 150)
	    }
	}

	function clearSearchResults(key) {
	    $('#search-result .search-input').css("opacity", "1")
	    lastkey = "";
	    $(".search-input input").val(key)
	    $(".search-input-v3 input").val("")
	    $(".result-count,.search-top3,.text-result-list,.page-count-box .page-count span").empty()
	    $('html').removeClass('noscroll');
	    $('.search-shade').hide();
	    
	    dmpa_sid = getDmpaSid();
	}
}
})();
(function() {
	$(function() {
	  var len = $(".featured-product-v2").length;
	  if (len > 0) {
	    //计算box 高度 实现文本垂直居中
	    var boxH = $(".featured-product-v2 .featured-box .com-item1 .item-box").outerHeight(true);
	    var ww = $(window).width();
	    var wh = $(window).height();
	    var smallRoundeSrc = "/etc/designs/honor-site/assets/round/small_circle.png";
	    var bigRoundeSrc = "/etc/designs/honor-site/assets/round/big_circle.png";
	    if (ww > 768) {
	      $(".featured-product-v2 .small-round img").attr("src", smallRoundeSrc);
	      $(".featured-product-v2 .big-round img").attr("src", bigRoundeSrc);
	    }
	    //圆圈动画
	    function ScollPostion() { //滚动条位置
	      var t, l, w, h;
	      if (document.documentElement && document.documentElement.scrollTop) {
	        t = document.documentElement.scrollTop;
	        l = document.documentElement.scrollLeft;
	        w = document.documentElement.scrollWidth;
	        h = document.documentElement.scrollHeight;
	      } else if (document.body) {
	        t = document.body.scrollTop;
	        l = document.body.scrollLeft;
	        w = document.body.scrollWidth;
	        h = document.body.scrollHeight;
	      }
	      return {
	        top: t,
	        left: l,
	        width: w,
	        height: h
	      };
	    }
	    var scrolltop = new Array();
	    var i = 0;
	    scrolltop[0] = 0;
	    var leftw=-219,leftw2=-480;
	    $(document).scroll(function() {
	      i++
	      //移动端图片进入可视区域 去掉遮罩
	      if(ww<=768){    
	    	  $(".featured-product-v2 .featured-box .com-item1 .item-box").each(function(i,el){
	    	    var elTop = $(el).offset().top;
	  	        var isInView = elTop >= $(window).scrollTop() && elTop < ($(window).scrollTop() + $(window).height()- $(window).height()/2);
	  	        if (isInView) {
	  	          $(el).children("a").children("div.main-box-bg").fadeOut();
	  	        }
	    	  })    
	    	    
	      }
	     
	      var elMove = $(".featured-product-v2").offset().top;
	      var isInView = elMove >= $(window).scrollTop() && elMove < ($(window).scrollTop() + $(window).height());
	      scrolltop[i] = $(document).scrollTop();    
	      //在可视区且是下滑圆圈进入
	      if (scrolltop[i] > scrolltop[i - 1] && isInView) {
	    	  leftw+=23.75;
	    	  if(leftw>46 || elMove >= $(window).scrollTop() && elMove < ($(window).scrollTop() + $(window).height()- $(window).height()/2)){
	    		  leftw=46;
	    	  }
	    	  $(".featured-product-v2  .small-round> img").css("left",leftw);    
	    	  leftw2+=13.9;
	    	  if(leftw2>-140 || elMove >= $(window).scrollTop() && elMove < ($(window).scrollTop() + $(window).height()- $(window).height()*2/3)){
	    		  leftw2=-140;
	    	  }
	        $(".featured-product-v2 .big-round >img").css("left",leftw2); 
	      }
	      if (scrolltop[i] < scrolltop[i - 1]) {
	    	  leftw-=39.75;
	    	  if(leftw<-219||!isInView){
	    		  leftw=-219; 
	    	  }
	    	  leftw2-=36.9;
	    	  if(leftw2<-480||!isInView){
	    		  leftw2=-480; 
	    	  }
	    	  $(".featured-product-v2  .small-round> img").css("left",leftw);
	    	  $(".featured-product-v2 .big-round >img").css("left",leftw2); 
	      }
	    })
	    
	      //点击跳转新窗口
	      $(".featured_swiper").on("click", ".swiper-slide", function() {
	        var url = $(this).find('a').attr('href');
	        var isBlank = $(this).find('a').attr('target');
	        if (url && isBlank) {
	          window.open(url);
	        } else if (url) {
	          window.location.href = url;
	        }
	      });
	    
	
	    if(ww>768){
	    	var arabicLength = $(".__arabic__").length;
	    	if(arabicLength > 0) {
	    		$(".featured-product-v2 .featured-box .com-item1 .item-box").hover(function(){
	     	    	$(this).find(".box-bg").css("transform","translate(16px,-16px)").css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
	     	    	$(this).find("img").css("transform","scale(1.11)").css("transition","transform 1s  0.1s cubic-bezier(.22, .89, .57, 1)");
	     	    }).mouseleave(function(){
	     	    	$(this).find(".box-bg").css("transform","translate(0,0)").css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
	     	    	$(this).find("img").css("transform","scale(1)").css("transition","transform  1.5s cubic-bezier(.22, .89, .57, 1)");
	     	    })
	    	} else {
	    		$(".featured-product-v2 .featured-box .com-item1 .item-box").hover(function(){
	     	    	$(this).find(".box-bg").css("transform","translate(-16px,-16px)").css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
	     	    	$(this).find("img").css("transform","scale(1.11)").css("transition","transform 1s  0.1s cubic-bezier(.22, .89, .57, 1)");
	     	    }).mouseleave(function(){
	     	    	$(this).find(".box-bg").css("transform","translate(0,0)").css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
	     	    	$(this).find("img").css("transform","scale(1)").css("transition","transform  1.5s cubic-bezier(.22, .89, .57, 1)");
	     	    })
	    	}
	    }
	   
	    if (ww <= 768) {
	      //移动端加载移动端的图
	      $(".featured-product-v2 .featured-box .com-item1 .item-box").each(function(i, el) {
	        var mbSrc = $(el).find(".product-img").children("img").attr("data-mb");
	        $(el).find(".product-img").children("img").attr("data-original", mbSrc);
	      })
	    }  
	    //懒加载
	    $(".featured-product-v2 .featured-box img.lazy").lazyload({
	    	"failure_limit":4,
	    	"placeholder":lazyload.placeholder
	    }).show().parent().removeClass('honor-loading-v2');
	    
	    
	    var homeproView=[];
	    
	    var proName1=$(".featured-product-v2 .featured-box .com-item1:eq(0) .item-box:eq(0) .product-img .img-info h2").text();
	    var proName2=$(".featured-product-v2 .featured-box .com-item1:eq(0) .item-box:eq(1) .product-img .img-info h2").text();
	    var proName3=$(".featured-product-v2 .featured-box .com-item1:eq(1) .item-box:eq(0) .product-img .img-info h2").text();
	    var proName4=$(".featured-product-v2 .featured-box .com-item1:eq(1) .item-box:eq(1) .product-img .img-info h2").text();
	    var proNameGrup=[proName1,proName2,proName3,proName4];
	    
	    $.each(proNameGrup, function(i, proName){
	    	var proPosition=i+1;
	    	var homeproItem={
	    			"listName": "featured product",
	    			"name": proName,
	    			"id": proName,
	    			"price": "",
	    			"brand": "HONOR",
	    			"category": "",
	    			"variant": "",
	    			"position": proPosition,
	    			"productAvailability":""
	    		};
	    	homeproView.push(homeproItem);
	    })
	    
	    window.dataLayer.push({
			"event": "eeListView",
			"loginStatus": honorData.loginStatus,
			"productAvailability": "",
			'products': homeproView
		})
	    //GA code
	    $("body").on("click",".featured-product-v2 .featured-box .com-item1 .item-box a",function(){
	    	var proName=$(this).find(".img-info h2").text();
	    	var proPosition;
	    	if($(this).parents(".com-item1").index()==0){
	    		proPosition=$(this).parent().index()+1;
	    	}else{
	    		proPosition=$(this).parent().index()+3;
	    	}
	    	window.dataLayer.push({
	         	"event": "eeListClick",
	         	"loginStatus": honorData.loginStatus,
	         	"productAvailability": "",
	         	'products': [{
	         	"listName": "featured product",
	         	"name": proName,
	         	"id": proName,
	         	"price": "",
	         	"brand": "HONOR",
	         	"category": "",
	         	"variant": "",
	         	"position": proPosition,
	         	"productAvailability":""
	         	}]
	     	})
	    })
	    // View All Products Button GA Code
	    $('.featured-product-v2 .featured-box .viewall').click(function(){
	    	var buttonName = $.trim($(this).text()) || '';
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Product List",
				"eventAction": "click",
				"eventLabel": buttonName
			})	
	    })
	  }
	});
})();
(function(){
	setTimeout(function(){
        var featured_swiper = new Swiper('.featured_swiper', {
            slidesPerView: 'auto',
            centeredSlides: true,
            spaceBetween: 10,
            initialSlide:0,
            loop : true, 
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
                type:'fraction',
            },
        });
    },100);

	$(function(){ 
		 //点击跳转新窗口
        $(".featured_swiper").on("click", ".swiper-slide", function(){
			var url = $(this).find('a').attr('href');
            var isBlank =  $(this).find('a').attr('target');

			if(url&&isBlank){
				window.open(url);
			}else if(url){
				window.location.href= url;
			}
		});
        //ga code start
        $("body").on("click",".featured-products .item-box a",function(){
       	 	var proName=$(this).children(".cont").children("h2").text();
    		var proCategory=$(this).parents(".featured-box").children("h2").children("span");
    		var proPosition;
    		if($(this).parents(".com-item1").hasClass("ab")){
    			proPosition=$(this).parent("div").index()+1;
    		}else{
    			proPosition=$(this).parent("div").index()+3;
    		}
    		
            window.dataLayer.push({
            	"event": "eeListClick",
            	"loginStatus": honorData.loginStatus,
            	"productAvailability": "",
            	'products': [{
            	"listName": "footer product list",
            	"name": proName,
            	"id": proName,
            	"price": "",
            	"brand": "Honor",
            	"category": proCategory,
            	"variant": "",
            	"position": proPosition,
            	"productAvailability":""
            	}]
            	})
       })
       //ga code end
	});

})();

/*! Video.js v4.12.7 Copyright 2014 Brightcove, Inc. https://github.com/videojs/video.js/blob/master/LICENSE */ 
(function() {var b=void 0,f=!0,j=null,l=!1;function m(){return function(){}}function n(a){return function(){return this[a]}}function q(a){return function(){return a}}var s;document.createElement("video");document.createElement("audio");document.createElement("track");
function t(a,c,d){if("string"===typeof a){0===a.indexOf("#")&&(a=a.slice(1));if(t.Aa[a])return c&&t.log.warn('Player "'+a+'" is already initialised. Options will not be applied.'),d&&t.Aa[a].I(d),t.Aa[a];a=t.m(a)}if(!a||!a.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return a.player||new t.Player(a,c,d)}var videojs=window.videojs=t;t.ic="4.12";t.vd="https:"==document.location.protocol?"https://":"http://";t.VERSION="4.12.7";
t.options={techOrder:["html5","flash"],html5:{},flash:{},width:300,height:150,defaultVolume:0,playbackRates:[],inactivityTimeout:2E3,children:{mediaLoader:{},posterImage:{},loadingSpinner:{},textTrackDisplay:{},bigPlayButton:{},controlBar:{},errorDisplay:{},textTrackSettings:{}},language:document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.If||navigator.language||"en",languages:{},notSupportedMessage:"No compatible source was found for this video."};
"GENERATED_CDN_VSN"!==t.ic&&(videojs.options.flash.swf=t.vd+"vjs.zencdn.net/"+t.ic+"/video-js.swf");t.Jd=function(a,c){t.options.languages[a]=t.options.languages[a]!==b?t.$.ya(t.options.languages[a],c):c;return t.options.languages};t.Aa={};"function"===typeof define&&define.amd?define("videojs",[],function(){return videojs}):"object"===typeof exports&&"object"===typeof module&&(module.exports=videojs);t.Ea=t.CoreObject=m();
t.Ea.extend=function(a){var c,d;a=a||{};c=a.init||a.l||this.prototype.init||this.prototype.l||m();d=function(){c.apply(this,arguments)};d.prototype=t.i.create(this.prototype);d.prototype.constructor=d;d.extend=t.Ea.extend;d.create=t.Ea.create;for(var e in a)a.hasOwnProperty(e)&&(d.prototype[e]=a[e]);return d};t.Ea.create=function(){var a=t.i.create(this.prototype);this.apply(a,arguments);return a};
t.b=function(a,c,d){if(t.i.isArray(c))return v(t.b,a,c,d);var e=t.getData(a);e.G||(e.G={});e.G[c]||(e.G[c]=[]);d.s||(d.s=t.s++);e.G[c].push(d);e.ca||(e.disabled=l,e.ca=function(c){if(!e.disabled){c=t.Pb(c);var d=e.G[c.type];if(d)for(var d=d.slice(0),k=0,p=d.length;k<p&&!c.Rc();k++)d[k].call(a,c)}});1==e.G[c].length&&(a.addEventListener?a.addEventListener(c,e.ca,l):a.attachEvent&&a.attachEvent("on"+c,e.ca))};
t.n=function(a,c,d){if(t.Mc(a)){var e=t.getData(a);if(e.G){if(t.i.isArray(c))return v(t.n,a,c,d);if(c){var g=e.G[c];if(g){if(d){if(d.s)for(e=0;e<g.length;e++)g[e].s===d.s&&g.splice(e--,1)}else e.G[c]=[];t.Ac(a,c)}}else for(g in e.G)c=g,e.G[c]=[],t.Ac(a,c)}}};t.Ac=function(a,c){var d=t.getData(a);0===d.G[c].length&&(delete d.G[c],a.removeEventListener?a.removeEventListener(c,d.ca,l):a.detachEvent&&a.detachEvent("on"+c,d.ca));t.ib(d.G)&&(delete d.G,delete d.ca,delete d.disabled);t.ib(d)&&t.cd(a)};
t.Pb=function(a){function c(){return f}function d(){return l}if(!a||!a.Vb){var e=a||window.event;a={};for(var g in e)"layerX"!==g&&("layerY"!==g&&"keyLocation"!==g)&&("returnValue"==g&&e.preventDefault||(a[g]=e[g]));a.target||(a.target=a.srcElement||document);a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement;a.preventDefault=function(){e.preventDefault&&e.preventDefault();a.returnValue=l;a.ie=c;a.defaultPrevented=f};a.ie=d;a.defaultPrevented=l;a.stopPropagation=function(){e.stopPropagation&&
e.stopPropagation();a.cancelBubble=f;a.Vb=c};a.Vb=d;a.stopImmediatePropagation=function(){e.stopImmediatePropagation&&e.stopImmediatePropagation();a.Rc=c;a.stopPropagation()};a.Rc=d;if(a.clientX!=j){g=document.documentElement;var h=document.body;a.pageX=a.clientX+(g&&g.scrollLeft||h&&h.scrollLeft||0)-(g&&g.clientLeft||h&&h.clientLeft||0);a.pageY=a.clientY+(g&&g.scrollTop||h&&h.scrollTop||0)-(g&&g.clientTop||h&&h.clientTop||0)}a.which=a.charCode||a.keyCode;a.button!=j&&(a.button=a.button&1?0:a.button&
4?1:a.button&2?2:0)}return a};t.o=function(a,c){var d=t.Mc(a)?t.getData(a):{},e=a.parentNode||a.ownerDocument;"string"===typeof c&&(c={type:c,target:a});c=t.Pb(c);d.ca&&d.ca.call(a,c);if(e&&!c.Vb()&&c.bubbles!==l)t.o(e,c);else if(!e&&!c.defaultPrevented&&(d=t.getData(c.target),c.target[c.type])){d.disabled=f;if("function"===typeof c.target[c.type])c.target[c.type]();d.disabled=l}return!c.defaultPrevented};
t.N=function(a,c,d){function e(){t.n(a,c,e);d.apply(this,arguments)}if(t.i.isArray(c))return v(t.N,a,c,d);e.s=d.s=d.s||t.s++;t.b(a,c,e)};function v(a,c,d,e){t.wc.forEach(d,function(d){a(c,d,e)})}var w=Object.prototype.hasOwnProperty;t.e=function(a,c){var d;c=c||{};d=document.createElement(a||"div");t.i.da(c,function(a,c){-1!==a.indexOf("aria-")||"role"==a?d.setAttribute(a,c):d[a]=c});return d};t.ua=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};t.i={};
t.i.create=Object.create||function(a){function c(){}c.prototype=a;return new c};t.i.da=function(a,c,d){for(var e in a)w.call(a,e)&&c.call(d||this,e,a[e])};t.i.D=function(a,c){if(!c)return a;for(var d in c)w.call(c,d)&&(a[d]=c[d]);return a};t.i.Rd=function(a,c){var d,e,g;a=t.i.copy(a);for(d in c)w.call(c,d)&&(e=a[d],g=c[d],a[d]=t.i.jb(e)&&t.i.jb(g)?t.i.Rd(e,g):c[d]);return a};t.i.copy=function(a){return t.i.D({},a)};
t.i.jb=function(a){return!!a&&"object"===typeof a&&"[object Object]"===a.toString()&&a.constructor===Object};t.i.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};t.ke=function(a){return a!==a};t.bind=function(a,c,d){function e(){return c.apply(a,arguments)}c.s||(c.s=t.s++);e.s=d?d+"_"+c.s:c.s;return e};t.ta={};t.s=1;t.expando="vdata"+(new Date).getTime();t.getData=function(a){var c=a[t.expando];c||(c=a[t.expando]=t.s++);t.ta[c]||(t.ta[c]={});return t.ta[c]};
t.Mc=function(a){a=a[t.expando];return!(!a||t.ib(t.ta[a]))};t.cd=function(a){var c=a[t.expando];if(c){delete t.ta[c];try{delete a[t.expando]}catch(d){a.removeAttribute?a.removeAttribute(t.expando):a[t.expando]=j}}};t.ib=function(a){for(var c in a)if(a[c]!==j)return l;return f};t.Oa=function(a,c){return-1!==(" "+a.className+" ").indexOf(" "+c+" ")};t.p=function(a,c){t.Oa(a,c)||(a.className=""===a.className?c:a.className+" "+c)};
t.r=function(a,c){var d,e;if(t.Oa(a,c)){d=a.className.split(" ");for(e=d.length-1;0<=e;e--)d[e]===c&&d.splice(e,1);a.className=d.join(" ")}};t.A=t.e("video");var x=document.createElement("track");x.Wb="captions";x.hd="en";x.label="English";t.A.appendChild(x);t.P=navigator.userAgent;t.Cd=/iPhone/i.test(t.P);t.Bd=/iPad/i.test(t.P);t.Dd=/iPod/i.test(t.P);t.Ad=t.Cd||t.Bd||t.Dd;var aa=t,y;var z=t.P.match(/OS (\d+)_/i);y=z&&z[1]?z[1]:b;aa.kf=y;t.zd=/Android/i.test(t.P);var ba=t,B;
var C=t.P.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),D,E;C?(D=C[1]&&parseFloat(C[1]),E=C[2]&&parseFloat(C[2]),B=D&&E?parseFloat(C[1]+"."+C[2]):D?D:j):B=j;ba.hc=B;t.Ed=t.zd&&/webkit/i.test(t.P)&&2.3>t.hc;t.jc=/Firefox/i.test(t.P);t.lf=/Chrome/i.test(t.P);t.oa=/MSIE\s8\.0/.test(t.P);t.Eb=!!("ontouchstart"in window||window.xd&&document instanceof window.xd);t.wd="backgroundSize"in t.A.style;
t.ed=function(a,c){t.i.da(c,function(c,e){e===j||"undefined"===typeof e||e===l?a.removeAttribute(c):a.setAttribute(c,e===f?"":e)})};t.Na=function(a){var c,d,e,g;c={};if(a&&a.attributes&&0<a.attributes.length){d=a.attributes;for(var h=d.length-1;0<=h;h--){e=d[h].name;g=d[h].value;if("boolean"===typeof a[e]||-1!==",autoplay,controls,loop,muted,default,".indexOf(","+e+","))g=g!==j?f:l;c[e]=g}}return c};
t.vf=function(a,c){var d="";document.defaultView&&document.defaultView.getComputedStyle?d=document.defaultView.getComputedStyle(a,"").getPropertyValue(c):a.currentStyle&&(d=a["client"+c.substr(0,1).toUpperCase()+c.substr(1)]+"px");return d};t.Ub=function(a,c){c.firstChild?c.insertBefore(a,c.firstChild):c.appendChild(a)};t.cb={};t.m=function(a){0===a.indexOf("#")&&(a=a.slice(1));return document.getElementById(a)};
t.Ma=function(a,c){c=c||a;var d=Math.floor(a%60),e=Math.floor(a/60%60),g=Math.floor(a/3600),h=Math.floor(c/60%60),k=Math.floor(c/3600);if(isNaN(a)||Infinity===a)g=e=d="-";g=0<g||0<k?g+":":"";return g+(((g||10<=h)&&10>e?"0"+e:e)+":")+(10>d?"0"+d:d)};t.Ld=function(){document.body.focus();document.onselectstart=q(l)};t.af=function(){document.onselectstart=q(f)};t.trim=function(a){return(a+"").replace(/^\s+|\s+$/g,"")};t.round=function(a,c){c||(c=0);return Math.round(a*Math.pow(10,c))/Math.pow(10,c)};
t.Lb=function(a,c){return{length:1,start:function(){return a},end:function(){return c}}};t.Me=function(a){try{var c=window.localStorage||l;c&&(c.volume=a)}catch(d){22==d.code||1014==d.code?t.log("LocalStorage Full (VideoJS)",d):18==d.code?t.log("LocalStorage not allowed (VideoJS)",d):t.log("LocalStorage Error (VideoJS)",d)}};t.$d=function(a){a.match(/^https?:\/\//)||(a=t.e("div",{innerHTML:'<a href="'+a+'">x</a>'}).firstChild.href);return a};
t.Ee=function(a){var c,d,e,g;g="protocol hostname port pathname search hash host".split(" ");d=t.e("a",{href:a});if(e=""===d.host&&"file:"!==d.protocol)c=t.e("div"),c.innerHTML='<a href="'+a+'"></a>',d=c.firstChild,c.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(c);a={};for(var h=0;h<g.length;h++)a[g[h]]=d[g[h]];"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,""));"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,""));e&&document.body.removeChild(c);return a};
function F(a,c){var d,e;d=Array.prototype.slice.call(c);e=m();e=window.console||{log:e,warn:e,error:e};a?d.unshift(a.toUpperCase()+":"):a="log";t.log.history.push(d);d.unshift("VIDEOJS:");if(e[a].apply)e[a].apply(e,d);else e[a](d.join(" "))}t.log=function(){F(j,arguments)};t.log.history=[];t.log.error=function(){F("error",arguments)};t.log.warn=function(){F("warn",arguments)};
t.Yd=function(a){var c,d;a.getBoundingClientRect&&a.parentNode&&(c=a.getBoundingClientRect());if(!c)return{left:0,top:0};a=document.documentElement;d=document.body;return{left:t.round(c.left+(window.pageXOffset||d.scrollLeft)-(a.clientLeft||d.clientLeft||0)),top:t.round(c.top+(window.pageYOffset||d.scrollTop)-(a.clientTop||d.clientTop||0))}};t.wc={};t.wc.forEach=function(a,c,d){if(t.i.isArray(a)&&c instanceof Function)for(var e=0,g=a.length;e<g;++e)c.call(d||t,a[e],e,a);return a};
t.ff=function(a,c){var d,e,g,h,k,p,r;"string"===typeof a&&(a={uri:a});videojs.$.ya({method:"GET",timeout:45E3},a);c=c||m();p=function(){window.clearTimeout(k);c(j,e,e.response||e.responseText)};r=function(a){window.clearTimeout(k);if(!a||"string"===typeof a)a=Error(a);c(a,e)};d=window.XMLHttpRequest;"undefined"===typeof d&&(d=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(c){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(d){}throw Error("This browser does not support XMLHttpRequest.");
});e=new d;e.uri=a.uri;d=t.Ee(a.uri);g=window.location;d.protocol+d.host!==g.protocol+g.host&&window.XDomainRequest&&!("withCredentials"in e)?(e=new window.XDomainRequest,e.onload=p,e.onerror=r,e.onprogress=m(),e.ontimeout=m()):(h="file:"==d.protocol||"file:"==g.protocol,e.onreadystatechange=function(){if(4===e.readyState){if(e.Ye)return r("timeout");200===e.status||h&&0===e.status?p():r()}},a.timeout&&(k=window.setTimeout(function(){4!==e.readyState&&(e.Ye=f,e.abort())},a.timeout)));try{e.open(a.method||
"GET",a.uri,f)}catch(u){r(u);return}a.withCredentials&&(e.withCredentials=f);a.responseType&&(e.responseType=a.responseType);try{e.send()}catch(A){r(A)}};t.$={};t.$.ya=function(a,c){var d,e,g;a=t.i.copy(a);for(d in c)c.hasOwnProperty(d)&&(e=a[d],g=c[d],a[d]=t.i.jb(e)&&t.i.jb(g)?t.$.ya(e,g):c[d]);return a};t.z=m();s=t.z.prototype;s.bb={};s.b=function(a,c){var d=this.addEventListener;this.addEventListener=Function.prototype;t.b(this,a,c);this.addEventListener=d};s.addEventListener=t.z.prototype.b;
s.n=function(a,c){t.n(this,a,c)};s.removeEventListener=t.z.prototype.n;s.N=function(a,c){t.N(this,a,c)};s.o=function(a){var c=a.type||a;"string"===typeof a&&(a={type:c});a=t.Pb(a);if(this.bb[c]&&this["on"+c])this["on"+c](a);t.o(this,a)};s.dispatchEvent=t.z.prototype.o;
t.a=t.Ea.extend({l:function(a,c,d){this.d=a;this.q=t.i.copy(this.q);c=this.options(c);this.Pa=c.id||c.el&&c.el.id;this.Pa||(this.Pa=(a.id&&a.id()||"no_player")+"_component_"+t.s++);this.te=c.name||j;this.c=c.el||this.e();this.R=[];this.fb={};this.gb={};this.Oc();this.I(d);if(c.dd!==l){var e,g;this.k().reportUserActivity&&(e=t.bind(this.k(),this.k().reportUserActivity),this.b("touchstart",function(){e();this.clearInterval(g);g=this.setInterval(e,250)}),a=function(){e();this.clearInterval(g)},this.b("touchmove",
e),this.b("touchend",a),this.b("touchcancel",a))}}});s=t.a.prototype;s.dispose=function(){this.o({type:"dispose",bubbles:l});if(this.R)for(var a=this.R.length-1;0<=a;a--)this.R[a].dispose&&this.R[a].dispose();this.gb=this.fb=this.R=j;this.n();this.c.parentNode&&this.c.parentNode.removeChild(this.c);t.cd(this.c);this.c=j};s.d=f;s.k=n("d");s.options=function(a){return a===b?this.q:this.q=t.$.ya(this.q,a)};s.e=function(a,c){return t.e(a,c)};
s.v=function(a){var c=this.d.language(),d=this.d.languages();return d&&d[c]&&d[c][a]?d[c][a]:a};s.m=n("c");s.va=function(){return this.B||this.c};s.id=n("Pa");s.name=n("te");s.children=n("R");s.ae=function(a){return this.fb[a]};s.ea=function(a){return this.gb[a]};
s.ba=function(a,c){var d,e;"string"===typeof a?(e=a,c=c||{},d=c.componentClass||t.ua(e),c.name=e,d=new window.videojs[d](this.d||this,c)):d=a;this.R.push(d);"function"===typeof d.id&&(this.fb[d.id()]=d);(e=e||d.name&&d.name())&&(this.gb[e]=d);"function"===typeof d.el&&d.el()&&this.va().appendChild(d.el());return d};
s.removeChild=function(a){"string"===typeof a&&(a=this.ea(a));if(a&&this.R){for(var c=l,d=this.R.length-1;0<=d;d--)if(this.R[d]===a){c=f;this.R.splice(d,1);break}c&&(this.fb[a.id()]=j,this.gb[a.name()]=j,(c=a.m())&&c.parentNode===this.va()&&this.va().removeChild(a.m()))}};
s.Oc=function(){var a,c,d,e,g,h;a=this;c=a.options();if(d=c.children)if(h=function(d,e){c[d]!==b&&(e=c[d]);e!==l&&(a[d]=a.ba(d,e))},t.i.isArray(d))for(var k=0;k<d.length;k++)e=d[k],"string"==typeof e?(g=e,e={}):g=e.name,h(g,e);else t.i.da(d,h)};s.V=q("");
s.b=function(a,c,d){var e,g,h;"string"===typeof a||t.i.isArray(a)?t.b(this.c,a,t.bind(this,c)):(e=t.bind(this,d),h=this,g=function(){h.n(a,c,e)},g.s=e.s,this.b("dispose",g),d=function(){h.n("dispose",g)},d.s=e.s,a.nodeName?(t.b(a,c,e),t.b(a,"dispose",d)):"function"===typeof a.b&&(a.b(c,e),a.b("dispose",d)));return this};
s.n=function(a,c,d){!a||"string"===typeof a||t.i.isArray(a)?t.n(this.c,a,c):(d=t.bind(this,d),this.n("dispose",d),a.nodeName?(t.n(a,c,d),t.n(a,"dispose",d)):(a.n(c,d),a.n("dispose",d)));return this};s.N=function(a,c,d){var e,g,h;"string"===typeof a||t.i.isArray(a)?t.N(this.c,a,t.bind(this,c)):(e=t.bind(this,d),g=this,h=function(){g.n(a,c,h);e.apply(this,arguments)},h.s=e.s,this.b(a,c,h));return this};s.o=function(a){t.o(this.c,a);return this};
s.I=function(a){a&&(this.wa?a.call(this):(this.nb===b&&(this.nb=[]),this.nb.push(a)));return this};s.Wa=function(){this.wa=f;var a=this.nb;if(a&&0<a.length){for(var c=0,d=a.length;c<d;c++)a[c].call(this);this.nb=[];this.o("ready")}};s.Oa=function(a){return t.Oa(this.c,a)};s.p=function(a){t.p(this.c,a);return this};s.r=function(a){t.r(this.c,a);return this};s.show=function(){this.r("vjs-hidden");return this};s.Y=function(){this.p("vjs-hidden");return this};function G(a){a.r("vjs-lock-showing")}
s.width=function(a,c){return ca(this,"width",a,c)};s.height=function(a,c){return ca(this,"height",a,c)};s.Td=function(a,c){return this.width(a,f).height(c)};function ca(a,c,d,e){if(d!==b){if(d===j||t.ke(d))d=0;a.c.style[c]=-1!==(""+d).indexOf("%")||-1!==(""+d).indexOf("px")?d:"auto"===d?"":d+"px";e||a.o("resize");return a}if(!a.c)return 0;d=a.c.style[c];e=d.indexOf("px");return-1!==e?parseInt(d.slice(0,e),10):parseInt(a.c["offset"+t.ua(c)],10)}
function da(a){var c,d,e,g,h,k,p,r;c=0;d=j;a.b("touchstart",function(a){1===a.touches.length&&(d=t.i.copy(a.touches[0]),c=(new Date).getTime(),g=f)});a.b("touchmove",function(a){1<a.touches.length?g=l:d&&(k=a.touches[0].pageX-d.pageX,p=a.touches[0].pageY-d.pageY,r=Math.sqrt(k*k+p*p),10<r&&(g=l))});h=function(){g=l};a.b("touchleave",h);a.b("touchcancel",h);a.b("touchend",function(a){d=j;g===f&&(e=(new Date).getTime()-c,200>e&&(a.preventDefault(),this.o("tap")))})}
s.setTimeout=function(a,c){function d(){this.clearTimeout(e)}a=t.bind(this,a);var e=setTimeout(a,c);d.s="vjs-timeout-"+e;this.b("dispose",d);return e};s.clearTimeout=function(a){function c(){}clearTimeout(a);c.s="vjs-timeout-"+a;this.n("dispose",c);return a};s.setInterval=function(a,c){function d(){this.clearInterval(e)}a=t.bind(this,a);var e=setInterval(a,c);d.s="vjs-interval-"+e;this.b("dispose",d);return e};
s.clearInterval=function(a){function c(){}clearInterval(a);c.s="vjs-interval-"+a;this.n("dispose",c);return a};t.w=t.a.extend({l:function(a,c){t.a.call(this,a,c);da(this);this.b("tap",this.u);this.b("click",this.u);this.b("focus",this.lb);this.b("blur",this.kb)}});s=t.w.prototype;
s.e=function(a,c){var d;c=t.i.D({className:this.V(),role:"button","aria-live":"polite",tabIndex:0},c);d=t.a.prototype.e.call(this,a,c);c.innerHTML||(this.B=t.e("div",{className:"vjs-control-content"}),this.Jb=t.e("span",{className:"vjs-control-text",innerHTML:this.v(this.sa)||"Need Text"}),this.B.appendChild(this.Jb),d.appendChild(this.B));return d};s.V=function(){return"vjs-control "+t.a.prototype.V.call(this)};s.u=m();s.lb=function(){t.b(document,"keydown",t.bind(this,this.ka))};
s.ka=function(a){if(32==a.which||13==a.which)a.preventDefault(),this.u()};s.kb=function(){t.n(document,"keydown",t.bind(this,this.ka))};t.U=t.a.extend({l:function(a,c){t.a.call(this,a,c);this.Kd=this.ea(this.q.barName);this.handle=this.ea(this.q.handleName);this.b("mousedown",this.mb);this.b("touchstart",this.mb);this.b("focus",this.lb);this.b("blur",this.kb);this.b("click",this.u);this.b(a,"controlsvisible",this.update);this.b(a,this.Yc,this.update)}});s=t.U.prototype;
s.e=function(a,c){c=c||{};c.className+=" vjs-slider";c=t.i.D({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},c);return t.a.prototype.e.call(this,a,c)};s.mb=function(a){a.preventDefault();t.Ld();this.p("vjs-sliding");this.b(document,"mousemove",this.la);this.b(document,"mouseup",this.za);this.b(document,"touchmove",this.la);this.b(document,"touchend",this.za);this.la(a)};s.la=m();
s.za=function(){t.af();this.r("vjs-sliding");this.n(document,"mousemove",this.la);this.n(document,"mouseup",this.za);this.n(document,"touchmove",this.la);this.n(document,"touchend",this.za);this.update()};s.update=function(){if(this.c){var a,c=this.Sb(),d=this.handle,e=this.Kd;if("number"!==typeof c||c!==c||0>c||Infinity===c)c=0;a=c;if(d){a=this.c.offsetWidth;var g=d.m().offsetWidth;a=g?g/a:0;c*=1-a;a=c+a/2;d.m().style.left=t.round(100*c,2)+"%"}e&&(e.m().style.width=t.round(100*a,2)+"%")}};
function ea(a,c){var d,e,g,h;d=a.c;e=t.Yd(d);h=g=d.offsetWidth;d=a.handle;if(a.options().vertical)return h=e.top,e=c.changedTouches?c.changedTouches[0].pageY:c.pageY,d&&(d=d.m().offsetHeight,h+=d/2,g-=d),Math.max(0,Math.min(1,(h-e+g)/g));g=e.left;e=c.changedTouches?c.changedTouches[0].pageX:c.pageX;d&&(d=d.m().offsetWidth,g+=d/2,h-=d);return Math.max(0,Math.min(1,(e-g)/h))}s.lb=function(){this.b(document,"keydown",this.ka)};
s.ka=function(a){if(37==a.which||40==a.which)a.preventDefault(),this.jd();else if(38==a.which||39==a.which)a.preventDefault(),this.kd()};s.kb=function(){this.n(document,"keydown",this.ka)};s.u=function(a){a.stopImmediatePropagation();a.preventDefault()};t.ha=t.a.extend();t.ha.prototype.defaultValue=0;t.ha.prototype.e=function(a,c){c=c||{};c.className+=" vjs-slider-handle";c=t.i.D({innerHTML:'<span class="vjs-control-text">'+this.defaultValue+"</span>"},c);return t.a.prototype.e.call(this,"div",c)};
t.pa=t.a.extend();function fa(a,c){a.ba(c);c.b("click",t.bind(a,function(){G(this)}))}t.pa.prototype.e=function(){var a=this.options().Cc||"ul";this.B=t.e(a,{className:"vjs-menu-content"});a=t.a.prototype.e.call(this,"div",{append:this.B,className:"vjs-menu"});a.appendChild(this.B);t.b(a,"click",function(a){a.preventDefault();a.stopImmediatePropagation()});return a};t.M=t.w.extend({l:function(a,c){t.w.call(this,a,c);this.selected(c.selected)}});
t.M.prototype.e=function(a,c){return t.w.prototype.e.call(this,"li",t.i.D({className:"vjs-menu-item",innerHTML:this.v(this.q.label)},c))};t.M.prototype.u=function(){this.selected(f)};t.M.prototype.selected=function(a){a?(this.p("vjs-selected"),this.c.setAttribute("aria-selected",f)):(this.r("vjs-selected"),this.c.setAttribute("aria-selected",l))};
t.O=t.w.extend({l:function(a,c){t.w.call(this,a,c);this.update();this.b("keydown",this.ka);this.c.setAttribute("aria-haspopup",f);this.c.setAttribute("role","button")}});s=t.O.prototype;s.update=function(){var a=this.Ja();this.xa&&this.removeChild(this.xa);this.xa=a;this.ba(a);this.H&&0===this.H.length?this.Y():this.H&&1<this.H.length&&this.show()};s.Ha=l;
s.Ja=function(){var a=new t.pa(this.d);this.options().title&&a.va().appendChild(t.e("li",{className:"vjs-menu-title",innerHTML:t.ua(this.options().title),We:-1}));if(this.H=this.createItems())for(var c=0;c<this.H.length;c++)fa(a,this.H[c]);return a};s.Ia=m();s.V=function(){return this.className+" vjs-menu-button "+t.w.prototype.V.call(this)};s.lb=m();s.kb=m();s.u=function(){this.N("mouseout",t.bind(this,function(){G(this.xa);this.c.blur()}));this.Ha?H(this):ga(this)};
s.ka=function(a){32==a.which||13==a.which?(this.Ha?H(this):ga(this),a.preventDefault()):27==a.which&&(this.Ha&&H(this),a.preventDefault())};function ga(a){a.Ha=f;a.xa.p("vjs-lock-showing");a.c.setAttribute("aria-pressed",f);a.H&&0<a.H.length&&a.H[0].m().focus()}function H(a){a.Ha=l;G(a.xa);a.c.setAttribute("aria-pressed",l)}t.J=function(a){"number"===typeof a?this.code=a:"string"===typeof a?this.message=a:"object"===typeof a&&t.i.D(this,a);this.message||(this.message=t.J.Sd[this.code]||"")};
t.J.prototype.code=0;t.J.prototype.message="";t.J.prototype.status=j;t.J.hb="MEDIA_ERR_CUSTOM MEDIA_ERR_ABORTED MEDIA_ERR_NETWORK MEDIA_ERR_DECODE MEDIA_ERR_SRC_NOT_SUPPORTED MEDIA_ERR_ENCRYPTED".split(" ");
t.J.Sd={1:"You aborted the video playback",2:"A network error caused the video download to fail part-way.",3:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support.",4:"The video could not be loaded, either because the server or network failed or because the format is not supported.",5:"The video is encrypted and we do not have the keys to decrypt it."};for(var I=0;I<t.J.hb.length;I++)t.J[t.J.hb[I]]=I,t.J.prototype[t.J.hb[I]]=I;
var J,ha,K,L;
J=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")];
ha=J[0];for(L=0;L<J.length;L++)if(J[L][1]in document){K=J[L];break}if(K){t.cb.Rb={};for(L=0;L<K.length;L++)t.cb.Rb[ha[L]]=K[L]}
t.Player=t.a.extend({l:function(a,c,d){this.L=a;a.id=a.id||"vjs_video_"+t.s++;this.Xe=a&&t.Na(a);c=t.i.D(ia(a),c);this.Tc=c.language||t.options.language;this.ne=c.languages||t.options.languages;this.K={};this.Zc=c.poster||"";this.Kb=!!c.controls;a.controls=l;c.dd=l;ja(this,"audio"===this.L.nodeName.toLowerCase());t.a.call(this,this,c,d);this.controls()?this.p("vjs-controls-enabled"):this.p("vjs-controls-disabled");ja(this)&&this.p("vjs-audio");t.Aa[this.Pa]=this;c.plugins&&t.i.da(c.plugins,function(a,
c){this[a](c)},this);var e,g,h,k,p;e=t.bind(this,this.reportUserActivity);this.b("mousedown",function(){e();this.clearInterval(g);g=this.setInterval(e,250)});this.b("mousemove",function(a){if(a.screenX!=k||a.screenY!=p)k=a.screenX,p=a.screenY,e()});this.b("mouseup",function(){e();this.clearInterval(g)});this.b("keydown",e);this.b("keyup",e);this.setInterval(function(){if(this.Da){this.Da=l;this.userActive(f);this.clearTimeout(h);var a=this.options().inactivityTimeout;0<a&&(h=this.setTimeout(function(){this.Da||
this.userActive(l)},a))}},250)}});s=t.Player.prototype;s.language=function(a){if(a===b)return this.Tc;this.Tc=a;return this};s.languages=n("ne");s.q=t.options;s.dispose=function(){this.o("dispose");this.n("dispose");t.Aa[this.Pa]=j;this.L&&this.L.player&&(this.L.player=j);this.c&&this.c.player&&(this.c.player=j);this.h&&this.h.dispose();t.a.prototype.dispose.call(this)};
function ia(a){var c,d,e={sources:[],tracks:[]};c=t.Na(a);d=c["data-setup"];d!==j&&t.i.D(c,t.JSON.parse(d||"{}"));t.i.D(e,c);if(a.hasChildNodes()){var g,h;a=a.childNodes;g=0;for(h=a.length;g<h;g++)c=a[g],d=c.nodeName.toLowerCase(),"source"===d?e.sources.push(t.Na(c)):"track"===d&&e.tracks.push(t.Na(c))}return e}
s.e=function(){var a=this.c=t.a.prototype.e.call(this,"div"),c=this.L,d;c.removeAttribute("width");c.removeAttribute("height");d=t.Na(c);t.i.da(d,function(c){"class"==c?a.className=d[c]:a.setAttribute(c,d[c])});c.id+="_html5_api";c.className="vjs-tech";c.player=a.player=this;this.p("vjs-paused");this.width(this.q.width,f);this.height(this.q.height,f);c.ge=c.networkState;c.parentNode&&c.parentNode.insertBefore(a,c);t.Ub(c,a);this.c=a;this.b("loadstart",this.xe);this.b("waiting",this.De);this.b(["canplay",
"canplaythrough","playing","ended"],this.Ce);this.b("seeking",this.Ae);this.b("seeked",this.ze);this.b("ended",this.ue);this.b("play",this.$b);this.b("firstplay",this.ve);this.b("pause",this.Zb);this.b("progress",this.ye);this.b("durationchange",this.Wc);this.b("fullscreenchange",this.we);return a};
function ka(a,c,d){a.h&&(a.wa=l,a.h.dispose(),a.h=l);"Html5"!==c&&a.L&&(t.f.Mb(a.L),a.L=j);a.Ua=c;a.wa=l;var e=t.i.D({source:d,parentEl:a.c},a.q[c.toLowerCase()]);d&&(a.Gc=d.type,d.src==a.K.src&&0<a.K.currentTime&&(e.startTime=a.K.currentTime),a.K.src=d.src);a.h=new window.videojs[c](a,e);a.h.I(function(){this.d.Wa()})}s.xe=function(){this.r("vjs-ended");this.error(j);this.paused()?la(this,l):this.o("firstplay")};s.Nc=l;
function la(a,c){c!==b&&a.Nc!==c&&((a.Nc=c)?(a.p("vjs-has-started"),a.o("firstplay")):a.r("vjs-has-started"))}s.$b=function(){this.r("vjs-ended");this.r("vjs-paused");this.p("vjs-playing");la(this,f)};s.De=function(){this.p("vjs-waiting")};s.Ce=function(){this.r("vjs-waiting")};s.Ae=function(){this.p("vjs-seeking")};s.ze=function(){this.r("vjs-seeking")};s.ve=function(){this.q.starttime&&this.currentTime(this.q.starttime);this.p("vjs-has-started")};s.Zb=function(){this.r("vjs-playing");this.p("vjs-paused")};
s.ye=function(){1==this.bufferedPercent()&&this.o("loadedalldata")};s.ue=function(){this.p("vjs-ended");this.q.loop?(this.currentTime(0),this.play()):this.paused()||this.pause()};s.Wc=function(){var a=M(this,"duration");a&&(0>a&&(a=Infinity),this.duration(a),Infinity===a?this.p("vjs-live"):this.r("vjs-live"))};s.we=function(){this.isFullscreen()?this.p("vjs-fullscreen"):this.r("vjs-fullscreen")};
function N(a,c,d){if(a.h&&!a.h.wa)a.h.I(function(){this[c](d)});else try{a.h[c](d)}catch(e){throw t.log(e),e;}}function M(a,c){if(a.h&&a.h.wa)try{return a.h[c]()}catch(d){throw a.h[c]===b?t.log("Video.js: "+c+" method not defined for "+a.Ua+" playback technology.",d):"TypeError"==d.name?(t.log("Video.js: "+c+" unavailable on "+a.Ua+" playback technology element.",d),a.h.wa=l):t.log(d),d;}}s.play=function(){N(this,"play");return this};s.pause=function(){N(this,"pause");return this};
s.paused=function(){return M(this,"paused")===l?l:f};s.currentTime=function(a){return a!==b?(N(this,"setCurrentTime",a),this):this.K.currentTime=M(this,"currentTime")||0};s.duration=function(a){if(a!==b)return this.K.duration=parseFloat(a),this;this.K.duration===b&&this.Wc();return this.K.duration||0};s.remainingTime=function(){return this.duration()-this.currentTime()};s.buffered=function(){var a=M(this,"buffered");if(!a||!a.length)a=t.Lb(0,0);return a};
s.bufferedPercent=function(){var a=this.duration(),c=this.buffered(),d=0,e,g;if(!a)return 0;for(var h=0;h<c.length;h++)e=c.start(h),g=c.end(h),g>a&&(g=a),d+=g-e;return d/a};s.volume=function(a){if(a!==b)return a=Math.max(0,Math.min(1,parseFloat(a))),this.K.volume=a,N(this,"setVolume",a),t.Me(a),this;a=parseFloat(M(this,"volume"));return isNaN(a)?1:a};s.muted=function(a){return a!==b?(N(this,"setMuted",a),this):M(this,"muted")||l};s.Ta=function(){return M(this,"supportsFullScreen")||l};s.Qc=l;
s.isFullscreen=function(a){return a!==b?(this.Qc=!!a,this):this.Qc};s.isFullScreen=function(a){t.log.warn('player.isFullScreen() has been deprecated, use player.isFullscreen() with a lowercase "s")');return this.isFullscreen(a)};
s.requestFullscreen=function(){var a=t.cb.Rb;this.isFullscreen(f);a?(t.b(document,a.fullscreenchange,t.bind(this,function(c){this.isFullscreen(document[a.fullscreenElement]);this.isFullscreen()===l&&t.n(document,a.fullscreenchange,arguments.callee);this.o("fullscreenchange")})),this.c[a.requestFullscreen]()):this.h.Ta()?N(this,"enterFullScreen"):(this.Jc(),this.o("fullscreenchange"));return this};
s.requestFullScreen=function(){t.log.warn('player.requestFullScreen() has been deprecated, use player.requestFullscreen() with a lowercase "s")');return this.requestFullscreen()};s.exitFullscreen=function(){var a=t.cb.Rb;this.isFullscreen(l);if(a)document[a.exitFullscreen]();else this.h.Ta()?N(this,"exitFullScreen"):(this.Nb(),this.o("fullscreenchange"));return this};s.cancelFullScreen=function(){t.log.warn("player.cancelFullScreen() has been deprecated, use player.exitFullscreen()");return this.exitFullscreen()};
s.Jc=function(){this.je=f;this.Ud=document.documentElement.style.overflow;t.b(document,"keydown",t.bind(this,this.Kc));document.documentElement.style.overflow="hidden";t.p(document.body,"vjs-full-window");this.o("enterFullWindow")};s.Kc=function(a){27===a.keyCode&&(this.isFullscreen()===f?this.exitFullscreen():this.Nb())};s.Nb=function(){this.je=l;t.n(document,"keydown",this.Kc);document.documentElement.style.overflow=this.Ud;t.r(document.body,"vjs-full-window");this.o("exitFullWindow")};
s.selectSource=function(a){for(var c=0,d=this.q.techOrder;c<d.length;c++){var e=t.ua(d[c]),g=window.videojs[e];if(g){if(g.isSupported())for(var h=0,k=a;h<k.length;h++){var p=k[h];if(g.canPlaySource(p))return{source:p,h:e}}}else t.log.error('The "'+e+'" tech is undefined. Skipped browser support check for that tech.')}return l};
s.src=function(a){if(a===b)return M(this,"src");t.i.isArray(a)?ma(this,a):"string"===typeof a?this.src({src:a}):a instanceof Object&&(a.type&&!window.videojs[this.Ua].canPlaySource(a)?ma(this,[a]):(this.K.src=a.src,this.Gc=a.type||"",this.I(function(){window.videojs[this.Ua].prototype.hasOwnProperty("setSource")?N(this,"setSource",a):N(this,"src",a.src);"auto"==this.q.preload&&this.load();this.q.autoplay&&this.play()})));return this};
function ma(a,c){var d=a.selectSource(c);d?d.h===a.Ua?a.src(d.source):ka(a,d.h,d.source):(a.setTimeout(function(){this.error({code:4,message:this.v(this.options().notSupportedMessage)})},0),a.Wa())}s.load=function(){N(this,"load");return this};s.currentSrc=function(){return M(this,"currentSrc")||this.K.src||""};s.Qd=function(){return this.Gc||""};s.Qa=function(a){return a!==b?(N(this,"setPreload",a),this.q.preload=a,this):M(this,"preload")};
s.autoplay=function(a){return a!==b?(N(this,"setAutoplay",a),this.q.autoplay=a,this):M(this,"autoplay")};s.loop=function(a){return a!==b?(N(this,"setLoop",a),this.q.loop=a,this):M(this,"loop")};s.poster=function(a){if(a===b)return this.Zc;a||(a="");this.Zc=a;N(this,"setPoster",a);this.o("posterchange");return this};
s.controls=function(a){return a!==b?(a=!!a,this.Kb!==a&&((this.Kb=a)?(this.r("vjs-controls-disabled"),this.p("vjs-controls-enabled"),this.o("controlsenabled")):(this.r("vjs-controls-enabled"),this.p("vjs-controls-disabled"),this.o("controlsdisabled"))),this):this.Kb};t.Player.prototype.ec;s=t.Player.prototype;
s.usingNativeControls=function(a){return a!==b?(a=!!a,this.ec!==a&&((this.ec=a)?(this.p("vjs-using-native-controls"),this.o("usingnativecontrols")):(this.r("vjs-using-native-controls"),this.o("usingcustomcontrols"))),this):this.ec};s.ja=j;s.error=function(a){if(a===b)return this.ja;if(a===j)return this.ja=a,this.r("vjs-error"),this;this.ja=a instanceof t.J?a:new t.J(a);this.o("error");this.p("vjs-error");t.log.error("(CODE:"+this.ja.code+" "+t.J.hb[this.ja.code]+")",this.ja.message,this.ja);return this};
s.ended=function(){return M(this,"ended")};s.seeking=function(){return M(this,"seeking")};s.Da=f;s.reportUserActivity=function(){this.Da=f};s.dc=f;s.userActive=function(a){return a!==b?(a=!!a,a!==this.dc&&((this.dc=a)?(this.Da=f,this.r("vjs-user-inactive"),this.p("vjs-user-active"),this.o("useractive")):(this.Da=l,this.h&&this.h.N("mousemove",function(a){a.stopPropagation();a.preventDefault()}),this.r("vjs-user-active"),this.p("vjs-user-inactive"),this.o("userinactive"))),this):this.dc};
s.playbackRate=function(a){return a!==b?(N(this,"setPlaybackRate",a),this):this.h&&this.h.featuresPlaybackRate?M(this,"playbackRate"):1};s.Pc=l;function ja(a,c){return c!==b?(a.Pc=!!c,a):a.Pc}s.networkState=function(){return M(this,"networkState")};s.readyState=function(){return M(this,"readyState")};s.textTracks=function(){return this.h&&this.h.textTracks()};s.Z=function(){return this.h&&this.h.remoteTextTracks()};s.addTextTrack=function(a,c,d){return this.h&&this.h.addTextTrack(a,c,d)};
s.ia=function(a){return this.h&&this.h.addRemoteTextTrack(a)};s.Ba=function(a){this.h&&this.h.removeRemoteTextTrack(a)};t.ub=t.a.extend();t.ub.prototype.q={wf:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},liveDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{},playbackRateMenuButton:{},subtitlesButton:{},captionsButton:{},chaptersButton:{}}};t.ub.prototype.e=function(){return t.e("div",{className:"vjs-control-bar"})};
t.kc=t.a.extend({l:function(a,c){t.a.call(this,a,c)}});t.kc.prototype.e=function(){var a=t.a.prototype.e.call(this,"div",{className:"vjs-live-controls vjs-control"});this.B=t.e("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.v("Stream Type")+"</span>"+this.v("LIVE"),"aria-live":"off"});a.appendChild(this.B);return a};t.nc=t.w.extend({l:function(a,c){t.w.call(this,a,c);this.b(a,"play",this.$b);this.b(a,"pause",this.Zb)}});s=t.nc.prototype;s.sa="Play";
s.V=function(){return"vjs-play-control "+t.w.prototype.V.call(this)};s.u=function(){this.d.paused()?this.d.play():this.d.pause()};s.$b=function(){this.r("vjs-paused");this.p("vjs-playing");this.c.children[0].children[0].innerHTML=this.v("Pause")};s.Zb=function(){this.r("vjs-playing");this.p("vjs-paused");this.c.children[0].children[0].innerHTML=this.v("Play")};t.vb=t.a.extend({l:function(a,c){t.a.call(this,a,c);this.b(a,"timeupdate",this.ga)}});
t.vb.prototype.e=function(){var a=t.a.prototype.e.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});this.B=t.e("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00',"aria-live":"off"});a.appendChild(this.B);return a};t.vb.prototype.ga=function(){var a=this.d.ob?this.d.K.currentTime:this.d.currentTime();this.B.innerHTML='<span class="vjs-control-text">'+this.v("Current Time")+"</span> "+t.Ma(a,this.d.duration())};
t.wb=t.a.extend({l:function(a,c){t.a.call(this,a,c);this.b(a,"timeupdate",this.ga);this.b(a,"loadedmetadata",this.ga)}});t.wb.prototype.e=function(){var a=t.a.prototype.e.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});this.B=t.e("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">'+this.v("Duration Time")+"</span> 0:00","aria-live":"off"});a.appendChild(this.B);return a};
t.wb.prototype.ga=function(){var a=this.d.duration();a&&(this.B.innerHTML='<span class="vjs-control-text">'+this.v("Duration Time")+"</span> "+t.Ma(a))};t.tc=t.a.extend({l:function(a,c){t.a.call(this,a,c)}});t.tc.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"})};t.Db=t.a.extend({l:function(a,c){t.a.call(this,a,c);this.b(a,"timeupdate",this.ga)}});
t.Db.prototype.e=function(){var a=t.a.prototype.e.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});this.B=t.e("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">'+this.v("Remaining Time")+"</span> -0:00","aria-live":"off"});a.appendChild(this.B);return a};t.Db.prototype.ga=function(){this.d.duration()&&(this.B.innerHTML='<span class="vjs-control-text">'+this.v("Remaining Time")+"</span> -"+t.Ma(this.d.remainingTime()))};
t.Za=t.w.extend({l:function(a,c){t.w.call(this,a,c)}});t.Za.prototype.sa="Fullscreen";t.Za.prototype.V=function(){return"vjs-fullscreen-control "+t.w.prototype.V.call(this)};t.Za.prototype.u=function(){this.d.isFullscreen()?(this.d.exitFullscreen(),this.Jb.innerHTML=this.v("Fullscreen")):(this.d.requestFullscreen(),this.Jb.innerHTML=this.v("Non-Fullscreen"))};t.Cb=t.a.extend({l:function(a,c){t.a.call(this,a,c)}});t.Cb.prototype.q={children:{seekBar:{}}};
t.Cb.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-progress-control vjs-control"})};t.qc=t.U.extend({l:function(a,c){t.U.call(this,a,c);this.b(a,"timeupdate",this.Ca);a.I(t.bind(this,this.Ca))}});s=t.qc.prototype;s.q={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"};s.Yc="timeupdate";s.e=function(){return t.U.prototype.e.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})};
s.Ca=function(){var a=this.d.ob?this.d.K.currentTime:this.d.currentTime();this.c.setAttribute("aria-valuenow",t.round(100*this.Sb(),2));this.c.setAttribute("aria-valuetext",t.Ma(a,this.d.duration()))};s.Sb=function(){return this.d.currentTime()/this.d.duration()};s.mb=function(a){t.U.prototype.mb.call(this,a);this.d.ob=f;this.d.p("vjs-scrubbing");this.df=!this.d.paused();this.d.pause()};s.la=function(a){a=ea(this,a)*this.d.duration();a==this.d.duration()&&(a-=0.1);this.d.currentTime(a)};
s.za=function(a){t.U.prototype.za.call(this,a);this.d.ob=l;this.d.r("vjs-scrubbing");this.df&&this.d.play()};s.kd=function(){this.d.currentTime(this.d.currentTime()+5)};s.jd=function(){this.d.currentTime(this.d.currentTime()-5)};t.zb=t.a.extend({l:function(a,c){t.a.call(this,a,c);this.b(a,"progress",this.update)}});t.zb.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.v("Loaded")+"</span>: 0%</span>"})};
t.zb.prototype.update=function(){var a,c,d,e,g=this.d.buffered();a=this.d.duration();var h,k=this.d;h=k.buffered();k=k.duration();h=h.end(h.length-1);h>k&&(h=k);k=this.c.children;this.c.style.width=100*(h/a||0)+"%";for(a=0;a<g.length;a++)c=g.start(a),d=g.end(a),(e=k[a])||(e=this.c.appendChild(t.e())),e.style.left=100*(c/h||0)+"%",e.style.width=100*((d-c)/h||0)+"%";for(a=k.length;a>g.length;a--)this.c.removeChild(k[a-1])};t.mc=t.a.extend({l:function(a,c){t.a.call(this,a,c)}});
t.mc.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.v("Progress")+"</span>: 0%</span>"})};t.$a=t.ha.extend({l:function(a,c){t.ha.call(this,a,c);this.b(a,"timeupdate",this.ga)}});t.$a.prototype.defaultValue="00:00";t.$a.prototype.e=function(){return t.ha.prototype.e.call(this,"div",{className:"vjs-seek-handle","aria-live":"off"})};
t.$a.prototype.ga=function(){var a=this.d.ob?this.d.K.currentTime:this.d.currentTime();this.c.innerHTML='<span class="vjs-control-text">'+t.Ma(a,this.d.duration())+"</span>"};t.Gb=t.a.extend({l:function(a,c){t.a.call(this,a,c);a.h&&a.h.featuresVolumeControl===l&&this.p("vjs-hidden");this.b(a,"loadstart",function(){a.h.featuresVolumeControl===l?this.p("vjs-hidden"):this.r("vjs-hidden")})}});t.Gb.prototype.q={children:{volumeBar:{}}};
t.Gb.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-volume-control vjs-control"})};t.Fb=t.U.extend({l:function(a,c){t.U.call(this,a,c);this.b(a,"volumechange",this.Ca);a.I(t.bind(this,this.Ca))}});s=t.Fb.prototype;s.Ca=function(){this.c.setAttribute("aria-valuenow",t.round(100*this.d.volume(),2));this.c.setAttribute("aria-valuetext",t.round(100*this.d.volume(),2)+"%")};s.q={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"};
s.Yc="volumechange";s.e=function(){return t.U.prototype.e.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})};s.la=function(a){this.d.muted()&&this.d.muted(l);this.d.volume(ea(this,a))};s.Sb=function(){return this.d.muted()?0:this.d.volume()};s.kd=function(){this.d.volume(this.d.volume()+0.1)};s.jd=function(){this.d.volume(this.d.volume()-0.1)};t.uc=t.a.extend({l:function(a,c){t.a.call(this,a,c)}});
t.uc.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})};t.Hb=t.ha.extend();t.Hb.prototype.defaultValue="00:00";t.Hb.prototype.e=function(){return t.ha.prototype.e.call(this,"div",{className:"vjs-volume-handle"})};
t.qa=t.w.extend({l:function(a,c){t.w.call(this,a,c);this.b(a,"volumechange",this.update);a.h&&a.h.featuresVolumeControl===l&&this.p("vjs-hidden");this.b(a,"loadstart",function(){a.h.featuresVolumeControl===l?this.p("vjs-hidden"):this.r("vjs-hidden")})}});t.qa.prototype.e=function(){return t.w.prototype.e.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.v("Mute")+"</span></div>"})};
t.qa.prototype.u=function(){this.d.muted(this.d.muted()?l:f)};t.qa.prototype.update=function(){var a=this.d.volume(),c=3;0===a||this.d.muted()?c=0:0.33>a?c=1:0.67>a&&(c=2);this.d.muted()?this.c.children[0].children[0].innerHTML!=this.v("Unmute")&&(this.c.children[0].children[0].innerHTML=this.v("Unmute")):this.c.children[0].children[0].innerHTML!=this.v("Mute")&&(this.c.children[0].children[0].innerHTML=this.v("Mute"));for(a=0;4>a;a++)t.r(this.c,"vjs-vol-"+a);t.p(this.c,"vjs-vol-"+c)};
t.Fa=t.O.extend({l:function(a,c){t.O.call(this,a,c);this.b(a,"volumechange",this.ef);a.h&&a.h.featuresVolumeControl===l&&this.p("vjs-hidden");this.b(a,"loadstart",function(){a.h.featuresVolumeControl===l?this.p("vjs-hidden"):this.r("vjs-hidden")});this.p("vjs-menu-button")}});t.Fa.prototype.Ja=function(){var a=new t.pa(this.d,{Cc:"div"}),c=new t.Fb(this.d,this.q.volumeBar);c.b("focus",function(){a.p("vjs-lock-showing")});c.b("blur",function(){G(a)});a.ba(c);return a};
t.Fa.prototype.u=function(){t.qa.prototype.u.call(this);t.O.prototype.u.call(this)};t.Fa.prototype.e=function(){return t.w.prototype.e.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">'+this.v("Mute")+"</span></div>"})};t.Fa.prototype.ef=t.qa.prototype.update;t.oc=t.O.extend({l:function(a,c){t.O.call(this,a,c);this.sd();this.rd();this.b(a,"loadstart",this.sd);this.b(a,"ratechange",this.rd)}});s=t.oc.prototype;s.sa="Playback Rate";
s.className="vjs-playback-rate";s.e=function(){var a=t.O.prototype.e.call(this);this.Sc=t.e("div",{className:"vjs-playback-rate-value",innerHTML:1});a.appendChild(this.Sc);return a};s.Ja=function(){var a=new t.pa(this.k()),c=this.k().options().playbackRates;if(c)for(var d=c.length-1;0<=d;d--)a.ba(new t.Bb(this.k(),{rate:c[d]+"x"}));return a};s.Ca=function(){this.m().setAttribute("aria-valuenow",this.k().playbackRate())};
s.u=function(){for(var a=this.k().playbackRate(),c=this.k().options().playbackRates,d=c[0],e=0;e<c.length;e++)if(c[e]>a){d=c[e];break}this.k().playbackRate(d)};function na(a){return a.k().h&&a.k().h.featuresPlaybackRate&&a.k().options().playbackRates&&0<a.k().options().playbackRates.length}s.sd=function(){na(this)?this.r("vjs-hidden"):this.p("vjs-hidden")};s.rd=function(){na(this)&&(this.Sc.innerHTML=this.k().playbackRate()+"x")};
t.Bb=t.M.extend({Cc:"button",l:function(a,c){var d=this.label=c.rate,e=this.$c=parseFloat(d,10);c.label=d;c.selected=1===e;t.M.call(this,a,c);this.b(a,"ratechange",this.update)}});t.Bb.prototype.u=function(){t.M.prototype.u.call(this);this.k().playbackRate(this.$c)};t.Bb.prototype.update=function(){this.selected(this.k().playbackRate()==this.$c)};t.pc=t.w.extend({l:function(a,c){t.w.call(this,a,c);this.update();a.b("posterchange",t.bind(this,this.update))}});s=t.pc.prototype;
s.dispose=function(){this.k().n("posterchange",this.update);t.w.prototype.dispose.call(this)};s.e=function(){var a=t.e("div",{className:"vjs-poster",tabIndex:-1});t.wd||(this.Ob=t.e("img"),a.appendChild(this.Ob));return a};s.update=function(){var a=this.k().poster();this.ma(a);a?this.show():this.Y()};s.ma=function(a){var c;this.Ob?this.Ob.src=a:(c="",a&&(c='url("'+a+'")'),this.c.style.backgroundImage=c)};s.u=function(){this.d.play()};t.lc=t.a.extend({l:function(a,c){t.a.call(this,a,c)}});
t.lc.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-loading-spinner"})};t.sb=t.w.extend();t.sb.prototype.e=function(){return t.w.prototype.e.call(this,"div",{className:"vjs-big-play-button",innerHTML:'<span aria-hidden="true"></span>',"aria-label":"play video"})};t.sb.prototype.u=function(){this.d.play()};t.xb=t.a.extend({l:function(a,c){t.a.call(this,a,c);this.update();this.b(a,"error",this.update)}});
t.xb.prototype.e=function(){var a=t.a.prototype.e.call(this,"div",{className:"vjs-error-display"});this.B=t.e("div");a.appendChild(this.B);return a};t.xb.prototype.update=function(){this.k().error()&&(this.B.innerHTML=this.v(this.k().error().message))};var O;t.j=t.a.extend({l:function(a,c,d){c=c||{};c.dd=l;t.a.call(this,a,c,d);this.featuresProgressEvents||this.re();this.featuresTimeupdateEvents||this.se();this.fe();this.featuresNativeTextTracks||this.Vd();this.he()}});s=t.j.prototype;
s.fe=function(){var a,c;a=this.k();c=function(){a.controls()&&!a.usingNativeControls()&&this.Id()};this.I(c);this.b(a,"controlsenabled",c);this.b(a,"controlsdisabled",this.He);this.I(function(){this.networkState&&0<this.networkState()&&this.k().o("loadstart")})};
s.Id=function(){var a;this.b("mousedown",this.u);this.b("touchstart",function(){a=this.d.userActive()});this.b("touchmove",function(){a&&this.k().reportUserActivity()});this.b("touchend",function(a){a.preventDefault()});da(this);this.b("tap",this.Be)};s.He=function(){this.n("tap");this.n("touchstart");this.n("touchmove");this.n("touchleave");this.n("touchcancel");this.n("touchend");this.n("click");this.n("mousedown")};
s.u=function(a){0===a.button&&this.k().controls()&&(this.k().paused()?this.k().play():this.k().pause())};s.Be=function(){this.k().userActive(!this.k().userActive())};s.re=function(){this.Uc=f;this.$e()};s.qe=function(){this.Uc=l;this.ld()};s.$e=function(){this.Ge=this.setInterval(function(){var a=this.k().bufferedPercent();this.Md!=a&&this.k().o("progress");this.Md=a;1===a&&this.ld()},500)};s.ld=function(){this.clearInterval(this.Ge)};
s.se=function(){var a=this.d;this.Yb=f;this.b(a,"play",this.pd);this.b(a,"pause",this.rb);this.N("timeupdate",function(){this.featuresTimeupdateEvents=f;this.Vc()})};s.Vc=function(){var a=this.d;this.Yb=l;this.rb();this.n(a,"play",this.pd);this.n(a,"pause",this.rb)};s.pd=function(){this.Fc&&this.rb();this.Fc=this.setInterval(function(){this.k().o("timeupdate")},250)};s.rb=function(){this.clearInterval(this.Fc);this.k().o("timeupdate")};s.dispose=function(){this.Uc&&this.qe();this.Yb&&this.Vc();t.a.prototype.dispose.call(this)};
s.bc=function(){this.Yb&&this.k().o("timeupdate")};s.he=function(){function a(){var a=c.ea("textTrackDisplay");a&&a.C()}var c=this.d,d;if(d=this.textTracks())d.addEventListener("removetrack",a),d.addEventListener("addtrack",a),this.b("dispose",t.bind(this,function(){d.removeEventListener("removetrack",a);d.removeEventListener("addtrack",a)}))};
s.Vd=function(){var a=this.d,c,d,e;window.WebVTT||(e=document.createElement("script"),e.src=a.options()["vtt.js"]||"../node_modules/vtt.js/dist/vtt.js",a.m().appendChild(e),window.WebVTT=f);if(d=this.textTracks())c=function(){var c,d,e;e=a.ea("textTrackDisplay");e.C();for(c=0;c<this.length;c++)d=this[c],d.removeEventListener("cuechange",t.bind(e,e.C)),"showing"===d.mode&&d.addEventListener("cuechange",t.bind(e,e.C))},d.addEventListener("change",c),this.b("dispose",t.bind(this,function(){d.removeEventListener("change",
c)}))};s.textTracks=function(){this.d.od=this.d.od||new t.F;return this.d.od};s.Z=function(){this.d.ad=this.d.ad||new t.F;return this.d.ad};O=function(a,c,d,e,g){var h=a.textTracks();g=g||{};g.kind=c;d&&(g.label=d);e&&(g.language=e);g.player=a.d;a=new t.t(g);P(h,a);return a};t.j.prototype.addTextTrack=function(a,c,d){if(!a)throw Error("TextTrack kind is required but was not provided");return O(this,a,c,d)};t.j.prototype.ia=function(a){a=O(this,a.kind,a.label,a.language,a);P(this.Z(),a);return{T:a}};
t.j.prototype.Ba=function(a){Q(this.textTracks(),a);Q(this.Z(),a)};t.j.prototype.fd=m();t.j.prototype.featuresVolumeControl=f;t.j.prototype.featuresFullscreenResize=l;t.j.prototype.featuresPlaybackRate=l;t.j.prototype.featuresProgressEvents=l;t.j.prototype.featuresTimeupdateEvents=l;t.j.prototype.featuresNativeTextTracks=l;
t.j.gc=function(a){a.Ra=function(c,d){var e=a.gd;e||(e=a.gd=[]);d===b&&(d=e.length);e.splice(d,0,c)};a.pb=function(c){for(var d=a.gd||[],e,g=0;g<d.length;g++)if(e=d[g].eb(c))return d[g];return j};a.zc=function(c){var d=a.pb(c);return d?d.eb(c):""};a.prototype.Sa=function(c){var d=a.pb(c);d||(a.S?d=a.S:t.log.error("No source hander found for the current source."));this.Ka();this.n("dispose",this.Ka);this.Ec=c;this.cc=d.Tb(c,this);this.b("dispose",this.Ka);return this};a.prototype.Ka=function(){this.cc&&
this.cc.dispose&&this.cc.dispose()}};t.media={};
t.f=t.j.extend({l:function(a,c,d){var e,g,h;if(c.nativeCaptions===l||c.nativeTextTracks===l)this.featuresNativeTextTracks=l;t.j.call(this,a,c,d);for(d=t.f.yb.length-1;0<=d;d--)this.b(t.f.yb[d],this.Wd);(c=c.source)&&(this.c.currentSrc!==c.src||a.L&&3===a.L.ge)&&this.Sa(c);if(this.c.hasChildNodes()){d=this.c.childNodes;e=d.length;for(c=[];e--;)g=d[e],h=g.nodeName.toLowerCase(),"track"===h&&(this.featuresNativeTextTracks?P(this.Z(),g.track):c.push(g));for(d=0;d<c.length;d++)this.c.removeChild(c[d])}this.featuresNativeTextTracks&&
this.b("loadstart",t.bind(this,this.ee));if(t.Eb&&a.options().nativeControlsForTouch===f){var k,p,r,u;k=this;p=this.k();c=p.controls();k.c.controls=!!c;r=function(){k.c.controls=f};u=function(){k.c.controls=l};p.b("controlsenabled",r);p.b("controlsdisabled",u);c=function(){p.n("controlsenabled",r);p.n("controlsdisabled",u)};k.b("dispose",c);p.b("usingcustomcontrols",c);p.usingNativeControls(f)}a.I(function(){this.src()&&(this.L&&this.q.autoplay&&this.paused())&&(delete this.L.poster,this.play())});
this.Wa()}});s=t.f.prototype;s.dispose=function(){t.f.Mb(this.c);t.j.prototype.dispose.call(this)};
s.e=function(){var a=this.d,c,d,e,g=a.L;if(!g||this.movingMediaElementInDOM===l){g?(e=g.cloneNode(l),t.f.Mb(g),g=e,a.L=j):(g=t.e("video"),e=videojs.$.ya({},a.Xe),(!t.Eb||a.options().nativeControlsForTouch!==f)&&delete e.controls,t.ed(g,t.i.D(e,{id:a.id()+"_html5_api","class":"vjs-tech"})));g.player=a;if(a.q.qd)for(e=0;e<a.q.qd.length;e++)c=a.q.qd[e],d=document.createElement("track"),d.Wb=c.Wb,d.label=c.label,d.hd=c.hd,d.src=c.src,"default"in c&&d.setAttribute("default","default"),g.appendChild(d);
t.Ub(g,a.m())}c=["autoplay","preload","loop","muted"];for(e=c.length-1;0<=e;e--){d=c[e];var h={};"undefined"!==typeof a.q[d]&&(h[d]=a.q[d]);t.ed(g,h)}return g};s.ee=function(){for(var a=this.c.querySelectorAll("track"),c,d=a.length,e={captions:1,subtitles:1};d--;)if((c=a[d].T)&&c.kind in e&&!a[d]["default"])c.mode="disabled"};s.Wd=function(a){"error"==a.type&&this.error()?this.k().error(this.error().code):(a.bubbles=l,this.k().o(a))};s.play=function(){this.c.play()};s.pause=function(){this.c.pause()};
s.paused=function(){return this.c.paused};s.currentTime=function(){return this.c.currentTime};s.bc=function(a){try{this.c.currentTime=a}catch(c){t.log(c,"Video is not ready. (Video.js)")}};s.duration=function(){return this.c.duration||0};s.buffered=function(){return this.c.buffered};s.volume=function(){return this.c.volume};s.Se=function(a){this.c.volume=a};s.muted=function(){return this.c.muted};s.Oe=function(a){this.c.muted=a};s.width=function(){return this.c.offsetWidth};s.height=function(){return this.c.offsetHeight};
s.Ta=function(){return"function"==typeof this.c.webkitEnterFullScreen&&(/Android/.test(t.P)||!/Chrome|Mac OS X 10.5/.test(t.P))?f:l};s.Ic=function(){var a=this.c;"webkitDisplayingFullscreen"in a&&this.N("webkitbeginfullscreen",function(){this.d.isFullscreen(f);this.N("webkitendfullscreen",function(){this.d.isFullscreen(l);this.d.o("fullscreenchange")});this.d.o("fullscreenchange")});a.paused&&a.networkState<=a.jf?(this.c.play(),this.setTimeout(function(){a.pause();a.webkitEnterFullScreen()},0)):a.webkitEnterFullScreen()};
s.Xd=function(){this.c.webkitExitFullScreen()};s.src=function(a){if(a===b)return this.c.src;this.ma(a)};s.ma=function(a){this.c.src=a};s.load=function(){this.c.load()};s.currentSrc=function(){return this.c.currentSrc};s.poster=function(){return this.c.poster};s.fd=function(a){this.c.poster=a};s.Qa=function(){return this.c.Qa};s.Qe=function(a){this.c.Qa=a};s.autoplay=function(){return this.c.autoplay};s.Le=function(a){this.c.autoplay=a};s.controls=function(){return this.c.controls};s.loop=function(){return this.c.loop};
s.Ne=function(a){this.c.loop=a};s.error=function(){return this.c.error};s.seeking=function(){return this.c.seeking};s.ended=function(){return this.c.ended};s.playbackRate=function(){return this.c.playbackRate};s.Pe=function(a){this.c.playbackRate=a};s.networkState=function(){return this.c.networkState};s.readyState=function(){return this.c.readyState};s.textTracks=function(){return!this.featuresNativeTextTracks?t.j.prototype.textTracks.call(this):this.c.textTracks};
s.addTextTrack=function(a,c,d){return!this.featuresNativeTextTracks?t.j.prototype.addTextTrack.call(this,a,c,d):this.c.addTextTrack(a,c,d)};
s.ia=function(a){if(!this.featuresNativeTextTracks)return t.j.prototype.ia.call(this,a);var c=document.createElement("track");a=a||{};a.kind&&(c.kind=a.kind);a.label&&(c.label=a.label);if(a.language||a.srclang)c.srclang=a.language||a.srclang;a["default"]&&(c["default"]=a["default"]);a.id&&(c.id=a.id);a.src&&(c.src=a.src);this.m().appendChild(c);c.track.mode="metadata"===c.T.kind?"hidden":"disabled";c.onload=function(){var a=c.track;2<=c.readyState&&("metadata"===a.kind&&"hidden"!==a.mode?a.mode="hidden":
"metadata"!==a.kind&&"disabled"!==a.mode&&(a.mode="disabled"),c.onload=j)};P(this.Z(),c.T);return c};s.Ba=function(a){if(!this.featuresNativeTextTracks)return t.j.prototype.Ba.call(this,a);var c,d;Q(this.Z(),a);c=this.m().querySelectorAll("track");for(d=0;d<c.length;d++)if(c[d]===a||c[d].track===a){c[d].parentNode.removeChild(c[d]);break}};t.f.isSupported=function(){try{t.A.volume=0.5}catch(a){return l}return!!t.A.canPlayType};t.j.gc(t.f);t.f.S={};
t.f.S.eb=function(a){function c(a){try{return t.A.canPlayType(a)}catch(c){return""}}return a.type?c(a.type):a.src?(a=(a=a.src.match(/\.([^.\/\?]+)(\?[^\/]+)?$/i))&&a[1],c("video/"+a)):""};t.f.S.Tb=function(a,c){c.ma(a.src)};t.f.S.dispose=m();t.f.Ra(t.f.S);t.f.Od=function(){var a=t.A.volume;t.A.volume=a/2+0.1;return a!==t.A.volume};t.f.Nd=function(){var a=t.A.playbackRate;t.A.playbackRate=a/2+0.1;return a!==t.A.playbackRate};
t.f.Ve=function(){var a;(a=!!t.A.textTracks)&&0<t.A.textTracks.length&&(a="number"!==typeof t.A.textTracks[0].mode);a&&t.jc&&(a=l);return a};t.f.prototype.featuresVolumeControl=t.f.Od();t.f.prototype.featuresPlaybackRate=t.f.Nd();t.f.prototype.movingMediaElementInDOM=!t.Ad;t.f.prototype.featuresFullscreenResize=f;t.f.prototype.featuresProgressEvents=f;t.f.prototype.featuresNativeTextTracks=t.f.Ve();var S,oa=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,pa=/^video\/mp4/i;
t.f.Xc=function(){4<=t.hc&&(S||(S=t.A.constructor.prototype.canPlayType),t.A.constructor.prototype.canPlayType=function(a){return a&&oa.test(a)?"maybe":S.call(this,a)});t.Ed&&(S||(S=t.A.constructor.prototype.canPlayType),t.A.constructor.prototype.canPlayType=function(a){return a&&pa.test(a)?"maybe":S.call(this,a)})};t.f.bf=function(){var a=t.A.constructor.prototype.canPlayType;t.A.constructor.prototype.canPlayType=S;S=j;return a};t.f.Xc();t.f.yb="loadstart suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate progress play pause ratechange volumechange".split(" ");
t.f.Mb=function(a){if(a){a.player=j;for(a.parentNode&&a.parentNode.removeChild(a);a.hasChildNodes();)a.removeChild(a.firstChild);a.removeAttribute("src");if("function"===typeof a.load)try{a.load()}catch(c){}}};
t.g=t.j.extend({l:function(a,c,d){t.j.call(this,a,c,d);var e=c.source;d=a.id()+"_flash_api";var g=a.q,g=t.i.D({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:g.autoplay,preload:g.Qa,loop:g.loop,muted:g.muted},c.flashVars),h=t.i.D({wmode:"opaque",bgcolor:"#000000"},c.params);d=t.i.D({id:d,name:d,"class":"vjs-tech"},c.attributes);e&&this.I(function(){this.Sa(e)});t.Ub(this.c,c.parentEl);c.startTime&&this.I(function(){this.load();
this.play();this.currentTime(c.startTime)});t.jc&&this.I(function(){this.b("mousemove",function(){this.k().o({type:"mousemove",bubbles:l})})});a.b("stageclick",a.reportUserActivity);this.c=t.g.Hc(c.swf,this.c,g,h,d)}});s=t.g.prototype;s.dispose=function(){t.j.prototype.dispose.call(this)};s.play=function(){this.c.vjs_play()};s.pause=function(){this.c.vjs_pause()};s.src=function(a){return a===b?this.currentSrc():this.ma(a)};
s.ma=function(a){a=t.$d(a);this.c.vjs_src(a);if(this.d.autoplay()){var c=this;this.setTimeout(function(){c.play()},0)}};t.g.prototype.setCurrentTime=function(a){this.oe=a;this.c.vjs_setProperty("currentTime",a);t.j.prototype.bc.call(this)};t.g.prototype.currentTime=function(){return this.seeking()?this.oe||0:this.c.vjs_getProperty("currentTime")};t.g.prototype.currentSrc=function(){return this.Ec?this.Ec.src:this.c.vjs_getProperty("currentSrc")};t.g.prototype.load=function(){this.c.vjs_load()};
t.g.prototype.poster=function(){this.c.vjs_getProperty("poster")};t.g.prototype.setPoster=m();t.g.prototype.buffered=function(){return t.Lb(0,this.c.vjs_getProperty("buffered"))};t.g.prototype.Ta=q(l);t.g.prototype.Ic=q(l);function qa(){var a=T[U],c=a.charAt(0).toUpperCase()+a.slice(1);ra["set"+c]=function(c){return this.c.vjs_setProperty(a,c)}}function sa(a){ra[a]=function(){return this.c.vjs_getProperty(a)}}
var ra=t.g.prototype,T="rtmpConnection rtmpStream preload defaultPlaybackRate playbackRate autoplay loop mediaGroup controller controls volume muted defaultMuted".split(" "),ta="error networkState readyState seeking initialTime duration startOffsetTime paused played seekable ended videoTracks audioTracks videoWidth videoHeight".split(" "),U;for(U=0;U<T.length;U++)sa(T[U]),qa();for(U=0;U<ta.length;U++)sa(ta[U]);t.g.isSupported=function(){return 10<=t.g.version()[0]};t.j.gc(t.g);t.g.S={};
t.g.S.eb=function(a){return!a.type?"":a.type.replace(/;.*/,"").toLowerCase()in t.g.Zd?"maybe":""};t.g.S.Tb=function(a,c){c.ma(a.src)};t.g.S.dispose=m();t.g.Ra(t.g.S);t.g.Zd={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"};t.g.onReady=function(a){var c;if(c=(a=t.m(a))&&a.parentNode&&a.parentNode.player)a.player=c,t.g.checkReady(c.h)};t.g.checkReady=function(a){a.m()&&(a.m().vjs_getProperty?a.Wa():this.setTimeout(function(){t.g.checkReady(a)},50))};
t.g.onEvent=function(a,c){t.m(a).player.o(c)};t.g.onError=function(a,c){var d=t.m(a).player,e="FLASH: "+c;"srcnotfound"==c?d.error({code:4,message:e}):d.error(e)};
t.g.version=function(){var a="0,0,0";try{a=(new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(c){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(a=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(d){}}return a.split(",")};
t.g.Hc=function(a,c,d,e,g){a=t.g.ce(a,d,e,g);a=t.e("div",{innerHTML:a}).childNodes[0];d=c.parentNode;c.parentNode.replaceChild(a,c);a[t.expando]=c[t.expando];var h=d.childNodes[0];setTimeout(function(){h.style.display="block"},1E3);return a};
t.g.ce=function(a,c,d,e){var g="",h="",k="";c&&t.i.da(c,function(a,c){g+=a+"="+c+"&amp;"});d=t.i.D({movie:a,flashvars:g,allowScriptAccess:"always",allowNetworking:"all"},d);t.i.da(d,function(a,c){h+='<param name="'+a+'" value="'+c+'" />'});e=t.i.D({data:a,width:"100%",height:"100%"},e);t.i.da(e,function(a,c){k+=a+'="'+c+'" '});return'<object type="application/x-shockwave-flash" '+k+">"+h+"</object>"};t.g.Ue={"rtmp/mp4":"MP4","rtmp/flv":"FLV"};t.g.Hf=function(a,c){return a+"&"+c};
t.g.Te=function(a){var c={Bc:"",md:""};if(!a)return c;var d=a.indexOf("&"),e;-1!==d?e=d+1:(d=e=a.lastIndexOf("/")+1,0===d&&(d=e=a.length));c.Bc=a.substring(0,d);c.md=a.substring(e,a.length);return c};t.g.me=function(a){return a in t.g.Ue};t.g.Gd=/^rtmp[set]?:\/\//i;t.g.le=function(a){return t.g.Gd.test(a)};t.g.ac={};t.g.ac.eb=function(a){return t.g.me(a.type)||t.g.le(a.src)?"maybe":""};t.g.ac.Tb=function(a,c){var d=t.g.Te(a.src);c.setRtmpConnection(d.Bc);c.setRtmpStream(d.md)};t.g.Ra(t.g.ac);
t.Fd=t.a.extend({l:function(a,c,d){t.a.call(this,a,c,d);if(!a.q.sources||0===a.q.sources.length){c=0;for(d=a.q.techOrder;c<d.length;c++){var e=t.ua(d[c]),g=window.videojs[e];if(g&&g.isSupported()){ka(a,e);break}}}else a.src(a.q.sources)}});t.rc={disabled:"disabled",hidden:"hidden",showing:"showing"};t.Hd={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"};
t.t=function(a){var c,d,e,g,h,k,p,r,u,A,R;a=a||{};if(!a.player)throw Error("A player was not provided.");c=this;if(t.oa)for(R in c=document.createElement("custom"),t.t.prototype)c[R]=t.t.prototype[R];c.d=a.player;e=t.rc[a.mode]||"disabled";g=t.Hd[a.kind]||"subtitles";h=a.label||"";k=a.language||a.srclang||"";d=a.id||"vjs_text_track_"+t.s++;if("metadata"===g||"chapters"===g)e="hidden";c.X=[];c.Ga=[];p=new t.W(c.X);r=new t.W(c.Ga);A=l;u=t.bind(c,function(){this.activeCues;A&&(this.trigger("cuechange"),
A=l)});"disabled"!==e&&c.d.b("timeupdate",u);Object.defineProperty(c,"kind",{get:function(){return g},set:Function.prototype});Object.defineProperty(c,"label",{get:function(){return h},set:Function.prototype});Object.defineProperty(c,"language",{get:function(){return k},set:Function.prototype});Object.defineProperty(c,"id",{get:function(){return d},set:Function.prototype});Object.defineProperty(c,"mode",{get:function(){return e},set:function(a){t.rc[a]&&(e=a,"showing"===e&&this.d.b("timeupdate",u),
this.o("modechange"))}});Object.defineProperty(c,"cues",{get:function(){return!this.Xb?j:p},set:Function.prototype});Object.defineProperty(c,"activeCues",{get:function(){var a,c,d,e,g;if(!this.Xb)return j;if(0===this.cues.length)return r;e=this.d.currentTime();a=0;c=this.cues.length;for(d=[];a<c;a++)g=this.cues[a],g.startTime<=e&&g.endTime>=e?d.push(g):g.startTime===g.endTime&&(g.startTime<=e&&g.startTime+0.5>=e)&&d.push(g);A=l;if(d.length!==this.Ga.length)A=f;else for(a=0;a<d.length;a++)-1===ua.call(this.Ga,
d[a])&&(A=f);this.Ga=d;r.qb(this.Ga);return r},set:Function.prototype});a.src?va(a.src,c):c.Xb=f;if(t.oa)return c};t.t.prototype=t.i.create(t.z.prototype);t.t.prototype.constructor=t.t;t.t.prototype.bb={cuechange:"cuechange"};t.t.prototype.vc=function(a){var c=this.d.textTracks(),d=0;if(c)for(;d<c.length;d++)c[d]!==this&&c[d].bd(a);this.X.push(a);this.cues.qb(this.X)};t.t.prototype.bd=function(a){for(var c=0,d=this.X.length,e,g=l;c<d;c++)e=this.X[c],e===a&&(this.X.splice(c,1),g=f);g&&this.Dc.qb(this.X)};
var va,V,ua;va=function(a,c){t.ff(a,t.bind(this,function(a,e,g){if(a)return t.log.error(a);c.Xb=f;V(g,c)}))};V=function(a,c){if("function"!==typeof window.WebVTT)window.setTimeout(function(){V(a,c)},25);else{var d=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder());d.oncue=function(a){c.vc(a)};d.onparsingerror=function(a){t.log.error(a)};d.parse(a);d.flush()}};
ua=function(a,c){var d;if(this==j)throw new TypeError('"this" is null or not defined');var e=Object(this),g=e.length>>>0;if(0===g)return-1;d=+c||0;Infinity===Math.abs(d)&&(d=0);if(d>=g)return-1;for(d=Math.max(0<=d?d:g-Math.abs(d),0);d<g;){if(d in e&&e[d]===a)return d;d++}return-1};
t.F=function(a){var c=this,d,e=0;if(t.oa)for(d in c=document.createElement("custom"),t.F.prototype)c[d]=t.F.prototype[d];a=a||[];c.Va=[];for(Object.defineProperty(c,"length",{get:function(){return this.Va.length}});e<a.length;e++)P(c,a[e]);if(t.oa)return c};t.F.prototype=t.i.create(t.z.prototype);t.F.prototype.constructor=t.F;t.F.prototype.bb={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var wa in t.F.prototype.bb)t.F.prototype["on"+wa]=j;
function P(a,c){var d=a.Va.length;""+d in a||Object.defineProperty(a,d,{get:function(){return this.Va[d]}});c.addEventListener("modechange",t.bind(a,function(){this.o("change")}));a.Va.push(c);a.o({type:"addtrack",T:c})}function Q(a,c){for(var d=0,e=a.length,g;d<e;d++)if(g=a[d],g===c){a.Va.splice(d,1);break}a.o({type:"removetrack",T:c})}t.F.prototype.de=function(a){for(var c=0,d=this.length,e=j,g;c<d;c++)if(g=this[c],g.id===a){e=g;break}return e};
t.W=function(a){var c=this,d;if(t.oa)for(d in c=document.createElement("custom"),t.W.prototype)c[d]=t.W.prototype[d];t.W.prototype.qb.call(c,a);Object.defineProperty(c,"length",{get:n("pe")});if(t.oa)return c};t.W.prototype.qb=function(a){var c=this.length||0,d=0,e=a.length;this.X=a;this.pe=a.length;a=function(a){""+a in this||Object.defineProperty(this,""+a,{get:function(){return this.X[a]}})};if(c<e)for(d=c;d<e;d++)a.call(this,d)};
t.W.prototype.be=function(a){for(var c=0,d=this.length,e=j,g;c<d;c++)if(g=this[c],g.id===a){e=g;break}return e};t.ra=t.a.extend({l:function(a,c,d){t.a.call(this,a,c,d);a.b("loadstart",t.bind(this,this.Ze));a.I(t.bind(this,function(){if(a.h&&a.h.featuresNativeTextTracks)this.Y();else{var c,d,h;a.b("fullscreenchange",t.bind(this,this.C));d=a.q.tracks||[];for(c=0;c<d.length;c++)h=d[c],this.d.ia(h)}}))}});t.ra.prototype.Ze=function(){this.d.h&&this.d.h.featuresNativeTextTracks?this.Y():this.show()};
t.ra.prototype.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-text-track-display"})};t.ra.prototype.Pd=function(){"function"===typeof window.WebVTT&&window.WebVTT.processCues(window,[],this.c)};function W(a,c){return"rgba("+parseInt(a[1]+a[1],16)+","+parseInt(a[2]+a[2],16)+","+parseInt(a[3]+a[3],16)+","+c+")"}
var xa={xf:"monospace",Df:"sans-serif",Ff:"serif",yf:'"Andale Mono", "Lucida Console", monospace',zf:'"Courier New", monospace',Bf:"sans-serif",Cf:"serif",of:'"Comic Sans MS", Impact, fantasy',Ef:'"Monotype Corsiva", cursive',Gf:'"Andale Mono", "Lucida Console", monospace, sans-serif'};t.ra.prototype.C=function(){var a=this.d.textTracks(),c=0,d;this.Pd();if(a)for(;c<a.length;c++)d=a[c],"showing"===d.mode&&this.cf(d)};
t.ra.prototype.cf=function(a){if("function"===typeof window.WebVTT&&a.activeCues){for(var c=0,d=this.d.textTrackSettings.Lc(),e,g=[];c<a.activeCues.length;c++)g.push(a.activeCues[c]);window.WebVTT.processCues(window,a.activeCues,this.c);for(c=g.length;c--;){a=g[c].pf;d.color&&(a.firstChild.style.color=d.color);if(d.nd)try{a.firstChild.style.color=W(d.color||"#fff",d.nd)}catch(h){}d.backgroundColor&&(a.firstChild.style.backgroundColor=d.backgroundColor);if(d.yc)try{a.firstChild.style.backgroundColor=
W(d.backgroundColor||"#000",d.yc)}catch(k){}if(d.fc)if(d.ud)try{a.style.backgroundColor=W(d.fc,d.ud)}catch(p){}else a.style.backgroundColor=d.fc;d.La&&("dropshadow"===d.La?a.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===d.La?a.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===d.La?a.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===d.La&&(a.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222"));
d.Qb&&1!==d.Qb&&(e=window.Af(a.style.fontSize),a.style.fontSize=e*d.Qb+"px",a.style.height="auto",a.style.top="auto",a.style.bottom="2px");d.fontFamily&&"default"!==d.fontFamily&&("small-caps"===d.fontFamily?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=xa[d.fontFamily])}}};
t.aa=t.M.extend({l:function(a,c){var d=this.T=c.track,e=a.textTracks(),g,h;e&&(g=t.bind(this,function(){var a="showing"===this.T.mode,c,d,g;if(this instanceof t.Ab){a=f;d=0;for(g=e.length;d<g;d++)if(c=e[d],c.kind===this.T.kind&&"showing"===c.mode){a=l;break}}this.selected(a)}),e.addEventListener("change",g),a.b("dispose",function(){e.removeEventListener("change",g)}));c.label=d.label||d.language||"Unknown";c.selected=d["default"]||"showing"===d.mode;t.M.call(this,a,c);e&&e.onchange===b&&this.b(["tap",
"click"],function(){if("object"!==typeof window.yd)try{h=new window.yd("change")}catch(a){}h||(h=document.createEvent("Event"),h.initEvent("change",f,f));e.dispatchEvent(h)})}});t.aa.prototype.u=function(){var a=this.T.kind,c=this.d.textTracks(),d,e=0;t.M.prototype.u.call(this);if(c)for(;e<c.length;e++)d=c[e],d.kind===a&&(d.mode=d===this.T?"showing":"disabled")};t.Ab=t.aa.extend({l:function(a,c){c.track={kind:c.kind,player:a,label:c.kind+" off","default":l,mode:"disabled"};t.aa.call(this,a,c);this.selected(f)}});
t.tb=t.aa.extend({l:function(a,c){c.track={kind:c.kind,player:a,label:c.kind+" settings","default":l,mode:"disabled"};t.aa.call(this,a,c);this.p("vjs-texttrack-settings")}});t.tb.prototype.u=function(){this.k().ea("textTrackSettings").show()};
t.Q=t.O.extend({l:function(a,c){var d,e;t.O.call(this,a,c);d=this.d.textTracks();1>=this.H.length&&this.Y();d&&(e=t.bind(this,this.update),d.addEventListener("removetrack",e),d.addEventListener("addtrack",e),this.d.b("dispose",function(){d.removeEventListener("removetrack",e);d.removeEventListener("addtrack",e)}))}});
t.Q.prototype.Ia=function(){var a=[],c,d;this instanceof t.na&&(!this.k().h||!this.k().h.featuresNativeTextTracks)&&a.push(new t.tb(this.d,{kind:this.fa}));a.push(new t.Ab(this.d,{kind:this.fa}));d=this.d.textTracks();if(!d)return a;for(var e=0;e<d.length;e++)c=d[e],c.kind===this.fa&&a.push(new t.aa(this.d,{track:c}));return a};t.na=t.Q.extend({l:function(a,c,d){t.Q.call(this,a,c,d);this.c.setAttribute("aria-label","Captions Menu")}});t.na.prototype.fa="captions";t.na.prototype.sa="Captions";
t.na.prototype.className="vjs-captions-button";t.na.prototype.update=function(){var a=2;t.Q.prototype.update.call(this);this.k().h&&this.k().h.featuresNativeTextTracks&&(a=1);this.H&&this.H.length>a?this.show():this.Y()};t.ab=t.Q.extend({l:function(a,c,d){t.Q.call(this,a,c,d);this.c.setAttribute("aria-label","Subtitles Menu")}});t.ab.prototype.fa="subtitles";t.ab.prototype.sa="Subtitles";t.ab.prototype.className="vjs-subtitles-button";
t.Xa=t.Q.extend({l:function(a,c,d){t.Q.call(this,a,c,d);this.c.setAttribute("aria-label","Chapters Menu")}});s=t.Xa.prototype;s.fa="chapters";s.sa="Chapters";s.className="vjs-chapters-button";s.Ia=function(){var a=[],c,d;d=this.d.textTracks();if(!d)return a;for(var e=0;e<d.length;e++)c=d[e],c.kind===this.fa&&a.push(new t.aa(this.d,{track:c}));return a};
s.Ja=function(){for(var a=this.d.textTracks()||[],c=0,d=a.length,e,g,h=this.H=[];c<d;c++)if(e=a[c],e.kind==this.fa)if(e.Dc){g=e;break}else e.mode="hidden",window.setTimeout(t.bind(this,function(){this.Ja()}),100);a=this.xa;a===b&&(a=new t.pa(this.d),a.va().appendChild(t.e("li",{className:"vjs-menu-title",innerHTML:t.ua(this.fa),We:-1})));if(g){e=g.cues;for(var k,c=0,d=e.length;c<d;c++)k=e[c],k=new t.Ya(this.d,{track:g,cue:k}),h.push(k),a.ba(k);this.ba(a)}0<this.H.length&&this.show();return a};
t.Ya=t.M.extend({l:function(a,c){var d=this.T=c.track,e=this.cue=c.cue,g=a.currentTime();c.label=e.text;c.selected=e.startTime<=g&&g<e.endTime;t.M.call(this,a,c);d.addEventListener("cuechange",t.bind(this,this.update))}});t.Ya.prototype.u=function(){t.M.prototype.u.call(this);this.d.currentTime(this.cue.startTime);this.update(this.cue.startTime)};t.Ya.prototype.update=function(){var a=this.cue,c=this.d.currentTime();this.selected(a.startTime<=c&&c<a.endTime)};
function X(a){var c;a.Ke?c=a.Ke[0]:a.options&&(c=a.options[a.options.selectedIndex]);return c.value}function Y(a,c){var d,e;if(c){for(d=0;d<a.options.length&&!(e=a.options[d],e.value===c);d++);a.selectedIndex=d}}
t.sc=t.a.extend({l:function(a,c){t.a.call(this,a,c);this.Y();t.b(this.m().querySelector(".vjs-done-button"),"click",t.bind(this,function(){this.Je();this.Y()}));t.b(this.m().querySelector(".vjs-default-button"),"click",t.bind(this,function(){this.m().querySelector(".vjs-fg-color > select").selectedIndex=0;this.m().querySelector(".vjs-bg-color > select").selectedIndex=0;this.m().querySelector(".window-color > select").selectedIndex=0;this.m().querySelector(".vjs-text-opacity > select").selectedIndex=
0;this.m().querySelector(".vjs-bg-opacity > select").selectedIndex=0;this.m().querySelector(".vjs-window-opacity > select").selectedIndex=0;this.m().querySelector(".vjs-edge-style select").selectedIndex=0;this.m().querySelector(".vjs-font-family select").selectedIndex=0;this.m().querySelector(".vjs-font-percent select").selectedIndex=2;this.C()}));t.b(this.m().querySelector(".vjs-fg-color > select"),"change",t.bind(this,this.C));t.b(this.m().querySelector(".vjs-bg-color > select"),"change",t.bind(this,
this.C));t.b(this.m().querySelector(".window-color > select"),"change",t.bind(this,this.C));t.b(this.m().querySelector(".vjs-text-opacity > select"),"change",t.bind(this,this.C));t.b(this.m().querySelector(".vjs-bg-opacity > select"),"change",t.bind(this,this.C));t.b(this.m().querySelector(".vjs-window-opacity > select"),"change",t.bind(this,this.C));t.b(this.m().querySelector(".vjs-font-percent select"),"change",t.bind(this,this.C));t.b(this.m().querySelector(".vjs-edge-style select"),"change",t.bind(this,
this.C));t.b(this.m().querySelector(".vjs-font-family select"),"change",t.bind(this,this.C));a.options().persistTextTrackSettings&&this.Ie()}});s=t.sc.prototype;s.e=function(){return t.a.prototype.e.call(this,"div",{className:"vjs-caption-settings vjs-modal-overlay",innerHTML:'<div class="vjs-tracksettings"><div class="vjs-tracksettings-colors"><div class="vjs-fg-color vjs-tracksetting"><label class="vjs-label">Foreground</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-text-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Opaque</option></select></span></div><div class="vjs-bg-color vjs-tracksetting"><label class="vjs-label">Background</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-bg-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div><div class="window-color vjs-tracksetting"><label class="vjs-label">Window</label><select><option value="">---</option><option value="#FFF">White</option><option value="#000">Black</option><option value="#F00">Red</option><option value="#0F0">Green</option><option value="#00F">Blue</option><option value="#FF0">Yellow</option><option value="#F0F">Magenta</option><option value="#0FF">Cyan</option></select><span class="vjs-window-opacity vjs-opacity"><select><option value="">---</option><option value="1">Opaque</option><option value="0.5">Semi-Transparent</option><option value="0">Transparent</option></select></span></div></div><div class="vjs-tracksettings-font"><div class="vjs-font-percent vjs-tracksetting"><label class="vjs-label">Font Size</label><select><option value="0.50">50%</option><option value="0.75">75%</option><option value="1.00" selected>100%</option><option value="1.25">125%</option><option value="1.50">150%</option><option value="1.75">175%</option><option value="2.00">200%</option><option value="3.00">300%</option><option value="4.00">400%</option></select></div><div class="vjs-edge-style vjs-tracksetting"><label class="vjs-label">Text Edge Style</label><select><option value="none">None</option><option value="raised">Raised</option><option value="depressed">Depressed</option><option value="uniform">Uniform</option><option value="dropshadow">Dropshadow</option></select></div><div class="vjs-font-family vjs-tracksetting"><label class="vjs-label">Font Family</label><select><option value="">Default</option><option value="monospaceSerif">Monospace Serif</option><option value="proportionalSerif">Proportional Serif</option><option value="monospaceSansSerif">Monospace Sans-Serif</option><option value="proportionalSansSerif">Proportional Sans-Serif</option><option value="casual">Casual</option><option value="script">Script</option><option value="small-caps">Small Caps</option></select></div></div></div><div class="vjs-tracksettings-controls"><button class="vjs-default-button">Defaults</button><button class="vjs-done-button">Done</button></div>'})};
s.Lc=function(){var a,c,d,e,g,h,k,p,r,u;a=this.m();g=X(a.querySelector(".vjs-edge-style select"));h=X(a.querySelector(".vjs-font-family select"));k=X(a.querySelector(".vjs-fg-color > select"));d=X(a.querySelector(".vjs-text-opacity > select"));p=X(a.querySelector(".vjs-bg-color > select"));c=X(a.querySelector(".vjs-bg-opacity > select"));r=X(a.querySelector(".window-color > select"));e=X(a.querySelector(".vjs-window-opacity > select"));a=window.parseFloat(X(a.querySelector(".vjs-font-percent > select")));
c={backgroundOpacity:c,textOpacity:d,windowOpacity:e,edgeStyle:g,fontFamily:h,color:k,backgroundColor:p,windowColor:r,fontPercent:a};for(u in c)(""===c[u]||"none"===c[u]||"fontPercent"===u&&1===c[u])&&delete c[u];return c};
s.Re=function(a){var c=this.m();Y(c.querySelector(".vjs-edge-style select"),a.La);Y(c.querySelector(".vjs-font-family select"),a.fontFamily);Y(c.querySelector(".vjs-fg-color > select"),a.color);Y(c.querySelector(".vjs-text-opacity > select"),a.nd);Y(c.querySelector(".vjs-bg-color > select"),a.backgroundColor);Y(c.querySelector(".vjs-bg-opacity > select"),a.yc);Y(c.querySelector(".window-color > select"),a.fc);Y(c.querySelector(".vjs-window-opacity > select"),a.ud);(a=a.Qb)&&(a=a.toFixed(2));Y(c.querySelector(".vjs-font-percent > select"),
a)};s.Ie=function(){var a;try{a=JSON.parse(window.localStorage.getItem("vjs-text-track-settings"))}catch(c){}a&&this.Re(a)};s.Je=function(){var a;if(this.d.options().persistTextTrackSettings){a=this.Lc();try{t.ib(a)?window.localStorage.removeItem("vjs-text-track-settings"):window.localStorage.setItem("vjs-text-track-settings",JSON.stringify(a))}catch(c){}}};s.C=function(){var a=this.d.ea("textTrackDisplay");a&&a.C()};
if("undefined"!==typeof window.JSON&&"function"===typeof window.JSON.parse)t.JSON=window.JSON;else{t.JSON={};var Z=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;t.JSON.parse=function(a,c){function d(a,e){var k,p,r=a[e];if(r&&"object"===typeof r)for(k in r)Object.prototype.hasOwnProperty.call(r,k)&&(p=d(r,k),p!==b?r[k]=p:delete r[k]);return c.call(a,e,r)}var e;a=String(a);Z.lastIndex=0;Z.test(a)&&(a=a.replace(Z,function(a){return"\\u"+("0000"+
a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof c?d({"":e},""):e;throw new SyntaxError("JSON.parse(): invalid or malformed JSON data");}}
t.xc=function(){var a,c,d,e;a=document.getElementsByTagName("video");c=document.getElementsByTagName("audio");var g=[];if(a&&0<a.length){d=0;for(e=a.length;d<e;d++)g.push(a[d])}if(c&&0<c.length){d=0;for(e=c.length;d<e;d++)g.push(c[d])}if(g&&0<g.length){d=0;for(e=g.length;d<e;d++)if((c=g[d])&&c.getAttribute)c.player===b&&(a=c.getAttribute("data-setup"),a!==j&&videojs(c));else{t.Ib();break}}else t.td||t.Ib()};t.Ib=function(){setTimeout(t.xc,1)};
"complete"===document.readyState?t.td=f:t.N(window,"load",function(){t.td=f});t.Ib();t.Fe=function(a,c){t.Player.prototype[a]=c};var ya=this;function $(a,c){var d=a.split("."),e=ya;!(d[0]in e)&&e.execScript&&e.execScript("var "+d[0]);for(var g;d.length&&(g=d.shift());)!d.length&&c!==b?e[g]=c:e=e[g]?e[g]:e[g]={}};$("videojs",t);$("_V_",t);$("videojs.options",t.options);$("videojs.players",t.Aa);$("videojs.TOUCH_ENABLED",t.Eb);$("videojs.cache",t.ta);$("videojs.Component",t.a);t.a.prototype.player=t.a.prototype.k;t.a.prototype.options=t.a.prototype.options;t.a.prototype.init=t.a.prototype.l;t.a.prototype.dispose=t.a.prototype.dispose;t.a.prototype.createEl=t.a.prototype.e;t.a.prototype.contentEl=t.a.prototype.va;t.a.prototype.el=t.a.prototype.m;t.a.prototype.addChild=t.a.prototype.ba;
t.a.prototype.getChild=t.a.prototype.ea;t.a.prototype.getChildById=t.a.prototype.ae;t.a.prototype.children=t.a.prototype.children;t.a.prototype.initChildren=t.a.prototype.Oc;t.a.prototype.removeChild=t.a.prototype.removeChild;t.a.prototype.on=t.a.prototype.b;t.a.prototype.off=t.a.prototype.n;t.a.prototype.one=t.a.prototype.N;t.a.prototype.trigger=t.a.prototype.o;t.a.prototype.triggerReady=t.a.prototype.Wa;t.a.prototype.show=t.a.prototype.show;t.a.prototype.hide=t.a.prototype.Y;
t.a.prototype.width=t.a.prototype.width;t.a.prototype.height=t.a.prototype.height;t.a.prototype.dimensions=t.a.prototype.Td;t.a.prototype.ready=t.a.prototype.I;t.a.prototype.addClass=t.a.prototype.p;t.a.prototype.removeClass=t.a.prototype.r;t.a.prototype.hasClass=t.a.prototype.Oa;t.a.prototype.buildCSSClass=t.a.prototype.V;t.a.prototype.localize=t.a.prototype.v;t.a.prototype.setInterval=t.a.prototype.setInterval;t.a.prototype.setTimeout=t.a.prototype.setTimeout;$("videojs.EventEmitter",t.z);
t.z.prototype.on=t.z.prototype.b;t.z.prototype.addEventListener=t.z.prototype.addEventListener;t.z.prototype.off=t.z.prototype.n;t.z.prototype.removeEventListener=t.z.prototype.removeEventListener;t.z.prototype.one=t.z.prototype.N;t.z.prototype.trigger=t.z.prototype.o;t.z.prototype.dispatchEvent=t.z.prototype.dispatchEvent;t.Player.prototype.ended=t.Player.prototype.ended;t.Player.prototype.enterFullWindow=t.Player.prototype.Jc;t.Player.prototype.exitFullWindow=t.Player.prototype.Nb;
t.Player.prototype.preload=t.Player.prototype.Qa;t.Player.prototype.remainingTime=t.Player.prototype.remainingTime;t.Player.prototype.supportsFullScreen=t.Player.prototype.Ta;t.Player.prototype.currentType=t.Player.prototype.Qd;t.Player.prototype.requestFullScreen=t.Player.prototype.requestFullScreen;t.Player.prototype.requestFullscreen=t.Player.prototype.requestFullscreen;t.Player.prototype.cancelFullScreen=t.Player.prototype.cancelFullScreen;t.Player.prototype.exitFullscreen=t.Player.prototype.exitFullscreen;
t.Player.prototype.isFullScreen=t.Player.prototype.isFullScreen;t.Player.prototype.isFullscreen=t.Player.prototype.isFullscreen;t.Player.prototype.textTracks=t.Player.prototype.textTracks;t.Player.prototype.remoteTextTracks=t.Player.prototype.Z;t.Player.prototype.addTextTrack=t.Player.prototype.addTextTrack;t.Player.prototype.addRemoteTextTrack=t.Player.prototype.ia;t.Player.prototype.removeRemoteTextTrack=t.Player.prototype.Ba;$("videojs.MediaLoader",t.Fd);$("videojs.TextTrackDisplay",t.ra);
$("videojs.ControlBar",t.ub);$("videojs.Button",t.w);$("videojs.PlayToggle",t.nc);$("videojs.FullscreenToggle",t.Za);$("videojs.BigPlayButton",t.sb);$("videojs.LoadingSpinner",t.lc);$("videojs.CurrentTimeDisplay",t.vb);$("videojs.DurationDisplay",t.wb);$("videojs.TimeDivider",t.tc);$("videojs.RemainingTimeDisplay",t.Db);$("videojs.LiveDisplay",t.kc);$("videojs.ErrorDisplay",t.xb);$("videojs.Slider",t.U);$("videojs.ProgressControl",t.Cb);$("videojs.SeekBar",t.qc);$("videojs.LoadProgressBar",t.zb);
$("videojs.PlayProgressBar",t.mc);$("videojs.SeekHandle",t.$a);$("videojs.VolumeControl",t.Gb);$("videojs.VolumeBar",t.Fb);$("videojs.VolumeLevel",t.uc);$("videojs.VolumeMenuButton",t.Fa);$("videojs.VolumeHandle",t.Hb);$("videojs.MuteToggle",t.qa);$("videojs.PosterImage",t.pc);$("videojs.Menu",t.pa);$("videojs.MenuItem",t.M);$("videojs.MenuButton",t.O);$("videojs.PlaybackRateMenuButton",t.oc);$("videojs.ChaptersTrackMenuItem",t.Ya);$("videojs.TextTrackButton",t.Q);$("videojs.TextTrackMenuItem",t.aa);
$("videojs.OffTextTrackMenuItem",t.Ab);$("videojs.CaptionSettingsMenuItem",t.tb);t.O.prototype.createItems=t.O.prototype.Ia;t.Q.prototype.createItems=t.Q.prototype.Ia;t.Xa.prototype.createItems=t.Xa.prototype.Ia;$("videojs.SubtitlesButton",t.ab);$("videojs.CaptionsButton",t.na);$("videojs.ChaptersButton",t.Xa);$("videojs.MediaTechController",t.j);t.j.withSourceHandlers=t.j.gc;t.j.prototype.featuresVolumeControl=t.j.prototype.uf;t.j.prototype.featuresFullscreenResize=t.j.prototype.qf;
t.j.prototype.featuresPlaybackRate=t.j.prototype.rf;t.j.prototype.featuresProgressEvents=t.j.prototype.sf;t.j.prototype.featuresTimeupdateEvents=t.j.prototype.tf;t.j.prototype.setPoster=t.j.prototype.fd;t.j.prototype.textTracks=t.j.prototype.textTracks;t.j.prototype.remoteTextTracks=t.j.prototype.Z;t.j.prototype.addTextTrack=t.j.prototype.addTextTrack;t.j.prototype.addRemoteTextTrack=t.j.prototype.ia;t.j.prototype.removeRemoteTextTrack=t.j.prototype.Ba;$("videojs.Html5",t.f);t.f.Events=t.f.yb;
t.f.isSupported=t.f.isSupported;t.f.canPlaySource=t.f.zc;t.f.patchCanPlayType=t.f.Xc;t.f.unpatchCanPlayType=t.f.bf;t.f.prototype.setCurrentTime=t.f.prototype.bc;t.f.prototype.setVolume=t.f.prototype.Se;t.f.prototype.setMuted=t.f.prototype.Oe;t.f.prototype.setPreload=t.f.prototype.Qe;t.f.prototype.setAutoplay=t.f.prototype.Le;t.f.prototype.setLoop=t.f.prototype.Ne;t.f.prototype.enterFullScreen=t.f.prototype.Ic;t.f.prototype.exitFullScreen=t.f.prototype.Xd;t.f.prototype.playbackRate=t.f.prototype.playbackRate;
t.f.prototype.setPlaybackRate=t.f.prototype.Pe;t.f.registerSourceHandler=t.f.Ra;t.f.selectSourceHandler=t.f.pb;t.f.prototype.setSource=t.f.prototype.Sa;t.f.prototype.disposeSourceHandler=t.f.prototype.Ka;t.f.prototype.textTracks=t.f.prototype.textTracks;t.f.prototype.remoteTextTracks=t.f.prototype.Z;t.f.prototype.addTextTrack=t.f.prototype.addTextTrack;t.f.prototype.addRemoteTextTrack=t.f.prototype.ia;t.f.prototype.removeRemoteTextTrack=t.f.prototype.Ba;$("videojs.Flash",t.g);t.g.isSupported=t.g.isSupported;
t.g.canPlaySource=t.g.zc;t.g.onReady=t.g.onReady;t.g.embed=t.g.Hc;t.g.version=t.g.version;t.g.prototype.setSource=t.g.prototype.Sa;t.g.registerSourceHandler=t.g.Ra;t.g.selectSourceHandler=t.g.pb;t.g.prototype.setSource=t.g.prototype.Sa;t.g.prototype.disposeSourceHandler=t.g.prototype.Ka;$("videojs.TextTrack",t.t);$("videojs.TextTrackList",t.F);$("videojs.TextTrackCueList",t.W);$("videojs.TextTrackSettings",t.sc);t.t.prototype.id=t.t.prototype.id;t.t.prototype.label=t.t.prototype.label;
t.t.prototype.kind=t.t.prototype.Wb;t.t.prototype.mode=t.t.prototype.mode;t.t.prototype.cues=t.t.prototype.Dc;t.t.prototype.activeCues=t.t.prototype.nf;t.t.prototype.addCue=t.t.prototype.vc;t.t.prototype.removeCue=t.t.prototype.bd;t.F.prototype.getTrackById=t.F.prototype.de;t.W.prototype.getCueById=t.F.prototype.be;$("videojs.CaptionsTrack",t.gf);$("videojs.SubtitlesTrack",t.mf);$("videojs.ChaptersTrack",t.hf);$("videojs.autoSetup",t.xc);$("videojs.plugin",t.Fe);$("videojs.createTimeRange",t.Lb);
$("videojs.util",t.$);t.$.mergeOptions=t.$.ya;t.addLanguage=t.Jd;})();

/* vtt.js - v0.11.11 (https://github.com/mozilla/vtt.js) built on 22-01-2015 */
!function(a){var b=a.vttjs={},c=b.VTTCue,d=b.VTTRegion,e=a.VTTCue,f=a.VTTRegion;b.shim=function(){b.VTTCue=c,b.VTTRegion=d},b.restore=function(){b.VTTCue=e,b.VTTRegion=f}}(this),function(a,b){function c(a){if("string"!=typeof a)return!1;var b=h[a.toLowerCase()];return b?a.toLowerCase():!1}function d(a){if("string"!=typeof a)return!1;var b=i[a.toLowerCase()];return b?a.toLowerCase():!1}function e(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a}function f(a,b,f){var h=this,i=/MSIE\s8\.0/.test(navigator.userAgent),j={};i?h=document.createElement("custom"):j.enumerable=!0,h.hasBeenReset=!1;var k="",l=!1,m=a,n=b,o=f,p=null,q="",r=!0,s="auto",t="start",u=50,v="middle",w=50,x="middle";return Object.defineProperty(h,"id",e({},j,{get:function(){return k},set:function(a){k=""+a}})),Object.defineProperty(h,"pauseOnExit",e({},j,{get:function(){return l},set:function(a){l=!!a}})),Object.defineProperty(h,"startTime",e({},j,{get:function(){return m},set:function(a){if("number"!=typeof a)throw new TypeError("Start time must be set to a number.");m=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",e({},j,{get:function(){return n},set:function(a){if("number"!=typeof a)throw new TypeError("End time must be set to a number.");n=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",e({},j,{get:function(){return o},set:function(a){o=""+a,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",e({},j,{get:function(){return p},set:function(a){p=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",e({},j,{get:function(){return q},set:function(a){var b=c(a);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");q=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",e({},j,{get:function(){return r},set:function(a){r=!!a,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",e({},j,{get:function(){return s},set:function(a){if("number"!=typeof a&&a!==g)throw new SyntaxError("An invalid number or illegal string was specified.");s=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",e({},j,{get:function(){return t},set:function(a){var b=d(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");t=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",e({},j,{get:function(){return u},set:function(a){if(0>a||a>100)throw new Error("Position must be between 0 and 100.");u=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",e({},j,{get:function(){return v},set:function(a){var b=d(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");v=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",e({},j,{get:function(){return w},set:function(a){if(0>a||a>100)throw new Error("Size must be between 0 and 100.");w=a,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",e({},j,{get:function(){return x},set:function(a){var b=d(a);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");x=b,this.hasBeenReset=!0}})),h.displayState=void 0,i?h:void 0}var g="auto",h={"":!0,lr:!0,rl:!0},i={start:!0,middle:!0,end:!0,left:!0,right:!0};f.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},a.VTTCue=a.VTTCue||f,b.VTTCue=f}(this,this.vttjs||{}),function(a,b){function c(a){if("string"!=typeof a)return!1;var b=f[a.toLowerCase()];return b?a.toLowerCase():!1}function d(a){return"number"==typeof a&&a>=0&&100>=a}function e(){var a=100,b=3,e=0,f=100,g=0,h=100,i="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return a},set:function(b){if(!d(b))throw new Error("Width must be between 0 and 100.");a=b}},lines:{enumerable:!0,get:function(){return b},set:function(a){if("number"!=typeof a)throw new TypeError("Lines must be set to a number.");b=a}},regionAnchorY:{enumerable:!0,get:function(){return f},set:function(a){if(!d(a))throw new Error("RegionAnchorX must be between 0 and 100.");f=a}},regionAnchorX:{enumerable:!0,get:function(){return e},set:function(a){if(!d(a))throw new Error("RegionAnchorY must be between 0 and 100.");e=a}},viewportAnchorY:{enumerable:!0,get:function(){return h},set:function(a){if(!d(a))throw new Error("ViewportAnchorY must be between 0 and 100.");h=a}},viewportAnchorX:{enumerable:!0,get:function(){return g},set:function(a){if(!d(a))throw new Error("ViewportAnchorX must be between 0 and 100.");g=a}},scroll:{enumerable:!0,get:function(){return i},set:function(a){var b=c(a);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");i=b}}})}var f={"":!0,up:!0};a.VTTRegion=a.VTTRegion||e,b.VTTRegion=e}(this,this.vttjs||{}),function(a){function b(a,b){this.name="ParsingError",this.code=a.code,this.message=b||a.message}function c(a){function b(a,b,c,d){return 3600*(0|a)+60*(0|b)+(0|c)+(0|d)/1e3}var c=a.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return c?c[3]?b(c[1],c[2],c[3].replace(":",""),c[4]):c[1]>59?b(c[1],c[2],0,c[4]):b(0,c[1],c[2],c[4]):null}function d(){this.values=o(null)}function e(a,b,c,d){var e=d?a.split(d):[a];for(var f in e)if("string"==typeof e[f]){var g=e[f].split(c);if(2===g.length){var h=g[0],i=g[1];b(h,i)}}}function f(a,f,g){function h(){var d=c(a);if(null===d)throw new b(b.Errors.BadTimeStamp,"Malformed timestamp: "+k);return a=a.replace(/^[^\sa-zA-Z-]+/,""),d}function i(a,b){var c=new d;e(a,function(a,b){switch(a){case"region":for(var d=g.length-1;d>=0;d--)if(g[d].id===b){c.set(a,g[d].region);break}break;case"vertical":c.alt(a,b,["rl","lr"]);break;case"line":var e=b.split(","),f=e[0];c.integer(a,f),c.percent(a,f)?c.set("snapToLines",!1):null,c.alt(a,f,["auto"]),2===e.length&&c.alt("lineAlign",e[1],["start","middle","end"]);break;case"position":e=b.split(","),c.percent(a,e[0]),2===e.length&&c.alt("positionAlign",e[1],["start","middle","end"]);break;case"size":c.percent(a,b);break;case"align":c.alt(a,b,["start","middle","end","left","right"])}},/:/,/\s/),b.region=c.get("region",null),b.vertical=c.get("vertical",""),b.line=c.get("line","auto"),b.lineAlign=c.get("lineAlign","start"),b.snapToLines=c.get("snapToLines",!0),b.size=c.get("size",100),b.align=c.get("align","middle"),b.position=c.get("position",{start:0,left:0,middle:50,end:100,right:100},b.align),b.positionAlign=c.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},b.align)}function j(){a=a.replace(/^\s+/,"")}var k=a;if(j(),f.startTime=h(),j(),"-->"!==a.substr(0,3))throw new b(b.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+k);a=a.substr(3),j(),f.endTime=h(),j(),i(a,f)}function g(a,b){function d(){function a(a){return b=b.substr(a.length),a}if(!b)return null;var c=b.match(/^([^<]*)(<[^>]+>?)?/);return a(c[1]?c[1]:c[2])}function e(a){return p[a]}function f(a){for(;o=a.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)a=a.replace(o[0],e);return a}function g(a,b){return!s[b.localName]||s[b.localName]===a.localName}function h(b,c){var d=q[b];if(!d)return null;var e=a.document.createElement(d);e.localName=d;var f=r[b];return f&&c&&(e[f]=c.trim()),e}for(var i,j=a.document.createElement("div"),k=j,l=[];null!==(i=d());)if("<"!==i[0])k.appendChild(a.document.createTextNode(f(i)));else{if("/"===i[1]){l.length&&l[l.length-1]===i.substr(2).replace(">","")&&(l.pop(),k=k.parentNode);continue}var m,n=c(i.substr(1,i.length-2));if(n){m=a.document.createProcessingInstruction("timestamp",n),k.appendChild(m);continue}var o=i.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!o)continue;if(m=h(o[1],o[3]),!m)continue;if(!g(k,m))continue;o[2]&&(m.className=o[2].substr(1).replace("."," ")),l.push(o[1]),k.appendChild(m),k=m}return j}function h(a){function b(a,b){for(var c=b.childNodes.length-1;c>=0;c--)a.push(b.childNodes[c])}function c(a){if(!a||!a.length)return null;var d=a.pop(),e=d.textContent||d.innerText;if(e){var f=e.match(/^.*(\n|\r)/);return f?(a.length=0,f[0]):e}return"ruby"===d.tagName?c(a):d.childNodes?(b(a,d),c(a)):void 0}var d,e=[],f="";if(!a||!a.childNodes)return"ltr";for(b(e,a);f=c(e);)for(var g=0;g<f.length;g++){d=f.charCodeAt(g);for(var h=0;h<t.length;h++)if(t[h]===d)return"rtl"}return"ltr"}function i(a){if("number"==typeof a.line&&(a.snapToLines||a.line>=0&&a.line<=100))return a.line;if(!a.track||!a.track.textTrackList||!a.track.textTrackList.mediaElement)return-1;for(var b=a.track,c=b.textTrackList,d=0,e=0;e<c.length&&c[e]!==b;e++)"showing"===c[e].mode&&d++;return-1*++d}function j(){}function k(a,b,c){var d=/MSIE\s8\.0/.test(navigator.userAgent),e="rgba(255, 255, 255, 1)",f="rgba(0, 0, 0, 0.8)";d&&(e="rgb(255, 255, 255)",f="rgb(0, 0, 0)"),j.call(this),this.cue=b,this.cueDiv=g(a,b.text);var i={color:e,backgroundColor:f,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};d||(i.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl",i.unicodeBidi="plaintext"),this.applyStyles(i,this.cueDiv),this.div=a.document.createElement("div"),i={textAlign:"middle"===b.align?"center":b.align,font:c.font,whiteSpace:"pre-line",position:"absolute"},d||(i.direction=h(this.cueDiv),i.writingMode=""===b.vertical?"horizontal-tb":"lr"===b.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(i),this.div.appendChild(this.cueDiv);var k=0;switch(b.positionAlign){case"start":k=b.position;break;case"middle":k=b.position-b.size/2;break;case"end":k=b.position-b.size}this.applyStyles(""===b.vertical?{left:this.formatStyle(k,"%"),width:this.formatStyle(b.size,"%")}:{top:this.formatStyle(k,"%"),height:this.formatStyle(b.size,"%")}),this.move=function(a){this.applyStyles({top:this.formatStyle(a.top,"px"),bottom:this.formatStyle(a.bottom,"px"),left:this.formatStyle(a.left,"px"),right:this.formatStyle(a.right,"px"),height:this.formatStyle(a.height,"px"),width:this.formatStyle(a.width,"px")})}}function l(a){var b,c,d,e,f=/MSIE\s8\.0/.test(navigator.userAgent);if(a.div){c=a.div.offsetHeight,d=a.div.offsetWidth,e=a.div.offsetTop;var g=(g=a.div.childNodes)&&(g=g[0])&&g.getClientRects&&g.getClientRects();a=a.div.getBoundingClientRect(),b=g?Math.max(g[0]&&g[0].height||0,a.height/g.length):0}this.left=a.left,this.right=a.right,this.top=a.top||e,this.height=a.height||c,this.bottom=a.bottom||e+(a.height||c),this.width=a.width||d,this.lineHeight=void 0!==b?b:a.lineHeight,f&&!this.lineHeight&&(this.lineHeight=13)}function m(a,b,c,d){function e(a,b){for(var e,f=new l(a),g=1,h=0;h<b.length;h++){for(;a.overlapsOppositeAxis(c,b[h])||a.within(c)&&a.overlapsAny(d);)a.move(b[h]);if(a.within(c))return a;var i=a.intersectPercentage(c);g>i&&(e=new l(a),g=i),a=new l(f)}return e||f}var f=new l(b),g=b.cue,h=i(g),j=[];if(g.snapToLines){var k;switch(g.vertical){case"":j=["+y","-y"],k="height";break;case"rl":j=["+x","-x"],k="width";break;case"lr":j=["-x","+x"],k="width"}var m=f.lineHeight,n=m*Math.round(h),o=c[k]+m,p=j[0];Math.abs(n)>o&&(n=0>n?-1:1,n*=Math.ceil(o/m)*m),0>h&&(n+=""===g.vertical?c.height:c.width,j=j.reverse()),f.move(p,n)}else{var q=f.lineHeight/c.height*100;switch(g.lineAlign){case"middle":h-=q/2;break;case"end":h-=q}switch(g.vertical){case"":b.applyStyles({top:b.formatStyle(h,"%")});break;case"rl":b.applyStyles({left:b.formatStyle(h,"%")});break;case"lr":b.applyStyles({right:b.formatStyle(h,"%")})}j=["+y","-x","+x","-y"],f=new l(b)}var r=e(f,j);b.move(r.toCSSCompatValues(c))}function n(){}var o=Object.create||function(){function a(){}return function(b){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return a.prototype=b,new a}}();b.prototype=o(Error.prototype),b.prototype.constructor=b,b.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},d.prototype={set:function(a,b){this.get(a)||""===b||(this.values[a]=b)},get:function(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b},has:function(a){return a in this.values},alt:function(a,b,c){for(var d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}},integer:function(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))},percent:function(a,b){var c;return(c=b.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(b=parseFloat(b),b>=0&&100>=b)?(this.set(a,b),!0):!1}};var p={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"â€Ž","&rlm;":"â€","&nbsp;":"Â "},q={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},r={v:"title",lang:"lang"},s={rt:"ruby"},t=[1470,1472,1475,1478,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1506,1507,1508,1509,1510,1511,1512,1513,1514,1520,1521,1522,1523,1524,1544,1547,1549,1563,1566,1567,1568,1569,1570,1571,1572,1573,1574,1575,1576,1577,1578,1579,1580,1581,1582,1583,1584,1585,1586,1587,1588,1589,1590,1591,1592,1593,1594,1595,1596,1597,1598,1599,1600,1601,1602,1603,1604,1605,1606,1607,1608,1609,1610,1645,1646,1647,1649,1650,1651,1652,1653,1654,1655,1656,1657,1658,1659,1660,1661,1662,1663,1664,1665,1666,1667,1668,1669,1670,1671,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,1703,1704,1705,1706,1707,1708,1709,1710,1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1765,1766,1774,1775,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1800,1801,1802,1803,1804,1805,1807,1808,1810,1811,1812,1813,1814,1815,1816,1817,1818,1819,1820,1821,1822,1823,1824,1825,1826,1827,1828,1829,1830,1831,1832,1833,1834,1835,1836,1837,1838,1839,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1969,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2036,2037,2042,2048,2049,2050,2051,2052,2053,2054,2055,2056,2057,2058,2059,2060,2061,2062,2063,2064,2065,2066,2067,2068,2069,2074,2084,2088,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2142,2208,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,2220,8207,64285,64287,64288,64289,64290,64291,64292,64293,64294,64295,64296,64298,64299,64300,64301,64302,64303,64304,64305,64306,64307,64308,64309,64310,64312,64313,64314,64315,64316,64318,64320,64321,64323,64324,64326,64327,64328,64329,64330,64331,64332,64333,64334,64335,64336,64337,64338,64339,64340,64341,64342,64343,64344,64345,64346,64347,64348,64349,64350,64351,64352,64353,64354,64355,64356,64357,64358,64359,64360,64361,64362,64363,64364,64365,64366,64367,64368,64369,64370,64371,64372,64373,64374,64375,64376,64377,64378,64379,64380,64381,64382,64383,64384,64385,64386,64387,64388,64389,64390,64391,64392,64393,64394,64395,64396,64397,64398,64399,64400,64401,64402,64403,64404,64405,64406,64407,64408,64409,64410,64411,64412,64413,64414,64415,64416,64417,64418,64419,64420,64421,64422,64423,64424,64425,64426,64427,64428,64429,64430,64431,64432,64433,64434,64435,64436,64437,64438,64439,64440,64441,64442,64443,64444,64445,64446,64447,64448,64449,64467,64468,64469,64470,64471,64472,64473,64474,64475,64476,64477,64478,64479,64480,64481,64482,64483,64484,64485,64486,64487,64488,64489,64490,64491,64492,64493,64494,64495,64496,64497,64498,64499,64500,64501,64502,64503,64504,64505,64506,64507,64508,64509,64510,64511,64512,64513,64514,64515,64516,64517,64518,64519,64520,64521,64522,64523,64524,64525,64526,64527,64528,64529,64530,64531,64532,64533,64534,64535,64536,64537,64538,64539,64540,64541,64542,64543,64544,64545,64546,64547,64548,64549,64550,64551,64552,64553,64554,64555,64556,64557,64558,64559,64560,64561,64562,64563,64564,64565,64566,64567,64568,64569,64570,64571,64572,64573,64574,64575,64576,64577,64578,64579,64580,64581,64582,64583,64584,64585,64586,64587,64588,64589,64590,64591,64592,64593,64594,64595,64596,64597,64598,64599,64600,64601,64602,64603,64604,64605,64606,64607,64608,64609,64610,64611,64612,64613,64614,64615,64616,64617,64618,64619,64620,64621,64622,64623,64624,64625,64626,64627,64628,64629,64630,64631,64632,64633,64634,64635,64636,64637,64638,64639,64640,64641,64642,64643,64644,64645,64646,64647,64648,64649,64650,64651,64652,64653,64654,64655,64656,64657,64658,64659,64660,64661,64662,64663,64664,64665,64666,64667,64668,64669,64670,64671,64672,64673,64674,64675,64676,64677,64678,64679,64680,64681,64682,64683,64684,64685,64686,64687,64688,64689,64690,64691,64692,64693,64694,64695,64696,64697,64698,64699,64700,64701,64702,64703,64704,64705,64706,64707,64708,64709,64710,64711,64712,64713,64714,64715,64716,64717,64718,64719,64720,64721,64722,64723,64724,64725,64726,64727,64728,64729,64730,64731,64732,64733,64734,64735,64736,64737,64738,64739,64740,64741,64742,64743,64744,64745,64746,64747,64748,64749,64750,64751,64752,64753,64754,64755,64756,64757,64758,64759,64760,64761,64762,64763,64764,64765,64766,64767,64768,64769,64770,64771,64772,64773,64774,64775,64776,64777,64778,64779,64780,64781,64782,64783,64784,64785,64786,64787,64788,64789,64790,64791,64792,64793,64794,64795,64796,64797,64798,64799,64800,64801,64802,64803,64804,64805,64806,64807,64808,64809,64810,64811,64812,64813,64814,64815,64816,64817,64818,64819,64820,64821,64822,64823,64824,64825,64826,64827,64828,64829,64848,64849,64850,64851,64852,64853,64854,64855,64856,64857,64858,64859,64860,64861,64862,64863,64864,64865,64866,64867,64868,64869,64870,64871,64872,64873,64874,64875,64876,64877,64878,64879,64880,64881,64882,64883,64884,64885,64886,64887,64888,64889,64890,64891,64892,64893,64894,64895,64896,64897,64898,64899,64900,64901,64902,64903,64904,64905,64906,64907,64908,64909,64910,64911,64914,64915,64916,64917,64918,64919,64920,64921,64922,64923,64924,64925,64926,64927,64928,64929,64930,64931,64932,64933,64934,64935,64936,64937,64938,64939,64940,64941,64942,64943,64944,64945,64946,64947,64948,64949,64950,64951,64952,64953,64954,64955,64956,64957,64958,64959,64960,64961,64962,64963,64964,64965,64966,64967,65008,65009,65010,65011,65012,65013,65014,65015,65016,65017,65018,65019,65020,65136,65137,65138,65139,65140,65142,65143,65144,65145,65146,65147,65148,65149,65150,65151,65152,65153,65154,65155,65156,65157,65158,65159,65160,65161,65162,65163,65164,65165,65166,65167,65168,65169,65170,65171,65172,65173,65174,65175,65176,65177,65178,65179,65180,65181,65182,65183,65184,65185,65186,65187,65188,65189,65190,65191,65192,65193,65194,65195,65196,65197,65198,65199,65200,65201,65202,65203,65204,65205,65206,65207,65208,65209,65210,65211,65212,65213,65214,65215,65216,65217,65218,65219,65220,65221,65222,65223,65224,65225,65226,65227,65228,65229,65230,65231,65232,65233,65234,65235,65236,65237,65238,65239,65240,65241,65242,65243,65244,65245,65246,65247,65248,65249,65250,65251,65252,65253,65254,65255,65256,65257,65258,65259,65260,65261,65262,65263,65264,65265,65266,65267,65268,65269,65270,65271,65272,65273,65274,65275,65276,67584,67585,67586,67587,67588,67589,67592,67594,67595,67596,67597,67598,67599,67600,67601,67602,67603,67604,67605,67606,67607,67608,67609,67610,67611,67612,67613,67614,67615,67616,67617,67618,67619,67620,67621,67622,67623,67624,67625,67626,67627,67628,67629,67630,67631,67632,67633,67634,67635,67636,67637,67639,67640,67644,67647,67648,67649,67650,67651,67652,67653,67654,67655,67656,67657,67658,67659,67660,67661,67662,67663,67664,67665,67666,67667,67668,67669,67671,67672,67673,67674,67675,67676,67677,67678,67679,67840,67841,67842,67843,67844,67845,67846,67847,67848,67849,67850,67851,67852,67853,67854,67855,67856,67857,67858,67859,67860,67861,67862,67863,67864,67865,67866,67867,67872,67873,67874,67875,67876,67877,67878,67879,67880,67881,67882,67883,67884,67885,67886,67887,67888,67889,67890,67891,67892,67893,67894,67895,67896,67897,67903,67968,67969,67970,67971,67972,67973,67974,67975,67976,67977,67978,67979,67980,67981,67982,67983,67984,67985,67986,67987,67988,67989,67990,67991,67992,67993,67994,67995,67996,67997,67998,67999,68e3,68001,68002,68003,68004,68005,68006,68007,68008,68009,68010,68011,68012,68013,68014,68015,68016,68017,68018,68019,68020,68021,68022,68023,68030,68031,68096,68112,68113,68114,68115,68117,68118,68119,68121,68122,68123,68124,68125,68126,68127,68128,68129,68130,68131,68132,68133,68134,68135,68136,68137,68138,68139,68140,68141,68142,68143,68144,68145,68146,68147,68160,68161,68162,68163,68164,68165,68166,68167,68176,68177,68178,68179,68180,68181,68182,68183,68184,68192,68193,68194,68195,68196,68197,68198,68199,68200,68201,68202,68203,68204,68205,68206,68207,68208,68209,68210,68211,68212,68213,68214,68215,68216,68217,68218,68219,68220,68221,68222,68223,68352,68353,68354,68355,68356,68357,68358,68359,68360,68361,68362,68363,68364,68365,68366,68367,68368,68369,68370,68371,68372,68373,68374,68375,68376,68377,68378,68379,68380,68381,68382,68383,68384,68385,68386,68387,68388,68389,68390,68391,68392,68393,68394,68395,68396,68397,68398,68399,68400,68401,68402,68403,68404,68405,68416,68417,68418,68419,68420,68421,68422,68423,68424,68425,68426,68427,68428,68429,68430,68431,68432,68433,68434,68435,68436,68437,68440,68441,68442,68443,68444,68445,68446,68447,68448,68449,68450,68451,68452,68453,68454,68455,68456,68457,68458,68459,68460,68461,68462,68463,68464,68465,68466,68472,68473,68474,68475,68476,68477,68478,68479,68608,68609,68610,68611,68612,68613,68614,68615,68616,68617,68618,68619,68620,68621,68622,68623,68624,68625,68626,68627,68628,68629,68630,68631,68632,68633,68634,68635,68636,68637,68638,68639,68640,68641,68642,68643,68644,68645,68646,68647,68648,68649,68650,68651,68652,68653,68654,68655,68656,68657,68658,68659,68660,68661,68662,68663,68664,68665,68666,68667,68668,68669,68670,68671,68672,68673,68674,68675,68676,68677,68678,68679,68680,126464,126465,126466,126467,126469,126470,126471,126472,126473,126474,126475,126476,126477,126478,126479,126480,126481,126482,126483,126484,126485,126486,126487,126488,126489,126490,126491,126492,126493,126494,126495,126497,126498,126500,126503,126505,126506,126507,126508,126509,126510,126511,126512,126513,126514,126516,126517,126518,126519,126521,126523,126530,126535,126537,126539,126541,126542,126543,126545,126546,126548,126551,126553,126555,126557,126559,126561,126562,126564,126567,126568,126569,126570,126572,126573,126574,126575,126576,126577,126578,126580,126581,126582,126583,126585,126586,126587,126588,126590,126592,126593,126594,126595,126596,126597,126598,126599,126600,126601,126603,126604,126605,126606,126607,126608,126609,126610,126611,126612,126613,126614,126615,126616,126617,126618,126619,126625,126626,126627,126629,126630,126631,126632,126633,126635,126636,126637,126638,126639,126640,126641,126642,126643,126644,126645,126646,126647,126648,126649,126650,126651,1114109];j.prototype.applyStyles=function(a,b){b=b||this.div;for(var c in a)a.hasOwnProperty(c)&&(b.style[c]=a[c])},j.prototype.formatStyle=function(a,b){return 0===a?0:a+b},k.prototype=o(j.prototype),k.prototype.constructor=k,l.prototype.move=function(a,b){switch(b=void 0!==b?b:this.lineHeight,a){case"+x":this.left+=b,this.right+=b;break;case"-x":this.left-=b,this.right-=b;break;case"+y":this.top+=b,this.bottom+=b;break;case"-y":this.top-=b,this.bottom-=b}},l.prototype.overlaps=function(a){return this.left<a.right&&this.right>a.left&&this.top<a.bottom&&this.bottom>a.top},l.prototype.overlapsAny=function(a){for(var b=0;b<a.length;b++)if(this.overlaps(a[b]))return!0;return!1},l.prototype.within=function(a){return this.top>=a.top&&this.bottom<=a.bottom&&this.left>=a.left&&this.right<=a.right},l.prototype.overlapsOppositeAxis=function(a,b){switch(b){case"+x":return this.left<a.left;case"-x":return this.right>a.right;case"+y":return this.top<a.top;case"-y":return this.bottom>a.bottom}},l.prototype.intersectPercentage=function(a){var b=Math.max(0,Math.min(this.right,a.right)-Math.max(this.left,a.left)),c=Math.max(0,Math.min(this.bottom,a.bottom)-Math.max(this.top,a.top)),d=b*c;return d/(this.height*this.width)},l.prototype.toCSSCompatValues=function(a){return{top:this.top-a.top,bottom:a.bottom-this.bottom,left:this.left-a.left,right:a.right-this.right,height:this.height,width:this.width}},l.getSimpleBoxPosition=function(a){var b=a.div?a.div.offsetHeight:a.tagName?a.offsetHeight:0,c=a.div?a.div.offsetWidth:a.tagName?a.offsetWidth:0,d=a.div?a.div.offsetTop:a.tagName?a.offsetTop:0;a=a.div?a.div.getBoundingClientRect():a.tagName?a.getBoundingClientRect():a;var e={left:a.left,right:a.right,top:a.top||d,height:a.height||b,bottom:a.bottom||d+(a.height||b),width:a.width||c};return e},n.StringDecoder=function(){return{decode:function(a){if(!a)return"";if("string"!=typeof a)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(a))}}},n.convertCueToDOMTree=function(a,b){return a&&b?g(a,b):null};var u=.05,v="sans-serif",w="1.5%";n.processCues=function(a,b,c){function d(a){for(var b=0;b<a.length;b++)if(a[b].hasBeenReset||!a[b].displayState)return!0;return!1}if(!a||!b||!c)return null;for(;c.firstChild;)c.removeChild(c.firstChild);var e=a.document.createElement("div");if(e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.margin=w,c.appendChild(e),d(b)){var f=[],g=l.getSimpleBoxPosition(e),h=Math.round(g.height*u*100)/100,i={font:h+"px "+v};!function(){for(var c,d,h=0;h<b.length;h++)d=b[h],c=new k(a,d,i),e.appendChild(c.div),m(a,c,g,f),d.displayState=c.div,f.push(l.getSimpleBoxPosition(c))}()}else for(var j=0;j<b.length;j++)e.appendChild(b[j].displayState)},n.Parser=function(a,b,c){c||(c=b,b={}),b||(b={}),this.window=a,this.vttjs=b,this.state="INITIAL",this.buffer="",this.decoder=c||new TextDecoder("utf8"),this.regionList=[]},n.Parser.prototype={reportOrThrowError:function(a){if(!(a instanceof b))throw a;this.onparsingerror&&this.onparsingerror(a)},parse:function(a){function c(){for(var a=i.buffer,b=0;b<a.length&&"\r"!==a[b]&&"\n"!==a[b];)++b;var c=a.substr(0,b);return"\r"===a[b]&&++b,"\n"===a[b]&&++b,i.buffer=a.substr(b),c}function g(a){var b=new d;if(e(a,function(a,c){switch(a){case"id":b.set(a,c);break;case"width":b.percent(a,c);break;case"lines":b.integer(a,c);break;case"regionanchor":case"viewportanchor":var e=c.split(",");if(2!==e.length)break;var f=new d;if(f.percent("x",e[0]),f.percent("y",e[1]),!f.has("x")||!f.has("y"))break;b.set(a+"X",f.get("x")),b.set(a+"Y",f.get("y"));break;case"scroll":b.alt(a,c,["up"])}},/=/,/\s/),b.has("id")){var c=new(i.vttjs.VTTRegion||i.window.VTTRegion);c.width=b.get("width",100),c.lines=b.get("lines",3),c.regionAnchorX=b.get("regionanchorX",0),c.regionAnchorY=b.get("regionanchorY",100),c.viewportAnchorX=b.get("viewportanchorX",0),c.viewportAnchorY=b.get("viewportanchorY",100),c.scroll=b.get("scroll",""),i.onregion&&i.onregion(c),i.regionList.push({id:b.get("id"),region:c})}}function h(a){e(a,function(a,b){switch(a){case"Region":g(b)}},/:/)}var i=this;a&&(i.buffer+=i.decoder.decode(a,{stream:!0}));try{var j;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;j=c();var k=j.match(/^WEBVTT([ \t].*)?$/);if(!k||!k[0])throw new b(b.Errors.BadSignature);i.state="HEADER"}for(var l=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(l?l=!1:j=c(),i.state){case"HEADER":/:/.test(j)?h(j):j||(i.state="ID");continue;case"NOTE":j||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(j)){i.state="NOTE";break}if(!j)continue;if(i.cue=new(i.vttjs.VTTCue||i.window.VTTCue)(0,0,""),i.state="CUE",-1===j.indexOf("-->")){i.cue.id=j;continue}case"CUE":try{f(j,i.cue,i.regionList)}catch(m){i.reportOrThrowError(m),i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var n=-1!==j.indexOf("-->");if(!j||n&&(l=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=j;continue;case"BADCUE":j||(i.state="ID");continue}}}catch(m){i.reportOrThrowError(m),"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var a=this;try{if(a.buffer+=a.decoder.decode(),(a.cue||"HEADER"===a.state)&&(a.buffer+="\n\n",a.parse()),"INITIAL"===a.state)throw new b(b.Errors.BadSignature)}catch(c){a.reportOrThrowError(c)}return a.onflush&&a.onflush(),this}},a.WebVTT=n}(this,this.vttjs||{});
(function() {
	var STORY_HONOR = window.HONOR || {};
	STORY_HONOR.init = function() {
		if ($('div[name="videoPlayContainer"]').length > 0) {
			this.initVideoBox();
			this.initVideoButton();
		}
	};
	STORY_HONOR.initVideoBox = function(videoType, videoRatio, videoURL, videoWebmURL, videoOggURL) {
		var videoHTML;
		if (videoType == 'embed') {
			videoHTML = '<video id="div_video" class="video-js vjs-default-skin vjs-big-play-centered" controls autoplay="false" preload="none" width="100%">'+
							'<source src="' + videoURL + '" type="video/mp4" />'+
							'<source src="' + videoWebmURL + '" type="video/webm" />'+
							'<source src="' + videoOggURL + '" type="video/ogg" />'+
						'</video>';
		} else if (videoType == 'youtube') {
			videoHTML = '<div class="embed-responsive embed-responsive-' + videoRatio + '"><iframe class="embed-responsive-item"  src="https://www.youtube.com/embed/' + videoURL + '?rel=0&amp;autoplay=1&amp;showinfo=0" allowfullscreen></iframe></div>';
		} else if (videoType == 'youku') {
			videoHTML = '<div class="embed-responsive embed-responsive-' + videoRatio + '"><iframe src="http://player.youku.com/embed/' + videoURL + '" allowfullscreen></iframe></div>';
		}

		return videoHTML;
	};

	STORY_HONOR.initVideoButton = function() {
		videojs.options.flash.swf = "http://www.hihonor.com/global/wp-content/themes/honor/js/vendor/video-js.swf";
		var videoPlayer = null;
		var isBlur = false;
		var isIE = true;
		if (BrowserDetect.init() == 'Chrome' || BrowserDetect.init() == 'Safari') {
			isIE = false;
		}
		$('div[name="videoPlayContainer"]').click(function() {
			var videoURL;
			if (STORY_HONOR.checkScreen() == 'x-small' || isIE == true) {
				isBlur = false;
			} else {
				isBlur = true;
			}
			if (isBlur != false) {
				// $('#main, #sideNav, header, footer').foggy({
				//     blurRadius: 8,
				//     opacity: 0.8,
				//     cssFilterSupport: true
				// });
			}
			$('#video-dialog').modal('show');
			
			if ($(this).data('video-type') != 'embed') {
				var temp = STORY_HONOR.initVideoBox($(this).data('video-type')||$(this).attr('data-video-type'), $(this).data('ratio'), $(this).data('video-source'));
				setTimeout(function(){
					$('#video-dialog').find('.video-content').empty().html(temp);
				},500)
				videoURL=$(this).data('video-source');
			} else {
				var temp = STORY_HONOR.initVideoBox($(this).data('video-type'), $(this).data('ratio'), $(this).data('video-source-mp4'), $(this).data('video-source-webm'), $(this).data('video-source-ogg'));
				setTimeout(function(){
				  $('#video-dialog').find('.video-content').empty().html(temp);
				  
//				  videojs("div_video", {}, function() {
//						videoPlayer = this;
//						$('#div_video').css('height', $('#video-dialog .modal-body').height());
//					});
				},500);
				videoURL=$(this).data('video-source-mp4');
			}
			
			//ga code start
        	window.dataLayer.push({"event": "video","videoStep":"play","videoURL":videoURL})
        	//ga code end
			return false;
		});
		
		$('#video-dialog .close-video-btn').click(function() {
			try{
				if (videoPlayer != null) {
					videoPlayer.dispose();
				}
			}catch(e){}finally{
				$('#video-dialog').find('.video-content').empty();
			}
			
			
			$('#video-dialog').modal('hide');
			return false;
		});
		$('#video-dialog').on('shown.bs.modal', function(e) {
			if (videoPlayer != null) {
				$('#div_video').css('height', $('#video-dialog .modal-body').height());
			}
			if (!isBlur) {
				$('.modal-backdrop').css({
					'background-color' : '#000'
				});
			}
		});
		$('#video-dialog').on('hidden.bs.modal', function(e) {
			if (videoPlayer != null) {
				videoPlayer.dispose();
			}
			$('#video-dialog').find('.video-content').empty();
			if (isBlur) {
				// $('#main, #sideNav, header, footer').foggy(false);
			} else {
				$('.modal-backdrop').css({
					'background-color' : 'transparent'
				});
			}
		});
		$(window).bind('resizeEnd', function() {
			if (videoPlayer != null) {
				$('#div_video').css('height', $('#video-dialog .modal-body').height());
			}
		});

	};

	STORY_HONOR.checkScreen = function() {
		if ($('.visible-xs').css('display') == 'block') {
			return 'x-small';
		} else if ($('.visible-sm').css('display') == 'block') {
			return 'small';
		} else if ($('.visible-md').css('display') == 'block') {
			return 'medium';
		} else if ($('.visible-lg').css('display') == 'block') {
			return 'large';
		}
	};

	var BrowserDetect = window.BrowserDetect || {};

	BrowserDetect.init = function() {
		this.browser = this.searchString(this.dataBrowser) || "Other";
		this.version = this.searchVersion(navigator.userAgent) || this.searchVersion(navigator.appVersion) || "Unknown";
		return this.browser;
	};

	BrowserDetect.searchString = function(data) {
		for (var i = 0; i < data.length; i++) {
			var dataString = data[i].string;
			this.versionSearchString = data[i].subString;
			if (dataString.indexOf(data[i].subString) != -1) {
				return data[i].identity;
			}
		}
	};

	BrowserDetect.searchVersion = function(dataString) {
		var index = dataString.indexOf(this.versionSearchString);
		if (index == -1)
			return;
		return parseFloat(dataString.substring(index + this.versionSearchString.length + 1));
	};

	BrowserDetect.dataBrowser = [ {
		string : navigator.userAgent,
		subString : "Chrome",
		identity : "Chrome"
	}, {
		string : navigator.userAgent,
		subString : "MSIE",
		identity : "Explorer"
	}, {
		string : navigator.userAgent,
		subString : "Firefox",
		identity : "Firefox"
	}, {
		string : navigator.userAgent,
		subString : "Safari",
		identity : "Safari"
	}, {
		string : navigator.userAgent,
		subString : "Opera",
		identity : "Opera"
	} ];

	(function($) {
	})(jQuery);

	window.onload = function() { 
		if($('.ourstories').length>0){ 
			var slideNum =0;
			$('.ourstories .gallery-thumbs .swiper-wrapper .swiper-slide').each(function(){
				slideNum++
			}) 
			setTimeout(function() {
				var galleryTop = new Swiper('.ourstories .gallery-top', {
					spaceBetween : 16,
					navigation : {
						nextEl : '.ourstories .swiper-button-next',
						prevEl : '.ourstories .swiper-button-prev',
					},
					loop : true,
					loopedSlides: slideNum,
					autoplay : true,
					delay : 8000
				});
				var galleryThumbs = new Swiper('.ourstories .gallery-thumbs', {
					spaceBetween : 16,
					loop : true,
					loopedSlides: slideNum,
					centeredSlides : true,
					slidesPerView : 'auto',
					touchRatio : 0.2,
					slideToClickedSlide : true
				});
				
				$(".ourstories .gallery-thumbs").on("click", ".swiper-slide", function(){
					galleryTop.autoplay.stop();
				});
				
				if (galleryTop && galleryTop.controller) {
					galleryTop.controller.control = galleryThumbs;
					galleryThumbs.controller.control = galleryTop;
				}
				
				BrowserDetect.init();
				STORY_HONOR.init();
			}, 500)
		}
	}
})();
/*!
 *	Themes List Tabs By Xudongming
 * 	themes-list-tabs - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($(".themes-list-tabs .themesTabs").length > 0) {
			function bindHover() {
				$(".themesTabs .normal").off("mouseenter").off("mouseleave");
				var ww = utils.pageWidth();
				var moveWidth;
				var arabic_moveWidth;
				var moveHeight = '-16px';
				if(ww >=1024) {
					moveWidth = '-16px';
					arabic_moveWidth = '16px';
				} else {
					moveWidth = 0;
					arabic_moveWidth = 0;
					moveHeight = '-8px';
				}
				$(".themesTabs").on("mouseenter", ".normal", function(){
				    var arabicLength = $(".__arabic__").length;
					if(arabicLength > 0) {
						$(this).find(".tabTitle").css({"transform":"translate(" + arabic_moveWidth + "," + moveHeight + ")"}).css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
					} else {
						$(this).find(".tabTitle").css({"transform":"translate(" + moveWidth + "," + moveHeight + ")"}).css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
					}
	    	    }).on("mouseleave", ".normal", function(){
	    	    	if(!$(this).hasClass("active")) {
	    	    		$(this).find(".tabTitle").css({"transform":"translate(0,0)","transition":"transform 1.5s cubic-bezier(.22, .89, .57, 1)"});
	    	    	}
	    	    });
			}
			
			bindHover();
			
			//tabs 内容切换
			function changeModel() {
				$(".themesTabs").on("click", ".tab", function() {
					var thisTarget = $(this).attr("data-content");
					$("#category").text(thisTarget).trigger("click");
					$(this).removeClass("normal").addClass("active").siblings(".active").removeClass("active").addClass("normal");
					$(this).siblings(".tab").find(".tabTitle").css({"transform":"translate(0,0)","transition":"transform 1.5s cubic-bezier(.22, .89, .57, 1)"});
					bindHover();
					
					//GA CODE
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Categories Page+"+honorConfig.pageType,
						"eventAction": "Public Module",
						"eventLabel": thisTarget
					})
				});
			}
			
			changeModel();
			
			//获取分类tab
			var api = themesBaseData.apiUrl;
			if($('#themesHeader .loginout-data').length > 0) {
				api = $('#themesHeader .loginout-data').attr("data-loginredirecturl").split('/abroad/')[0] || themesBaseData.apiUrl;
			}
			function getCategoryList() {
				var obj = {
					activityName: "wallpaper_design_contest",
					lang: themesBaseData.lang
				}
				$.ajax({
					type: "POST",
					data: obj,
					url: api + "/abroad/wallpaper/getCategoryList",
					dataType: 'json',
					xhrFields: {
			            withCredentials: true
			        },
					success: function(data) {
						var tabHtml;
						var tabArray = [];
						var data = data.infoBean;
						var activeClass;
						for(var i = 0; i < data.length; ++i) {
							activeClass = i === 0 ? " active" : "";
							tabHtml = '<div class="tab normal' + activeClass + '" data-content="' + data[i].nodeName + '">' +
									  '<div class="main-box-bg"></div>' +
									  '<span class="tabTitle">' + data[i].value + '</span>' +
									  '</div>';
							tabArray[tabArray.length] = tabHtml;
						}
						$(".themesTabs").html(tabArray.join(""));
						
						$("#category").text(data[0].nodeName).trigger("click");
					}
				})
			}
			getCategoryList();
        }
	})
}());
$(function() {
	// get data
	var pageInfoText = $(".news-list-data-holder").data("page-info-text");
	
	// process flag
	if ($(".newList_").length < 1)
		return;

	var isFirefox = (navigator.userAgent.indexOf('Firefox') > 0);
	
	/* !art-template - Template Engine | http://aui.github.com/artTemplate/ */
	//获取便签列表
	var getTagData = function() {
		// debugger;
		var data = JSON.parse($('div[name="tag"]').text() || "[]");

		//pc
		if ($("#newsListTagP").length > 0) {
			var temp = template('newsListTagP', {
				list : data
			});
			$('div[name="newsBtnGroup"]').html(temp);
		}

		//mobile
		if ($("#newsListTagM").length > 0) {
			var temp = template('newsListTagM', {
				list : data
			});
			$('div[name="newsSelectModalContent"]').html(temp);
		}
	}

	
	
	//新闻列表 超出部分隐藏效果
	//判断lastnews div高度超出两行
	
	var renderListStyle = function(){
		var arrObj = $('.inner-third-desc');
		for(var i=0;i<arrObj.length;i++){
			if($(arrObj[i]).height()>40){
				$(arrObj[i]).parent().addClass('inner-third-after');
				$(arrObj[i]).css({"overflow":"hidden","max-height":"37px"});
			}
		}
		
	}
	
	/*
	 *新闻列表
	 *@param 
	 **/
	var getNewsListData = function(isFilter) {
		location.hash = pageObj.pageNo;
		var bodyWidth = document.body.offsetWidth;
		var data = JSON.parse($('div[name="list-news"]').text() || "[]");
		//取出标签的值 过滤
//		  debugger;
		var TagStr = '';
		var TagArr = [];

		if (bodyWidth <= 768) {//手机上
			TagStr = $('div[name="newsSelectModalContent"]').find('.item-selected').attr('tag') || '';
			var arrObj = $('div[name="newsSelectModalContent"]').find('.item-selected');
			for (var j = 0; j < arrObj.length; j++) {
				TagArr.push($(arrObj[j]).attr('tag'));
			}
		} else {
			TagStr = $('div[name="newsBtnGroup"]').find('.item-selected').attr('tag') || '';
			var arrObj = $('div[name="newsBtnGroup"]').find('.item-selected');
			for (var j = 0; j < arrObj.length; j++) {
				TagArr.push($(arrObj[j]).attr('tag'));
			}
		}

		var realData = [];
		if (TagStr == "" || /ALL/.test(TagStr)) {
			realData = data;
		} else {
			for (var i = 0; i < data.length; i++) {
				for (var k = 0; k < TagArr.length; k++) {
					if (data[i].tag && data[i].tag == TagArr[k]) {
						realData.push(data[i]);
					}else if(data[i].tag&&data[i].tag instanceof Array){//多个标签的情况
						data[i].tag.map(function(item){
							if(item==TagArr[k]){
								realData.push(data[i]);
							}
						})
					}
				}
			}
		}

		//数组去重
		var o = {};
		var new_arr = [];
		for (var i = 0; i < realData.length; i++) {
			var k = realData[i].id;
			if (!o[k]) {
				o[k] = true;
				new_arr.push(realData[i]);
			}
		}

		realData = new_arr;

		if (bodyWidth <= 768) {//手机上
			//mobile
			var tempM = '';

			if ($('#newsListContentM').text()) {
				tempM = template('newsListContentM', {
					list : realData.slice((pageObj.pageNo - 1) * pageObj.pageSizeMobile, pageObj.pageNo * pageObj.pageSizeMobile)
				});
			}
			//var tempM  = template('newsListContentM', {list:realData.slice((pageObj.pageNo-1)*pageObj.pageSizeMobile,pageObj.pageNo*pageObj.pageSizeMobile)});
			if (isFilter) {
				$('ul[name="newListM"]').html(tempM);
			} else {
				$('ul[name="newListM"]').append(tempM);
			}
			if(realData.slice((pageObj.pageNo - 1) * pageObj.pageSizeMobile, pageObj.pageNo * pageObj.pageSizeMobile).length<4){
				$('a[name="showMore"]').hide();
			}else{
				$('a[name="showMore"]').show();
			}
		} else {
			//pc
			// var temp  = template('newsListContent', {list:realData.slice((pageObj.pageNo-1)*pageObj.pageSize,pageObj.pageNo*pageObj.pageSize)});
			var temp = '';
			if ($('#newsListContent').text()) {
				temp = template('newsListContent', {
					list : realData.slice((pageObj.pageNo - 1) * pageObj.pageSize, pageObj.pageNo * pageObj.pageSize)
				});
			}

			$('ul[name="newList"]').html(temp);
			initPage(realData); //初始化页码
		}
		
//		clampDesc();
	
		renderListStyle();
	}

	// 分页的全局对象
	var pageObj = {
		pageNo : 1,
		pageSize : 9,
		pageSizeMobile : 4,
		pageCount : 0
	}

	var hash = location.hash;
	if (hash) {
		var hashInt = parseInt(hash.substring(1));
		if (!isNaN(hashInt)) {
			pageObj.pageNo = hashInt;
		}
	}

	var initPage = function(data) {
		// debugger;
		var temp = '<a href="javascript:void(0);" name="prev"><span class="fa fa-caret-left"></span></a>&nbsp;';
		var pageCount = Math.ceil(data.length / 9);
		pageObj.pageCount = pageCount; //总的页码

		for (var i = 0; i < pageCount; i++) {
			temp += '<a href="javascript:void(0);" class="' + (i == (pageObj.pageNo - 1) ? "on" : "") + '">' + (i + 1) + '</a>&nbsp;';
		}
		temp += '<a href="javascript:void(0);" name="next"><span class="fa fa-caret-right"></span></a>';
		$('div[name="page-container"]').find('.page-num').html(temp);
		if(pageInfoText){
			pageInfoText = pageInfoText.replace("$1", "<b>" + ((pageObj.pageNo - 1) * 9 + 1) + "</b>").replace("$2", "<b>" + (pageObj.pageNo * 9 > data.length ? data.length : pageObj.pageNo * 9) + "</b>").replace("$3", "<b>" + data.length + "</b>");
		}
		/*$('div[name="page-container"]').find('.tips').html('Showing ' + ((pageObj.pageNo - 1) * 9 + 1) + ' - ' + (pageObj.pageNo * 9 > data.length ? data.length : pageObj.pageNo * 9) + ' of ' + data.length + ' results');*/
		$('div[name="page-container"]').find('.tips').html(pageInfoText);
		if (pageCount > 1) {
			$('div[name="page-container"]').find('.page-num').css("display", "block");
		} else {
			$('div[name="page-container"]').find('.page-num').css("display", "none");
		}
	}

	var bindClick = function() {
		$('i[name="newsIcon"]').on('click', function() {
			$(this).toggleClass('font-Minus');
			$(this).toggleClass('font-Plus');
			// $(this).removeClass('font-Plus').addClass('font-Minus');
			$('div[name="newsSelectModal"]').toggle();
		})

		//加载更多
		$('a[name="showMore"]').on('click', function() {
			pageObj.pageNo = pageObj.pageNo + 1;
			getNewsListData();
		});

		//新闻标签选择
		$('div[name="newsSelectModalContent"]').on('touchstart', '.item-ff', function(e) {
			//              debugger;		
			if ($(this).attr('tag') == 'ALL') {
				$(this).addClass('item-selected');
				$(this).siblings().removeClass('item-selected');
			} else {
				$('a[name="newsBtnM-Item"]:first-child').removeClass('item-selected');
				$(this).addClass('item-selected');
			}

		})

		//清楚标签选项
		$('a[name="CLEAR"]').on('click', function() {
			$('a[name="newsBtnM-Item"]').removeClass('item-selected');
			pageObj.pageNo = 1;
			getNewsListData();
		});

		//提交选项
		$('a[name="APPLY"]').on('click', function(e) {
			pageObj.pageNo = 1;
			getNewsListData(true);
			$('i[name="newsIcon"]').addClass('font-Plus').removeClass('font-Minus');
			$('div[name="newsSelectModal"]').toggle();
		});

		//pc选择
		$('div[name="newsBtnGroup"]').on('click', 'a[name="newsBtn-Item"]', function(e) {
			if (/ALL/.test($(this).attr('tag'))) {
				$(this).addClass('item-selected');
				$(this).siblings().removeClass('item-selected');
			} else {
				// $('a[tag="ALL"]').removeClass('item-selected');
				$('a[tag="ALL"]').removeClass('item-selected');
				$('a[name="newsBtnM-Item"]:first-child').removeClass('item-selected');
				$(this).toggleClass('item-selected');
			}
			pageObj.pageNo = 1;
			getNewsListData();
		})

		//pc
		$('ul[name="newList"]').on('click', 'li', function() {
			var detailUrl = $(this).data("detail-url");
			location.href = detailUrl;
		})
		//手机
		$('ul[name="newListM"]').on('click', 'li', function() {
			var detailUrl = $(this).data("detail-url");
			location.href = detailUrl;
		})

		$('div[name="page-container"]').on('click', 'a:not(.on)', function(e) {
			var pageNo = $(this).text() || $(this).attr('name');
			if (!isNaN(pageNo)) {
				pageObj.pageNo = parseInt(pageNo);
			} else { //点击了前进后退的页码
				if (/prev/.test(pageNo)) {
					if (pageObj.pageNo == 1) {
						return false;
					}
					pageObj.pageNo = pageObj.pageNo - 1;
				} else {
					if (pageObj.pageNo >= pageObj.pageCount) {
						return false;
					}
					pageObj.pageNo = pageObj.pageNo + 1;
				}
			}
			window.scrollTo(0, 0);
			getNewsListData();
		})
	}
	
/*	function clampDesc() {
		if (!isFirefox) {
			$(".newList_ .inner-third").each(function() {
				$clamp(this, {clamp : 2});
			});
		}
	}

	window.onresize = function() {
		clampDesc();
	}*/

	getTagData();
	getNewsListData();
	bindClick();
	
	

	
//	renderListStyle();

});
/*!
 *	Blog News Event Home Component By Xudongming
 * 	blog-news-event-home - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($(".news-blog-events-home-component").length > 0) {
			var ww = utils.pageWidth();
//			内容列表填充
			function addContentList() {
				var itemtype = $(".item-tags.active").find(".tabsBtn").attr("itemtype");
				var dataList;
				if($("#" + itemtype).text() && $("#" + itemtype).text() != "[]") {
					dataList = JSON.parse($("#" + itemtype).text());
					var itemTopHtml; //第一条内容
					var dataOne = dataList[0];
					var pcImg = dataOne.img;
					var mbImg = dataOne.imgMB;
					var dataImg;
					if(!mbImg) {
						dataImg = pcImg;
					} else {
						if(ww > 768) {
							dataImg = pcImg;
						} else {
							dataImg = mbImg;
						}
					}
					var dataOneTag;
					if(dataOne.tag.length > 0) {
						dataOneTag = dataOne.tag[0]['tagTitle'];
					} else {
						dataOneTag = "";
					}
					var readMore = $("#readMore").val() || "Read More";
					itemTopHtml = '<div class="leftImg honor-loading-v2">' +
								'<a href="' + dataOne.url + '">' +
								'<img class="lazy" data-original="' + dataImg + '"/>' +
								'</a>' +
								'</div>' +
								'<div class="rightContent">' +
								'<a href="' + dataOne.url + '">' +
								'<div class="realContent">' +
								'<div class="top">' +
								'<span class="date">' + dataOne.date + '</span>' +
								'<span class="links-tag">' + dataOneTag + '</span>' +
								'</div>' +
								'<div class="middle">' +
								'<h3>' + dataOne.title + '</h3>' +
								'<div class="pContent"><p class="middleContent">' +
								dataOne.desc +	
								'</p></div>' +
								'</div>' +
								'<div class="bottom">' +
								'<a href="' + dataOne.url + '">' + readMore + '</a>' +
								'</div>' +
								'</div>' +
								'</a>' +
								'</div>';
					$(".contentList").find(".itemTop").html(itemTopHtml);
					if(ww >= 1024) {
						$(".news-blog-events-home-component").find(".circle-sm").show();
						$(".news-blog-events-home-component").find(".circle-bg").show();
					}
					$(".news-blog-events-home-component").find("img.lazy").lazyload({effect: "fadeIn"});
					
					//填充底部列表
					var itemListArray = [];
					var itemListHtml;
					var finalItemListHtml;
					for(var i = 1; i < dataList.length; i++) {
						var pcImg = dataList[i].img;
						var mbImg = dataList[i].imgMB;
						var dataImg;
						if(!mbImg) {
							dataImg = pcImg;
						} else {
							if(ww > 768) {
								dataImg = pcImg;
							} else {
								dataImg = mbImg;
							}
						}
						var dataListTag;
						if(dataList[i].tag.length > 0) {
							dataListTag = dataList[i].tag[0]['tagTitle'];
						} else {
							dataListTag = "";
						}
						itemListHtml = '<div class="listRoom">' +
									'<div class="topImg honor-loading-v2">' +
									'<a href="' + dataList[i].url + '">' +
									'<img class="lazy" data-original="' + dataImg + '"/>' +
									'</a>' +
									'</div>' +
									'<div class="bottomContent">' +
									'<div class="main-box-bg"></div>' +
									'<a href="' + dataList[i].url + '">' +
									'<div class="realContent">' +
									'<div class="top">' +
									'<span class="date">' + dataList[i].date + '</span>' +
									'<span class="links-tag">' + dataListTag + '</span>' +
									'</div>' +
									'<div class="middle">' +
									'<h3>' + dataList[i].title + '</h3>' +
									'<div class="pContent"><p class="middleContent">' +
									dataList[i].desc +
									'</p></div>' +
									'</div>' +
									'<div class="bottom">' +
									'<a href="' + dataList[i].url + '">' + readMore + '</a>' +
									'</div>' +
									'</div>' +
									'</a>' +
									'</div>' +
									'</div>';
						itemListArray[itemListArray.length] = itemListHtml;
					}
					
					finalItemListHtml = itemListArray.join("");
					$(".contentList").find(".itemList").html(finalItemListHtml);
					$(".news-blog-events-home-component").find(".listRoom img.lazy").lazyload({effect: "fadeIn"});
					
					
					if(ww >=1024) {
						$(".brandTab-lists .listRoom").hover(function(){
						    $(this).find(".bottomContent").css({"height":"248px","transition":"height 1.5s cubic-bezier(.22, .89, .57, 1)"});
						    var arabicLength = $(".__arabic__").length;
							if(arabicLength > 0) {
								$(this).find(".realContent").css({"transform":"translate(1rem,-1rem)"}).css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
							} else {
								$(this).find(".realContent").css({"transform":"translate(-1rem,-1rem)"}).css("transition","transform 1.5s cubic-bezier(.22, .89, .57, 1)");
							}
							$(this).find(".bottom").show();
							$(this).find(".pContent").css({"height":"46px","transition":"height 1.5s cubic-bezier(.22, .89, .57, 1)"});
			    	    }).mouseleave(function(){
			    	    	$(this).find(".bottomContent").css({"height":"170px","transition":"height 1.5s cubic-bezier(.22, .89, .57, 1)"});
			    	    	$(this).find(".realContent").css({"transform":"translate(0,0)","transition":"transform 1.5s cubic-bezier(.22, .89, .57, 1)"});
			    	    	$(this).find(".bottom").hide();
			    	    	$(this).find(".pContent").css({"height":"0","transition":"height 1.5s cubic-bezier(.22, .89, .57, 1)"});
			    	    });
					}
					$(".viewMore").show();
					$(".contentList").find(".nodata").hide();
				} else {
					$(".contentList").find(".nodata").show();
					$(".viewMore").hide();
				}
			}
			
			setTimeout(function(){
				addContentList();
			});
			
			
//			给第一个tab添加active样式
			$(".tabs").find(".item-tags:first").addClass("active");
			if($(".tabs").find(".item-tags:first").children(".tabsBtn").attr("itemtype") != "news"){
				$(".brandTab-lists .tabs .top-nav").hide();
				//编辑环境需要显示Media Contact组件
				if($("#wcmmodeEdit").length==0){
					$(".media-contact .media-contact-box").css("height","0");
				}
			}
//			tabs 点击切换事件
			$(".tabs").on("click", ".item-tags", function() {
				var _this = $(this);
				_this.siblings(".item-tags").removeClass("active");
				_this.addClass("active");
				//newsTabs不是news时不显示锚点导航
				if(_this.children(".tabsBtn").attr("itemtype") != "news"){
					$(".brandTab-lists .tabs .top-nav").hide();
					$(".media-contact .media-contact-box").css("height","0");
				}else{
					$(".brandTab-lists .tabs .top-nav").show();
					$(".media-contact .media-contact-box").css("height","auto");
				}
				
				//切换时返回顶部
				$('body,html').animate({scrollTop: '0'}, 100);
				
				vierMoreLink();
				addContentList();
			});
			
			setTimeout(function(){
        		var nav=$(".top-nav span").eq(0).attr("id");
        		var top;
        		if(utils.windowWidth()>768 && $('.media-contact').length>0){
        			$("#"+nav).parent("a").attr("href","javascript:;").attr("target","");
        			top=$(".media-contact").offset().top-320;
        		}
				$("#"+nav).click(function(){
					$("html,body").animate({ scrollTop:top}, 1000);
				})
        	},1000);
			
//			view more 添加链接
			function vierMoreLink(){
				var itemtype = $(".tabs").find(".active .tabsBtn").attr("itemtype");
				var viewMoreLink = $(".aHref[itemtype='" + itemtype + "']").text();
				$(".viewMore").find("a").attr("href", viewMoreLink);
			}
			
			vierMoreLink();
			
//			url参数定位tab导航位置
			function locatedTab() {
				var urlParameter = "news";
//				if(utils.getRequest().type) {
//					urlParameter = utils.getRequest().type;
//				}
				//"?"获取传参，显示产品分类
				var urltype = utils.getRequest().type;
				//"."获取传参，显示产品分类
				var getNewsUrl = window.location.href;
				var urlParameter;
				if(urltype){
					urlParameter=urltype.replace(/\//g, "");
				}else{
					urlParameter = getNewsUrl.split("news-events-trends.")[1];
				}
				if (urlParameter != "" && urlParameter !== undefined) {
			        if (urlParameter.indexOf('.html') != -1) {
			        	urlParameter = urlParameter.split(".html")[0];
			        }else if (urlParameter.indexOf('html') != -1) {
			        	urlParameter = urlParameter.split("html")[0];
			        } else if (urlParameter.indexOf('/?') != -1) {
			        	urlParameter = urlParameter.split("/?")[0];
			        } else if (urlParameter.indexOf('?') != -1) {
			        	urlParameter = urlParameter.split("?")[0];
			        }
			        urlParameter=urlParameter.replace(/\//g, "");
			    }
				if(urlParameter) {
					$(".brandTab-lists").find(".tabsBtn[itemtype='" + urlParameter + "']").trigger("click");
				}
			}
			
			setTimeout(function(){
				locatedTab();
			});
			
			// 圆圈跟随页面滚动特效
			var m=4,a=0,x=-314,y=310;
			var n=2,b=0,h=-475,i=712;
			function smCircleMove(type){
				if(type=='down'){
					$(".news-blog-events-home-component .circle-sm").animate({
						right:(x+=m*Math.cos((a++)/200))+'px',
						top:(y+=m*Math.sin((a++)/200))+'px'
					},5,function(){
						smCircleMove(type);
						if(a>=148){
							$(".news-blog-events-home-component .circle-sm").stop();
						}
					});
				}else{
					$(".news-blog-events-home-component .circle-sm").animate({
						right:(x+=-m*Math.cos((a--)/200))+'px',
						top:(y+=-m*Math.sin((a--)/200))+'px'
					},5,function(){
						smCircleMove(type);
						if(a<=-2){
							m=4,a=0,x=-310,y=310;
							$(".news-blog-events-home-component .circle-sm").stop();
						}
					});
				}
			}	
			function bgCircleMove(type){
				if(type=='down'){
					$(".news-blog-events-home-component .circle-bg").animate({
						right:(h+=n*Math.cos((b++)/100))+'px',
						top:(i+=-n*Math.sin((b++)/100))+'px'
					},5,function(){
						bgCircleMove(type);
						if(b>=148){
							$(".news-blog-events-home-component .circle-bg").stop();
						}
					});
				}else{
					$(".news-blog-events-home-component .circle-bg").animate({
						right:(h+=-n*Math.cos((b--)/100))+'px',
						top:(i+=+n*Math.sin((b--)/100))+'px'
					},5,function(){
						bgCircleMove(type);
						if(b<=-2){
							n=2,b=0,h=-475,i=712;
							$(".news-blog-events-home-component .circle-bg").stop();
						}
					});
				}
			}
			
			// 判断页面上下滚动方向
			var scrollData = {
				y: 'undefined',
				diffY:0,
				scrollDirection:'down'
			}
			function scrollFunc() {
			    if (typeof scrollData.y == 'undefined') {
			    	scrollData.y = window.pageYOffset;
			    }
			    scrollData.diffY = window.pageYOffset-scrollData.y;
			    if (scrollData.diffY > 0) {
			        // Scroll down
			    	scrollData.scrollDirection = 'down';
			    } else if (scrollData.diffY < 0) {
			        // Scroll up
			    	scrollData.scrollDirection = 'up';
			    }
			    scrollData.y = window.pageYOffset;
			}
			
			function scrollNav(){
				//添加悬浮导航
	        	if($(document).scrollTop()!=0){
	        		$(".brandTab-lists .tabs").addClass("fixed");
	        	}else{
	        		$(".brandTab-lists .tabs").removeClass("fixed");
	        	}
			}
			
			if(ww > 768){
				scrollNav();
			}
			
			
			//页面滚动监听
			window.onscroll = function(e) {
				// 实时获取滚动方向
				scrollFunc();
		        
	        	// 圆圈跟随页面上下滚动效果
	        	smCircleMove(scrollData.scrollDirection);
	        	bgCircleMove(scrollData.scrollDirection);
	        	
	        	if(ww > 768){
					scrollNav();
				}
			}
		}
	})
}());
(function() {
	$(document).ready(function () {
			//页面是否加载media组件
			if ($('.media-contact').length > 0) {
				// 组件背景设置
	        	var componentBg = '';
	        	
	        	var apiurl=$("#apiUrl").val();
	        	var subject = 'Information from ' + $('.contact-text.name').val();
	        	var site = $("#apiSite").val();
	        	var email = $(".contact-from li .contact-text.email");
	        	var name = $(".contact-from li .contact-text.name");
	        	var company = $(".contact-from li .contact-text.company");
	        	var pageurl = $(".contact-from li .contact-text.pageurl");
	        	var message = $(".contact-from li .contact-textarea.message");
	        	var radioSelect = $(".contact-from li .radio-box label");
	        	var radioSelectVal = $(".contact-from li .radio-box label.on input").val();
	        	var emailName = email.attr("placeholder");
	        	var emailVal = email.val();
	        	var userName = name.attr("placeholder");
	        	var userVal = name.val();
	        	var companyName = company.attr("placeholder");
	        	var companyVal = company.val();
	        	var pageurlName = pageurl.attr("placeholder");
	        	var pageurlVal = pageurl.val();
	        	var messageName = message.attr("placeholder");
	        	var messageVal = message.val();
	        	var toAddress = $("#toAddress").val();
	        	
	        	if(utils.windowWidth()>768){
	        		componentBg= $('.media-contact .media-content').data('pcbgimg');
	        	}else{
	        		componentBg= $('.media-contact .media-content').data('mbbgimg');
	        	}
	        	if(componentBg){
	        		$('.media-contact .media-content').css('background-image','url('+componentBg+')');
	        	}
	        		
	        	$('.contact-from li .contact-text,.contact-from li .contact-textarea').focus(function(){
	        		$(this).parent().addClass("on");
	        	});
	        	
	        	$('.contact-from li .contact-text,.contact-from li .contact-textarea').blur(function(){
	        		$(this).parent().removeClass("on");
	        		var val = $(this).val();
	        		if($(this).hasClass("email")){
	        			var reg = /[^`~!@#$%\^&\*\(\)\+=\|\{\}\':;\',\\\[\]<>\/\?~！@#￥%……&\*（）——+\|\{\}【】‘；：”“’。，、？\s]{1,}@[^`~!@#$%\^&\*\(\)\+=\|\{\}\':;\',\\\[\]\.<>\/\?~！@#￥%……&\*（）——+\|\{\}【】‘；：”“’。，、？\s]{1,}\.[^`~!@#$%\^&\*\(\)\+=\|\{\}\':;\',\\\[\]<>\/\?~！@#￥%……&\*（）——+\|\{\}【】‘；：”“’。，、？\s]{1,}/i;
		        		if(val=="" || !reg.test(val)){
		        			$(this).next(".text").fadeIn();
		        		}else{
		        			$(this).next(".text").fadeOut();
		        		}
	        		}else{
	        			if(val==""){
		        			$(this).next(".text").fadeIn();
		        		}else{
		        			$(this).next(".text").fadeOut();
		        		}
	        		}
	        		
	        		
	        	});

		        if(radioSelect.length>0){
		        	$(".pp-item .contact-link.tc").click(function(){
		        		var i=$(this).parent(".pp-item").index();
		        		$(".item-content").eq(i).children(".hp-popup.tc-text").show();
		        		$("html,body").css("overflow","hidden");
		        	})
		        	
		        	$(".pp-item .contact-link.pp").click(function(){
		        		var i=$(this).parent(".pp-item").index();
		        		$(".item-content").eq(i).children(".hp-popup.pp-text").show();
		        		$("html,body").css("overflow","hidden");
		        	})
		        	
		        	$(".contact-from li.pp-text .pp-item label .ckbox").click(function(){
			        		if($(this).is(":checked")){
			        			$(this).parents(".pp-item").find(".cktext").fadeOut();
			        		}else{
			        			$(this).parents(".pp-item").find(".cktext").fadeIn();
			        		}
		        	})
		        	
		        }else{
		        	$(".contact-link.tc").click(function(){
		        		$(".media-contact-box .hp-popup.tc-text").show();
		        		$("html,body").css("overflow","hidden");
		        	})
		        	
		        	$(".contact-link.pp").click(function(){
		        		$(".media-contact-box .hp-popup.pp-text").show();
		        		$("html,body").css("overflow","hidden");
		        	})
		        	$(".contact-from li.pp-text label .ckbox").click(function(){
			        		if($(".contact-from li .ckbox").is(":checked")){
			        			$(".cktext").fadeOut();
			        		}else{
			        			$(".cktext").fadeIn();
			        		}
		        	})
		        }
		        
		        $(".media-contact-box .hp-popup .honorFont-close").click(function(){
	        		$(this).parents(".hp-popup").hide();
	        		$("html,body").css("overflow","auto");
	        	})
		        
		        $(".contact-from li .radio-box label").click(function(){
		        	radioSelect.parent(".radio-box").next(".text").fadeOut();
		        	var index = $(this).index();
		        	$(this).addClass("on").siblings().removeClass("on");
		        	if($(this).hasClass("on")){
		        		$(".contact-from li.pp-text .pp-item").eq(index).show().siblings().hide();
		        	}
		        })
		        
		        
		        
				$(".contact-btn").click(function(){
					
		        	checkFrom();
	
				})
				
				function checkFrom(){
	        		
	        		subject = 'Information from ' + $('.contact-text.name').val();
		        	radioSelectVal = $(".contact-from li .radio-box label.on input").val();
		        	radioAddress = $(".contact-from li .radio-box label.on input").attr("forEmail");
		        	emailVal = email.val();
		        	userVal = name.val();
		        	companyVal = company.val();
		        	pageurlVal = pageurl.val();
		        	messageVal = message.val();
		        	
		        	var content = '<table border="1" cellpadding="0" cellspacing="0">';
	        		if(radioSelect.length>0){//判断是否有radio按钮
	        			content += '<tr>';
	        				content += '<td width="130" style="width:130px; font-weight:bold; padding: 5px 15px;">';
	        				content += 'type';
	        				content += '</td>';
	        				content += '<td style="padding: 5px 15px;">';
	        				content += '' + radioSelectVal + '';
	        				content += '</td>';
	        			content += '</tr>';
	        		}
	        		if(email.length>0){//判断是否有email文本框
	        			content += '<tr>';
	        				content += '<td width="130" style="width:130px; font-weight:bold; padding: 5px 15px;">';
	        				content += '' + emailName + '';
	        				content += '</td>';
	        				content += '<td style="padding: 5px 15px;">';
	        				content += '' + emailVal + '';
	        				content += '</td>';
	        			content += '</tr>';
	        		}
	        		if(name.length>0){//判断是否有name文本框
	        			content += '<tr>';
	        				content += '<td width="130" style="width:130px; font-weight:bold; padding: 5px 15px;">';
	        				content += '' + userName + '';
	        				content += '</td>';
	        				content += '<td style="padding: 5px 15px;">';
	        				content += '' + userVal + '';
	        				content += '</td>';
	        			content += '</tr>';
	        		}
	        		if(company.length>0){//判断是否有company文本框
	        			content += '<tr>';
	        				content += '<td width="130" style="width:130px; font-weight:bold; padding: 5px 15px;">';
	        				content += '' + companyName + '';
	        				content += '</td>';
	        				content += '<td style="padding: 5px 15px;">';
	        				content += '' + companyVal + '';
	        				content += '</td>';
	        			content += '</tr>';
	        		}
	        		if(pageurl.length>0){//判断是否有pageurl文本框
	        			content += '<tr>';
	        				content += '<td width="130" style="width:130px; font-weight:bold; padding: 5px 15px;">';
	        				content += '' + pageurlName + '';
	        				content += '</td>';
	        				content += '<td style="padding: 5px 15px;">';
	        				content += '' + pageurlVal + '';
	        				content += '</td>';
	        			content += '</tr>';
	        		}
	        		if(message.length>0){//判断是否有message文本框
	        			content += '<tr>';
	        				content += '<td width="130" style="width:130px; font-weight:bold; padding: 5px 15px;">';
	        				content += '' + messageName + '';
	        				content += '</td>';
	        				content += '<td style="padding: 5px 15px;">';
	        				content += '' + messageVal + '';
	        				content += '</td>';
	        			content += '</tr>';
	        		}
	        		content += '</table>';
	        		
	        		var reg = /[^`~!@#$%\^&\*\(\)\+=\|\{\}\':;\',\\\[\]<>\/\?~！@#￥%……&\*（）——+\|\{\}【】‘；：”“’。，、？\s]{1,}@[^`~!@#$%\^&\*\(\)\+=\|\{\}\':;\',\\\[\]\.<>\/\?~！@#￥%……&\*（）——+\|\{\}【】‘；：”“’。，、？\s]{1,}\.[^`~!@#$%\^&\*\(\)\+=\|\{\}\':;\',\\\[\]<>\/\?~！@#￥%……&\*（）——+\|\{\}【】‘；：”“’。，、？\s]{1,}/i;
	        		//t&c checked
	        		var ck=$(".contact-from li .ckbox").is(":checked");
	        		if(radioSelect.length>0){//radio场景
		        		if(radioSelect.length>0 && $(".contact-from li .radio-box label.on").length>0 && emailVal && reg.test(emailVal) && userVal && pageurlVal && messageVal){
		        			var i = $(".contact-from li .radio-box label.on").index();
		        			if($(".contact-from li.pp-text .pp-item").eq(i).find("input").is(":checked")){
		        				radioSelect.parent(".radio-box").next(".text").fadeOut();
		        				$(".cktext").fadeOut();
		        				submitEmail(subject,content,radioAddress);
		        			}else{
		        				$(".cktext").fadeIn();
					        	return
		        			}
		        			
			        	}else{
			        		if(!radioSelect.hasClass("on")){
			        			radioSelect.parent(".radio-box").next(".text").fadeIn();
			        		}
			        		if(emailVal=="" || !reg.test(emailVal)){
			        			email.next(".text").fadeIn();
			        		}
			        		if(userVal==""){
			        			name.next(".text").fadeIn();
			        		}
			        		if(pageurlVal==""){
			        			pageurl.next(".text").fadeIn();
			        		}
			        		if(messageVal==""){
			        			message.next(".text").fadeIn();
			        		}
			        	}
		        	}else if(email.length>0 && pageurl.length==0){//emial场景
		        		if(emailVal && reg.test(emailVal) && userVal && companyVal && messageVal && ck){
		        			submitEmail(subject,content);
			        	}else{
			        		if(emailVal=="" || !reg.test(emailVal)){
			        			email.next(".text").fadeIn();
			        		}
			        		if(userVal==""){
			        			name.next(".text").fadeIn();
			        		}
			        		if(companyVal==""){
			        			company.next(".text").fadeIn();
			        		}
			        		if(messageVal==""){
			        			message.next(".text").fadeIn();
			        		}
			        		if(!ck){
			        			$(".cktext").fadeIn();
			        		}
			        	}
		        	}else if(pageurl.length>0 && radioSelect.length==0){//url场景
		        		if(emailVal && reg.test(emailVal) && userVal && pageurlVal && messageVal && ck){
		        			
		        			submitEmail(subject,content);
			        	}else{
			        		if(emailVal=="" || !reg.test(emailVal)){
			        			email.next(".text").fadeIn();
			        		}
			        		if(userVal==""){
			        			name.next(".text").fadeIn();
			        		}
			        		if(pageurlVal==""){
			        			pageurl.next(".text").fadeIn();
			        		}
			        		if(messageVal==""){
			        			message.next(".text").fadeIn();
			        		}
			        		if(!ck){
			        			$(".cktext").fadeIn();
			        		}
			        	}
		        	}else{
		        		if(userVal && companyVal && messageVal && ck){
		        			submitEmail(subject,content);
			        	}else{
			        		if(userVal==""){
			        			name.next(".text").fadeIn();
			        		}
			        		if(companyVal==""){
			        			company.next(".text").fadeIn();
			        		}
			        		if(messageVal==""){
			        			message.next(".text").fadeIn();
			        		}
			        		if(!ck){
			        			$(".cktext").fadeIn();
			        		}
			        	}
		        	}
		        	
		        	
	        	}
				
				function submitEmail(subject,content,radioAddress){
					
					if(radioAddress){
						toAddress = radioAddress;
					}
	        		$(".contact-from li .text").fadeOut();
	        		$.ajax({
		                type: 'post',
		                dataType: 'json',
		                url: apiurl,
		                data: {
		                    subject: subject,
		                    content: content,
		                    toAddressList: toAddress,
		                    site: site
		                },
		                success: function (data) {
		                    console.log(data.resultDesc);
		                    $(".media-contact-box .hp-popup.tips").show();
		                    setTimeout(function(){
		                    	$(".media-contact-box .hp-popup.tips").hide();
		    	        	},3000);
		                },
		                error: function (error) {
		                    console.log(error.statusText);
		                    console.log(error.responseText);
		                }
		            });
	        		
	        	}
	        	
			};
	});
})();
/*!
 *	Brand All Data Lists Component By Bruce
 * 	brand-all-data-lists - v1.0.0 (2019-07-04T14:20:31+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.brand-all-data-lists-component').length>0){
			// Pagination Data
			var pageData={
				page:1,
				size: $('.brand-all-data-lists #listDatas').data('pagesize') || 6,
				pageNum:0,
				total: $('.brand-all-data-lists #listDatas').data('total') || 0
			}
			var chosenDatas={
				year:"",
				month:""
			}
			var lastYear ='';
			// Selected Tags
			var selectedTags = new Array();
			
			var pageWidth = utils.pageWidth();
			
			// Rendering Tags
			renderingTags();
			
			// Rendering Default Lists
			var currData = getCurrDatas();
			renderingLists(currData);
			
			// Rendering Pagination
			renderingPagination(pageData.total,pageData.page);
			
			// Choose Main Tag
			if(pageWidth>768){
				$('.brand-all-data-lists .tags-main>li').hover(function(){
					$(this).addClass('active').find('.tags-sub').stop().slideDown();
					$(this).siblings().removeClass('active').find('.tags-sub').stop().slideUp();
				},function(){
					$(this).removeClass('active').find('.tags-sub').stop().slideUp();
				})
			}else{
				$('.brand-all-data-lists .tags-main .tags-title').click(function(){
					var that = $(this).parent();
					var flag = that.hasClass('active');
					if(!flag){
						that.stop().addClass('active');
						that.find('.tags-sub').stop().slideDown();
					}else{
						that.stop().removeClass('active');
						that.find('.tags-sub').stop().slideUp();
					}
				})
			}
			
			// Choose Sub Tag without year or month
			var chosenNum = 0;
			$('.brand-all-data-lists .tags-other .tags-sub li').click(function(){
				var that = $(this);
				// 单击选中，再次点击取消选中
				var hasActive = that.hasClass('active');
				if(hasActive){
					that.removeClass('active');
					resetTagTitle(that);
				}else{
					changTagTitle(that);
					that.addClass('active').siblings().removeClass('active');
				}
				if(pageWidth>768){
					that.parent().stop().slideUp();
					that.parent().parent().removeClass('active');
					// Reset button的显示与隐藏
					chosenNum = $('.brand-all-data-lists .tags-sub li.active').length;
					if(chosenNum>0){
						$('.brand-all-data-lists .brand-tags .tags-main>li.tags-reset').show();
					}else{
						$('.brand-all-data-lists .brand-tags .tags-main>li.tags-reset').hide();
					}
				}
				
				// 获取除年月外全部选中的 分类标签
				selectedTags = new Array();
				$('.brand-all-data-lists .tags-other .tags-sub li.active').each(function(i,obj){
					var currTagId = $(obj).data('tagid');
					selectedTags.push(currTagId);
				})
				
				var currData = getCurrDatas(selectedTags,1,chosenDatas.year,chosenDatas.month);
				renderingLists(currData);
				
				//Rendering Pagination
				renderingPagination(pageData.total,1);
			})
			
			// Mobile Toggle Filter
			$('.brand-all-data-lists .filter-box').click(function(){
				$('html,body').toggleClass('honor-noscroll');
				$('.brand-all-data-lists .brand-tags .tags-content').slideToggle();
				$('.brand-all-data-lists .brand-tags .filter-icon').toggleClass('active');
				
				$('.brand-all-data-lists .brand-tags .tags-main>li:first-child').addClass('active').find('.tags-sub').slideDown();
			})
			
			// PC Reset tags
			$('.brand-all-data-lists .brand-tags .tags-main>li.tags-reset').click(function(){
				$('.brand-all-data-lists .tags-sub li').removeClass('active');
				$(this).hide();
				
				pageData.page = 1;
				// 重置月份
				getMonth(lastYear);
				// 重置筛选标签
				selectedTags = new Array();
				// 重置筛选标签title
				resetTagTitle();

				var currData = getCurrDatas();
				renderingLists(currData);
				
				//Rendering Pagination
				renderingPagination(pageData.total,1);
			})
			
			// Mobile Reset tags
			$('.brand-all-data-lists .btn-reset').click(function(){
				pageData.page = 1;
				// 重置月份
				getMonth(lastYear);
				// 重置筛选标签
				selectedTags = new Array();
				// 重置筛选标签title
				resetTagTitle();
				
				$('.brand-all-data-lists .tags-sub li').removeClass('active');
			})
			
			// Mobile Apply
			$('.brand-all-data-lists .btn-apply').click(function(){
				$('.brand-all-data-lists .tags-other .tags-sub li.active').each(function(i,obj){
					var currTagId = $(obj).data('tagid');
					selectedTags.push(currTagId);
				})
				var currData = getCurrDatas(selectedTags,1,chosenDatas.year,chosenDatas.month);
				renderingLists(currData);
				
				//Rendering Pagination
				renderingPagination(pageData.total,pageData.page);
				
				$('html,body').removeClass('honor-noscroll');
				$('.brand-all-data-lists .brand-tags .tags-content').slideUp();
				$('.brand-all-data-lists .brand-tags .filter-icon').removeClass('active');
			})
			
			// Prev Page
			$('.brand-all-data-lists .brand-pagination .prev-page').click(function(){
				if(Number(pageData.page) > 1){
					--pageData.page;
				}else{
					pageData.page = 1;
				}
				var currData = getCurrDatas(selectedTags,pageData.page,chosenDatas.year,chosenDatas.month);
				renderingLists(currData);
				
				//Rendering Pagination
				renderingPagination(pageData.total,pageData.page);
			})
			
			// Next Page
			$('.brand-all-data-lists .brand-pagination .next-page').click(function(){
				if(pageData.page < pageData.pageNum){
					++pageData.page;
				}else{
					pageData.page = pageData.pageNum;
				}
				
				var currData = getCurrDatas(selectedTags,pageData.page,chosenDatas.year,chosenDatas.month);
				renderingLists(currData);
				
				//Rendering Pagination
				renderingPagination(pageData.total,pageData.page);
			})
			// Mobile View More
			$('.brand-all-data-lists .load-more').click(function(){
				if(pageData.page < pageData.pageNum){
					++pageData.page;
					$('.brand-all-data-lists .brand-pagination').css('display','flex');
					var currData = getCurrDatas(selectedTags,pageData.page,chosenDatas.year,chosenDatas.month);
					renderingLists(currData,'mobile');
				}else{
					pageData.page = pageData.pageNum;
					$('.brand-all-data-lists .brand-pagination').css('display','none');
				}
				
			})
			
			// 根据分类标签和页码，筛选数据，先筛选标签再确认页码
			function getCurrDatas(tags,page,chosenYear,chosenMonth){
				page = page || pageData.page;
				tags = tags || [];
				chosenYear = chosenYear || '';
				chosenMonth = chosenMonth || '';
				
				var listDatas = $('#listDatas').text();
				var allDatas = new Array();
				if(listDatas){
					allDatas = JSON.parse($.trim(listDatas));
				}
				
				var currData = new Array();
				var startIndex = (page-1)*pageData.size+1;
				var endIndex = page*pageData.size;
				
				// 按标签筛选数据
				var flag = (tags && tags.length>0) || chosenYear || chosenMonth;
				if(flag){
					var tagsDataTotal= 0;
					for(var x = 0;x < allDatas.length; x++){
						for(var key in allDatas[x]){
							if(allDatas[x].hasOwnProperty(key)){
								var listBlock = new Object();
								var item = allDatas[x][key];
								var endItem = getRgArray(item,tags,chosenYear,chosenMonth);
								if(endItem.length>0){
									tagsDataTotal = tagsDataTotal + endItem.length;
									//获取筛选后的全部数据数目
									listBlock.title=key;
									listBlock.data=endItem;
									currData.push(listBlock);
								}
							}
						}
					}
					
					pageData.total= tagsDataTotal;
					
					// 将筛选后的数据进行分页
					var count=0;
					var endData = new Array();
					for(var x = 0;x < currData.length; x++){
						var item = currData[x].data;
						var endItem = new Array();
						var listBlock = new Object();
						for(var y = 0;y<item.length;y++){
							++count;
							if(count >= startIndex && count <= endIndex){
								endItem.push(item[y]);
							}
						}
						if(endItem.length>0){
							listBlock.title= currData[x].title;
							listBlock.data=endItem;
							endData.push(listBlock);
						}
					}
					currData = endData;
				}else{
					// 按页码分配数据
					var count=0;
					for(var x = 0;x < allDatas.length; x++){
						for(var key in allDatas[x]){
							if(allDatas[x].hasOwnProperty(key)){
								var item = allDatas[x][key];
								var endItem = new Array();
								var listBlock = new Object();
								for(var y = 0;y<item.length;y++){
									++count;
									if(count >= startIndex && count <= endIndex){
										endItem.push(item[y]);
									}
								}
								if(endItem.length>0){
									listBlock.title=key;
									listBlock.data=endItem;
									currData.push(listBlock);
								}
								
							}
						}
					}
					// init total data
					pageData.total = $('.brand-all-data-lists #listDatas').data('total') || 0;
				}
				return currData;
			}
			
			
			/*
			 * 按照已选分类标签，过滤列表数据数组
			 * itemArr 待处理数组
			 * tagsArr 已选分类标签数组
			 * */
			function getRgArray(itemArr,tagsArr,chosenYear,chosenMonth){
				itemArr = itemArr || [];
				tagsArr = tagsArr || [];
				
				var endItem = new Array();
				for(var y = 0;y < itemArr.length; y++){
					var itemTags = itemArr[y].tag;
					// 判断 item 是否 符合筛选条件？
					if(itemTags.length>=tagsArr.length){
						var flag= Array(tagsArr.length).fill(false);
						for(var z = 0; z<tagsArr.length;z++){
							for(var m = 0; m < itemTags.length;m++){
								if(tagsArr[z]==itemTags[m].tagID){
									// 匹配成功
									flag[z] = true;
								}
							}
						}
						var flagYear = true;
						var initDate = itemArr[y].initDate;
						if(chosenYear && initDate.indexOf(chosenYear)==-1){
							flagYear = false;
						}
						
						var flagMonth = true;
						var endMonth = '-'+ chosenMonth+'-';
						if(chosenMonth && initDate.indexOf(endMonth)==-1){
							flagMonth = false;
						}
						
						var boolFlag = flag.every(function(ele){return ele});
						if(boolFlag && flagYear && flagMonth){
							// 完全匹配成功
							endItem.push(itemArr[y]);
						}
					}
				}
				
				return endItem;
			}
			
			// Rendering Tags
			function renderingTags(){
				var tagDatas = $('#tagDatas').text();
				var monthYearJson = $('#monthYearJson').text();
				if(tagDatas){
					var data =JSON.parse(tagDatas);
					if(data.length>0){
						var tagHtml='';
						for(var x =0;x<data.length;x++){
							tagHtml +='<li class="tags-other">';
							tagHtml +='<div class="tags-title">';
							tagHtml +='<span class="sub-title" data-tagid="'+data[x].tagID+'" data-title="'+data[x].title+'">'+data[x].title+'</span>';
							tagHtml +='<span class="honorFont-arr-down icon-down-arrow"></span>';
							tagHtml +='</div>';
							tagHtml +='<ul class="tags-sub">';
							var subTag = data[x].brandCategoryItem;
							if(subTag && subTag.length>0){
								for(var y= 0;y < subTag.length; y++){
									var endData = subTag[y].availableValues;
									for(var z=0;z< endData.length;z++){
										tagHtml +='<li data-tagid="'+endData[z].tagID+'">';
										tagHtml +='<span>'+endData[z].title+'</span>';
										tagHtml +='<span class="check-box mb-info"></span>';
										tagHtml +='</li>';
									}
								}
							}
							tagHtml +='</ul>';
							tagHtml +='</li>';
						}
						$('.brand-all-data-lists .tags-main .info-years').prev().remove();
						$('.brand-all-data-lists .tags-main').prepend(tagHtml);
					}
				}
				if(monthYearJson){
					var currYear = 2018;
					var data =JSON.parse(monthYearJson);
					var years = Object.keys(data);
					
					var yearHtml = '';
					if(years.length>0){
						for(var x = years.length-1;x>=0;x--){
							yearHtml+='<li data-tagid="'+years[x]+'" data-flag="year">';
								yearHtml+='<span>'+years[x]+'</span>';
								yearHtml+='<span class="check-box mb-info"></span>';
							yearHtml+='</li>';
						}
					}
					$('.brand-all-data-lists .info-years .tags-sub').html(yearHtml);
					
					// 默认显示最新年份对应的月份列表
					lastYear = years[years.length-1];
					getMonth(lastYear);
					
				}
				//Rendering Reset
				if(tagDatas || monthYearJson){
					var resetTxt = $('.brand-all-data-lists .brand-tags .tags-main').data('reset') || 'Reset';
					var resetHtml='<li class="tags-reset">'+resetTxt+'</li>';
					$('.brand-all-data-lists .tags-main').prepend(resetHtml);
				}
			}
			
			$('.brand-all-data-lists .tags-ym').on('click','.tags-sub li',function(){
				var that = $(this);
				var flag = that.data('flag');
				// 单击选中，再次点击取消选中
				var hasActive = that.hasClass('active'); 
				if(hasActive){
					that.removeClass('active');
					if(flag=='year'){
						chosenDatas.year = "";
					}else if(flag=='month'){
						chosenDatas.month = "";
					}
					resetTagTitle(that);
				}else{
					changTagTitle(that);
					that.addClass('active').siblings().removeClass('active');
					if(flag=='year'){
						chosenDatas.year = that.data('tagid');
						getMonth(chosenDatas.year);
						chosenDatas.month = "";
					}else if(flag=='month'){
						chosenDatas.month = that.data('tagid');
					}
				}
				
				if(pageWidth>768){
					that.parent().stop().slideUp();
					that.parent().parent().removeClass('active');
					// Reset button的显示与隐藏
					chosenNum = $('.brand-all-data-lists .tags-sub li.active').length;
					if(chosenNum>0){
						$('.brand-all-data-lists .brand-tags .tags-main>li.tags-reset').show();
					}else{
						$('.brand-all-data-lists .brand-tags .tags-main>li.tags-reset').hide();
					}
					// 获取除年月外全部选中的 分类标签
					selectedTags = new Array();
					$('.brand-all-data-listsc .tags-other .tags-sub li.active').each(function(i,obj){
						var currTagId = $(obj).data('tagid');
						selectedTags.push(currTagId);
					})
					
					var currData = getCurrDatas(selectedTags,1,chosenDatas.year,chosenDatas.month);
					renderingLists(currData);
					
					//Rendering Pagination
					renderingPagination(pageData.total,1);
				}
				
			})
			
			function getMonth(year){
				chosenDatas.month='';
				var monthYearJson = $('#monthYearJson').text();
				var data =JSON.parse(monthYearJson);
				var monthHtml = '<ul class="tags-sub">';
				if(data[year].length>0){
					for(var x =0;x< data[year].length;x++){
						var month = data[year][x].split(':')[0];
						var i18nMonth = data[year][x].split(':')[1];
						monthHtml+='<li data-tagid="'+month+'" data-flag="month">';
							monthHtml+='<span>'+i18nMonth+'</span>';
							monthHtml+='<span class="check-box mb-info"></span>';
						monthHtml+='</li>';
					}
					monthHtml+='</ul>';
					$('.brand-all-data-lists .info-month .tags-title').next().remove();
					$('.brand-all-data-lists .info-month').removeClass('active').append(monthHtml);
				}
			}
			
			/* Reset tag's title
			 * obj：Current Object
			*/
			function resetTagTitle(obj){
				if(obj){
					// Reset current tag's title			
					var $subTitle = obj.parent().siblings('.tags-title').find('.sub-title');
					var currTitle = $subTitle.data('title');
					$subTitle.text(currTitle);
				}else{
					// Reset all tags's title
					$('.tags-main .sub-title').each(function(){
						var title = $(this).data('title');
						$(this).text(title);
					})
				}
			}
			
			function changTagTitle(obj){
				var currTag = $.trim(obj.text());
				var $subTitle = obj.parent().siblings('.tags-title').find('.sub-title');
				$subTitle.text(currTag);
			}
			
			/* Rendering Lists
			 * data: 数据
			 * type: 终端类型 （mobile:移动端）
			 */ 
			function renderingLists(data,type){
				var listHtml ='';
				if(data.length==0){
					$('.brand-all-data-lists .brand-all-lists').hide();
					$('.brand-all-data-lists .brand-nodatatip').show();
				}else{
					$('.brand-all-data-lists .brand-all-lists').show();
					$('.brand-all-data-lists .brand-nodatatip').hide();
					for(var x = 0;x < data.length; x++){
						listHtml +='<div class="list-block">';
						listHtml +='<p class="block-date">'+data[x].title+'</p>';
						listHtml +='<ul>';
						var item = data[x].data;
						for(var y=0;y<item.length;y++){
							listHtml +='<li>';
								listHtml +='<div class="lf-img honor-loading-v2">';
									listHtml +='<a href="'+item[y].url+'">';
										listHtml +='<img class="lazy" data-original=""  data-pc="'+item[y].img+'" data-mb="'+item[y].imgMB+'" alt="'+item[y].cardImgAlt+'" title="'+item[y].cardImgTitle+'" />';
									listHtml +='</a>';
								listHtml +='</div>';
								listHtml +='<div class="rg-content">';
									listHtml +='<a href="'+item[y].url+'">';
										listHtml +='<div class="rg-box">';
											listHtml +='<div class="content-top">';
												listHtml +='<span class="item-date">'+item[y].date+'</span>';
												var tag = '';
												if(item[y].tag && item[y].tag.length>0){
													// 只取第一个分类标签
													tag = item[y].tag[0].tagTitle;
												}
												listHtml +='<span class="item-type">'+tag+'</span>';
											listHtml +='</div>';
											listHtml +='<div class="content-main">';
												listHtml +='<h3 class="item-title" title="'+item[y].title+'">'+item[y].title+'</h3>';
												listHtml +='<div class="item-summary">';
													listHtml +='<p>'+item[y].desc+'</p>';
													var readMore = $('.brand-all-data-lists .brand-all-lists').data('readmore');
													listHtml +='<span class="read-more">'+readMore+'</span>';
												listHtml +='</div>';
											listHtml +='</div>';
										listHtml +='</div>';
									listHtml +='</a>';
								listHtml +='</div>';
							listHtml +='</li>';
						}
						listHtml +='</ul>';
						listHtml +='</div>';
					}
					
					if(type=='mobile'){
						$('.brand-all-data-lists .brand-all-lists').append(listHtml);
					}else{
						// Back to top
						$('html,body').animate({
							scrollTop: 0
						}, 0);
						$('.brand-all-data-lists .brand-all-lists').empty().html(listHtml);
					}
					// 图片懒加载
					$('.brand-all-data-lists .brand-all-lists .lf-img .lazy').each(function(){
						var that = $(this);
						if(pageWidth>768){
							var img = that.data('pc') || '';
							that.attr('data-original',img);
						}else{
							var img = that.data('mb') || that.data('pc') || '';
							that.attr('data-original',img);
						}
					});
					$(".brand-all-data-lists .brand-all-lists .lf-img .lazy").lazyload({
						"placeholder":lazyload.placeholder
					}); 
				}
			}
			
			// Rendering Pagination
			function renderingPagination(total,currPage){
				total = total || pageData.total;
				currPage = currPage || 1;
				endcurrPage = currPage+6;
				endpageNum = pageData.pageNum-5;
				pageData.pageNum = Math.ceil(total/pageData.size);
				var morePrevNum,moreNextNum;
				if(pageData.pageNum > 1 && pageData.pageNum <= 6){
					var pageHtml ='';
					for(var i = 1;i<(pageData.pageNum+1);i++){
						var activeClass ='';
						if(i==currPage){
							activeClass='active';
						}
						pageHtml +='<li class="'+activeClass+'" data-num="'+i+'">';
						pageHtml +='<span>'+i+'</span>';
						pageHtml +='</li>';
					}
					$('.brand-all-data-lists .brand-pagination').css('display','flex');
					$('.brand-all-data-lists .brand-page').empty().html(pageHtml);
					
					var $prev = $('.brand-all-data-lists .brand-pagination .prev-page');
					var $next = $('.brand-all-data-lists .brand-pagination .next-page');
					if(currPage==1){
						$prev.addClass('disabled');
						$next.removeClass('disabled');
					}else if(currPage==pageData.pageNum){
						$prev.removeClass('disabled');
						$next.addClass('disabled');
					}else{
						$prev.removeClass('disabled');
						$next.removeClass('disabled');
					}
				}else if(pageData.pageNum > 6){
					var pageHtml ='';
					var maxNum=pageData.pageNum-6;
					if(currPage==1){
						pageHtml +='<li class="active" data-num="1">';
					}else{
						pageHtml +='<li data-num="1">';
					}
					pageHtml +='<span>1</span>';
					pageHtml +='</li>';
					
					if(currPage == 1){
						for(var i = 2;i < endcurrPage;i++){
							var activeClass ='';
							if(i==currPage){
								activeClass='active';
							}
							pageHtml +='<li class="'+activeClass+'" data-num="'+i+'">';
							pageHtml +='<span>'+i+'</span>';
							pageHtml +='</li>';
							
						}
					}else if(endcurrPage <= pageData.pageNum){
						if(currPage!=2){
							pageHtml +='<li class="more-prev" data-num="">';
							pageHtml +='<span>...</span>';
							pageHtml +='</li>';
						}
						
						for(var i = currPage;i < endcurrPage;i++){
							var activeClass ='';
							if(i==currPage){
								activeClass='active';
							}
							pageHtml +='<li class="'+activeClass+'" data-num="'+i+'">';
							pageHtml +='<span>'+i+'</span>';
							pageHtml +='</li>';
							
						}
						
					}else{
						pageHtml +='<li class="more-prev" data-num="">';
						pageHtml +='<span>...</span>';
						pageHtml +='</li>';
						for(var i = endpageNum;i < pageData.pageNum;i++){
							var activeClass ='';
							if(i==currPage){
								activeClass='active';
							}
							pageHtml +='<li class="'+activeClass+'" data-num="'+i+'">';
							pageHtml +='<span>'+i+'</span>';
							pageHtml +='</li>';
						}
						
					}
					
					if(currPage < maxNum){
						pageHtml +='<li class="more-next" data-num="">';
						pageHtml +='<span>...</span>';
						pageHtml +='</li>';
					}
					if(pageData.pageNum!=6){
						if(currPage==pageData.pageNum){
							pageHtml +='<li class="active" data-num="'+pageData.pageNum+'">';
						}else{
							pageHtml +='<li data-num="'+pageData.pageNum+'">';
						}
						pageHtml +='<span>'+pageData.pageNum+'</span>';
						pageHtml +='</li>';
					}
					$('.brand-all-data-lists .brand-pagination').css('display','flex');
					$('.brand-all-data-lists .brand-page').empty().html(pageHtml);
					
					var $prev = $('.brand-all-data-lists .brand-pagination .prev-page');
					var $next = $('.brand-all-data-lists .brand-pagination .next-page');
					if(currPage==1){
						$prev.addClass('disabled');
						$next.removeClass('disabled');
					}else if(currPage==pageData.pageNum){
						$prev.removeClass('disabled');
						$next.addClass('disabled');
					}else{
						$prev.removeClass('disabled');
						$next.removeClass('disabled');
					}
					
					startNum = $(".more-prev").next("li").data("num");
					endNum = $(".more-next").prev("li").data("num");
					if(startNum < 5){
						morestartNum=2;
					}else{
						morestartNum=startNum-5;
					}
					$(".more-prev").attr("data-num",morestartNum);
					$(".more-next").attr("data-num",endNum);
				}else{
					$('.brand-all-data-lists .brand-pagination').hide();
				}
				
				// Change Page Number
				$('.brand-all-data-lists .brand-page li').click(function(){
					var currNum = $(this).data('num') || 1;
					pageData.page = currNum;
					
					var currData = getCurrDatas(selectedTags,pageData.page,chosenDatas.year,chosenDatas.month);
					renderingLists(currData);
					
					//Rendering Pagination
					renderingPagination(pageData.total,pageData.page);
				})
				
			}
		}
	})
}());
$(function(){
	if ($('.newsDetails-v2').length < 1) return;
	$("body").addClass("bg-black");
	// 懒加载
	var imgLazy=$(".newsDetails-v2 .detail-banner img.lazy");
	var imgSrc;
	if($(window).width()>768){
		imgSrc=imgLazy.data("pc");
    }else{
    	if(imgLazy.data("mb")){
    		imgSrc=imgLazy.data("mb");
    	}else{
    		imgSrc=imgLazy.data("pc");
    	}
    	
    }
	imgLazy.attr("src",imgSrc);
	var imgLoad = imagesLoaded(imgLazy);
    imgLoad.on('done', function(instance) {
    	// 加载完成 
    	imgLazy.parent().removeClass('honor-loading-v2');
    });
    //获取TAG赋值
    var str=JSON.parse($("#tags").val());
    if(str.length>0){
    	$(".news-tag").text(str[0].tagTitle);
    }
});
/*!
 *	HONOR Breadcrumb Component
 * 	breadcrumb - v2.0.0 (2019-07-26T09:03:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.breadcrumb').length>0){
			// 判断页面是否替换h1
			var pageType=digitalData.page.category.pageType.replace(" ","");
			var isProductList = (pageType!=="productlist");
			var isProductDetail = (pageType!=="productdetail");
			var isNewDetail = (pageType!=="newsdetail");
			var isBlogDetail = (pageType!=="blogdetail");
			if(isProductList && isProductDetail && isNewDetail && isBlogDetail){
				var title= $(".honor-breadcrumb .curr-page").text();
				var html=$(".honor-breadcrumb").html().replace(title,"");
				$(".honor-breadcrumb").html(html+"<h1>"+title+"</h1>");
				$(".honor-breadcrumb .curr-page").remove();
			}
			
			// 面包屑点击事件GA统计
			$("body").on("click",".honor-breadcrumb a",function(){
				var navigationName = $(this).text();
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Breadcrumb Navigation",
					"eventAction": "click",
					"eventLabel": navigationName
				})
			})
		}
	})
}());

$(function(){
	var $productListV1 = $('.product-list .pro-list-v1');
	if ($productListV1.length < 1) return;

	// get data
	var $dataHolder = $(".product-list-data-holder");
	
	var categoriesData = $dataHolder.data("categories");
	var moreCategoriesData = $dataHolder.data("more-categories");
	var productsData = $dataHolder.data("products");
	var tagPrefixProductsSpecsColors = $dataHolder.data("tag-prefix-products-specs-colors");
	var productsText = $dataHolder.data("products-text");
	var moreProductsText = $dataHolder.data("more-products-text");
	var clearAllText = $dataHolder.data("clear-all-text");
	var filterText = $dataHolder.data("filter-text");
	var loadMoreText = $dataHolder.data("load-more-text");
	var pageInfoText = $dataHolder.data("page-info-text");
	var noProductFoundText = $dataHolder.data("no-product-found-text");
	
	var pageCount = 6;
	var pageOf = 1;
	var initFlag = true;
	
	var hash = location.hash;
    if (hash){
    	var hashInt = parseInt(hash.substring(1));
    	if (!isNaN(hashInt)) {
    		pageOf = hashInt;
    	}
    }
	
	var noProductFoundHtml = "<div class='nodate'>" + noProductFoundText + "</div>";
	
	var $body = $("body");
	var $proLeft = $(".pro-left");
	var $categoriesBox = $(".categories-box");
	var $subCate = $(".sub-cate");
	var $itemList = $(".item-list");
	var $proRight = $(".pro-right");
	var $proFilter = $(".pro-filter");
	
	var tags = undefined, products = undefined;
	
	$categoriesBox.on("click", ".sub-cont .categories .sel-sub-btn", function(){
		var $this = $(this);
		if ($this.hasClass("on")) {
			$(".sub-cont li .sel-sub-btn").removeClass("on");
			if (!$this.hasClass("more")) {
				return;
			} else {
				$this.toggleClass("spread").siblings(".sub-box").toggleClass("hidden");
			}
		} else {
			$(".sub-cont li .sel-sub-btn").removeClass("on");
			clearActivedItem();
			$this.addClass("on");
			if ($this.hasClass("more")) {
				$this.toggleClass("spread").siblings(".sub-box").toggleClass("hidden");
			}
			changeSpecs();
			if (!initFlag) {
				pageOf = 1;
				history.replaceState(null, '', location.pathname + location.search);
			}
			queryAndDrawProducts(true);
			//ga code start
			var filterName=$.trim($this.text());
			var filterCategory=$this.parents(".sub-cont").prev(".sel-btn").text();
			window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
			//ga code end
		}
		
	});
	
	$categoriesBox.on("click", ".sub-cont .categories .sub-box a", function(){
		var $this = $(this);
		var $selSubBtn = $this.parent().siblings(".sel-sub-btn");
		var shouldChangeSpecs = !$selSubBtn.hasClass("on");
		var excludedDomObjs = [this];
		//$($this.siblings("a")).each(function(i, item){ excludedDomObjs.push(item); });
		clearActivedItem(excludedDomObjs);
		$selSubBtn.addClass("on");
		$this.toggleClass("on");
		if (shouldChangeSpecs) changeSpecs();
		pageOf = 1;
		history.replaceState(null, '', location.pathname + location.search);
		queryAndDrawProducts(shouldChangeSpecs);
		//ga code start
		var filterName=$.trim($this.text());
		var filterCategory=$this.parent(".sub-box").prev(".sel-sub-btn").text();
		window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
		//ga code end
	});
	
	$categoriesBox.on("click", ".sub-cont .more-products .sel-sub-btn", function(){
		var $this = $(this);
		if ($this.hasClass("on")) {
			$this.toggleClass("spread").siblings(".sub-box").toggleClass("hidden");
		} else {
			clearActivedItem();
			$this.addClass("on").toggleClass("spread").siblings(".sub-box").toggleClass("hidden");
			changeSpecs();
			pageOf = 1;
			history.replaceState(null, '', location.pathname + location.search);
			queryAndDrawProducts(true);
			//ga code start
			var filterName=$.trim($this.text());
			var filterCategory=$this.parents(".sub-cont").prev(".sel-btn").text();
			window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
			//ga code end
		}
		
	});
	
	$categoriesBox.on("click", ".sub-cont .more-products .sub-box a", function(){
		var $this = $(this);
		var excludedDomObjs = [this];
		//$($this.siblings("a")).each(function(i, item){ excludedDomObjs.push(item); });
		clearActivedItem(excludedDomObjs);
		$this.parent().siblings(".sel-sub-btn").addClass("on");
		$this.toggleClass("on");
		changeSpecs();
		pageOf = 1;
		history.replaceState(null, '', location.pathname + location.search);
		queryAndDrawProducts(true);
		//ga code start
		var filterName=$.trim($this.text());
		var filterCategory=$this.parent(".sub-box").prev(".sel-sub-btn").text();
		window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
		//ga code end
	});
	
	$proLeft.on("click", ".sub-cate li .sel-btn", function(i, item){
		var $this = $(this);
		if($this.hasClass("on")){
			$this.removeClass("on").children("span").addClass("fa-angle-down").removeClass("fa-angle-up");
			$this.next(".sub-box, .sub-cont").hide();
		}else{
			$this.addClass("on").children("span").addClass("fa-angle-up").removeClass("fa-angle-down")
			$this.next(".sub-box, .sub-cont").show();
		}
	});
	
	$proLeft.on("click", ".sub-cate .sub-box a", function(i, item){
		var $this = $(this);
		if ($this.hasClass("selected")) {
			$this.removeClass("on").removeClass("selected").children("span").addClass("fa-square-o").removeClass("fa-check-square-o");
			var title = $this.text();
			var tagID = $this.data("tag");
			removeTag({tagID:tagID, title:title});
		} else {
			$this.addClass("on selected").children("span").addClass("fa-check-square-o").removeClass("fa-square-o");
			var title = $this.text();
			var tagID = $this.data("tag");
			addTag({tagID:tagID, title:title});
			//ga code start
			var filterName=$.trim($this.text());
			
			var filterCategory=$this.parent(".sub-box").prev(".sel-btn").text();
			window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
			//ga code end
		}
		pageOf = 1;
		history.replaceState(null, '', location.pathname + location.search);
		queryAndDrawProducts(false);
	});
	
	$proRight.on("click", ".tags-box .tag .fa-remove", function(){
		var tagID = $(this).parent().data("tag");
		$proLeft.find(".sub-cate .sub-box a.on[data-tag='" + tagID + "']").trigger("click");
	});
	
	$proRight.on("click", ".tags-box .clear-btn", function(){
		$proLeft.find(".sub-cate .sub-box a.on").removeClass("on").removeClass("selected").children("span").addClass("fa-square-o").removeClass("fa-check-square-o");
		pageOf = 1;
		history.replaceState(null, '', location.pathname + location.search);
		queryAndDrawProducts(true);
	});
	
	$proRight.on("click", ".page-box .btn-box a", function(){
		var index = $(this).index();
		if (pageOf == index + 1) return;
		pageOf = index + 1;
		location.hash = pageOf;
		$(this).addClass("on").siblings("a").removeClass("on");
		window.scrollTo(0,0);
		pageAndDrawCategoryProducts();
		  window.scrollTo(0,0);
	});
	
	$proRight.on("click", ".page-box .btn-prev", function(){
        var index = $(".page-box .btn-box a.on").index();
        if(index > 0) {
        	pageOf = index;
        	location.hash = pageOf;
        	window.scrollTo(0,0);
        	pageAndDrawCategoryProducts(index);
        }
    });
	
	$proRight.on("click",".page-box .btn-next",function(){
        var index = $(".page-box .btn-box a.on").index();
        var totalSize = $(".page-box .btn-box a").length;
        if(index + 1 < totalSize) {
        	pageOf = index + 2;
        	location.hash = pageOf;
        	window.scrollTo(0,0);
        	pageAndDrawCategoryProducts();
        }
    });
	
	//ga code start
	$proRight.on("click", ".list li a", function(){
		var proName=$(this).parent("li").find(".pro-name").text();
		var proCategory=$(".pro-right .pro-title .title-name").text();
		var num=$(".pro-right .pro-title .page-info b").eq(0).text();
		var proPosition;
		if(num>1){
			var a=(num-1)*6;
			proPosition=$(this).parent("li").index()+1+a;
		}else{
			proPosition=$(this).parent("li").index()+1;
		}
		window.dataLayer.push({
			"event": "eeListClick",
			"loginStatus": honorData.loginStatus,
			"productAvailability": "",
			'products': [{"listName": "product list","name": proName,"id": proName,"price": "","brand": "Honor","category": proCategory,"variant": "","position": proPosition,"productAvailability":""}]
			})
	});
	//ga code end
	
	$proRight.on("click", ".pro-color div", function(event){
		var $this = $(this);
		var index = $this.index();
		$this.parent().prev("a").find(".pro-img").children("img:eq(" + index + ")").show().siblings("img").hide();
		$this.addClass("on").siblings("div").removeClass("on");
		event.stopPropagation();
	});
	
	$proRight.on("click", ".filter-btn", function(){
		showProFilter();
	});
	
	$proFilter.find('.font-Cross').click(function(){
		hideProFilter();
	});
	
	$proFilter.on("click", ".filter-item .sub-box a", function(i, item){
		var $this = $(this);
		var title = $this.text();
		var tagID = $this.data("tag");
		if ($this.hasClass("selected")) {
			$this.removeClass("on").removeClass("selected").children("span").addClass("fa-square-o").removeClass("fa-check-square-o");
			//removeTag({tagID:tagID, title:title}, true);
		} else {
			$this.addClass("on selected").children("span").addClass("fa-check-square-o").removeClass("fa-square-o");
			//addTag({tagID:tagID, title:title}, true);
			//ga code start
			var filterName=$.trim($this.text());
			var filterCategory=$this.parent(".sub-box").prev("h3").text();
			window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
			//ga code end
		}
		//queryAndDrawProducts(false, true);
		
	});
	
	$('.res-btn').click(function(){
		$('.pro-filter .sub-box a').removeClass("on");
		$('.pro-filter .sub-box a span').addClass("fa-square-o").removeClass("fa-check-square-o");
	});
	
	$('.app-btn').click(function(){
		queryAndDrawProducts(false, true);
	});

    $('.pro-list').on("click", ".app-btn", function(){
    	hideProFilter();
    });
    
    $('.pro-filter .filter-box .close').on("click", function(){
    	hideProFilter();
    });
        
    $('.pro-filter .filter-box .item-list').on('touchmove', function(event){
    	event.stopPropagation();
    });
    
    $('.pro-filter').on('touchmove', function(event){
    	event.preventDefault();
    });
    
    $proRight.on("click", ".more-btn",function(){
        pageOf++;
        pageAndDrawCategoryProducts();
    });
	
    $(".sub-cont .sel-sub-btn:first", $categoriesBox).trigger("click");
   
    
    initFlag = false;
	
	function clearActivedItem (excludedDomObjs) {
		var $selSubBtns = $(".sub-cont .sel-sub-btn", $categoriesBox);
		var $subLinks = $(".sub-cont .sub-box a", $categoriesBox);
		$.each(excludedDomObjs || [], function(i, item){ 
			$selSubBtns = $selSubBtns.not(item); 
			$subLinks = $subLinks.not(item);
		});
		$selSubBtns.removeClass("on");
		$subLinks.removeClass("on");
	}
	
	function changeSpecs () {		
		// get category tagID and specifications
		var categoryTagID = undefined;
		var specifications = undefined;
		$(".sub-cont .categories .sel-sub-btn", $categoriesBox).each(function(i, item){
			if ($(this).hasClass("on")) categoryTagID = $(this).data("tag");
			if (categoryTagID) {
				$.each(categoriesData, function(i, item){
					if (item && item.tagID && categoryTagID.toLowerCase() == item.tagID.toLowerCase()) {
						specifications = item.specifications;
					}
				});
			}
		});
		if (!categoryTagID) {
			$(".sub-cont .more-products .sub-box a", $categoriesBox).each(function(i, item){
				if ($(this).hasClass("on")) categoryTagID = $(this).data("tag");
			});
			if (!categoryTagID) {
				console.log("there is no category tagID");
			} else {
				$.each(moreCategoriesData, function(i, item){
					if (item && item.tagID && categoryTagID.toLowerCase() == item.tagID.toLowerCase()) {
						specifications = item.specifications;
					}
				});
			}
		}
		
		$subCate.empty();
		$itemList.empty();
		
		if (specifications && specifications.length > 0) {
			$.each(specifications, function(i, spec){
				var availableValues = spec.availableValues;
				var specName = spec.title;
				if (specName && availableValues && availableValues.length > 0) {
					var li = "<li><div class='sel-btn on'>" + specName + "<span class='fa fa-angle-up'></span></div><div class='sub-box'></div></li>";
					var mbli = "<div class='filter-item'><h3>" + specName + "</h3><div class='sub-box'></div></div>";
					$subCate.append(li);
					$itemList.append(mbli);
					$.each(availableValues, function(j, value){
						var ckItem = "<a href='javascript:;' data-tag='" + value.tagID + "'><span class='ck-box fa fa-square-o'></span>" + value.title + "</a>";
						var mbckItem= "<a href='javascript:;' data-tag='" + value.tagID + "'><span class='ck-box fa fa-square-o'></span>" + value.title + "</a>";
						$(".sub-cate li:eq(" + i + ") .sub-box").append(ckItem);
						$(".item-list .filter-item:eq(" + i + ") .sub-box").append(ckItem);
					});
				}
			});
		} else {
			// CODE STUB
		}
	}
	
	function query (mobile) {
		// get filters
		var categoryTagIDs = [];
		var colorTagIDs = [];
		var specificationTagIDGroupMap = {};
		var specificationTagIDGroups = [];
		
		$(".sub-cont .categories .sel-sub-btn.on", $categoriesBox).each(function(i, item){
				var $this = $(this);
				var $activeLinks = $this.siblings(".sub-box").find("a.on");
				if ($activeLinks.length > 0) {
					$activeLinks.each(function(j, item1){ categoryTagIDs.push($(item1).data("tag")); });
				} else {
					categoryTagIDs.push($this.data("tag"));
				}
		});
			
		if ($(".sub-cont .more-products .sel-sub-btn.on", $categoriesBox).length > 0) {
				if ($(".sub-cont .more-products .sub-box a.on", $categoriesBox).length > 0) {
					$(".sub-cont .more-products .sub-box a.on", $categoriesBox).each(function(i, item){ categoryTagIDs.push($(this).data("tag")); });
				} else {
					$(".sub-cont .more-products .sub-box a", $categoriesBox).each(function(i, item){ categoryTagIDs.push($(this).data("tag")); });
				}
		}
			
		$(".sub-cate .sub-box a.on", $proLeft).each(function(i, item){
				var tagID = $(this).data("tag");
				if (tagID) {
					if (tagID.substr(0, tagPrefixProductsSpecsColors.length) == tagPrefixProductsSpecsColors) {
						colorTagIDs.push(tagID);
					} else {
						var parentTagID = tagID.substring(0, tagID.lastIndexOf("/"));
						var specificationTagIDGroup = specificationTagIDGroupMap[parentTagID];
						if (specificationTagIDGroup) {
							specificationTagIDGroup.push(tagID);
						} else {
							specificationTagIDGroup = [tagID];
							specificationTagIDGroupMap[parentTagID] = specificationTagIDGroup;
							specificationTagIDGroups.push(specificationTagIDGroup);
						}
					}
				}
		});
		

		// query begin
		if (categoryTagIDs.length > 0 || colorTagIDs.length > 0 || specificationTagIDGroups.length > 0) {
			products = [];
			$.each(productsData, function(i, productData){
				var marketingCategory = productData.marketingCategory;
				var colors = productData.colors;
				var filters = productData.filters;
				var isCategoryMatch = false;
				
				if (marketingCategory) {
					$.each(categoryTagIDs, function(j, categoryTagID){
						if (marketingCategory.substr(0, categoryTagID.length) == categoryTagID) {
							isCategoryMatch = true;
							return false;
						}
					});
				}
				
				var isColorMatch = false;
				if (colorTagIDs.length > 0) {
					if (colors && colors.length > 0) {
						$.each(colorTagIDs, function(j, colorTagID){
							if (!isColorMatch) {
								$.each(colors, function(n, color){
									if (color.color && color.color.substr(0, colorTagID.length) == colorTagID) {
										isColorMatch = true;
										return false;
									}
								});
							} else {
								return false;
							}
						});
					}
				} else {
					isColorMatch = true;
				}
				
				var isFilterMatch = false;
				if (specificationTagIDGroups.length > 0) {
					if (filters && filters.length > 0) {
						var matchCount = 0;
						$.each(specificationTagIDGroups, function(j, specificationTagIDGroup){
							var isGroupMatch = false;
                            $.each(specificationTagIDGroup, function(m, specificationTagID){
                                $.each(filters, function(n, filter){
                                    if (filter.substr(0, specificationTagID.length) == specificationTagID) {
                                        isGroupMatch = true;
                                        return false;
                                    }
                                });
                                if (m == specificationTagIDGroup.length - 1 && isGroupMatch) {
                                    matchCount ++;
                                }
                            });
                        });
						if (matchCount == specificationTagIDGroups.length) isFilterMatch = true;
					}
				} else {
					isFilterMatch = true;
				}
				
				if (isCategoryMatch && isColorMatch && isFilterMatch) products.push(productData);  
			});
		} else {
			products = productsData;
		}
	}
	
	function queryAndDrawProducts (needClearTag, mobile) {
		
		query(mobile);
		
		if (needClearTag) tags = [];
		
		// get title and product number
		var title = undefined;
		var number = products.length;
		var isMoreProducts = false;
		var $category = $('.sub-cont .sel-sub-btn.on', $categoriesBox);
		if ($category.length <= 0) { 
			title = productsText;
		} else {
			if ($category.parent().hasClass("more-products")) {
				title = moreProductsText;
				isMoreProducts = true;
			} else {
				var tagID = $category.data("tag");
				$.each(categoriesData, function(i, categoryData){
					if (tagID && tagID == categoryData.tagID) {
						title = categoryData.title;
						return false;
					}
				});
			}
		}
		if (isMoreProducts) {
			drawMoreProducts(title, number, mobile);
		} else {
			drawCategoryProducts(title, number, mobile);
		}
	}
	
	function drawCategoryProducts (title, number, mobile) {
		var headHtml = '<div class="pro-title"><h1 class="title-name">' + title + '</h1><span class="page-info"></span></div>' +
					   '<div class="tags-box hidden">'	+
					   		'<a href="javascript:;" class="clear-btn">' + clearAllText + '</a>' +
					   '</div>' +
					   '<div class="mb-top">' +
					   		'<div class="mb-link">' +
					   			'<a href="javascript:;">' + title + ' (' + number + ')' + '</a>' + 
							'</div>' +
							'<div class="mb-tags">' +
								'<div class="filter-btn" >' + filterText + '<span class="font-Plus"></span></div>' +
							'</div>' +
						'</div>' +
						'<ul class="list"></ul>' + 
						'<div class="page-box"></div>' + 
						'<p class="text-center">' +
							'<a href="javascript:;" class="more-btn">' + loadMoreText + '</a>' + 
						'</p>';
	
		$proRight.html("").append(headHtml);
		
		if (!mobile) renderTags();
		
		pageAndDrawCategoryProducts();
	}
	
	function pageAndDrawCategoryProducts () {
		var windowWidth = $(window).width();
		var startIndex = 0;
		var endIndex = products.length - 1;
		if (products.length > pageCount) {
			var pageNum = Math.ceil(products.length / pageCount);
			endIndex = pageCount * pageOf - 1;
			startIndex = endIndex - pageCount + 1;
			var pageL = '<span class="tips">' + getPageInfoText(pageOf, pageNum, products.length) + '</span>';
			var pageR = '<div class="page-num"><div class="btn-prev"><span class="fa fa-caret-left"></span></div><div class="btn-box"></div><div class="btn-next"><span class="fa fa-caret-right"></span></div></div>';
			$(".pro-right .pro-title .page-info").html('<span>' + getPageInfoText(pageOf, pageNum, products.length) + '</span>');
            $(".pro-right .page-box").html(pageL + pageR);
            var pageN = "";
            for (var i = 1; i <= pageNum; i++) {
            	if (i == pageOf) {
            		pageN += '<a href="javascript:;" class="on">' + i + '</a>';
                }else{
                	pageN += '<a href="javascript:;">' + i + '</a>';
                }           	
            }
            $(".pro-right .page-box .page-num .btn-box").append(pageN);
		}
		
		if (endIndex >= products.length - 1) {
			$proRight.find(".more-btn").addClass("hidden");
		}

		var currentProducts = [];
		$.each(products, function(i, product){ 
			product.selected=false;
			if(compareData.lists.length>0){
				for(var x=0;x<compareData.lists.length;x++){
					if( compareData.lists[x].id==product.productId){
						product.selected=true; 
					} 
				}
			}
			if (i >= startIndex){
				currentProducts.push(product);
			}
			if (i >= endIndex) return false;
		});
		
		var $productsContainer = $proRight.find(".list");
		if (windowWidth > 768) {
			$productsContainer.html("");
		}
		drawCurrentProducts($productsContainer, currentProducts);
	}
	
	function drawMoreProducts(title, number, mobile) {
		var headHtml = '<h2 class="pro-title">' + title + '</h2>' +
					   '<div class="tags-box hidden">'	+
					   		'<a href="javascript:;" class="clear-btn">' + clearAllText + '</a>' +
					   '</div>' +
					   '<div class="mb-top">' +
					   		'<div class="mb-link">' +
					   			'<a href="javascript:;"><span class="font-Next-Page-arrow"></span>' + title + ' (' + number + ')' + '</a>' + 
							'</div>' +
							'<div class="mb-tags">' +
								'<div class="filter-btn" >' + filterText + '<span class="font-Plus"></span></div>' +
							'</div>' +
						'</div>' +
						'<ul class="list"></ul>';
		
		$proRight.html("").append(headHtml);
		
		if (!mobile) renderTags();
		
		var currentMoreProductsCategories = [];
		var $activedMoreProductsCategories = $(".sub-cont .more-products .sub-box a.on", $categoriesBox);
		if ($activedMoreProductsCategories.length > 0) {
			$activedMoreProductsCategories.each(function(i, item1){
				var tagID = $(item1).data("tag");
				$.each(moreCategoriesData, function(j, item2){
					if (tagID == item2.tagID) {
						currentMoreProductsCategories.push({tagID:tagID, title:item2.title});
						return false;
					}
				});
			});
		} else {
			currentMoreProductsCategories = moreCategoriesData;
		}
		
		$.each(currentMoreProductsCategories, function(i, currentCategory){
			$proRight.append("<h3>" + currentCategory.title + "</h3><ul class='list mplist'></ul>");
			var tagID = currentCategory.tagID;
			var currentProduct = [];
			$.each(products, function(i, product){
				if (product.marketingCategory == tagID) currentProduct.push(product);
			});
			var $productsContainer = $(".pro-right .mplist").eq(i);
			drawCurrentProducts($productsContainer, currentProduct);
		});
	}

	function drawCurrentProducts ($productsContainer, currentProducts) {
		var windowWidth = $(window).width();
		if (windowWidth > 768) $productsContainer.css("visibility", "hidden");
		var currentNum = 0;
		if (windowWidth <= 768) currentNum = $productsContainer.find("li").length;
		if (currentProducts && currentProducts.length > 0) {
			var addToCompare,removeFromCompare,showCompare,selectToCompare;
			showCompare = $('.alert-compare').attr('show');
			addToCompare = $('.alert-compare').attr('add') || 'ADD TO COMPARE';
			removeFromCompare = $('.alert-compare').attr('remove') || 'REMOVE FROM COMPARE';
			selectToCompare = $('.alert-compare').attr('select') || 'SELECT TO COMPARE';
			
			$.each(currentProducts, function(i, product){
				i += currentNum;
				var productId = product['productId'];
				var marketingName = product['marketingName'];
				var detailPage = product['detailPage'] || 'javascript:;';
				var marketingCategory=product['marketingCategory'];
				// 选中状态
				var selected = product['selected'];
				// 产品分类
				var isPhone = (marketingCategory.indexOf('smartphones'))!=-1;
				// 判断当前是否支持比较（是否存在featuresTitle文案配置，已配置则支持）
				var canCompare = product.featuresTitle ? true : false;
				var listr = '';
				if(showCompare && isPhone){
					listr+='<li id="'+productId+'" class="show-compare">';
				}else{
					listr+='<li id="'+productId+'">';
				}
					listr+='<a href="' + detailPage + '">';
						listr+='<div class="pro-img"></div>';
					listr+='</a>';
					listr+='<div class="pro-color"></div>';
					listr+='<a href="' + detailPage + '">';
						listr+='<h2 class="pro-name">' + product["marketingName"] + '</h2>';
						listr+='<div class="pro-info"></div>';
					listr+='</a>';
					if(showCompare && isPhone && canCompare){
						if(selected){
							listr+='<div class="btn-compare compared" url="'+detailPage+'">';
						}else{
							listr+='<div class="btn-compare" url="'+detailPage+'">';
						}
						listr+='<div class="btn-add"><span class="fa fa-plus"></span>'+addToCompare+'</div>';
						listr+='<div class="btn-remove"><span class="fa fa-minus"></span>'+removeFromCompare+'</div>'
						listr+='</div>';
						listr+='<div class="item-select">';
						listr+='<label>';
						listr+='<div class="inp-name hidden">'+product["marketingName"]+'</div>';
						listr+='<input type="checkbox" url="'+detailPage+'" productid="'+productId+'">'
						listr+='<i class="font-Checkbox font-Checkbox-tick"></i>';
						listr+='<span class="plp-item-constrast-text">'+selectToCompare+'</span>'
						listr+='</label>';
						listr+='</div>';
					}
				listr+='</li>';
				var $li = $(listr);
				var $proInfo = $li.find(".pro-info");
				var mainSpecifications = product.mainSpecifications;
				if (mainSpecifications && mainSpecifications.length > 0) {
					$.each(mainSpecifications, function(j, specification){
						if (specification) $proInfo.append("<p><span></span>" + specification + "</p>");
					});
				}
				$productsContainer.append($li);
				 
				var $imageContainer = $productsContainer.find("li:eq(" + i + ") .pro-img");
				var colors = product.colors;
				if (colors && colors.length > 0) { 
					var activedColorIndex = getActivedColorIndex(colors);
					var $colorContainer = $productsContainer.find("li:eq(" + i + ") .pro-color");
					$.each(colors, function(j, color){
						var colorValue = color.color ? "#" + color.color.substring(color.color.lastIndexOf("/") + 1) : "white";
                        var colorName="white";
                        if(color.color){
                            var tempArr=color.color.split("/");
                            if(tempArr.length>4){
                                colorName=tempArr[3];
                                //$colorContainer.attr("data-color-name",colorName);                          
                            }              
                        }
                        var imgTitle = '',imgAlt=''; 
                        if(color.imgTitle && color.imgTitle!="null"){
                        	imgTitle =color.imgTitle;
                        }
                        if(color.imgAlt && color.imgAlt!="null"){
                        	imgAlt =color.imgAlt;
                        }   
						if (j == activedColorIndex) { 
							$imageContainer.append("<img src='" + color.imagePath + "' title='"+imgTitle +"' alt='"+imgAlt+"'>");
							$colorContainer.append("<div class='on'><span style='background:" + colorValue +"' lab='"+marketingName+"' act='"+colorName+"' cat='Color Selection'></span></div>");
						} else {
							$imageContainer.append("<img src='" + color.imagePath  + "' title='"+imgTitle +"' alt='"+imgAlt+" ' style='display:none;'>");
							$colorContainer.append("<div><span style='background:" + colorValue +"' lab='"+marketingName+"' act='"+colorName+"' cat='Color Selection'></span></div>");
						}

					});
					
					// 移动端下，产品颜色滑动
					var touchStartX = 0, touchEndX = 0;
					$(".pro-right").on("touchstart", ".pro-img img", function(e){
						var touch = e.originalEvent.touches[0];
						touchStartX = touch.clientX;
					}).on("touchmove", function(e){
						var touch = e.originalEvent.touches[0];
						touchEndX = touch.clientX;
					});
					
					$(".pro-right").on("touchend",'.pro-img img',function(e){
	                    var i = $(this).index();
	                    var a = $(this).siblings().length;
	                     if((touchEndX + 30) < touchStartX && touchEndX != 0){
	                       if(i == a){
	                        $(this).parent().parent().next(".pro-color").children("div").eq(0).click();
	                       }else{
	                        $(this).hide().next("img").show();
	                        $(this).parent().parent().next(".pro-color").children("div").eq(i + 1).addClass("on").siblings("div").removeClass("on");
	                       }
	                      
	                     }else if((touchEndX - 30) > touchStartX && touchEndX != 0){
	                      if(i == 0){
	                        $(this).parent().parent().next(".pro-color").children("div").eq(a).click();
	                       }else{
	                        $(this).hide().prev("img").show();
	                        $(this).parent().parent().next(".pro-color").children("div").eq(i - 1).addClass("on").siblings("div").removeClass("on");
	                       }
	                     }
	               });
				} else {
					var defaultImage = product.defaultImage;
					var imgTitle = '',imgAlt=''; 
					if(product.defaultImgTitle && product.defaultImgTitle!="null"){
						imgTitle =product.defaultImgTitle;
					}
					if(product.defaultImgAlt&& product.defaultImgAlt!="null"){
						imgAlt =product.defaultImgAlt;
					}   
					if (defaultImage) {
						$imageContainer.append("<img src='" + defaultImage + "' title='"+ imgTitle +"' alt='"+imgAlt+"' >");
					} else {
						$imageContainer.append("<img src='" + defaultImage + "' title='"+ imgTitle +"' alt='"+imgAlt+"' >");
						console.log("no picture is configured for product (ID: " + productId + " , NAME: " + marketingName + ")");
					}
				}
			});
			
			
		} else {
			$productsContainer.append(noProductFoundHtml);
		}
		if (windowWidth > 768) setTimeout(function(){ $productsContainer.css("visibility", "visible"); }, 150);
	}
	
	function addTag(tagObj, mobile) {
		tags.push(tagObj);
		if (!mobile) {
			var lengthBeforeAdd = tags.length;
			var $tagBox = $proRight.find(".tags-box");
			$tagBox.append("<div class='tag' data-tag='" + tagObj.tagID + "'><span class='tag-text'>" + tagObj.title + "</span><span class='fa fa-remove'></span></div>");
			if (lengthBeforeAdd == 0) $tagBox.removeClass("hidden");
		}
	}
	
	function removeTag(tagObj, mobile) {
		var index = -1;
		if (!mobile) {
			var $tagBox = $proRight.find(".tags-box");
			var $targetTag = $tagBox.find(".tag[data-tag='" + tagObj.tagID + "']");
			index = $targetTag.index() - 1;
			$targetTag.remove();
			tags.splice(index, 1);
			if (tags.length < 1) $tagBox.addClass("hidden");
		} else {
			$.each(tags, function(i, tag){
				if (tag.tagID == tagObj.tagID) {
					index = i;
					return false;
				}
			}); 
			tags.splice(index, 1);
		}
	}
	
	function renderTags(){
		if (tags && tags.length > 0) {
			var $tagBox = $proRight.find(".tags-box");
			$.each(tags, function(i, tagObj){
				$tagBox.append("<div class='tag' data-tag='" + tagObj.tagID + "'><span class='tag-text'>" + tagObj.title + "</span><span class='fa fa-remove'></span></div>");
			});
			$tagBox.removeClass("hidden");
		}
	}
	
	function getActivedColorIndex (colors) {
		var $checkedColor = $(".sub-cate .sub-box a.on[data-tag^='" + tagPrefixProductsSpecsColors + "']", $proLeft);
		var result = 0;
		if ($checkedColor.length > 0) {
			var checkedTagID = $checkedColor.data("tag");
			$.each(colors, function(i, color){
				var tagID = color.color;
				if (tagID && tagID.substr(0, checkedTagID.length) == checkedTagID) {
					result = i;
					return false;
				}
			});
		}
		return result;
	}
	
	function getPageInfoText(pageOf, pageNum, totalCount){
		return pageInfoText.replace("$1", "<b>" + pageOf + "</b>").replace("$2", "<b>" + pageNum + "</b>").replace("$3", "<b>" + totalCount + "</b>");
	}
	
	function showProFilter() {
		$proFilter.show();
		$('html').css("overflow-y","hidden");
		$('body').css({"position":"fixed","top":"0px","left":"0px"})
	}
	
	function hideProFilter() {
		$proFilter.hide();
		$('html').css("overflow-y","auto");
		$('body').css({"position":"","top":"","left":""})
	}
});
/**
 * 产品比较功能
 * Date:2018-09-18
 */
// 所有产品数据
var allProductsData = $(".product-list-data-holder").data("products");
// 产品对比数据
var compareData={
	num:0,
	lists:[], 
	full:false,
	descLists:[],
	compareTxt: $('.alert-compare').attr('compare') || 'SELECT TO COMPARE',
	selectTxt: $('.alert-compare').attr('select') || 'SELECT TO COMPARE',
	showCompare: $('.alert-compare').attr('show')
} 

$(function(){
	var $productListV1 = $('.product-list .pro-list-v1');
	if ($productListV1.length < 1) return;
	
	//产品比较功能相关方法列表

	// 获取产品数据接口路径
	function getAjaxUrl(productUrl){
		var ajaxUrl="";
		var protocol = document.location.protocol+"//";
		var currPageHost = location.host; 
		var urlPre = protocol+currPageHost;
		var endProductUrl='';
		var currPageUrl= location.href;
		if(currPageUrl.indexOf('/content/honor')!=-1){
			if(productUrl.indexOf('.html') !=-1){
				ajaxUrl=urlPre+productUrl.split('.html')[0]+'/jcr:content.specs.json';
			}else{
				endProductUrl=productUrl+'jcr:content.specs.json';
				ajaxUrl=urlPre+"/content/honor"+endProductUrl;
			}
		}else{
			endProductUrl=productUrl+'jcr:content.specs.json';
			ajaxUrl=urlPre+endProductUrl;
		}
		
		return ajaxUrl;
		
	}

	// 获取对比数据
	function getCompareData(goods){
		var index =-1;
		for(var i=0;i<compareData.lists.length;i++){
			if(compareData.lists[i].id=== goods.id){
				index = i;
			}
		}
		if(index!=-1){
			// 已存在相同的，需要删除	    			
			compareData.lists.splice(index,1);
			compareData.descLists.splice(index,1);
			compareData.full=false;
		}else{
			// 没有相同的	    			
			if(!compareData.full){
				// 总数没有到4个
				compareData.lists.push(goods);
				var productUrl =goods.productUrl;
				
				var ajaxUrl = getAjaxUrl(productUrl);
				// Get product specification info	
				$.ajax({
				    url: ajaxUrl, 
				    dataType: 'json', 
				    type: 'GET',
//				    async:false,
				    success: function(info) {
				    	var data = info.detailMode;
				    	data.productUrl = productUrl;
				    	compareData.descLists.push(data)
				    }
				})
			}
		} 
	}
	// 显示【PC端 产品列表选择弹窗】  渲染产品列表
	function showCompareLists(goods){
		getCompareData(goods);
		
		// 渲染数据
		var listhtml = '';
		var listData = compareData.lists;
		if(listData.length==0){
			// 隐藏弹窗
			$('.alert-compare .min-box').hide();
			$('.alert-compare .max-box').slideUp();
		}else{
	    	for(var i=0;i<listData.length;i++){
		    	listhtml+='<li>';
		    		listhtml+='<p goodsid="'+listData[i].id+'" class="icon-circle-box">';
		    			listhtml+='<span class="font-Cross"></span>';
					listhtml+='</p>';
					listhtml+='<img src="'+listData[i].imgsrc+'" />';
					listhtml+='<p class="chosen-title">'+listData[i].name+'</p>';
				listhtml+='</li>';
	    	}
		}
		$('.max-box .chosen-lists').empty().append(listhtml);
		
		 // 删除单个产品
	    $('.chosen-lists .icon-circle-box').click(function(){
	    	// 获取产品数据
	    	var id = $(this).attr('goodsid');
	    	var name = $(this).siblings('.chosen-title').html();
	    	var nameText = $(this).siblings('.chosen-title').text();
	    	var goods = new Object();
	    	goods.id = id;
	    	goods.name = name;
	    	goods.nameText = nameText;
	    	$('#'+goods.id +" .btn-compare").removeClass('compared')
			compareData.num -=1;
			compareData.full = false;
	    	$('.min-box .compare-num').text(compareData.num);
	    	showCompareLists(goods);
	    })
	    
	}
	//显示【MB端 产品列表选择弹窗】  渲染产品列表
	function showMBCompareLists(goods){
		getCompareData(goods);
		
		// 渲染数据
		var listhtml = '';
		var listData = compareData.lists;
		if(listData.length==0){
			// 隐藏弹窗
			$('.alert-compare-mb').slideUp();
		}else{
	    	for(var i=0;i<listData.length;i++){
	    		listhtml+='<li>';
					listhtml+='<p goodsid="'+listData[i].id+'" class="icon-circle-box">';
						listhtml+='<span class="font-Cross"></span>';
					listhtml+='</p>';
					listhtml+='<span class="product-name">'+listData[i].name+'</span>';
				listhtml+='</li>';
	    	}
	    	
		}
		$('.alert-compare-mb .chosen-lists').empty().append(listhtml);
		
		 // 删除单个产品
	    $('.alert-compare-mb .chosen-lists .icon-circle-box').click(function(){
	    	// 获取产品数据
	    	var id = $(this).attr('goodsid');
	    	var name = $(this).siblings('.product-name').html();
	    	var nameText = $(this).siblings('.product-name').text();
	    	var goods = new Object();
	    	goods.id = id;
	    	goods.name = name;
	    	goods.nameText = nameText;
	    	$(".item-select [productid="+goods.id+"]").prop('checked',false);
	    	$(".item-select [productid="+goods.id+"]").next('i').toggleClass('font-Checkbox');
	    	$(".list #"+goods.id).removeClass('active');
			compareData.num -=1;
			compareData.full = false;
			
			if(compareData.num==2){
				$('.alert-compare-mb .operate .chosen-compare-mb').attr('disabled',false).removeClass('only-one').text('Compare');
				$('.alert-compare-mb .operate .cancel-compare').show();
			}else{
				$('.alert-compare-mb .operate .chosen-compare-mb').attr('disabled',true).addClass('only-one').text('Select to Compare');
				$('.alert-compare-mb .operate .cancel-compare').hide();
			}
			
			showMBCompareLists(goods);
	    })
	    
	}


	// 渲染【产品详情对比弹窗】产品列表
	function showCompareProductDesc(data){
		// colors 
		var colorsList='';
		for(var x=0;x<data.length;x++){
			var colorstr = '',imgstr = '';
			var colorLists =  JSON.parse(data[x].colors);
			for(var i=0;i<colorLists.length;i++){
				var  colorValue = colorLists[i].color ? '#'+colorLists[i].color.substring(colorLists[i].color.lastIndexOf('/')+1) : 'white'
				if(i==0){
					colorstr+='<div num="'+(i+1)+'" class="on">';
					imgstr +='<img src="'+colorLists[i].imagePath+'" alt="'+colorLists[i].imgAlt +'" title="'+colorLists[i].imgTitle +'" />';
				}else{
					colorstr+='<div num="'+(i+1)+'">';
					imgstr +='<img style="display: none;" src="'+colorLists[i].imagePath+'" alt="'+colorLists[i].imgAlt +'" title="'+colorLists[i].imgTitle +'" />';
				}
					colorstr+='<span style="background:'+colorValue+'"></span>';
				colorstr+='</div>';
			}
			colorsList+='<li>';
				colorsList+='<a href="'+data[x].productUrl+'">';
					colorsList+='<div class="pro-img">';
						colorsList+=imgstr;
					colorsList+='</div>';
				colorsList+='</a>';
				colorsList+='<div class="pro-color">';
					colorsList+=colorstr;
				colorsList+='</div>';
				colorsList+='<a href="'+data[x].productUrl+'">';
					colorsList+='<h2 class="pro-name">';
						colorsList+='<span>'+data[x].marketingName+'</span>';
						colorsList+='<span class="fa fa-long-arrow-right"></span>';
					colorsList+='</h2>';
				colorsList+='</a>';
			colorsList+='</li>';
		}
		$('.product-imgs .product-list').empty().append(colorsList);
		
		var featurestr='',displaystr='',dimstr='',cameratr='',
		networkstr='',gpsstr='',connectivitystr='',
		intheboxstr='',btnandconnstr='';
		
		for(var x=0;x<data.length;x++){
			// features
			$('.specs-features .item-title').text(data[x].featuresTitle);
			var featureList = data[x].featuresContent.split('\n');
			featurestr +='<li>';
			for(var i=0;i<featureList.length;i++){
				featurestr+='<p>'+featureList[i]+'</p>'
			}
			featurestr+='</li>';
			
			
			// display
			$('.specs-display .item-title').text(data[x].displayTitle);
			var displayList = data[x].displayContent.split('\n');
			displaystr +='<li>';
//			displaystr+='<img class="display-img" src="'+data.displayImage+'" alt="'+data.displayImgAlt+'" title="'+data.displayImgTitle+'" />';
//			displaystr+='<div class="content-txt">';
			for(var i=0;i<displayList.length;i++){
				displaystr+='<p>'+displayList[i]+'</p>';
			}
			displaystr+='</li>';
			
			
			// dimensions
			$('.specs-dimensions .item-title').text(data[x].dimensionsTitle);
			dimstr+='<li>';
			var sizeList = data[x].sizeContent.split('\n');
			for(var i=0;i<sizeList.length;i++){
				dimstr+='<p>'+sizeList[i]+'</p>'
			}
			dimstr+='</li>';
			
			
			// camera 
			$('.specs-camera .item-title').text(data[x].cameraTitle);
			cameratr += '<li>';
			if(data[x].rearCameraTitle){
				cameratr+='<h3 class="li-title">'+data[x].rearCameraTitle+': </h3>';
			}
			var rearList = data[x].rearCameraContent.split('\n');
			for(var i=0;i<rearList.length;i++){
				cameratr+='<p>'+rearList[i]+'</p>';
			}
			
			if(data[x].frontCameraTitle){
				cameratr+='<h3 class="li-title">'+data[x].frontCameraTitle+':</h3>';
			}
			var frontList = data[x].frontCameraContent.split('\n');
			for(var i=0;i<frontList.length;i++){
				cameratr+='<p>'+frontList[i]+'</p>';
			}
			cameratr+='</li>';
			
			
			// network
			$('.specs-network .item-title').text(data[x].networkTitle);
			var networkList = data[x].networkContent.split('\n');
			networkstr +='<li>';
			for(var i=0;i<networkList.length;i++){
				networkstr+='<p>'+networkList[i]+'</p>'
			}
			networkstr+='</li>';
			
			
			// gps
			$('.specs-gps .item-title').text(data[x].gpsTitle);
			var gpsList = data[x].gpsContent.split('\n');
			gpsstr +='<li>';
			for(var i=0;i<gpsList.length;i++){
				gpsstr+='<p>'+gpsList[i]+'</p>'
			}
			gpsstr+='</li>';
			
			// connectivity
			$('.specs-connectivity .item-title').text(data[x].connectivityTitle);
			var connectivityList = data[x].connectivityContent.split('\n');
			connectivitystr +='<li>';
			for(var i=0;i<connectivityList.length;i++){
				connectivitystr+='<p>'+connectivityList[i]+'</p>'
			}
			connectivitystr+='</li>';
			
			// inthebox
			$('.specs-inthebox .item-title').text(data[x].intheboxTitle);
			var intheboxList = data[x].intheboxContent.split('\n');
			intheboxstr +='<li>';
			for(var i=0;i<intheboxList.length;i++){
				intheboxstr+='<p>'+intheboxList[i]+'</p>'
			}
			intheboxstr+='</li>';
			
			// btnandconn 
			$('.specs-btnandconn .item-title').text(data[x].btnAndConnTitle);
			btnandconnstr +='<li><img src="'+data[x].btnAndConnImage+'" alt="'+data[x].btnAndConnImgAlt+'" title="'+data[x].btnAndConnImgTitle+'" /></li>';
			
		}
		$('.specs-features .item-content').empty().append(featurestr);
		$('.specs-display .item-content').empty().append(displaystr);
		$('.specs-dimensions .item-content').empty().append(dimstr);
		$('.specs-camera .item-content').empty().append(cameratr);
		
		$('.specs-network .item-content').empty().append(networkstr);
		$('.specs-gps .item-content').empty().append(gpsstr);
		$('.specs-connectivity .item-content').empty().append(connectivitystr);
		$('.specs-inthebox .item-content').empty().append(intheboxstr);
		$('.specs-btnandconn .item-content').empty().append(btnandconnstr);
		
		var itemW =Math.round((100-data.length)/data.length * 100) / 100.00 +"%";
		$('.alert-productdesc .table-box li').css('width',itemW);
		
	}
	
	var pageWidth=utils.pageWidth();
	// 初始化样式
	if(pageWidth>1024){
		var boxR = (pageWidth - 1200) / 2;
		if($(".__arabic__").length>0){
			$('.min-box').css('left', boxR);
		}else{
			$('.min-box').css('right', boxR);
		}
	}
	
	if(pageWidth>768){
		// 显示隐藏 产品列表选择弹窗
		$('.min-box .chosen-compare,.min-box .icon-arrow-box').click(function() {
			$('.min-box').hide();
			$('.max-box').slideDown();
		});
		$('.max-box .icon-arrow-box').click(function() {
			$('.max-box').slideUp();
			$('.min-box').show();
		});
		
		// 清空，初始化对比产品数据
		$('.max-box .clear-list').click(function() {
			$('.max-box .chosen-lists').empty();
			compareData.num = 0;
			compareData.lists = [];
			compareData.full = false;
			compareData.descLists=[];
			
			$('.list .btn-compare').removeClass('compared')
			$('.alert-compare .max-box').slideUp('slow');
		});
		
		// 选择单个产品加入或移除对比列表
		$('.pro-list').on('click','.list li .btn-compare',function(){
			$('.alert-compare,.min-box').show();
			var flag =$(this).hasClass('compared');
			
			if(!flag){
				compareData.num +=1;
			}else{
				compareData.num -=1;
			}
			if(compareData.num<=4){
				$(this).toggleClass('compared')
			}else{
				compareData.full = true;
				compareData.num -=1;
				// 提示
				var pcAlertTxt = $('.alert-compare').attr('pcalerttxt');
				alert(pcAlertTxt)
			}
			if(compareData.num>1){
				$('.max-box .chosen-compare').attr('disabled',false);
			}else{
				$('.max-box .chosen-compare').attr('disabled',true);
			}
			$('.min-box .compare-num').text(compareData.num);
			
			// 获取产品数据
			var id = $(this).parent().attr('id');
			var name = $(this).parent().find('.pro-name').html();
			var nameText = $(this).parent().find('.pro-name').text();
			var imgsrc = $(this).parent().find('.pro-img img:first-child').attr('src');
			// 获取产品路径，调用接口渲染数据	
			var productUrl= $(this).attr('url');
			
			var goods = new Object();
			goods.id = id;
			goods.name = name;
			goods.nameText = nameText;
			goods.imgsrc = imgsrc;
			goods.productUrl = productUrl;
			
			showCompareLists(goods);
		});
		
		// 显示【产品详情对比弹窗】
		$('.max-box .chosen-compare').click(function(){
			$('html').css('overflow','hidden');
			$('.alert-productdesc').css('top','0');
			var contentH = utils.windowHeight()-70;
			$('.alert-productdesc .alert-content').css({
				'height':contentH,
				'overflow':'auto'
			});
			//渲染产品详情对比数据
			showCompareProductDesc(compareData.descLists);
		})
	
	}else{
		/* 移动端比较功能开始 */
		$('.pro-list').on('click','.item-select label input',function(){
			var flag = $(this).prop('checked');
			
			if(flag){
				//选中
				compareData.num +=1;
			}else{
				//未选中
				compareData.num -=1;
			}
			$('.alert-compare-mb').show();
			
			if(compareData.num<=2){
				$(this).next().toggleClass('font-Checkbox')
				var $li = $(this).parent().parent().parent();
				$li.toggleClass('active');
				
			}else{
				compareData.full = true;
				compareData.num -=1;
				$(this).prop('checked',false);
				var mbAlertTxt = $('.alert-compare').attr('mbalerttxt');
				alert(mbAlertTxt)
				return;
			}
			if(compareData.num==2){
				$('.alert-compare-mb .operate .chosen-compare-mb').attr('disabled',false).removeClass('only-one').text(compareData.compareTxt);
				$('.alert-compare-mb .operate .cancel-compare').show();
			}else{
				$('.alert-compare-mb .operate .chosen-compare-mb').attr('disabled',true).addClass('only-one').text(compareData.selectTxt);
				$('.alert-compare-mb .operate .cancel-compare').hide();
			}
			// 获取产品数据
			var id = $(this).attr('productid');
			var name = $(this).siblings('.inp-name').html();
			var nameText = $(this).siblings('inp-name').text();
			var productUrl= $(this).attr('url');
			
			var goods = new Object();
			goods.id = id;
			goods.name = name;
			goods.nameText = nameText;
			goods.productUrl = productUrl;

			showMBCompareLists(goods);
			
		})
		// 清空，初始化对比产品数据
		$('.alert-compare-mb .cancel-compare').click(function() {
			$('.alert-compare-mb .chosen-lists').empty();
			compareData.num = 0;
			compareData.lists = [];
			compareData.full = false;
			compareData.descLists=[];
			
			$(".item-select input").prop('checked',false);
			$(".list li").removeClass('active');
	    	var $i= $(".item-select input").next('i');
	    	$i.each(function(){
	    		if(!$(this).hasClass('font-Checkbox')){
	    			$(this).addClass('font-Checkbox')
	    		}
	    	})
	    	
	    	$('.alert-compare-mb').slideUp('slow');
	    	
		});
		// 显示【产品详情对比弹窗】
		$('.alert-compare-mb .chosen-compare-mb').click(function(){
			$('html').css('overflow','hidden');
			$('.alert-productdesc').css('top','0');
			var contentH = utils.windowHeight()-70;
			$('.alert-productdesc .alert-content').css({
				'height':contentH,
				'overflow':'auto'
			});
			//渲染产品详情对比数据
			showCompareProductDesc(compareData.descLists);
		})
	}
	
	
	// 隐藏【产品详情对比弹窗】
	$('.alert-productdesc .btn-arrow-down').click(function(){
		$('.alert-productdesc').css('top','100%');
		$('.alert-productdesc .alert-content').css('overflow','hidden')
		$('html').delay(1000).css('overflow','auto');
	})
	
	// 点击颜色切换图片
	$('.alert-productdesc').on("click", ".pro-color div", function(event){
		var $this = $(this);
		var index = $this.index();
		$this.parent().prev("a").find(".pro-img").children("img:eq(" + index + ")").show().siblings("img").hide();
		$this.addClass("on").siblings("div").removeClass("on");
		event.stopPropagation();
	});
	
	// 移动端下，产品颜色滑动
	var touchStartX = 0, touchEndX = 0;
	$(".alert-productdesc").on("touchstart", ".pro-img img", function(e){
		var touch = e.originalEvent.touches[0];
		touchStartX = touch.clientX;
	}).on("touchmove", function(e){
		var touch = e.originalEvent.touches[0];
		touchEndX = touch.clientX;
	});
	$(".alert-productdesc").on("touchend",'.pro-img img',function(e){
        var i = $(this).index();
        var a = $(this).siblings().length;
         if((touchEndX + 30) < touchStartX && touchEndX != 0){
           if(i == a){
            $(this).parent().parent().next(".pro-color").children("div").eq(0).click();
           }else{
            $(this).hide().next("img").show();
            $(this).parent().parent().next(".pro-color").children("div").eq(i + 1).addClass("on").siblings("div").removeClass("on");
           }
          
         }else if((touchEndX - 30) > touchStartX && touchEndX != 0){
          if(i == 0){
            $(this).parent().parent().next(".pro-color").children("div").eq(a).click();
           }else{
            $(this).hide().prev("img").show();
            $(this).parent().parent().next(".pro-color").children("div").eq(i - 1).addClass("on").siblings("div").removeClass("on");
           }
         }
   });
	
	
})

/**
 * 产品比较功能
 * Date:2019-06-20
 */
// 产品对比数据
var compareDataV2={
	num:0,
	lists:[], 
	full:false,
	descLists:[],
	compareTxt: $('.pro-list-v2 .alert-compare-v2').attr('compare') || 'COMPARE',
	selectTxt: $('.pro-list-v2 .alert-compare-v2').attr('select') || 'COMPARE',
	showCompare: $('.pro-list-v2 .alert-compare-v2').attr('show')
} 
$(function(){
	var $productListV2 = $('.product-list .pro-list-v2');
	if ($productListV2.length < 1) return;
	
	var pageWidth=utils.pageWidth();
	
	// 获取产品数据接口路径
	function getAjaxUrl(productUrl){
		var ajaxUrl="";
		var protocol = document.location.protocol+"//";
		var currPageHost = location.host; 
		var urlPre = protocol+currPageHost;
		var endProductUrl='';
		var currPageUrl= location.href;
		if(currPageUrl.indexOf('/content/honor')!=-1){
			if(productUrl.indexOf('.html') !=-1){
				ajaxUrl=urlPre+productUrl.split('.html')[0]+'/jcr:content.specs.json';
			}else{
				endProductUrl=productUrl+'jcr:content.specs.json';
				ajaxUrl=urlPre+"/content/honor"+endProductUrl;
			}
		}else{
			endProductUrl=productUrl+'jcr:content.specs.json';
			ajaxUrl=urlPre+endProductUrl;
		}
		return ajaxUrl;
	}

	// 获取对比数据
	function getCompareData(goods){
		var index =-1;
		for(var i=0;i<compareDataV2.lists.length;i++){
			if(compareDataV2.lists[i].id=== goods.id){
				index = i;
			}
		}
		if(index!=-1){
			// 已存在相同的，需要删除	    			
			compareDataV2.lists.splice(index,1);
			compareDataV2.descLists.splice(index,1);
			compareDataV2.full=false;
		}else{
			// 没有相同的	    			
			if(!compareDataV2.full){
				// 总数没有到4个
				compareDataV2.lists.push(goods);
				var productUrl =goods.productUrl;
				
				var ajaxUrl = getAjaxUrl(productUrl);
				// Get product specification info	
				$.ajax({
				    url: ajaxUrl, 
				    dataType: 'json', 
				    type: 'GET',
				    success: function(info) {
				    	var data = info.detailMode;
				    	data.productUrl = productUrl;
				    	compareDataV2.descLists.push(data)
				    }
				})
			}
		} 
	}
	/*	 更新列表产品状态
	 * 	@param that当前产品对象
	 * 	@type 终端类型： pc/mb
	 * */
	function updateProStatus(that,type){
		// 获取产品数据
    	var id = that.attr('goodsid');
    	var name = that.siblings('.pro-name').html();
    	var nameText = that.siblings('.pro-name').text();
    	var goods = new Object();
    	goods.id = id;
    	goods.name = name;
    	goods.nameText = nameText;
    	
    	var $btnCompare = $('#'+goods.id +" .btn-compare");
    	$btnCompare.removeClass('on').find('.app-close-icon').addClass('app-plus-icon').removeClass('app-close-icon');
    	$btnCompare.children(".btn-add").children("span").text(addToCompare);
    	
		compareDataV2.num -=1;
		compareDataV2.full = false;
		
		if(type=='pc'){
			showCompareLists(goods);
		}else if(type=='mb'){
			showMBCompareLists(goods);
		}
		
	}
	
	// 显示【PC端 产品列表选择弹窗】  渲染产品列表
	function showCompareLists(goods){
		getCompareData(goods);
		
		// 渲染数据
		var listhtml = '',listName='';
		var listData = compareDataV2.lists;
		if(listData.length==0){
			// 隐藏弹窗
			$('.pro-list-v2 .alert-compare-v2 .max-box').slideUp();
		}else{
	    	for(var i=0;i<listData.length;i++){
				listhtml+='<li>';
					listhtml+='<span class="pro-name" title="'+listData[i].nameText+'">'+listData[i].name+'</span>';
					listhtml+='<span class="icon-circle-box"  goodsid="'+listData[i].id+'">';
						listhtml+='<i class="honorFont-close"></i>';
					listhtml+='</span>';
				listhtml+='</li>'; 
				
				listName+='<li>'+listData[i].name+'</li>';
	    	}
		}
		$('.pro-list-v2 .max-box .chosen-lists').empty().append(listhtml);
		$('.pro-list-v2 .alert-productdesc-v2 .compare-lists-name').empty().append(listName);
		var itemW =Math.round((100-listData.length)/listData.length * 100) / 100.00 +"%";
		$('.alert-productdesc .table-box li,.alert-productdesc-v2 .compare-lists-name li').css('width',itemW);
		if(listData.length>1){
			$('.alert-productdesc-v2 .alert-header').removeClass('list2 list3 list4').addClass('list'+listData.length);
		}
		
		// 删除单个产品
	    $('.pro-list-v2 .chosen-lists .icon-circle-box').click(function(){
	    	var that = $(this);
	    	// 更新列表产品状态
	    	updateProStatus(that,'pc');
	    	
	    	// delete GA Code
			var productName = that.siblings('.pro-name').text() || '';
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Products Comparison",
				"eventAction": "click",
				"eventLabel": "delete "+productName
			})
	    })
	    
	}
	
	//显示【MB端 产品列表选择弹窗】  渲染产品列表
	function showMBCompareLists(goods){
		getCompareData(goods);
		
		// 渲染数据
		var listhtml = '',listName='';
		var listData = compareDataV2.lists;
		if(listData.length==0){
			// 隐藏弹窗
			$('.alert-compare-mb-v2').slideUp();
		}else{
	    	for(var i=0;i<listData.length;i++){
	    		listhtml+='<li>';
					listhtml+='<span class="pro-name">'+listData[i].name+'</span>';
					listhtml+='<span class="icon-circle-box"  goodsid="'+listData[i].id+'">';
						listhtml+='<i class="honorFont-close"></i>';
					listhtml+='</span>';
				listhtml+='</li>'; 
				
				listName+='<li>'+listData[i].name+'</li>';
	    	}
		}
		$('.alert-compare-mb-v2 .chosen-lists').empty().append(listhtml);
		$('.alert-productdesc-v2 .compare-lists-name').empty().append(listName);
		var itemW =Math.round((100-listData.length)/listData.length * 100) / 100.00 +"%";
		$('.alert-productdesc .table-box li,.alert-productdesc-v2 .compare-lists-name li').css('width',itemW);
		if(listData.length>1){
			$('.alert-productdesc-v2 .alert-header').removeClass('list2 list3 list4').addClass('list'+listData.length);
		}
		 // 删除单个产品
	    $('.alert-compare-mb-v2 .chosen-lists .icon-circle-box').click(function(){
	    	var that = $(this);
	    	// 更新列表产品状态
	    	updateProStatus(that,'mb');
			
			var $btnCompare = $('.pro-list-v2 .alert-compare-mb-v2 .operate .chosen-compare');
			$btnCompare.text(compareDataV2.selectTxt);
			if(compareDataV2.num==2){
				$btnCompare.attr('disabled',false);
			}else{
				$btnCompare.attr('disabled',true);
			}	
			
			// delete GA Code
			var productName = that.siblings('.pro-name').text() || '';
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Products Comparison",
				"eventAction": "click",
				"eventLabel": "delete "+productName
			})
			
	    })
	}

	// 渲染【产品详情对比弹窗】产品列表
	function showCompareProductDesc(data){
		// colors 
		var colorsList='';
		for(var x=0;x<data.length;x++){
			var colorstr = '',imgstr = '';
			if(data[x].colors){
				var colorLists =  JSON.parse(data[x].colors);
				for(var i=0;i<colorLists.length;i++){
					var  colorValue = colorLists[i].color ? '#'+colorLists[i].color.substring(colorLists[i].color.lastIndexOf('/')+1) : 'white'
					if(i==0){
						colorstr+='<div num="'+(i+1)+'" class="on">';
						imgstr +='<img src="'+colorLists[i].imagePath+'" alt="'+colorLists[i].imgAlt +'" title="'+colorLists[i].imgTitle +'" />';
					}else{
						colorstr+='<div num="'+(i+1)+'">';
						imgstr +='<img style="display: none;" src="'+colorLists[i].imagePath+'" alt="'+colorLists[i].imgAlt +'" title="'+colorLists[i].imgTitle +'" />';
					}
						colorstr+='<span style="background:'+colorValue+'"></span>';
					colorstr+='</div>';
				}
				colorsList+='<li>';
					colorsList+='<a href="'+data[x].productUrl+'">';
						colorsList+='<div class="pro-img">';
							colorsList+=imgstr;
						colorsList+='</div>';
					colorsList+='</a>';
					colorsList+='<div class="pro-color">';
						colorsList+=colorstr;
					colorsList+='</div>';
					colorsList+='<h2 class="pro-name">'+data[x].marketingName+'</h2>';
					colorsList+='<a href="'+data[x].productUrl+'">';
						var buyNowText = $('.alert-compare-v2').attr('buynow') || 'Buy Now';
						colorsList+='<buttom class="btn btn-buynow">'+buyNowText+'</button>';
					colorsList+='</a>';
				colorsList+='</li>';
			}
		}
		$('.pro-list-v2 .product-imgs .product-list').empty().append(colorsList);
		
		var featurestr='',displaystr='',dimstr='',rearcamerastr='',frontcamerastr='',
		networkstr='',gpsstr='',connectivitystr='',
		intheboxstr='',btnandconnstr='';
		
		for(var x=0;x<data.length;x++){
			// features
			$('.pro-list-v2 .specs-features .item-title-v2 .title-txt').text(data[x].featuresTitle);
			featurestr +='<li>';
			if(data[x].featuresContent){
				var featureList = data[x].featuresContent.split('\n');
				for(var i=0;i<featureList.length;i++){
					featurestr+='<p>'+featureList[i]+'</p>'
				}
				featurestr+='<p>'+data[x].featuresNote+'</p>';
			}
			featurestr+='</li>';
			
			
			// display
			$('.pro-list-v2 .specs-display .item-title-v2 .title-txt').text(data[x].displayTitle);
			displaystr +='<li>';
			if(data[x].displayContent){
				var displayList = data[x].displayContent.split('\n');
				for(var i=0;i<displayList.length;i++){
					displaystr+='<p>'+displayList[i]+'</p>';
				}
			}
			displaystr+='</li>';
			
			// dimensions
			$('.pro-list-v2 .specs-dimensions .item-title-v2 .title-txt').text(data[x].dimensionsTitle);
			dimstr+='<li>';
			if(data[x].sizeContent){
				var sizeList = data[x].sizeContent.split('\n');
				for(var i=0;i<sizeList.length;i++){
					dimstr+='<p>'+sizeList[i]+'</p>'
				}
			}
			dimstr+='</li>';
			// rear camera
			$('.pro-list-v2 .specs-rear-camera .item-title-v2 .title-txt').text(data[x].rearCameraTitle);
			rearcamerastr += '<li>';
			if(data[x].rearCameraContent){
				var rearList = data[x].rearCameraContent.split('\n');
				for(var i=0;i<rearList.length;i++){
					rearcamerastr+='<p>'+rearList[i]+'</p>';
				}
			}
			rearcamerastr+='</li>';
			//front camera
			$('.pro-list-v2 .specs-front-camera .item-title-v2 .title-txt').text(data[x].frontCameraTitle);
			frontcamerastr += '<li>';
			if(data[x].frontCameraContent){
				var frontList = data[x].frontCameraContent.split('\n');
				for(var i=0;i<frontList.length;i++){
					frontcamerastr+='<p>'+frontList[i]+'</p>';
				}
			}
			frontcamerastr+='</li>';
			
			// network
			$('.pro-list-v2 .specs-network .item-title-v2 .title-txt').text(data[x].networkTitle);
			networkstr +='<li>';
			if(data[x].networkContent){
				var networkList = data[x].networkContent.split('\n');
				for(var i=0;i<networkList.length;i++){
					networkstr+='<p>'+networkList[i]+'</p>'
				}
			}
			networkstr+='</li>';
			
			
			// gps
			$('.pro-list-v2 .specs-gps .item-title-v2 .title-txt').text(data[x].gpsTitle);
			gpsstr +='<li>';
			if(data[x].gpsContent){
				var gpsList = data[x].gpsContent.split('\n');
				for(var i=0;i<gpsList.length;i++){
					gpsstr+='<p>'+gpsList[i]+'</p>'
				}
			}
			gpsstr+='</li>';
			
			// connectivity
			$('.pro-list-v2 .specs-connectivity .item-title-v2 .title-txt').text(data[x].connectivityTitle);
			connectivitystr +='<li>';
			if(data[x].connectivityContent){
				var connectivityList = data[x].connectivityContent.split('\n');
				for(var i=0;i<connectivityList.length;i++){
					connectivitystr+='<p>'+connectivityList[i]+'</p>'
				}
			}
			connectivitystr+='</li>';
			
			// inthebox
			$('.pro-list-v2 .specs-inthebox .item-title-v2 .title-txt').text(data[x].intheboxTitle);
			intheboxstr +='<li>';
			if(data[x].intheboxContent){
				var intheboxList = data[x].intheboxContent.split('\n');
				for(var i=0;i<intheboxList.length;i++){
					intheboxstr+='<p>'+intheboxList[i]+'</p>'
				}
			}
			intheboxstr+='</li>';
			
			// btnandconn 
			$('.pro-list-v2 .specs-btnandconn .item-title-v2 .title-txt').text(data[x].btnAndConnTitle);
			btnandconnstr +='<li><img src="'+data[x].btnAndConnImage+'" alt="'+data[x].btnAndConnImgAlt+'" title="'+data[x].btnAndConnImgTitle+'" /></li>';
			
		}
		$('.pro-list-v2 .specs-features .item-content').empty().append(featurestr);
		$('.pro-list-v2 .specs-display .item-content').empty().append(displaystr);
		$('.pro-list-v2 .specs-dimensions .item-content').empty().append(dimstr);
		$('.pro-list-v2 .specs-rear-camera .item-content').empty().append(rearcamerastr);
		$('.pro-list-v2 .specs-front-camera .item-content').empty().append(frontcamerastr);
		
		$('.pro-list-v2 .specs-network .item-content').empty().append(networkstr);
		$('.pro-list-v2 .specs-gps .item-content').empty().append(gpsstr);
		$('.pro-list-v2 .specs-connectivity .item-content').empty().append(connectivitystr);
		$('.pro-list-v2 .specs-inthebox .item-content').empty().append(intheboxstr);
		$('.pro-list-v2 .specs-btnandconn .item-content').empty().append(btnandconnstr);
		
		var itemW =Math.round((100-data.length)/data.length * 100) / 100.00 +"%";
		$('.pro-list-v2 .alert-productdesc-v2 .table-box li').css('width',itemW);
		
	}
	
	//ga code start
	$(".pro-list-v2 .alert-productdesc-v2").on("click",".product-imgs .list li .btn-buynow",function(){
		  var productName=window.digitalData.page.category.subCategory2;
		  window.dataLayer.push({"event": "buyNow","productName": productName,"pageType":honorConfig.pageType})  
	})
	//ga code end
	
	var addToCompare,removeFromCompare,showCompare,selectToCompare;
	showCompare = $('.alert-compare-v2').attr('show');
	addToCompare = $('.alert-compare-v2').attr('add') || 'COMPARE';
	removeFromCompare = $('.alert-compare-v2').attr('remove') || 'REMOVE';
	selectToCompare = $('.alert-compare-v2').attr('select') || 'COMPARE';
	
	// 清空，初始化对比产品数据
	$('.pro-list-v2 .max-box .clear-list-v2,.pro-list-v2 .alert-compare-mb-v2 .cancel-compare').click(function() {
		// 获取当前比较的产品名 
		var comparedPro = compareDataV2.lists.map(function (value, index, array) {
			return value.name
		});
		// Clear All GA Code
		window.dataLayer.push({
			"event": "uaEvent",
			"eventCategory": "Products Comparison",
			"eventAction": "click",
			"eventLabel": "Clear all "+comparedPro.toLocaleString()
		})

		$('.pro-list-v2 .max-box .chosen-lists').empty();
		compareDataV2.num = 0;
		compareDataV2.lists = [];
		compareDataV2.full = false;
		compareDataV2.descLists=[];
		
		$('.pro-list-v2 .list .btn-compare').removeClass('on compared');
		$('.pro-list-v2 .list .btn-compare').children().children(".app-close-icon").addClass("app-plus-icon").removeClass("app-close-icon");
		$('.pro-list-v2 .list .btn-compare').children(".btn-add").children("span").text(addToCompare);
		$('.pro-list-v2 .alert-compare-v2 .max-box,.pro-list-v2 .alert-compare-mb-v2').slideUp('slow');
		
	});
	
	// 选择单个产品加入或移除对比列表
	$('.pro-list-v2').on('click','.list li .btn-compare',function(e){
		var that = $(this);
		var flag =that.hasClass("on");
		if(!flag){
			compareDataV2.num +=1;
		}else{
			compareDataV2.num -=1;
		}
		
		// 比较最大个数
		var maxNum = 0;
		// 比较个数超出时，提示文本
		var alertTxt = '';
		if(pageWidth>768){
			maxNum = 4;
			alertTxt = $('.pro-list-v2 .alert-compare-v2').attr('pcalerttxt');
		}else{
			maxNum = 2;
			alertTxt = $('.pro-list-v2 .alert-compare-v2').attr('mbalerttxt');
		}
		
		if(compareDataV2.num<=maxNum){
			var productName = that.parent().find('.pro-name').text() || '';
			that.toggleClass('on');
			
			if(!flag){
				//比较
				that.children().children(".app-plus-icon").addClass("app-close-icon").removeClass("app-plus-icon");
				that.children(".btn-add").children("span").text(removeFromCompare);
				
				// Compare1 GA Code
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Products Comparison",
					"eventAction": "click",
					"eventLabel": "Compare1 "+productName
				})
			}else{
				// 取消
				that.children().children(".app-close-icon").addClass("app-plus-icon").removeClass("app-close-icon");
				that.children(".btn-add").children("span").text(addToCompare);
				
				// Remove GA Code
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Products Comparison",
					"eventAction": "click",
					"eventLabel": "Remove "+productName
				})
			}
		}else{
			compareDataV2.full = true;
			compareDataV2.num -=1;
			
			// 比较个数超出提示
			alert(alertTxt);
		}
		
		var $btnCompare = $('.pro-list-v2 .alert-compare-mb-v2 .operate .chosen-compare');
		$btnCompare.text(compareDataV2.selectTxt);
		
		if(compareDataV2.num>1){
			$('.pro-list-v2 .max-box .chosen-compare').attr('disabled',false);
			$btnCompare.attr('disabled',false);
		}else{
			$('.pro-list-v2 .max-box .chosen-compare').attr('disabled',true);
			$btnCompare.attr('disabled',true);
		}
		
		// 获取产品数据
		var id = $(this).parent().attr('id');
		var name = $(this).parent().find('.pro-name').html();
		var nameText = $(this).parent().find('.pro-name').text();
		var imgsrc = $(this).parent().find('.pro-img img:first-child').attr('src');

		// 获取产品路径，调用接口渲染数据	
		var productUrl= $(this).attr('url');
		
		var goods = new Object();
		goods.id = id;
		goods.name = name;
		goods.nameText = nameText;
		goods.imgsrc = imgsrc;
		goods.productUrl = productUrl;
		
		if(pageWidth>768){
			$('.pro-list-v2 .alert-compare-v2,.pro-list-v2 .max-box').slideDown('slow');
			showCompareLists(goods);
		}else{
			$('.pro-list-v2 .alert-compare-mb-v2').slideDown('slow');
			showMBCompareLists(goods);
		}
	});
	
	// 单击比较按钮，显示【产品详情对比弹窗】
	$('.pro-list-v2 .max-box .chosen-compare,.pro-list-v2 .alert-compare-mb-v2 .chosen-compare').click(function(){
		$('.alert-productdesc').css('top','0');
		setTimeout(function(){
			$('html,body').css('overflow','hidden');
		},550);
		
		var contentH = utils.windowHeight()-70;
		$('.alert-productdesc .alert-content').css({
			'height':contentH,
			'overflow':'auto'
		});
		//渲染产品详情对比数据
		showCompareProductDesc(compareDataV2.descLists);
		
		// 获取当前比较的产品名 
		var comparedPro = compareDataV2.lists.map(function (value, index, array) {
			return value.name
		});
		// Clear All GA Code
		window.dataLayer.push({
			"event": "uaEvent",
			"eventCategory": "Products Comparison",
			"eventAction": "click",
			"eventLabel": "Compare2 "+comparedPro.toLocaleString()
		})
	})
	
	// 产品比较弹窗 内容滚动交互
	$('.pro-list-v2 .alert-productdesc-v2 .alert-content').scroll(function() {
        var scrollTop = $('.alert-productdesc-v2 .alert-content').scrollTop();
        if (scrollTop > 80) {
        	$('.pro-list-v2 .alert-productdesc-v2 .alert-header').addClass('auto');
        }else{ 
        	$('.pro-list-v2 .alert-productdesc-v2 .alert-header').removeClass('auto');
        }
	});
	
	// 隐藏【产品详情对比弹窗】
	$('.pro-list-v2 .alert-productdesc-v2 .btn-change').click(function(){
		$('html,body').css('overflow','auto');
		$('.alert-productdesc').css('top','100%');
		
		// 获取当前比较的产品名 
		var comparedPro = compareDataV2.lists.map(function (value, index, array) {
			return value.name
		});
		// Change Selection GA Code
		window.dataLayer.push({
			"event": "uaEvent",
			"eventCategory": "Products Comparison",
			"eventAction": "click",
			"eventLabel": "Change Selection "+comparedPro.toLocaleString()
		})
	})
	
	// 点击颜色切换图片
	$('.pro-list-v2 .alert-productdesc').on("click", ".pro-color div", function(event){
		var $this = $(this);
		var index = $this.index();
		$this.parent().prev("a").find(".pro-img").children("img:eq(" + index + ")").show().siblings("img").hide();
		$this.addClass("on").siblings("div").removeClass("on");
		event.stopPropagation();
	});
	
	// 移动端下，产品颜色滑动
	var touchStartX = 0, touchEndX = 0;
	$(".pro-list-v2 .alert-productdesc").on("touchstart", ".pro-img img", function(e){
		var touch = e.originalEvent.touches[0];
		touchStartX = touch.clientX;
	}).on("touchmove", function(e){
		var touch = e.originalEvent.touches[0];
		touchEndX = touch.clientX;
	});
	$(".pro-list-v2 .alert-productdesc").on("touchend",'.pro-img img',function(e){
        var i = $(this).index();
        var a = $(this).siblings().length;
         if((touchEndX + 30) < touchStartX && touchEndX != 0){
           if(i == a){
            $(this).parent().parent().next(".pro-color").children("div").eq(0).click();
           }else{
            $(this).hide().next("img").show();
            $(this).parent().parent().next(".pro-color").children("div").eq(i + 1).addClass("on").siblings("div").removeClass("on");
           }
          
         }else if((touchEndX - 30) > touchStartX && touchEndX != 0){
          if(i == 0){
            $(this).parent().parent().next(".pro-color").children("div").eq(a).click();
           }else{
            $(this).hide().prev("img").show();
            $(this).parent().parent().next(".pro-color").children("div").eq(i - 1).addClass("on").siblings("div").removeClass("on");
           }
         }
   });
	
	
})


$(function(){
	var $productListV2 = $('.product-list .pro-list-v2');
	if ($productListV2.length < 1) return;
	$("body").addClass("bg-black");
	
	// get data
	var $dataHolder = $(".product-list-data-holder");
	
	$(".breadcrumb").hide();
	var categoriesData = $dataHolder.data("categories");
	var moreCategoriesData = $dataHolder.data("more-categories");
	var productsData = $dataHolder.data("products");
	var tagPrefixProductsSpecsColors = $dataHolder.data("tag-prefix-products-specs-colors");
	var productsText = $dataHolder.data("products-text");
	var moreProductsText = $dataHolder.data("more-products-text");
	var clearAllText = $dataHolder.data("clear-all-text");
	var filterText = $dataHolder.data("filter-text");
	var loadMoreText = $dataHolder.data("load-more-text");
	var pageInfoText = $dataHolder.data("page-info-text");
	var noProductFoundText = $dataHolder.data("no-product-found-text");
	var windowWidth = $(window).width();
	if(windowWidth <= 768){
		var pageCount = 6;
		//移动端筛选模块固定悬浮顶部
		$(window).scroll(function() {
		    var scrollTop = $(document).scrollTop();
		    if (scrollTop > 0) {
		        // 固定头部
		    	$('.pro-list-v2 .filters-line').css('position','fixed');
		    } else {
		    	$('.pro-list-v2 .filters-line').css('position','unset');
		    }
		})
	}else{
		var pageCount = 12;
	}
	var pageOf = 1;
	var initFlag = true;
	
	var hash = location.hash;
    if (hash){
    	var hashInt = parseInt(hash.substring(1));
    	if (!isNaN(hashInt)) {
    		pageOf = hashInt;
    	}
    }
	
	var noProductFoundHtml = "<div class='nodate'>" + noProductFoundText + "</div>";
	
	var $body = $("body");
	var $proLeft = $(".pro-list-v2");
	var $filtersLine = $(".pro-list-v2 .filters-line");
	var $categoriesBox = $(".pro-list-v2 .filters-box");
	var $subCate = $(".pro-list-v2 .filters-box .filters-cate");
	var $itemList = $(".item-list");
	var $proRight = $(".product-lists");
	var $proFilter = $(".pro-filter");
	var addToCompare,removeFromCompare,showCompare,selectToCompare;
	showCompare = $('.alert-compare').attr('show');
	addToCompare = $('.alert-compare').attr('add') || 'COMPARE';
	removeFromCompare = $('.alert-compare').attr('remove') || 'REMOVE';
	selectToCompare = $('.alert-compare').attr('select') || 'COMPARE';
	
	var tags = undefined, products = undefined;
	
	$filtersLine.on("click", ".filter-tags a.item-tags", function(){
		var $this = $(this);
		$this.addClass("active").siblings().removeClass("active");
		clearActivedItem();
		changeSpecs();
		if (!initFlag) {
			pageOf = 1;
			history.replaceState(null, '', location.pathname + location.search);
		}
		queryAndDrawProducts(true);
		//ga code start
		var filterName=$.trim($(this).text());
		var filterCategory=$(this).text();
		window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
		//ga code end
		
		// Filter Tag Button GA Code
		window.dataLayer.push({
			"event": "uaEvent",
			"eventCategory": "Product List",
			"eventAction": "click",
			"eventLabel": filterName
		})
		
	});
	
	$proLeft.on("click", ".filters-cate li .cate-box a", function(i, item){
		var $this = $(this);
		if ($this.hasClass("selected")) {
			$this.removeClass("on selected");
			var title = $this.text();
			var tagID = $this.data("tag");
		} else {
			$this.addClass("on selected");
			var title = $this.text();
			var tagID = $this.data("tag");
			//ga code start
			var filterName=$.trim($this.text());
			var filterCategory=$(".pro-list-v2 .filters-line .filter-tags a.active").text();
			window.dataLayer.push({"event": "filter","filterCategory": filterCategory,"filterName": filterName});
			//ga code end
		}
		pageOf = 1;
		history.replaceState(null, '', location.pathname + location.search);
		queryAndDrawProducts(false);
	});
	

	$filtersLine.on("click", ".filter-clear", function(){
		$(".filters-cate li .cate-box a").removeClass("on").removeClass("selected");
		pageOf = 1;
		history.replaceState(null, '', location.pathname + location.search);
		queryAndDrawProducts(true);
	});
	
	$filtersLine.on("click", ".filter-apply", function(){
		$(".pro-list-v2 .filters-line .filter-btn").addClass("off");
		$("html,body").removeClass("overhidden");
		$(".pro-list-v2 .filters-line .filter-btn").children(".app-plus-icon").removeClass("clicked");
		$(".pro-list-v2 .filters-line .filter-clear,.pro-list-v2 .filters-line .filter-apply").stop().fadeOut();
		$(".pro-list-v2 .filters-box").stop().slideUp();
	});
	
	$proRight.on("click", ".page-box .btn-box a", function(){
		var index = $(this).index();
		if (pageOf == index + 1) return;
		pageOf = index + 1;
		location.hash = pageOf;
		$(this).addClass("on").siblings("a").removeClass("on");
		window.scrollTo(0,0);
		pageAndDrawCategoryProducts();
		window.scrollTo(0,0);
		
		// Product List Pagination GA Code
		var buttonName = $(this).text();
		window.dataLayer.push({
			"event": "uaEvent",
			"eventCategory": "Product List Pagination",
			"eventAction": "click",
			"eventLabel": buttonName
		})
	});
	
	$proRight.on("click", ".page-box .btn-prev", function(){
        var index = $(".page-box .btn-box a.on").index();
        if(index > 0) {
        	pageOf = index;
        	location.hash = pageOf;
        	window.scrollTo(0,0);
        	pageAndDrawCategoryProducts(index);
        }
        
        // Product List Pagination GA Code
		window.dataLayer.push({
			"event": "uaEvent",
			"eventCategory": "Product List Pagination",
			"eventAction": "click",
			"eventLabel": "previous"
		})
    });
	
	$proRight.on("click",".page-box .btn-next",function(){
        var index = $(".page-box .btn-box a.on").index();
        var totalSize = $(".page-box .btn-box a").length;
        if(index + 1 < totalSize) {
        	pageOf = index + 2;
        	location.hash = pageOf;
        	window.scrollTo(0,0);
        	pageAndDrawCategoryProducts();
        }
        
        // Product List Pagination GA Code
		window.dataLayer.push({
			"event": "uaEvent",
			"eventCategory": "Product List Pagination",
			"eventAction": "click",
			"eventLabel": "next"
		})
    });
	
	//ga code start
	$proRight.on("click", ".list li a", function(){
		var proName=$(this).parent("li").find(".pro-name").text();
		var proCategory=$(".pro-list-v2 .filters-line .filter-tags a.active").text();
		var proColor=$(this).parent("li").find(".pro-color .on span").attr("act");
		var num=pageOf;
		var proPosition;
		if(num>1){
			var a=(num-1)*6;
			proPosition=$(this).parent("li").index()+1+a;
		}else{
			proPosition=$(this).parent("li").index()+1;
		}
		window.dataLayer.push({
			"event": "eeListClick",
			"loginStatus": honorData.loginStatus,
			"productAvailability": "",
			'products': [{
				"listName": "product list",
				"name": proName,
				"id": proName,
				"price": "",
				"brand": "HONOR",
				"category": proCategory,
				"variant": proColor,
				"position": proPosition,
				"productAvailability":""
			}]
		})
	});
	//ga code end
	
	$proRight.on("click", ".pro-color div", function(event){
		var $this = $(this);
		var index = $this.index();
		var imgDom,imgSrc;
		imgDom=$this.parent().prev("a").find(".pro-img").children("img:eq(" + index + ")");
		imgSrc=imgDom.data("original");
		$this.parent().prev("a").find(".pro-img").addClass('honor-loading-v2');
		$this.parent().prev("a").find(".pro-img").children("img:eq(" + index + ")").attr("src",imgSrc).show().siblings("img").hide();
		
		$this.addClass("on").siblings("div").removeClass("on");
		event.stopPropagation();
		
		// 懒加载
		var imgLoad = imagesLoaded(imgDom);
        imgLoad.on('done', function(instance) {
        	// 加载完成 
        	imgDom.parent().removeClass('honor-loading-v2');
        });
	});
	

	
    $proRight.on("click", ".more-btn",function(){
        pageOf++;
        pageAndDrawCategoryProducts();
    });

    //"?"获取传参，显示产品分类
	var urlkey=utils.getRequest();
	//"."获取传参，显示产品分类
	var getProdeuctListUrl = window.location.href;
	var ProListCategories;
	if(urlkey.categories){
		ProListCategories=urlkey.categories.replace(/\//g, "");
	}else{
		ProListCategories = getProdeuctListUrl.split("products.")[1];
	}
	if (ProListCategories != "" && ProListCategories !== undefined) {
        if (ProListCategories.indexOf('.html') != -1) {
        	ProListCategories = ProListCategories.split(".html")[0];
        }else if (ProListCategories.indexOf('html') != -1) {
        	ProListCategories = ProListCategories.split("html")[0];
        } else if (ProListCategories.indexOf('/?') != -1) {
        	ProListCategories = ProListCategories.split("/?")[0];
        } else if (ProListCategories.indexOf('?') != -1) {
        	ProListCategories = ProListCategories.split("?")[0];
        }
        ProListCategories=ProListCategories.replace(/\//g, "");
    }
	
	//无传参，默认第一分类
	if(!ProListCategories){
		$(".filter-tags a.item-tags:first", $filtersLine).trigger("click");
	}else{
		var tagNum=$(".filter-tags a.item-tags").length;
		for(var i=0;i<tagNum;i++){
			var key=$(".filter-tags a.item-tags").eq(i).data("tag").split("/","-1");
			var keyNum=key.length-1;
			var tagkey=key[keyNum];
			if(ProListCategories == tagkey){
				$(".filter-tags a.item-tags:eq("+i+")", $filtersLine).trigger("click");
			}
		}
	}
	
    initFlag = false;
	
	function clearActivedItem (excludedDomObjs) {
		var $subLinks = $(".filters-cate li .cate-box a", $categoriesBox);
		$.each(excludedDomObjs || [], function(i, item){  
			$subLinks = $subLinks.not(item);
		});
		$subLinks.removeClass("on");
	}
	
	function changeSpecs () {
		// get category tagID and specifications
		var categoryTagID = undefined;
		var specifications = undefined;
		$(".filter-tags a", $filtersLine).each(function(i, item){
			if ($(this).hasClass("active")) categoryTagID = $(this).data("tag");
			if (categoryTagID) {
				$.each(categoriesData, function(i, item){
					if (item && item.tagID && categoryTagID.toLowerCase() == item.tagID.toLowerCase()) {
						specifications = item.specifications;
					}
				});
			}
		});

		$subCate.empty();
		$itemList.empty();
		
		if (specifications && specifications.length > 0) {
			
			$.each(specifications, function(i, spec){
				var availableValues = spec.availableValues;
				var specName = spec.title;
				if (specName && availableValues && availableValues.length > 0) {
					var li = "<li><div class='cate-title'>" + specName + "</div><div class='cate-box'></div></li>";
					$subCate.append(li);
					$.each(availableValues, function(j, value){
						var ckItem = "<a href='javascript:;' data-tag='" + value.tagID + "'><span class='ck-box'></span>" + value.title + "</a>";
						$(".filters-cate li:eq(" + i + ") .cate-box").append(ckItem);
					});
				}
			});
		}
		
	}
	
	if(windowWidth <= 768){
		//移动端下获取分类标题
		var categoriesText=$(".pro-list-v2 .filters-line .filter-tags a.active").children().text();
		$(".pro-list-v2 .filters-line .filter-btn .btn-text").text(categoriesText);
	}
	
	//筛选按钮展开和收起
	$('.pro-list-v2 .filters-line .filter-btn').click(function(){
		var opentxt=$(this).data("open");
		var closetxt=$(this).data("close");
		if(windowWidth <= 768){
			if($(this).hasClass("off")){
				$(this).removeClass("off");
				$(".header .go-back-top").hide();
				$("html,body").addClass("overhidden");
				$(this).children(".app-plus-icon").addClass("clicked");
				$(".pro-list-v2 .filters-line .filter-clear,.pro-list-v2 .filters-line .filter-apply").stop().fadeIn();
				$(".pro-list-v2 .filters-box").stop().slideDown();
			}else{
				$(this).addClass("off");
				$("html,body").removeClass("overhidden");
				$(this).children(".app-plus-icon").removeClass("clicked");
				$(".pro-list-v2 .filters-line .filter-clear,.pro-list-v2 .filters-line .filter-apply").stop().fadeOut();
				$(".pro-list-v2 .filters-box").stop().slideUp();
			}
		}else{
			if($(this).hasClass("off")){
				$(this).removeClass("off");
				$(this).children(".btn-text").text(closetxt);
				$(this).children(".app-plus-icon").addClass("app-close-icon").removeClass("app-plus-icon");
				$(".pro-list-v2 .filters-line .filter-clear").stop().fadeIn();
				$(".pro-list-v2 .filters-box").stop().slideDown();
			}else{
				$(this).addClass("off");
				$(this).children(".btn-text").text(opentxt);
				$(this).children(".app-close-icon").addClass("app-plus-icon").removeClass("app-close-icon");
				$(".pro-list-v2 .filters-line .filter-clear").stop().fadeOut();
				$(".pro-list-v2 .filters-box").stop().slideUp();
			}
		}
		
	});
	
	function query (mobile) {
		// get filters
		var categoryTagIDs = [];
		var colorTagIDs = [];
		var specificationTagIDGroupMap = {};
		var specificationTagIDGroups = [];
		
		$(".filter-tags a.item-tags.active", $filtersLine).each(function(i, item){
				var $this = $(this);
				var $activeLinks = $this;
				if ($activeLinks.length > 0) {
					$activeLinks.each(function(j, item1){ categoryTagIDs.push($(item1).data("tag")); });
				} else {
					categoryTagIDs.push($this.data("tag"));
				}
		});

			
		$(".filters-cate li .cate-box a.on", $proLeft).each(function(i, item){
				var tagID = $(this).data("tag");
				if (tagID) {
					if (tagID.substr(0, tagPrefixProductsSpecsColors.length) == tagPrefixProductsSpecsColors) {
						colorTagIDs.push(tagID);
					} else {
						var parentTagID = tagID.substring(0, tagID.lastIndexOf("/"));
						var specificationTagIDGroup = specificationTagIDGroupMap[parentTagID];
						if (specificationTagIDGroup) {
							specificationTagIDGroup.push(tagID);
						} else {
							specificationTagIDGroup = [tagID];
							specificationTagIDGroupMap[parentTagID] = specificationTagIDGroup;
							specificationTagIDGroups.push(specificationTagIDGroup);
						}
					}
				}	
		});
		

		// query begin
		if (categoryTagIDs.length > 0 || colorTagIDs.length > 0 || specificationTagIDGroups.length > 0) {
			products = [];
			$.each(productsData, function(i, productData){
				var marketingCategory = productData.marketingCategory;
				var colors = productData.colors;
				var filters = productData.filters;
				var isCategoryMatch = false;
				
				if (marketingCategory) {
					$.each(categoryTagIDs, function(j, categoryTagID){
						if (marketingCategory.substr(0, categoryTagID.length) == categoryTagID) {
							isCategoryMatch = true;
							return false;
						}
					});
				}
				
				var isColorMatch = false;
				if (colorTagIDs.length > 0) {
					if (colors && colors.length > 0) {
						$.each(colorTagIDs, function(j, colorTagID){
							if (!isColorMatch) {
								$.each(colors, function(n, color){
									if (color.color && color.color.substr(0, colorTagID.length) == colorTagID) {
										isColorMatch = true;
										return false;
									}
								});
							} else {
								return false;
							}
						});
					}
				} else {
					isColorMatch = true;
				}
				
				var isFilterMatch = false;
				if (specificationTagIDGroups.length > 0) {
					if (filters && filters.length > 0) {
						var matchCount = 0;
						$.each(specificationTagIDGroups, function(j, specificationTagIDGroup){
							var isGroupMatch = false;
                            $.each(specificationTagIDGroup, function(m, specificationTagID){
                                $.each(filters, function(n, filter){
                                    if (filter.substr(0, specificationTagID.length) == specificationTagID) {
                                        isGroupMatch = true;
                                        return false;
                                    }
                                });
                                if (m == specificationTagIDGroup.length - 1 && isGroupMatch) {
                                    matchCount ++;
                                }
                            });
                        });
						if (matchCount == specificationTagIDGroups.length) isFilterMatch = true;
					}
				} else {
					isFilterMatch = true;
				}
				
				if (isCategoryMatch && isColorMatch && isFilterMatch) products.push(productData);  
			});
		} else {
			products = productsData;
		}
	}
	
	function queryAndDrawProducts (needClearTag, mobile) {
		
		query(mobile);
		
		if (needClearTag) tags = [];
		
		// get title and product number
		var title = undefined;
		var number = products.length;
		var isMoreProducts = false;
		var $category = $('.filter-tags a.item-tags.active', $filtersLine);
		if ($category.length <= 0) { 
			title = productsText;
		} else {
			var tagID = $category.data("tag");
			$.each(categoriesData, function(i, categoryData){
					if (tagID && tagID == categoryData.tagID) {
						title = categoryData.title;
						return false;
					}
			});
			
		}
		
		drawCategoryProducts(title, number, mobile);
		
	}
	
	function drawCategoryProducts (title, number, mobile) {
		var headHtml = '<ul class="list"></ul>' + 
						'<div class="page-box"></div>' + 
						'<p class="text-center load-more">' +
							'<a href="javascript:;" class="more-btn">' + loadMoreText + '<span class="more-line"></span></a>' + 
						'</p>';
	
		$proRight.html("").append(headHtml);
		pageAndDrawCategoryProducts();
	}
	
	function pageAndDrawCategoryProducts () {
		var windowWidth = $(window).width();
		var startIndex = 0;
		var endIndex = products.length - 1;
		if (products.length > pageCount) {
			var pageNum = Math.ceil(products.length / pageCount);
			endIndex = pageCount * pageOf - 1;
			startIndex = endIndex - pageCount + 1;
			var pageR = '<div class="page-num"><div class="btn-prev"><span class="honorFont-arr-left"></span></div><div class="btn-box"></div><div class="btn-next"><span class="honorFont-arr-right"></span></div></div>';
            $(".product-lists .page-box").html(pageR);
            var pageN = "";
            for (var i = 1; i <= pageNum; i++) {
            	if (i == pageOf) {
            		pageN += '<a href="javascript:;" class="on"><span>' + i + '</span></a>';
                }else{
                	pageN += '<a href="javascript:;"><span>' + i + '</span></a>';
                }           	
            }
            $(".product-lists .page-box .page-num .btn-box").append(pageN);
		}
		
		if (endIndex >= products.length - 1) {
			$proRight.find(".more-btn").addClass("hidden");
		}

		var currentProducts = [];
		$.each(products, function(i, product){ 
			product.selected=false;
			if(compareDataV2.lists.length>0){
				for(var x=0;x<compareDataV2.lists.length;x++){
					if( compareDataV2.lists[x].id==product.productId){
						product.selected=true; 
					} 
				}
			}
			if (i >= startIndex){
				currentProducts.push(product);
			}
			if (i >= endIndex) return false;
		});
		
		var $productsContainer = $proRight.find(".list");
		if (windowWidth > 768) {
			$productsContainer.html("");
		}
		drawCurrentProducts($productsContainer, currentProducts);
	}
	
	function drawMoreProducts(title, number, mobile) {
		var headHtml = '<ul class="list"></ul>';
		$proRight.html("").append(headHtml);
	}

	function drawCurrentProducts ($productsContainer, currentProducts) {
		var windowWidth = $(window).width();
		if (windowWidth > 768) $productsContainer.css("visibility", "hidden");
		var currentNum = 0;
		if (windowWidth <= 768) currentNum = $productsContainer.find("li").length;
		if (currentProducts && currentProducts.length > 0) {
			$.each(currentProducts, function(i, product){
				i += currentNum;
				var productId = product['productId'];
				var marketingName = product['marketingName'];
				var detailPage = product['detailPage'] || 'javascript:;';
				var marketingCategory=product['marketingCategory'];
				// 选中状态
				var selected = product['selected'];
				// 产品分类
				var isPhone = (marketingCategory.indexOf('smartphones'))!=-1;
				// 判断当前是否支持比较（是否存在featuresTitle文案配置，已配置则支持）
				var canCompare = product.featuresTitle ? true : false;
				var listr = '';
				if(showCompare && isPhone){
					listr+='<li id="'+productId+'" class="show-compare">';
				}else{
					listr+='<li id="'+productId+'">';
				}
					listr+='<a href="' + detailPage + '">';
						listr+='<div class="pro-img honor-loading-v2"></div>';
					listr+='</a>';
					listr+='<div class="pro-color"></div>';
					listr+='<a href="' + detailPage + '">';
						listr+='<h2 class="pro-name">' + product["marketingName"] + '</h2>';
						listr+='<div class="pro-info"></div>';
					listr+='</a>';
					if(showCompare && isPhone && canCompare){
						if(selected){
							listr+='<div class="btn-compare on compared" url="'+detailPage+'">';
							listr+='<div class="btn-add"><span>'+addToCompare+'</span><div class="app-close-icon"><span></span><span></span><span></span></div></div>';
						}else{
							listr+='<div class="btn-compare" url="'+detailPage+'">';
							listr+='<div class="btn-add"><span>'+addToCompare+'</span><div class="app-plus-icon"><span></span><span></span><span></span></div></div>';
						}
						listr+='</div>';
					}
				listr+='</li>';
				var $li = $(listr);
				var $proInfo = $li.find(".pro-info");
				var mainSpecifications = product.mainSpecifications;
				if (mainSpecifications && mainSpecifications.length > 0) {
					$.each(mainSpecifications, function(j, specification){
						if (specification) $proInfo.append("<p>" + specification + "</p>");
					});
				}
				$productsContainer.append($li);
				 
				var $imageContainer = $productsContainer.find("li:eq(" + i + ") .pro-img");
				var colors = product.colors;
				if (colors && colors.length > 0) { 
					var activedColorIndex = getActivedColorIndex(colors);
					var $colorContainer = $productsContainer.find("li:eq(" + i + ") .pro-color");
					$.each(colors, function(j, color){
						var colorValue = color.color ? "#" + color.color.substring(color.color.lastIndexOf("/") + 1) : "white";
                        var colorName="white";
                        if(color.color){
                            var tempArr=color.color.split("/");
                            if(tempArr.length>4){
                                colorName=tempArr[3];                       
                            }              
                        }
                        var imgTitle = '',imgAlt=''; 
                        if(color.imgTitle && color.imgTitle!="null"){
                        	imgTitle =color.imgTitle;
                        }
                        if(color.imgAlt && color.imgAlt!="null"){
                        	imgAlt =color.imgAlt;
                        }   
						if (j == activedColorIndex) { 
							$imageContainer.append("<img class='lazy' data-original='" + color.imagePath  + "' title='"+imgTitle +"' alt='"+imgAlt+"'>");
							$colorContainer.append("<div class='on'><span style='background:" + colorValue +"' lab='"+marketingName+"' act='"+colorName+"' cat='Color Selection'></span></div>");
						} else {
							$imageContainer.append("<img class='lazy' data-original='" + color.imagePath  + "' title='"+imgTitle +"' alt='"+imgAlt+" ' style='display:none;'>");
							$colorContainer.append("<div><span style='background:" + colorValue +"' lab='"+marketingName+"' act='"+colorName+"' cat='Color Selection'></span></div>");
						}

					});
					
					$(".pro-list-v2 .product-lists .list li .pro-img img.lazy").lazyload({
						"placeholder":lazyload.placeholder
					});
					
					// 移动端下，产品颜色滑动
					var touchStartX = 0, touchEndX = 0;
					$(".product-lists").on("touchstart", ".pro-img img", function(e){
						var touch = e.originalEvent.touches[0];
						touchStartX = touch.clientX;
					}).on("touchmove", function(e){
						var touch = e.originalEvent.touches[0];
						touchEndX = touch.clientX;
					});
					
					$(".product-lists").on("touchend",'.pro-img img',function(e){
	                    var i = $(this).index();
	                    var a = $(this).siblings().length;
	                     if((touchEndX + 30) < touchStartX && touchEndX != 0){
	                       if(i == a){
	                        $(this).parent().parent().next(".pro-color").children("div").eq(0).click();
	                       }else{
	                        $(this).hide().next("img").lazyload({
	    						"placeholder":lazyload.placeholder
	    					}).show();
	                        $(this).parent().addClass("honor-loading-v2");
	                        $(this).parent().parent().next(".pro-color").children("div").eq(i + 1).addClass("on").siblings("div").removeClass("on");
	                        // 懒加载
	                		var imgLoad = imagesLoaded($(this).next("img"));
	                        imgLoad.on('done', function(instance) {
	                        	 //加载完成 
	                        	 $(this).parent().removeClass('honor-loading-v2');
	                        });
	                       }
	                      
	                     }else if((touchEndX - 30) > touchStartX && touchEndX != 0){
	                      if(i == 0){
	                        $(this).parent().parent().next(".pro-color").children("div").eq(a).click();
	                       }else{
	                        $(this).hide().prev("img").lazyload({
	    						"placeholder":lazyload.placeholder
	    					}).show();
	                        $(this).parent().addClass("honor-loading-v2");
	                        $(this).parent().parent().next(".pro-color").children("div").eq(i - 1).addClass("on").siblings("div").removeClass("on");
	                        // 懒加载
	                		var imgLoad = imagesLoaded($(this).prev("img"));
	                        imgLoad.on('done', function(instance) {
	                        	// 加载完成 
	                        	 $(this).parent().removeClass('honor-loading-v2');
	                        });
	                       }
	                     }
	                     
	               });
					
				} else {
					var defaultImage = product.defaultImage;
					var imgTitle = '',imgAlt=''; 
					if(product.defaultImgTitle && product.defaultImgTitle!="null"){
						imgTitle =product.defaultImgTitle;
					}
					if(product.defaultImgAlt&& product.defaultImgAlt!="null"){
						imgAlt =product.defaultImgAlt;
					}   
					if (defaultImage) {
						$imageContainer.append("<img class='lazy' src='" + defaultImage + "' title='"+ imgTitle +"' alt='"+imgAlt+"' >");
					} else {
						$imageContainer.append("<img class='lazy' src='" + defaultImage + "' title='"+ imgTitle +"' alt='"+imgAlt+"' >");
					}
				}
			});
			//GA code start		
			var proView=[];
			$.each(currentProducts, function(i, product){
				var num=pageOf;
				var proPosition,proCategory,proColor;
				if(product.marketingCategory){
					proCategory=product.marketingCategory;
				}else{
					proCategory="";
				}
				if(product.colors){
					proColor=product.colors[0].color;
				}else{
					proColor="";
				}
				if(num>1 && windowWidth > 768){//PC分页数
					var a=(num-1)*12;
					proPosition=i+1+a;
				}else if(num>1 && windowWidth <= 768){//MB分页数
					var b=(num-1)*6;
					proPosition=i+1+b;
				}else{
					proPosition=i+1;
				}
				
				var proItem={
						"listName": "product list",
						"name": product.productName,
						"id": product.productName,
						"price": "",
						"brand": "HONOR",
						"category": proCategory,
						"variant": proColor,
						"position": proPosition,
						"productAvailability":""
					};
				
				proView.push(proItem);
			})
			
			
			if(proView.length>6){
				var result = [];
				for(var i=0;i<proView.length;i+=6){
				    result.push(proView.slice(i,i+6));
				}
				$.each(result, function(i, proItem){
					window.dataLayer.push({
						"event": "eeListView",
						"loginStatus": honorData.loginStatus,
						"productAvailability": "",
						'products': proItem
					})
				})
			}else{
				window.dataLayer.push({
					"event": "eeListView",
					"loginStatus": honorData.loginStatus,
					"productAvailability": "",
					'products': proView
				})
			}
			
			
			//GA code end
		} else {
			$productsContainer.append(noProductFoundHtml);
		}
		if (windowWidth > 768) setTimeout(function(){ $productsContainer.css("visibility", "visible"); }, 150);
	
		// 懒加载
	    $(".pro-list-v2 .product-lists .list").find('li').each(function(i){
	        var $curr = $(".pro-list-v2 .product-lists .list li:eq("+i+") .pro-img img.lazy").eq(0);
	        var imgLoad = imagesLoaded($curr);
	        imgLoad.on('done', function(instance) {
	         // 加载完成 
	         $curr.parent().removeClass('honor-loading-v2');
	        })
	    });
	    
	}
	

	function getActivedColorIndex (colors) {
		var $checkedColor = $(".filters-cate .filters-box a.on[data-tag^='" + tagPrefixProductsSpecsColors + "']", $proLeft);
		var result = 0;
		if ($checkedColor.length > 0) {
			var checkedTagID = $checkedColor.data("tag");
			$.each(colors, function(i, color){
				var tagID = color.color;
				if (tagID && tagID.substr(0, checkedTagID.length) == checkedTagID) {
					result = i;
					return false;
				}
			});
		}
		return result;
	}
	
	function getPageInfoText(pageOf, pageNum, totalCount){
		return pageInfoText.replace("$1", "<b>" + pageOf + "</b>").replace("$2", "<b>" + pageNum + "</b>").replace("$3", "<b>" + totalCount + "</b>");
	}
	
	function showProFilter() {
		$proFilter.show();
		$('html').css("overflow-y","hidden");
		$('body').css({"position":"fixed","top":"0px","left":"0px"})
	}
	
	function hideProFilter() {
		$proFilter.hide();
		$('html').css("overflow-y","auto");
		$('body').css({"position":"","top":"","left":""})
	}
});
/*!
 * Brand Product List Component By Bruce
 *  brand-product-list – v1.0.0 (2020-03-16 15:00:30)
 *  Copyright 2020-2021 hihonor.com
 */
(function(){
	$(function(){
		var brandProductList = {
			$selector: $('.brand-product-list'),
			categoriesDatas:$(".brand-product-list .product-list-data-holder").data("categories") || [],
			allProductDatas:$(".brand-product-list .product-list-data-holder").data("products") || [],
			allDatas:[],
			num:1,
			init: function () {
				if (this.$selector.length) {
					this.renderingCategory(this.categoriesDatas,this.allProductDatas);
					if(utils.windowWidth()<=768){
						this.getMbCurrPageData();
						
						// 点击load more加载更多
						var that = this;
						$('.load-more').click(function(e){
							utils.stopBubble(e);
							utils.stopDefault(e);
							var allDatasIndex = $(this).attr('data-index');
							if(allDatasIndex){
								++that.allDatas[allDatasIndex].pageNum;
								that.getMbCurrPageData(allDatasIndex);
							}
						})
					}
					
				}
			},
			renderingCategory:function(category,products){
				// 渲染产品分类
				var that = this;
				category.forEach(function(item,index,arr){
					var lastIndex = item.tagID.lastIndexOf('/')+1;
					var itemName = item.tagID.slice(lastIndex,item.tagID.length);
					var str = '';
					str +='<div class="product-section" id="'+itemName+'">';
						str +='<h3 class="section-title">'+item.title+'</h3>';
						str +='<ul class="data-list">';
						str +='</ul>';
						str +='<div class="text-center load-more">';
							str +='<a href="javascript:;" class="more-btn">';
								var loadMore = $('.brand-product-list .brand-product-content').data('loadmore') || '';
								str +='<span>'+loadMore+'</span>';
								str +='<span class="more-line"></span>';
							str +='</a>';
						str +='</div>';
					str +='</div>';
					$('.brand-product-content').append(str);
					
					that.renderingDataLists(itemName,item.tagID,products);
				})
			},
			renderingDataLists:function(category,categoryID,products){
				// 渲染产品列表
				var endProducts = [];
				endProducts = products.filter(function(item){
					if(item.marketingCategory.indexOf(categoryID) != -1){
						return item;
					}
				})
				
				if(utils.windowWidth()>768){
					var listHtml = this.getListHtml(endProducts);
					$('#'+category +' .data-list').empty().html(listHtml);
					this.lazyload();
				}else{
					// 聚合数据
					var obj = {};
					obj.title = category; 	//分类
					obj.data=endProducts; 
					obj.total = endProducts.length; // 数据总数
					obj.pageNum=1;			// 当前页码
					obj.pageSize=6;			// 每页个数
					obj.isLoadMore=true;	// 是否记载更多
					obj.currPageDatas=[];	// 当前页面数据
					this.allDatas.push(obj);
				}
			},
			// 移动端获取当前页数据
			getMbCurrPageData:function(allDatasIndex){
				var that = this;
				if(!allDatasIndex){
					// 初始化 全数据
					that.allDatas.forEach(function(product,index){
						that.getCategoryCurrPageData(product,index);
					})
				}else{
					// 对应分类数据
					that.getCategoryCurrPageData(that.allDatas[allDatasIndex],allDatasIndex);
				}
			},
			// 获取对应分类对应页面数据
			getCategoryCurrPageData: function(product,allDatasIndex){
				var startIndex = (product.pageNum-1) * product.pageSize;
				var endIndex = product.pageNum * product.pageSize;
				endIndex = endIndex > product.total ? product.total : endIndex; 
				
				var currPageDatas = product.data.slice(startIndex,endIndex);
				product.currPageDatas = currPageDatas;
				
				if(currPageDatas.length< product.pageSize){
					product.isLoadMore=false;
				}
				// 渲染对应分类列表
				this.renderingMbDataLists(product,allDatasIndex);
			},
			// 移动端渲染产品列表
			renderingMbDataLists:function(product,allDatasIndex){
				var that = this;
				var listHtml = that.getListHtml(product.currPageDatas);
				$('#'+product.title +' .data-list').append(listHtml);
				that.lazyload();
				
				// 是否显示Load More
				if(product.isLoadMore){
					$('#'+product.title +' .load-more').attr('data-index',allDatasIndex);
				}else if(!product.isLoadMore || that.allDatas[allDatasIndex].total<6){
					$('#'+product.title +' .load-more').hide();
				}
				
			},
			getListHtml:function(products){
				// 获取列表对应HTML
				var str='';
				products.forEach(function(item){
					str+='<li>';
						var path = '';
						if(item.albumPath){
							path = item.albumPath
						}else if(item.detailPage){
							path = item.detailPage;
						}
						str+='<a href="'+path+'">';
							str+='<div class="img-box">';
								var imgSrc = item.defaultImage || '';
								if(item.colors && item.colors.length>0){
									imgSrc = item.colors[0].imagePath;
								}
								str+='<img class="lazy" data-original="'+imgSrc+'" alt="" />';
							str+='</div>';
							var productName = item.marketingName ? item.marketingName : item.productName;
							str+='<p class="item-name">'+productName+'</p>';
						str+='</a>';
					str+='</li>';
				})
				return str;
			},
			lazyload:function(){
				// 图片懒加载
				$(".brand-product-list img.lazy").show().lazyload({
					"placeholder":lazyload.placeholder,
					effect: 'fadeIn'
				}); 
			}
		}

		brandProductList.init();
		//GA Code
		$(".brand-product-content").on("click",".product-section .data-list li a",function(){
			var productCategory=$(this).parents(".product-section").attr("id");
			var productName=$(this).find(".item-name").text();
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Brand Resources Page",
				"eventAction": "Product",
				"eventLabel": productCategory+productName
			})
		})
		
		$('.download-link').click(function(){
			var title=$(this).data("title");
			var downloadResource;
			if(title=="HONOR_Logo"){
				downloadResource="LOGO"
			}else if(title=="AvenirNextW1G"){
				downloadResource="FONT"
			}else if(title=="HONOR Brand White Paper"){
				downloadResource="WHITE PAPER"
			}else{
				downloadResource="OTHER"
			}
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Brand Resources Page",
				"eventAction": "resources download",
				"eventLabel": downloadResource
			})
		})
		
	})
}());
﻿$(function(){
	if($(".product-subnav").length>0){ 
		// 二级导航版本区分
		var subnavVersion = 'v1';
		if($(".product-subnav .subnav-box").hasClass('subnav-box-cn')){
			subnavVersion = 'v2';
		}
		
		var pageWidth = $("body").width();
		var toTopHeight = $('.subnav-box').offset() ? $('.subnav-box').offset().top: 100;
		if(pageWidth<=992){
			toTopHeight=0;
		}
		var topH = $('.header').height();
		
		if($('body').hasClass('honor-v2')){
			// V2
			if($('body').hasClass('honor-cn')) {
				if(pageWidth > 992) {
					topH= 69;
				} else {
					var thisHeight = $(".header-cn").height();
					topH= thisHeight;
				}
			} else {
				topH= 69;
			}
		}else{
			// V1 PC End
			if(pageWidth>992){
				topH = 0;
			}
		}
		
		$(window).scroll(function() {
	        var scrollTop = $(document).scrollTop();
	        if (scrollTop > toTopHeight) {
	        	$('.subnav-box').css({
	        		'position':'fixed',
	        		'top':topH
	        	});
	        }else{ 
	    		$('.subnav-box').css({
	    			'position':'relative',
	    			'top':0
	    		}); 
	        }
		});
		
		if(subnavVersion == 'v1'){
			// 判断是否有相关产品
			var hasRelated = $('.product-subnav .relatedprod-li').length!=0;
			if(hasRelated){
				$('.product-subnav .subnav-box').addClass('has-related');
			}
		}
		
		if(subnavVersion == 'v2'){
			// 判断是否有更多平台 和 立即购买按钮
			var hasMorePlatform = $('.product-subnav .more-platform').length!=0;
			var hasBuyNow = $('.product-subnav .btn-buy').length!=0;
			if(!hasMorePlatform && hasBuyNow){
				// 只有 立即购买
				$('.product-subnav .btn-buy').show();
			}
			
			if(hasMorePlatform && !hasBuyNow){
				// 只有更多平台
				var $title = $('.product-subnav .more-platform .title');
				var txt = $title.data('more');
				$title.text(txt);
			}
			
			if(hasMorePlatform && hasBuyNow){
				// 有立即购买和更多平台
				var $title = $('.product-subnav .more-platform .title');
				var txt = $title.data('more');
				if(utils.windowWidth()<=992){
					// 移动端
					txt = $title.data('buynow')
				}
				$title.text(txt);
			}
			
		}
		
		if(pageWidth<=992 && $(".subnav-box-cn").length == 0){
			// 移动端判断是否有二级导航
			var hasChild = $(".subnav-list>li").length!=0;
			if(hasChild){
				$(".product-subnav .font-Arrow-down").css('display','inline-block');
			}
			// 移动端 二级导航切换
			var flag = true;
			$('.product-subnav .subnav-box').click(function(){
				if(flag){
					$('html,body').addClass('honor-noscroll');
					$('.header .goBackTop,.product-subnav .btn-buy').hide();
					$('.overbox').stop().show();
					$('.product-subnav .app-subnav-list').stop().slideDown();
					$(this).find('.app-subnav').addClass('active');
				}else{
					$('html,body').removeClass('honor-noscroll');
					$('.overbox').stop().hide();
					$('.product-subnav .btn-buy').show();
					$('.product-subnav .app-subnav-list').stop().slideUp();
					$(this).find('.app-subnav').removeClass('active');
				}
				flag = !flag;
			})
		}
		// 判断Buy Now按钮是否遮挡Footer
		var windowW = utils.windowWidth();
		if(windowW<=992){
			var btnBuyNowH = $('.product-subnav .btn-buy').height();
			var windowH = utils.windowHeight();
			$(window).scroll(function() {
				 var footerTop = $('.footer').offset().top;
				 var scrollTop = $(document).scrollTop();
				 var flag = (scrollTop+windowH)>=footerTop;
				 var isCNSite = $(".subnav-box-cn").length > 0;
				 if(flag || isCNSite){
					 $('.product-subnav .btn-buy').hide();
				 }else{
					 $('.product-subnav .btn-buy').show();
				 }
			})
		}
		
		//二级导航点击事件 GA统计
		$("body").on("click",".subnav-box .related-products .navli a,.subnav-box .subnav-list .navli a,.subnav-box .app-subnav-list .navli a",function(){
	    	var navigationName = $(this).text();
	    	window.dataLayer.push({
	    		"event": "uaEvent",
	    		"eventCategory": "Smartphone Navigation",
	    		"eventAction": "click",
	    		"eventLabel": navigationName
	    	})
	    	
	    	var pro = $(".subnav-box .product-name").text();
	    	var cat = "product+"+honorConfig.countryCode+"+"+honorConfig.lang;
	    	var url = $(this).attr("href");
	    	var urlStr = url.split("/","-1");
	    	var urlStrLength = urlStr.length-1;
	    	if(urlStr[urlStrLength]==""){
	    		urlStrLength = urlStr.length-2;
	    	}
	    	var lab = urlStr[urlStrLength];
	    	
	    	if (lab != "" && lab !== undefined) {
	            if (lab.indexOf('.html') != -1) {
	            	lab = lab.split(".html")[0];
	            }else if (urlStr.indexOf('html') != -1) {
	            	lab = lab.split("html")[0];
	            } else if (lab.indexOf('/?') != -1) {
	            	lab = lab.split("/?")[0];
	            } else if (lab.indexOf('?') != -1) {
	            	lab = lab.split("?")[0];
	            }
	            lab = lab.replace(/\//g, "");
	            if(lab.indexOf('honor') != -1){
	            	lab = "overview";
	            }
	        }
	    	if(url.indexOf("javascript:void(0);") == -1){
	    		if(url.indexOf("support") != -1){
		    		lab = pro+"+support";
		    	}else if(url.indexOf("album") != -1){
		    		lab = pro+"+album";
		    	}else if(url.indexOf("gallery") != -1){
		    		lab = pro+"+gallery";
		    	}else{
		    		lab = pro+"+"+lab;
		    	}
		    	
		    	ga('newhuaiweisupport.send', 'event', cat, 'Click on get to know your product', lab);
	    	}
	    	
	    })
	    
	    $(".product-subnav .subnav-box-cn .btn-buy").click(function(){
	    	var pro = $(".subnav-box .product-name").text();
	    	var cat = "product+"+honorConfig.countryCode+"+"+honorConfig.lang;
	    	var lab = pro+"+ buy now";
	    	ga('newhuaiweisupport.send', 'event', cat, 'Click on get to know your product', lab);
	    })
	    
	    $(".subnav-content li a").click(function(){
	    	var pro = $(".subnav-box .product-name").text();
	    	var cat = "product+"+honorConfig.countryCode+"+"+honorConfig.lang;
	    	var lab = pro+"+"+$(this).children("span.platformTitle").text();
	    	ga('newhuaiweisupport.send', 'event', cat, 'Click on get to know your product', lab);
	    })
	    
	    
	    function getObj(str) {
			  var theRequest = new Object();
			  var strs = str.split("&");
			  for (var i = 0; i < strs.length; i++) {
				theRequest[strs[i].split("=")[0]] = decodeURI(strs[i].split("=")[1]);
			  }
			return theRequest;
		}
	    
		// 获取二级导航信息
		$('.product-subnav .navli a').each(function(){
			var link = $(this).attr('href');
			if(link){
				var endLink = getUrl(link);
				if(endLink.active=='active'){
					$(this).parent().addClass('active');
				}
				$(this).attr('href',endLink.endUrl);
			}
		})
		// 获取合适的配置链接
		function getUrl(url){
			url = url.substring(0,url.lastIndexOf('/'));
			var path={
				'endUrl':'javascript:void(0);',
				'active':''
			}
			var currPage = location.href;
			var pathname = location.pathname;
			if(currPage.indexOf('/content/honor') !=-1){
				//编辑预览环境
				if(utils.isProduction()) {
					if($("body").hasClass("honor-cn")) {
						path.showUrl='/content/honor/cn'+url+'.html';
					} else {
						path.showUrl='/content/honor'+url+'.html';
					}
				} else {
					path.showUrl='/content/honor'+url+'.html';
				}
				
				path.endUrl='/content/honor'+url+'.html?wcmmode=disabled';
			}else{
				//发布环境
				url+='/';
				if(url.indexOf('/content/honor') !=-1){
					path.showUrl = path.endUrl = url.split('/content/honor')[1];
				}else{
					path.showUrl = path.endUrl = url;
				}
			}
			
			if(pathname == path.showUrl){
				//没有后缀，则是本页面，此链接为当前页面链接，不跳转
				path.active='active';
				path.endUrl='javascript:void(0);';
			}
			return path;
		}
		
		if($(".subnav-box-cn").length > 0) {
			// 更多平台 菜单导航展示
			$(".subnav-details").on("click", function() {
				$(this).toggleClass('active');
				$(this).find(".subnav-content").stop().slideToggle(500);
				$(this).find(".arrowLeft").toggleClass("arrowLeftUp");
				$(this).find(".arrowRight").toggleClass("arrowRightUp");
			});
			
			$(".subnav-details").on("click", "li", function(event) {
				event.stopPropagation();
			});
			
	    	//导航效果
			var activeSub = $(".subnav-box-cn").find("li.active a").eq(0).text();
    		$(".subnav-box-cn").find(".subnavText").text(activeSub);
	    	var pageWidth = utils.windowWidth();
	    	if(pageWidth<=992){
    			$(".subnav-box-cn").find(".navli.active").hide();
	    		$(".product-subnav").on("click", ".cnsubnav", function() {
	    			$(this).toggleClass("active");
	    			$(this).find(".subnavIcon").toggleClass("subnavIUp");
	    			$(this).siblings(".subnav-list").fadeToggle();
	    		});
			}
	    	
	    	// 移动端 “更多平台”文案替换为“立即购买”
	    	if(utils.windowWidth()<=992){
	    		var $title = $(".subnav-box-cn .subnav-details .title");
	    		var buyNowTxt = $title.data('buynow') || '';
	    		$title.text(buyNowTxt);
	    		
	    		$(".more-platform").on("click", function() {
	    			if($(".platform-mb").length > 0) {
	    				$(this).find(".platform-mb .platformImg").attr("src", $(this).find(".platformImg").data("origin"));
	    			}
	    		});
	    	}
	    	
	    	//懒加载调用
    		$(".subnav-box-cn img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
    		
    		if($(".subnav-box-cn").find(".subnav-list .navli").length == 0) {
    			$(".subnav-box-cn").find(".cnsubnav").hide();
    		}
		}
	}
}); 
 
(function(){
$(function(){
	if($(".product-specs").length>0){ 
		var version = $('#specsVersion').val();
		// 版本一
		if(!version || version=='v1'){
		// 二级导航 默认选中 切换specs
		$('.subnav-box .subnav-list li[name="spec"]').addClass('active').siblings().removeClass('active');
		
		var specData={
			productName:'',
			colors:[],
		};
		
		var currUrl = location.href;
		var ajaxUrl='';
		if(currUrl.indexOf('.html') !=-1){
			ajaxUrl=currUrl.split('.html')[0]+'/jcr:content.specs.json';
		}else if(currUrl.indexOf('?') != -1){
			ajaxUrl=currUrl.split('?')[0]+'jcr:content.specs.json';
		}else{
			ajaxUrl=currUrl+'jcr:content.specs.json';
		} 
		
		// Get product specification info	
		$.ajax({
		    url: ajaxUrl, 
		    dataType: 'json', 
		    type: 'GET',
		    success: function(info) {
		    	var data = info.detailMode;
		    	if(!$.isEmptyObject(data)){
		    		specData.productName = data.marketingName;
		    		//$('.product-subnav .product-name').text(specData.productName);
		    		
		    		// colors 
		    		$('.specs-colors .item-title').text(data.colorsTitle);
		    		specData.colors = JSON.parse(data.colors);
		    		var colorstr = '',imgstr = '';
		    		var colorLists = specData.colors;
		    		for(var i=0;i<colorLists.length;i++){
		    			var  colorValue = colorLists[i].color ? '#'+colorLists[i].color.substring(colorLists[i].color.lastIndexOf('/')+1) : 'white'
		    			if(i==0){
		    				colorstr+='<li num="'+(i+1)+'" class="on">';
		    				imgstr +='<img class="on" src="'+colorLists[i].specsImagePath+'" alt="'+colorLists[i].specsImgAlt +'" title="'+colorLists[i].specsImgTitle +'" />';
		    			}else{
		    				colorstr+='<li num="'+(i+1)+'">';
		    				imgstr +='<img src="'+colorLists[i].specsImagePath+'" alt="'+colorLists[i].specsImgAlt +'" title="'+colorLists[i].specsImgTitle +'" />';
		    			}
			    			colorstr+='<p>';
			    				colorstr+='<span style="background:'+colorValue+'"></span>';
							colorstr+='</p>';
							colorstr+='<p>'+colorLists[i].colorName+'</p>';
						colorstr+='</li>';
						
		    		}
		    		var $colorLists = $('.product-specs .color-lists');
		    		var $colorImgs = $('.product-specs .color-imgs');
		    		$colorLists.empty().append(colorstr);
		    		$colorImgs.empty().append(imgstr);
		    		
		    		if(data.hideColors=='true'){
						$('.product-specs .specs-colors').hide();
					} 
		    		
		    		// features
		    		$('.specs-features .item-title').text(data.featuresTitle);
		    		var featureList = data.featuresContent.split('\n');
		    		var featurestr ='';
		    		for(var i=0;i<featureList.length;i++){
		    			featurestr+='<p>'+featureList[i]+'</p>'
		    		}
		    		featurestr+='<div class="item-note">'+data.featuresNote+'</div>';
		    		$('.specs-features .item-content').empty().append(featurestr);
		    		
		    		if(data.hideFeatures=='true'){
						$('.product-specs .specs-features').hide();
					}
		    		
		    		// display
		    		$('.specs-display .item-title').text(data.displayTitle);
		    		var displayList = data.displayContent.split('\n');
		    		var displaystr ='';
		    		displaystr+='<img class="display-img" src="'+data.displayImage+'" alt="'+data.displayImgAlt+'" title="'+data.displayImgTitle+'" />';
		    		displaystr+='<div class="content-txt">';
		    		for(var i=0;i<displayList.length;i++){
		    			displaystr+='<p>'+displayList[i]+'</p>';
		    		}
		    		displaystr+='</div>';
		    		$('.specs-display .item-content').empty().append(displaystr);
		    		
		    		if(data.hideDisplay=='true'){
						$('.product-specs .specs-display').hide();
					}
		    		
		    		// dimensions
		    		$('.specs-dimensions .item-title').text(data.dimensionsTitle);
		    		var dimstr = '';
		    		dimstr+='<div class="content-txt">';
		    		var sizeList = data.sizeContent.split('\n');
		    		for(var i=0;i<sizeList.length;i++){
		    			dimstr+='<p>'+sizeList[i]+'</p>'
		    		}
					dimstr+='</div>';
					dimstr+='<img class="size-img" src="'+data.sizeImg+'" alt="'+data.sizeImgAlt+'"  title="'+data.sizeImgTitle+'"/>';
					$('.specs-dimensions .item-content').empty().append(dimstr);
					
					if(data.hideDimensions=='true'){
						$('.product-specs .specs-dimensions').hide();
					}
					
					// camera 
					$('.specs-camera .item-title').text(data.cameraTitle);
					var cameratr = '';
					if(data.rearCameraTitle){
						cameratr+='<div class="item-subtitle">'+data.rearCameraTitle+': </div>';
					}
					cameratr+='<div class="item-subcontent">';
						var rearList = data.rearCameraContent.split('\n');
						for(var i=0;i<rearList.length;i++){
							cameratr+='<p>'+rearList[i]+'</p>';
			    		}
					cameratr+='</div>';
					if(data.frontCameraTitle){
						cameratr+='<div class="item-subtitle">'+data.frontCameraTitle+':</div>';
					}
						cameratr+='<div class="item-subcontent">';
							var frontList = data.frontCameraContent.split('\n');
							for(var i=0;i<frontList.length;i++){
								cameratr+='<p>'+frontList[i]+'</p>';
				    		}
						cameratr+='</div>';
					cameratr+='</div>';
					$('.specs-camera .item-content').empty().append(cameratr);
					
					if(data.hideCamera=='true'){
						$('.product-specs .specs-camera').hide();
					}
					
					// wireless
					$('.specs-wireless .item-title').text(data.wirelessTitle);
					var wireless = '<ul>';
						if(!data.networkTitle && !data.networkContent){
							wireless+='<li class="hidden">';
						}else{
							wireless+='<li>';
						}
							wireless+='<div class="item-subtitle">'+data.networkTitle+'</div>';
							wireless+='<div class="item-subcontent">';
								var networkList = data.networkContent.split('\n');
								for(var i=0;i<networkList.length;i++){
									wireless+='<p>'+networkList[i]+'</p>';
					    		}
							wireless+='</div>';
						wireless+='</li>';
						
						
						if(!data.gpsTitle && !data.gpsContent){
							wireless+='<li class="hidden">';
						}else{
							wireless+='<li>';
						}
							wireless+='<div class="item-subtitle">'+data.gpsTitle+'</div>';
							wireless+='<div class="item-subcontent">';
								var gpsList = data.gpsContent.split('\n');
								for(var i=0;i<gpsList.length;i++){
									wireless+='<p>'+gpsList[i]+'</p>';
					    		}
							wireless+='</div>';
						wireless+='</li>';
						
						if(!data.connectivityTitle && !data.connectivityContent){
							wireless+='<li class="hidden">';
						}else{
							wireless+='<li>';
						}
						wireless+='<div class="item-subtitle">'+data.connectivityTitle+'</div>';
						wireless+='<div class="item-subcontent">';
							var connetctivityList = data.connectivityContent.split('\n');
							for(var i=0;i<connetctivityList.length;i++){
								wireless+='<p>'+connetctivityList[i]+'</p>';
				    		}
						wireless+='</div>';
					wireless+='</li>';
						
					wireless+='</ul>';
					$('.specs-wireless .item-content').empty().append(wireless);
					if(data.hideWireless=='true'){
						$('.product-specs .specs-wireless').hide();
					}
					
					// inthebox
					if(data.intheboxTitle){
						$('.specs-inthebox .item-title').text(data.intheboxTitle);
					}
					var intheboxstr = '';
					if(data.intheboxContent){
						var intheboxList = data.intheboxContent.split('\n');
						for(var i=0;i<intheboxList.length;i++){
							intheboxstr+='<p>'+intheboxList[i]+'</p>';
			    		}
					}
					if(data.intheboxNote){
						intheboxstr +='<div class="item-note">'+data.intheboxNote+'</div>';
					}
					$('.specs-inthebox .item-content').empty().append(intheboxstr);
					if(data.hideInthebox=='true'){
						$('.specs-inthebox').hide();
					}
					
					// btnandconn 
					$('.specs-btnandconn .item-title').text(data.btnAndConnTitle);
					var btnimg = '<img src="'+data.btnAndConnImage+'" alt="'+data.btnAndConnImgAlt+'" title="'+data.btnAndConnImgTitle+'" />';
					$('.specs-btnandconn .item-content').empty().append(btnimg);
					if(data.hideBtnAndConn=='true'){
						$('.product-specs .specs-btnandconn').hide();
					}
		    	}
		    }
		 })
		 
		 // colors图片组切换
		 $('.product-specs').on('click','.color-lists li',function(){
			 var that = $(this);
			 that.addClass('on');
			 that.siblings().removeClass('on');
			 var num = that.attr('num');
			 $('.product-specs .color-imgs img').removeClass('on')
			 $('.product-specs .color-imgs img:nth-child('+num+')').addClass('on')
		 })
		 
		// 移动端下，产品颜色滑动
			var touchStartX = 0, touchEndX = 0;
			$(".specs-colors").on("touchstart", ".color-imgs img", function(e){
				var touch = e.originalEvent.touches[0];
				touchStartX = touch.clientX;
			}).on("touchmove", function(e){
				var touch = e.originalEvent.touches[0];
				touchEndX = touch.clientX;
			});
			
			$(".specs-colors").on("touchend",'.color-imgs img',function(e){
	         var i = $(this).index();
	         var a = $(this).siblings().length;
	          if((touchEndX + 30) < touchStartX && touchEndX != 0){
	            if(i != a){
	             $(this).removeClass('on').next("img").addClass('on');
	             $('.specs-colors .color-lists li[num="'+(i+2)+'"]').addClass("on").siblings().removeClass("on");
	            }else{
	            	$('.specs-colors .color-lists li:first-child').click();
	            }
	          }else if((touchEndX - 30) > touchStartX && touchEndX != 0){
	           if(i != 0){
	             $(this).removeClass('on').prev("img").addClass('on');
	             $('.specs-colors .color-lists li[num="'+(i)+'"]').addClass("on").siblings().removeClass("on");
	            }else{
	            	$('.specs-colors .color-lists li:last-child').click();
	            }
	          }
	    });
		}
	}
}); 
}());
/*!
 * 	product-specs-v2 (2019-04-02T15:50:51+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($(".product-specs").length>0){ 
			var version = $('#specsVersion').val();
			// 版本二
			if(version && version=='v2'){
				var windowW = utils.windowWidth();
				var specData={
					productName:'',
					colors:[],
				};
				var currUrl = location.href;
				var ajaxUrl='';
				if(currUrl.indexOf('.html') !=-1){
					ajaxUrl=currUrl.split('.html')[0]+'/jcr:content.specs.json';
				}else if(currUrl.indexOf('?') != -1){
					ajaxUrl=currUrl.split('?')[0]+'jcr:content.specs.json';
				}else{
					ajaxUrl=currUrl+'jcr:content.specs.json';
				}
				
				// Get product specification info	
				$.ajax({
				    url: ajaxUrl, 
				    dataType: 'json', 
				    type: 'GET',
				    success: function(info) {
				    	var data = info.detailMode;
				    	if(!$.isEmptyObject(data)){
				    		// colors
				    		if(data.hideColors=='true'){
								$('.product-specs-v2 .specs-colors-v2').hide();
							}else{
								$('.specs-colors-v2 .title-txt').text(data.colorsTitle);
								specData.colors = JSON.parse(data.colors);
								var colorstr = '',imgstr = '';
								var colorLists = specData.colors;
								if(colorLists.length>=5){
									$('.specs-colors-v2 .item-content-v2').addClass('item-5');
								}
								for(var i=0;i<colorLists.length;i++){
									var colorValue = colorLists[i].color ? '#'+colorLists[i].color.substring(colorLists[i].color.lastIndexOf('/')+1) : 'white'
										if(i==0){
											imgstr+='<li class="active honor-loading-v2">';
										}else{
											imgstr+='<li class="honor-loading-v2">';
										}
									imgstr+='<img class="lazy" data-original="'+colorLists[i].specsImagePath+'" alt="'+colorLists[i].specsImgAlt +'" title="'+colorLists[i].specsImgTitle +'" />';
									imgstr+='<p class="color-name">'+colorLists[i].colorName+'</p>';
									imgstr+='</li>';
									
									if(i==0){
										colorstr+='<li class="active" num="'+(i+1)+'" name="'+colorLists[i].colorName+'">';
										$('.product-specs-v2 .app-curr-color').text(colorLists[i].colorName);
									}else{
										colorstr+='<li num="'+(i+1)+'" name="'+colorLists[i].colorName+'">';
									}
									colorstr+='<span style="background:'+colorValue+'"></span>';
									colorstr+='</li>';
								}
								
								var $colorImgs = $('.product-specs-v2 .specs-colors-v2 .color-imgs');
								var $colorLists = $('.product-specs-v2 .app-colors .color-lists');
								$colorImgs.empty().append(imgstr);
								$colorLists.empty().append(colorstr);
							}
				    		// features
				    		if(data.hideFeatures=='true'){
								$('.product-specs-v2 .specs-features-v2').hide();
							}else{
								$('.specs-features-v2 .title-txt').text(data.featuresTitle);
					    		var featureList = data.featuresContent.split('\n');
					    		var featurestr ='<ul>';
					    		for(var i=0;i<featureList.length;i++){
					    			featurestr+='<li>';
					    				featurestr+='<i class="font-Tickmark-right honor-icon"></i>';
				    					featurestr+='<span>'+featureList[i]+'</span>';
		    						featurestr+='</li>';
					    		}
					    		featurestr+='</ul>';
					    		featurestr+='<p class="tips-txt">'+data.featuresNote+'</p>';
					    		$('.specs-features-v2 .item-content-v2').empty().append(featurestr);
							}
				    		// display
				    		if(data.hideDisplay=='true'){
								$('.product-specs-v2 .specs-display-v2,.product-specs-v2 .display-dimensions .item-display-v2').hide();
							}else{
								$('.display-dimensions .display-title,.specs-display-v2 .title-txt').text(data.displayTitle);
								var displayList = data.displayContent.split('\n');
					    		var displaystr ='';
					    		displaystr+='<img class="lazy" data-original="'+data.displayImage+'" alt="'+data.displayImgAlt+'" title="'+data.displayImgTitle+'" />';
					    		displaystr+='<div class="display-desc">';
					    		for(var i=0;i<displayList.length;i++){
					    			displaystr+='<p>'+displayList[i]+'</p>';
					    		}
					    		displaystr+='</div>';
					    		if(windowW>768){
									$('.display-dimensions .item-display-v2').empty().append(displaystr);
								}else{
									$('.specs-display-v2 .item-content-v2').empty().append(displaystr);
								}
							}
				    		
				    		// dimensions
				    		if(data.hideDimensions=='true'){
								$('.product-specs-v2 .specs-dimensions-v2,.product-specs-v2 .display-dimensions .item-dimensions-v2').hide();
							}else{
								$('.display-dimensions .dimensions-title,.specs-dimensions-v2 .title-txt').text(data.dimensionsTitle);
					    		var dimstr = '';
					    		dimstr+='<div class="dimensions-desc">';
					    		var sizeList = data.sizeContent.split('\n');
					    		for(var i=0;i<sizeList.length;i++){
					    			var text='<strong>'+sizeList[i].split(":")[0]+':</strong>'+sizeList[i].split(":")[1];
					    			dimstr+='<p>'+text+'</p>'
					    		}
								dimstr+='</div>';
								if(windowW>768){
									dimstr+='<img class="lazy" data-original="'+data.sizeImg+'" alt="'+data.sizeImgAlt+'" title="'+data.sizeImgTitle+'"/>';
									$('.display-dimensions .item-dimensions-v2').empty().append(dimstr);
								}else{
									$('.specs-dimensions-v2 .item-content-v2').empty().append(dimstr);
								}
							}
				    		// camera 
				    		if(data.hideCamera=='true'){
								$('.product-specs-v2 .specs-camera-v2').hide();
							}else{
								$('.specs-camera-v2 .title-txt').text(data.cameraTitle);
								var camerastr = '';
								if(windowW>768){
									camerastr+='<img class="lazy" data-original="'+data.cameraImage+'" alt="'+data.cameraImgAlt+'" title="'+data.cameraImgTitle+'"/>';
								}
								camerastr += '<div class="camera-desc">';
								if(data.frontCameraTitle){
									camerastr+='<div class="item-subtitle">'+data.frontCameraTitle+':</div>';
								}
								camerastr+='<div class="front-item-subcontent">';
									var frontList = data.frontCameraContent.split('\n');
									for(var i=0;i<frontList.length;i++){
										camerastr+='<p>'+frontList[i]+'</p>';
						    		}
								camerastr+='</div>';
								if(data.rearCameraTitle){
									camerastr+='<div class="item-subtitle">'+data.rearCameraTitle+': </div>';
								}
								camerastr+='<div class="rear-item-subcontent">';
								var rearList = data.rearCameraContent.split('\n');
								for(var i=0;i<rearList.length;i++){
									camerastr+='<p>'+rearList[i]+'</p>';
					    		}
								camerastr+='</div>';
								camerastr+='</div>';
								if(windowW<=768){
									camerastr+='<img class="lazy" data-original="'+data.cameraImage+'" alt="'+data.cameraImgAlt+'" title="'+data.cameraImgTitle+'"/>';
								}
								$('.specs-camera-v2 .item-content-v2').empty().append(camerastr);
							}
				    		
				    		// wireless
				    		if(data.hideWireless=='true'){
								$('.product-specs-v2 .specs-wireless-v2').hide();
							}else{
								$('.specs-wireless-v2 .title-txt').text(data.wirelessTitle);
								var wireless = '';
								if(!data.networkTitle && !data.networkContent){
									wireless+='<li class="hidden">';
								}else{
									wireless+='<li>';
								}
									wireless+='<div class="item-subtitle">'+data.networkTitle+'</div>';
									wireless+='<div class="item-subcontent">';
										var networkList = data.networkContent.split('\n');
										for(var i=0;i<networkList.length;i++){
											wireless+='<p>'+networkList[i]+'</p>';
							    		}
									wireless+='</div>';
								wireless+='</li>';
								
								
								if(!data.gpsTitle && !data.gpsContent){
									wireless+='<li class="hidden">';
								}else{
									wireless+='<li>';
								}
									wireless+='<div class="item-subtitle">'+data.gpsTitle+'</div>';
									wireless+='<div class="item-subcontent">';
										var gpsList = data.gpsContent.split('\n');
										for(var i=0;i<gpsList.length;i++){
											wireless+='<p>'+gpsList[i]+'</p>';
							    		}
									wireless+='</div>';
								wireless+='</li>';
								
								if(!data.connectivityTitle && !data.connectivityContent){
									wireless+='<li class="hidden">';
								}else{
									wireless+='<li>';
								}
								wireless+='<div class="item-subtitle">'+data.connectivityTitle+'</div>';
								wireless+='<div class="item-subcontent">';
									var connetctivityList = data.connectivityContent.split('\n');
									for(var i=0;i<connetctivityList.length;i++){
										wireless+='<p>'+connetctivityList[i]+'</p>';
						    		}
								wireless+='</div>';
								wireless+='</li>';
									
								$('.specs-wireless-v2 .item-content').empty().append(wireless);
							}
				    		
				    		//intheboxNote
				    		$(".product-specs-v2").find(".inthebox").html(data.intheboxNote);
				    		
				    		$(".product-specs img.lazy").lazyload({
								"placeholder":lazyload.placeholder
							}).show(); 
				    		
				    		// 懒加载
							var imgLoad = imagesLoaded($("img.lazy"));
					        imgLoad.on('done', function(instance) {
					        	// 加载完成 
					        	$("img.lazy").parent().removeClass('honor-loading-v2');
					        });
					        
							// 移动端，colors图片组切换
							$('.product-specs-v2 .app-colors .color-lists li').click(function(){
								var that = $(this);
								that.addClass('active');
								that.siblings().removeClass('active');
								var name= that.attr('name');
								$('.product-specs-v2 .app-curr-color').text(name);
								var num = that.attr('num');
								$('.product-specs .color-imgs li').removeClass('active')
								var $next =$('.product-specs .color-imgs li:nth-child('+num+')');
								var imgsrc=$next.find('img').data('original');
								$next.find('img').attr('src',imgsrc);
								$next.addClass('active');
							})
							
							// 移动端下，产品颜色滑动
							var touchStartX = 0, touchEndX = 0;
							$(".product-specs-v2 .specs-colors-v2").on("touchstart", ".color-imgs li", function(e){
								var touch = e.originalEvent.touches[0];
								touchStartX = touch.clientX;
							}).on("touchmove", function(e){
								var touch = e.originalEvent.touches[0];
								touchEndX = touch.clientX;
							});
							$(".product-specs-v2 .specs-colors-v2").on("touchend",'.color-imgs li',function(e){
								var that = $(this);
								var i = that.index();
								var a = that.siblings().length;
								if((touchEndX + 30) < touchStartX && touchEndX != 0){
									// 左滑
									if(i != a){
										var name= that.find('.color-name').text();
										$('.product-specs-v2 .app-curr-color').text(name);
										var $next= that.removeClass('active').next("li");
										var imgsrc=$next.find('img').data('original');
										$next.find('img').attr('src',imgsrc);
										$next.addClass('active');
										$('.product-specs-v2 .app-colors .color-lists li[num="'+(i+2)+'"]').addClass("active").siblings().removeClass("active");
									}else{
										$('.product-specs-v2 .specs-colors-v2 .color-lists li:first-child').click();
									}
								}else if((touchEndX - 30) > touchStartX && touchEndX != 0){
									// 右滑
									if(i != 0){
										var name= that.find('.color-name').text();
										$('.product-specs-v2 .app-curr-color').text(name);
										var $prev= that.removeClass('active').prev("li");
										var imgsrc=$prev.find('img').data('original');
										$prev.find('img').attr('src',imgsrc);
										$prev.addClass('active');
										$('.product-specs-v2 .app-colors .color-lists li[num="'+(i)+'"]').addClass("active").siblings().removeClass("active");
									}else{
										$('.product-specs-v2 .specs-colors-v2 .color-lists li:last-child').click();
									}
								}
							});
				    		
				    	}
				    }
				})
				
				
			}
		}
	})
}());
(function(){
	var ww = $(window).width();
	//获得提交按钮的宽/高度
	var btnh = $('.web-power-component-v2 .input-right').height();
	var btnw = $('.web-power-component-v2 .input-right').width();
	var btnv = $('.web-power-component-v2 .input-right').val();
	var scrolltop = new Array();
    var i = 0;
    scrolltop[0] = 0;
    var leftw=-219,leftw2=-480;
    $(document).scroll(function() {
      i++
      if(ww<=768){    
    	  //移动端组件进入可视区域淡入
    	  $(".web-power-component-v2").each(function(i,el){
    	    var elTop = $(el).offset().top;
  	        var isInView = elTop >= $(window).scrollTop() && elTop < ($(window).scrollTop() + $(window).height()- $(window).height()/4);
  	        if (isInView) {
  	          $(".web-power-component-v2 .all-parts").fadeIn(1000);
  	        }
    	  })       
      }else{    
    	  //PC端组件进入可视区域上移淡入
    	  $(".web-power-component-v2").each(function(i,el){
    	    var elTop = $(el).offset().top;
    	    var lineWidth = ($(window).width() - $(".web-power-component-v2 div.all-parts .word-div .center-word").width())/2-15;
  	        var isInView = elTop >= $(window).scrollTop() && elTop < ($(window).scrollTop() + $(window).height()- $(window).height()/4);
  	        if (isInView) {
  	          $(".web-power-component-v2 .all-parts").animate({
  	        	  bottom:'180px',
  	        	  opacity:'1'	    
  	          },2000);
  	          $(".web-power-component-v2 .middle-line").animate({
	        	  width:lineWidth+'px',	    
	          },2000);
  	        }
    	  })       
      }
    }) 
    
    $('.web-power-component-v2 .input-right').on("click",function(){
    	//复位
    	$('#email-box').css("border-color","#1e1e1e");	
    	$('.web-power-component-v2 #email-box .ErrorMsg').css("display","none");
    	//定义正则表达式的变量:邮箱正则
  		var reg=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
  		
  		var strEmail = $('.web-power-component-v2 .input-left').val();
  		//文本框不为空，并且验证邮箱正则成功，给出正确提示
  		if(strEmail != null && strEmail.search(reg) != -1)
  		{
  			$('#email-box .input-right').css("background","#00B1FF");
  			$('#email-box .input-right').animate({
  				"width":btnh
  			},200);
  			$('#email-box .input-right').val("√");
  			
  			// 消息订阅（Newsletter Subscription）GA Code
  	  		window.dataLayer.push({
  	  			"event": "newsletterSubscription",
  	  			"siteLocation": "footer",
  	  			"pageType":honorConfig.pageType
  			})
  			
  			return true;
  		}else{
  			$('#email-box').css("border-color","#FF00D0");
  			$('#email-box .ErrorMsg').fadeIn(500);
  			return false;
  		}
    })
    
    $("#email-box .input-left").focus(function(){
    	$('#email-box .input-right').val(btnv);
    	//$('#email-box').css("border-color","#1e1e1e");
    	$('#email-box .input-right').css("background","linear-gradient(295deg, #00ffff, #00b1ff 33%, #bd00fe 69%, #ff00d0)");
			$('#email-box .input-right').animate({
				"width":btnw
			});
    });
}());
var HONOR_V2 = window.HONOR || {};

HONOR_V2.init = function() {
  var featured_swiper = new Swiper('.hot-box-v2 .hot_swiper', {
    effect: 'coverflow',
    grabCursor: true,
    loop: true,
    lazy: true,
    lazyLoading: true,
    centeredSlides: true,
    slidesPerView: '2',
    slideToClickedSlide: true,
    coverflowEffect: {
      rotate: 0,
      stretch: -12,
      depth: 100,
      slideShadows: true,
    },
    pagination: {
      el: '.hot-box-v2 .swiper-pagination',
      clickable: true,
    },
  });
}

$(document).ready(function() {
  if ($('.hot_swiper .swiper-slide').length > 0) {
    HONOR_V2.init();
  }
  //点击跳转新窗口
  $(".hot-box-v2").on("click", ".swiper-slide", function() {
    var url = $(this).find('a').attr('href');
    var isBlank = $(this).find('a').attr('target');

    if (url && isBlank) {
      window.open(url);
    } else if (url) {
      window.location.href = url;
    }
  });

});

(function() {
  var len = $(".hot-box-v2").length;
  var ww = $(window).width();
  var wh = $(window).height();
  if (len > 0) {
    var smallRoundeSrc = "/etc/designs/honor-site/assets/round/small_circle_2.png";
    var bigRoundeSrc = "/etc/designs/honor-site/assets/round/big_circle_2.png";
    $(".hot-box-v2 .np .video").each(function(i,el){
    	$(el).siblings("a").remove();
    })
    if(!!window.ActiveXObject || "ActiveXObject" in window){
	      $(".hot-box-v2 h2").css("color","#bd00fe");
	      $(".hot-box-v2 h2").css("background-image", "none");
	}
    if (ww > 768) {
      $(".hot-box-v2 .small-round img").attr("src", smallRoundeSrc);
      $(".hot-box-v2 .big-round img").attr("src", bigRoundeSrc);
    }
    
    //圆圈动画
    function ScollPostion() { //滚动条位置
      var t, l, w, h;
      if (document.documentElement && document.documentElement.scrollTop) {
        t = document.documentElement.scrollTop;
        l = document.documentElement.scrollLeft;
        w = document.documentElement.scrollWidth;
        h = document.documentElement.scrollHeight;
      } else if (document.body) {
        t = document.body.scrollTop;
        l = document.body.scrollLeft;
        w = document.body.scrollWidth;
        h = document.body.scrollHeight;
      }
      return {
        top: t,
        left: l,
        width: w,
        height: h
      };
    }
    var scrolltop = new Array();
    var i = 0;
    scrolltop[0] = 0;
    var rightW = -389, rightW2 = -576;
    $(document).scroll(function() {
    	 $(".hot-box-v2 .np").each(function(i,el){
     	    var elTop = $(el).offset().top;
   	        var isInView = elTop >= $(window).scrollTop() && elTop < ($(window).scrollTop() + $(window).height()- $(window).height()/2);
   	        if (isInView) {
   	        	$(el).children("div.bg").fadeOut();
   	        }
     	  })    
      i++
      var elMove = $(".hot-box-v2").offset().top;
      var isInView = elMove >= $(window).scrollTop() && elMove < ($(window).scrollTop() + $(window).height());
      var isInView2 = elMove >= $(window).scrollTop() && elMove < ($(window).scrollTop() + $(window).height()/2);
      var isInView3 = elMove >= $(window).scrollTop() && elMove < ($(window).scrollTop() + $(window).height()/1.2);
      scrolltop[i] = $(document).scrollTop();
      if(isInView3&&ww>768){
    	 $(".hot-box-v2 h2").animate({
    		 "top":"0px",
    		 "opacity":"1"
    	 },1500);
      }
      //在可视区且是下滑圆圈进入
      if (scrolltop[i] > scrolltop[i - 1] && isInView) {
    	  rightW+=71.8;
    	  if(rightW>-30){
    		  rightW=-30;
    	  }
    	  $(".hot-box-v2  .small-round> img").css("right",rightW);
    	  rightW2+=37.6;
    	  var elTop=$(".hot-box-v2 .row").offset().top;
    	  if(rightW2>-210 || elTop < ($(window).scrollTop() + $(window).height()- $(window).height()*2/3)){
    		  rightW2=-210;
    	  }
        $(".hot-box-v2 .big-round >img").css("right",rightW2);
      }
      if (scrolltop[i] < scrolltop[i - 1] ) {
    	  rightW-=31.8;
    	  if(rightW<-389){
    		  rightW=-389;
    	  }
        $(".hot-box-v2 .small-round >img").css("right",rightW);
        if(ww==1920){
        	 rightW2-=24.4;
        	 if(rightW2<-130){
        		 rightW2=130;
        	 }
        	  $(".hot-box-v2 .big-round >img").css("right","-130px").css("top","230px");
        }
        else{
        	 rightW2-=97.6;
        	 if(rightW2<-576){
        		 rightW2=-576;
        	 }
        	$(".hot-box-v2 .big-round >img").css("right",rightW2);
        }
      } 
    })
    //懒加载
    $(".hot-box-v2 img.lazy").lazyload({
    	"failure_limit":3, 
    	"placeholder":lazyload.placeholder
    }).show().parent().removeClass('honor-loading-v2');
    if (ww <= 768) {
      $(".hot-box-v2 .np").each(function(i, el) {
        var mbSrc = $(el).find("img").attr("data-mb");
        $(el).find("img").attr("data-original", mbSrc);
      })
    
    }
      //播放视频
    var videoURL = '';
    $(".hot-box-v2 .np .video").click(function(){
    	var vmb=$(this).find(".play-btn").attr("data-vmb");
    	var vpc=$(this).find(".play-btn").attr("data-vpc");
    	var modalH=wh+67;
    	var isVideo=$(this).length;
    	if(isVideo>0){
    		$(".hot-box-v2 .hot-video-modal").css("background-color","rgba(0,0,0,0.6)").css("z-index","9999");
    		var top = $(document).scrollTop();
            $(document).on('scroll.unable',function (e) {
                 $(document).scrollTop(top);
            })
            if(ww>768){
            	$("body").css("overflow","hidden");  
        	}
    	}
    	  
    	var vhtml='<iframe  name="kv-iframe" id="kv-iframe" class="kv-video-frame" height="90%" width="100%" src="'+vpc+'" frameborder=0 allowfullscreen />';
    	if(ww<=768){
    		var height="90%";
    		if(ww<=414){
    			height="87%";
    		}
    		if(ww<=375){
    			height="88%";
    		}
    		if(ww<=360){
    			height="85%";
    		}
    		if(ww<=320){
    			height="84%";
    		}
    		vhtml='<iframe  name="kv-iframe" id="kv-iframe" class="kv-video-frame" height="'+height+'" width="100%" src="'+vmb+'" frameborder=0 allowfullscreen />';
    		 
    	}
    	$(this).find(".video-youtobe").html(vhtml);
    	var headerH=$(".header-v2").outerHeight(true);
    	$(".hot-box-v2 .np .video .video-info").css("top",headerH);
      	$(this).find(".video-info").show();
      	
      	// 监测视频播放事件 GA Code
      	if(ww>768){
      		videoURL = vpc;
      	}else{
      		videoURL = vmb;
      	}
	    window.dataLayer.push({
	    	"event": "video",
	    	"videoStep":"play",
	    	"videoId": videoURL
	    })
      })
      $(".hot-box-v2 .np .video .video-info .close-video").click(function(e){
    	  e.stopPropagation();
    	  $(".hot-box-v2 .hot-video-modal").css("background","none").css("z-index","-1");
    	  $("body").css("overflow","auto").css("height","auto");    	  
    	  $(this).siblings(".video-youtobe").html('');
    	  $(document).off("scroll.unable");
    	  
    	  $(this).parent("div.video-info").hide();
    	  
    	  // 监测视频播放事件 GA Code
  		  window.dataLayer.push({
  			  "event": "video",
  			  "videoStep":"close",
  			  "videoId": videoURL
  		  })
      })
      
      // GA Code siteLocation base on pageTye
      var siteLocation = '';
      if(honorConfig.pageType=='home'){
    	  siteLocation = 'Brand Story';
      }else if(honorConfig.pageType=='brand'){
    	  siteLocation = 'Brand Events';
      }
      
      // Image Link Click GA Code
      $('.hot-box-v2 a.item-box').click(function(){
    	  var imageName = $(this).find('img.lazy').attr('title') || '';
    	  window.dataLayer.push({
    		  "event": "uaEvent",
    		  "eventCategory": "Image Link",
    		  "eventAction": "click",
    		  "eventLabel": siteLocation+" "+ imageName
    	  })
      })
      // Read All Stories Button GA Code
	  $('.hot-box-v2 .hononstory-box .readall').click(function(){
		  var buttonName = $.trim($(this).text()) || '';
		  window.dataLayer.push({
			  "event": "uaEvent",
			  "eventCategory": siteLocation,
			  "eventAction": "click",
			  "eventLabel": buttonName
		  })
	  })
  } 
  
})();

var HONOR = window.HONOR || {};

   HONOR.init = function(){
          var featured_swiper = new Swiper('.hot_swiper', {
            effect: 'coverflow',
            grabCursor: true,
            loop:true,
            lazy:true,
            lazyLoading : true,
            centeredSlides: true,
            slidesPerView: '2',
            slideToClickedSlide: true,
            coverflowEffect: {
                rotate: 0,
                stretch: -12,
                depth: 100,
                slideShadows : true,
            },
            pagination: {
                el: '.hot-box .swiper-pagination',
                clickable: true,
            },
        });
    }

    $( document ).ready(function() {
        if($('.hot_swiper .swiper-slide').length > 0){
            HONOR.init();
        }
        //懒加载
    	$(".hot-box img.lazy").lazyload({
    		"placeholder":lazyload.placeholder
    	}).show();
        //点击跳转新窗口
        $(".hot-box").on("click", ".swiper-slide", function(){
			var url = $(this).find('a').attr('href');
			var isBlank =  $(this).find('a').attr('target');

			if(url&&isBlank){
				window.open(url);
			}else if(url){
				window.location.href= url;
			}
		});

    });


 var HONORHISTORY = window.HONORHISTORY || {};

         HONORHISTORY.init = function(){
 
            getHistoryData();

            bindClick();
        }

           //获取历史事件数据
        var getHistoryData = function(){
                var result = JSON.parse($('div[name="historyJson"]').text() || "[]");
                if(result.length > 0) {
                    localStorage.setItem('historyData',JSON.stringify(result));
                    var bodyWidth = document.body.offsetWidth;
                    if(bodyWidth<=768){//手机上
                        var tempy  = '';
                        if($('#history-year-M').text()){
                            tempy =  template('history-year-M', {list:result[0].list.slice(0,6),active:0});
                        }
                        $('ul[name="history-list-M"]').html(tempy);

                        // var temp  = template('HistoryMObile', {list:result});
                        var temp  = '';
                        if($('#HistoryMObile').text()){
                            temp =  template('HistoryMObile', {list:result});
                        }
                        $('div[name="historyMobaileWrapper"]').html(temp);

                        var thisCount = 0;
                        var objIndex = 0;   //记录前一个index下标
                        setTimeout(function(){
                            var swiper = new Swiper('.HISTORYMOBILE .swiper-container',{
                                on: {
                                    slideChangeTransitionEnd: function(){
                                       // var month = $('.swiper-slide-active').find('.banner-big-btn').attr('month');
                                       // var monthNum = $('.swiper-slide-active').find('.banner-big-btn').attr('monthNum');
                                       var year = $('.swiper-slide-active').find('.banner-big-btn').attr('year');
                                       var prevYear = $('.swiper-slide-active').prev().find('.banner-big-btn').attr('year');
                                       // var nextYear = $('.swiper-slide-active').next().find('.banner-big-btn').attr('year');
                                       var list = [];
                                       for(var j=0;j<result.length;j++){
                                            if(year==result[j].year){
                                                list = result[j].list;
                                            }
                                       }
                                       if(prevYear != year){
                                            thisCount = this.activeIndex;  
                                       }
                                            // debugger;
                                            var tempy = '';
                                       if(thisCount>this.activeIndex&&thisCount!=0){  //往前滑动
                                            var start=0;var end = 6;
                                            var active = 0 ;
                                            // debugger;
                                            if(list.length>6&&(thisCount-this.activeIndex)<(list.length-6)){//年份事件列表长度大于6 并且
                                                start = 6;
                                                end = 12;
                                                if(objIndex!=0&&objIndex>this.activeIndex){
                                                    active = (list.length-6)-(thisCount-this.activeIndex);
                                                }else{
                                                    active = (list.length-6)-(thisCount-this.activeIndex)-1;
                                                }

                                            }else{
                                                start = 0;
                                                end = 6;
                                                if(objIndex!=0&&objIndex>this.activeIndex){
                                                    active = list.length-(thisCount-this.activeIndex);
                                                    list.length>6?active=active-1:active=active;
                                                }else{
                                                    active = list.length-(thisCount-this.activeIndex)-1;
                                                }
                                            }
                                            tempy ='';
                                            if($('#history-year-M').text()){
                                                tempy =  template('history-year-M', {
                                                    list:list.slice(start,end),
                                                    active:active
                                                });
                                            }
                                            
                                        }else{
                                            //tempy = template('history-year-M', {
                                              //    list:list.slice(this.activeIndex-thisCount<6?0:6,this.activeIndex-thisCount<6?6:12),
                                              //    active:this.activeIndex-thisCount<6?this.activeIndex-thisCount:(this.activeIndex-thisCount-6)
                                           // });

                                               tempy ='';
                                               if($('#history-year-M').text()){
                                                    tempy =  template('history-year-M', {
                                                        list:list.slice(this.activeIndex-thisCount<6?0:6,this.activeIndex-thisCount<6?6:12),
                                                        active:this.activeIndex-thisCount<6?this.activeIndex-thisCount:(this.activeIndex-thisCount-6)
                                                    });
                                               }
                                        }
                                                
                                        $('ul[name="history-list-M"]').html(tempy);
                                            objIndex = this.activeIndex;  
                                        }
                                    }
                                });
                        },500)
                    }else{
                        var tempy = '' ;
                        if($('#history-year').text()){
                            tempy = template('history-year', {list:result});
                        }
                        
                        $('ul[name="history-lsit-name"]').html(tempy);
                        
                        var liwidth = ($('li[name="li-parent"]').length-1)*70;
                        var width_ = "calc(100% - "+liwidth+"px)";
                        $('.history-open').css("width",width_);
                        
                        
                        var temp  = '';
                        if($('#HistoryPc').text()){
                            temp = template('HistoryPc', result[0].list[0]);
                        }

                        $('div[name="banner-contianer"]').html(temp);
                        setTimeout(function(){
                            $('.banner-second-left').css("display","inline-block")
                        },200)
                        //$('.history-open').css("width","calc(100%-"+70*($('li[name="li-parent"]').length-1)+"px)");
                        jqAnimate();
                        
                    }
                    
                }
            }


        var bindClick = function(){
        
            //历史进度折叠 history-lsit-name
            $('ul[name="history-lsit-name"]').on('click','li[name="li-parent"]',function(e){
                if(e.target.className.trim()!='history-process-header'){
                    return ;
                }
                $(this).siblings().find('ul').addClass('hide');
                $(this).siblings().find('.history-title').removeClass('hide');
                $(this).siblings().find('div[name=history-process]').removeClass('hide');
    
                $(this).find('ul').removeClass('hide');
                $(this).find('.history-title').addClass('hide');
                $(this).find('div[name=history-process]').addClass('hide');
    
                $(this).addClass("history-open");
                
    
                var l = $(this).find('ul').find('li').length;
                $(this).find('ul').find('li').css("width",100/l+"%");
                $(this).siblings().removeClass("history-open");
                
                
                var rData = JSON.parse(localStorage.getItem("historyData"));
                var year = $(this).find('.history-label-first').text()
                
                var datasObj = {};
                for(var i=0;i<rData.length;i++){
                    if(rData[i].year == year){
                        datasObj = rData[i].list[0];
                    }
                }
                // var temp  = template('HistoryPc', datasObj);
               var temp  = '';
               if($('#HistoryPc').text()){
                    temp = template('HistoryPc', datasObj);
               }
               $('div[name="banner-contianer"]').html(temp);
               $(this).find('ul').find('.history-process-big').addClass('hide');
               $(this).find('ul').find('.history-label').addClass('hide');
               $(this).find('ul').find('li:eq(1)').find('.history-process-big').removeClass('hide');
               $(this).find('ul').find('li:eq(1)').find('.history-label').removeClass('hide');
    
               jqAnimate();
               MonthFlag=0;
    
               // debugger;
               var liwidth = ($('li[name="li-parent"]').length-1)*70;
               var width_ = "calc(100% - "+liwidth+"px)";
               $(this).css("width",width_);
               $(this).siblings().attr('style','');
            })

            var MonthFlag =0;
            //历史事件点击
            $('ul[name="history-lsit-name"]').on('click','li[name="sub-item"] .history-process',function(e){
               // debugger;
               e.stopPropagation();
               var bodyWidth = document.body.offsetWidth;
               // debugger;
               if(bodyWidth<=768){
                    return ; 
               }else{
                var rData = JSON.parse(localStorage.getItem("historyData"));
                var year = $(this).parent().attr('year');
                var month = $(this).parent().attr('month');
                var monthNum = $(this).parent().attr('monthNum');
                var currentMonthFlag = $(this).prev().text();
                if(currentMonthFlag>MonthFlag){
                    $('#HISTORY').addClass('right').removeClass('left');
                }else{
                    $('#HISTORY').addClass('left').removeClass('right');
                }
                MonthFlag = currentMonthFlag;

                var datasObj = {};
                for(var i=0;i<rData.length;i++){
                    if(rData[i].year == year){
                        for(var j=0;j<rData[i].list.length;j++){
                            if(month==rData[i].list[j].month&&monthNum==rData[i].list[j].monthNum){
                                datasObj = rData[i].list[j];
                            }
                        }
                    }
                }
               $(this).parent().siblings().find('.history-process-big').addClass('hide');
               $('li[name="sub-item"]').find('.history-label').addClass('hide');
               $(this).parent().find('.history-process-big').removeClass('hide');
               $(this).parent().find('.history-label').removeClass('hide');
               
               var temp  = '';
               if($('#HistoryPc').text()){
                temp = template('HistoryPc', datasObj);
               }
               $('div[name="banner-contianer"]').html(temp);

               jqAnimate();
                       
               }
           })
        
        }
        
        var jqAnimate = function(){
            $(".right .banner-years-second").animate({"right":"0"},500);
            setTimeout(function(){
                $(".right .banner-second-left").animate({"right":"0"},500);
            },100)
            
            setTimeout(function(){
                $(".right .banner-second-right").animate({"right":"0"},500);
            },200)

            setTimeout(function(){
                $(".right .banner-big-btn").animate({"right":"430"},500);
            },300)
            
            
            $(".left .banner-years-second").animate({"left":"0"},500);
            setTimeout(function(){
                $(".left .banner-second-left").animate({"left":"0"},500);
            },100)

            setTimeout(function(){
                $(".left .banner-second-right").animate({"left":"0"},500);
            },200)
            
            setTimeout(function(){
                $(".left .banner-big-btn").animate({"left":"480"},500);
            },300)  
        }

        $( document ).ready(function() {
            HONORHISTORY.init();
        });


/*!art-template - Template Engine | http://aui.github.com/artTemplate/*/
!function(){function a(a){return a.replace(t,"").replace(u,",").replace(v,"").replace(w,"").replace(x,"").split(y)}function b(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function c(c,d){function e(a){return m+=a.split(/\n/).length-1,k&&(a=a.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),a&&(a=s[1]+b(a)+s[2]+"\n"),a}function f(b){var c=m;if(j?b=j(b,d):g&&(b=b.replace(/\n/g,function(){return m++,"$line="+m+";"})),0===b.indexOf("=")){var e=l&&!/^=[=#]/.test(b);if(b=b.replace(/^=[=#]?|[\s;]*$/g,""),e){var f=b.replace(/\s*\([^\)]+\)/,"");n[f]||/^(include|print)$/.test(f)||(b="$escape("+b+")")}else b="$string("+b+")";b=s[1]+b+s[2]}return g&&(b="$line="+c+";"+b),r(a(b),function(a){if(a&&!p[a]){var b;b="print"===a?u:"include"===a?v:n[a]?"$utils."+a:o[a]?"$helpers."+a:"$data."+a,w+=a+"="+b+",",p[a]=!0}}),b+"\n"}var g=d.debug,h=d.openTag,i=d.closeTag,j=d.parser,k=d.compress,l=d.escape,m=1,p={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},q="".trim,s=q?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],t=q?"$out+=text;return $out;":"$out.push(text);",u="function(){var text=''.concat.apply('',arguments);"+t+"}",v="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+t+"}",w="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(g?"$line=0,":""),x=s[0],y="return new String("+s[3]+");";r(c.split(h),function(a){a=a.split(i);var b=a[0],c=a[1];1===a.length?x+=e(b):(x+=f(b),c&&(x+=e(c)))});var z=w+x+y;g&&(z="try{"+z+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+b(c)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var A=new Function("$data","$filename",z);return A.prototype=n,A}catch(B){throw B.temp="function anonymous($data,$filename) {"+z+"}",B}}var d=function(a,b){return"string"==typeof b?q(b,{filename:a}):g(a,b)};d.version="3.0.0",d.config=function(a,b){e[a]=b};var e=d.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},f=d.cache={};d.render=function(a,b){return q(a,b)};var g=d.renderFile=function(a,b){var c=d.get(a)||p({filename:a,name:"Render Error",message:"Template not found"});return b?c(b):c};d.get=function(a){var b;if(f[a])b=f[a];else if("object"==typeof document){var c=document.getElementById(a);if(c){var d=(c.value||c.innerHTML).replace(/^\s*|\s*$/g,"");b=q(d,{filename:a})}}return b};var h=function(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?h(a.call(a)):""),a},i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},j=function(a){return i[a]},k=function(a){return h(a).replace(/&(?![\w#]+;)|[<>"']/g,j)},l=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},m=function(a,b){var c,d;if(l(a))for(c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)},n=d.utils={$helpers:{},$include:g,$string:h,$escape:k,$each:m};d.helper=function(a,b){o[a]=b};var o=d.helpers=n.$helpers;d.onerror=function(a){var b="Template Error\n\n";for(var c in a)b+="<"+c+">\n"+a[c]+"\n\n";"object"==typeof console&&console.error(b)};var p=function(a){return d.onerror(a),function(){return"{Template Error}"}},q=d.compile=function(a,b){function d(c){try{return new i(c,h)+""}catch(d){return b.debug?p(d)():(b.debug=!0,q(a,b)(c))}}b=b||{};for(var g in e)void 0===b[g]&&(b[g]=e[g]);var h=b.filename;try{var i=c(a,b)}catch(j){return j.filename=h||"anonymous",j.name="Syntax Error",p(j)}return d.prototype=i.prototype,d.toString=function(){return i.toString()},h&&b.cache&&(f[h]=d),d},r=n.$each,s="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",t=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,u=/[^\w$]+/g,v=new RegExp(["\\b"+s.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),w=/^\d[^,]*|,\d[^,]*/g,x=/^,+|,+$/g,y=/^$|,+/;e.openTag="{{",e.closeTag="}}";var z=function(a,b){var c=b.split(":"),d=c.shift(),e=c.join(":")||"";return e&&(e=", "+e),"$helpers."+d+"("+a+e+")"};e.parser=function(a){a=a.replace(/^\s/,"");var b=a.split(" "),c=b.shift(),e=b.join(" ");switch(c){case"if":a="if("+e+"){";break;case"else":b="if"===b.shift()?" if("+b.join(" ")+")":"",a="}else"+b+"{";break;case"/if":a="}";break;case"each":var f=b[0]||"$data",g=b[1]||"as",h=b[2]||"$value",i=b[3]||"$index",j=h+","+i;"as"!==g&&(f="[]"),a="$each("+f+",function("+j+"){";break;case"/each":a="});";break;case"echo":a="print("+e+");";break;case"print":case"include":a=c+"("+b.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(e)){var k=!0;0===a.indexOf("#")&&(a=a.substr(1),k=!1);for(var l=0,m=a.split("|"),n=m.length,o=m[l++];n>l;l++)o=z(o,m[l]);a=(k?"=":"=#")+o}else a=d.helpers[c]?"=#"+c+"("+b.join(",")+");":"="+a}return a},"function"==typeof define?define(function(){return d}):"undefined"!=typeof exports?module.exports=d:this.template=d}();
/**
 * Gallery how to video Banner
 */
(function(){
	$(function(){
		if($('.howto-video-banner').length>0){
			var windowW = utils.windowWidth();
			var $el=$(".howto-video-banner .banner-txt");
			var wh=$el.width();
			var calc='calc((100% - '+ wh+'px'+')/2)';
			$el.css('left',calc);
			if(windowW>768){
				//文案垂直居中
				 var hh=$(".howto-video-banner .banner-txt").outerHeight(true);
				var calcTop='calc((100% - '+ hh+'px'+')/2)';
				$el.css('top',calcTop);
			}
			if(windowW<=768){
				var src=$(".howto-video-banner a img").data("mb");
				$(".howto-video-banner a img").attr("src",src);
			}
			
		}
	}) 
}());
/**
 * Gallery Collection Banner
 */
(function(){
	$(function(){
		if($('.gallery-collection-banner').length>0){
			var $img = null;
			if(galleryPublicData.windowW>768){
				$img = $(".gallery-collection-banner .banner-pc");
			}else{
				$img = $(".gallery-collection-banner .banner-mb");
			}
			if($img){
				var imgsrc = $img.data('src');
				$img.attr('src',imgsrc);
				$img.imagesLoaded().done(function(){
					$img.show();
					$('.gallery-collection-banner .banner-info').show();
				})
			}
		}
	}) 
}());
(function() {
	var isFirefox = (navigator.userAgent.indexOf('Firefox') > 0);
	
	$(function(){
		$('#LATESTNEWS').on('click','.swiper-slide', function(){
			var url = $(this).find('a').attr('href');
			if (url) location.href = url;
		});
	})
	
	if ($('div[name="relatedNewsDataWrapper"]').length < 1) return;

	var result = JSON.parse($('div[name="relatedNewsDataWrapper"]').text() || "[]");

	var temp = '';
	if ($('#relatedNewsBrand').text()) {
		temp = template('relatedNewsBrand', {
			list : result
		});
	}

	$('div[name="relatedNewsList"]').html(temp);
	var bodyWidth = document.body.offsetWidth;
	var scrollListWidth = $(window).width() - 200;

	var swiper = new Swiper('.relatedNews .scrollList .swiper-container', {
		slidesPerView : bodyWidth > 600 ? scrollListWidth / 402 : 1.5,
		spaceBetween : 20,
		freeMode : true,
		pagination : {
			el : '.swiper-pagination',
			clickable : true,
		},
		mousewheel : true,
	});
	
	/*clampDesc();
	
	window.onresize = function(){
		clampDesc();
	}
	
	function clampDesc () {
		if (!isFirefox) {
			$(".relatedNews .inner-third").each(function(){
				$clamp(this, {clamp : 2});
			});
		}
	}*/
	
	//滚动条出现两行的问题  需要重新设置silder的宽度
	$(function(){
		var scount = $('.relatedNews .swiper-pagination-bullet').length;
		$('.relatedNews .swiper-pagination-bullet').css("width",Math.floor(100/scount)+'%');
		
		

		//判断lastnews div高度超出两行
		var arr = $('.inner-third-desc');
		for(var i=0;i<arr.length;i++){
//			console.log($(arr[i]).height());
			if($(arr[i]).height()>37){
				$(arr[i]).parent().addClass('inner-third-after');
				$(arr[i]).css({"overflow":"hidden","max-height":"37px"})
			}
		}
	});
	
})();
(function() {
	if ($('.related-list-v2').length < 1) return;

	var result = JSON.parse($('.related-list-v2 .data-list').text() || "[]");
	var relatedItem="";
	$.each(result, function(i, item){
		if(item.tags.length>0){
			var tagtitle=item.tags[0].tagTitle;
		}
		relatedItem+='<li>';
			relatedItem+='<a href="'+item.url+'">';
			if(item.cardImgMB && $(window).width()<768){
				relatedItem+='<div class="item-pic honor-loading-v2"><img class="lazy" data-original="'+item.cardImgMB+'"></div>';
			}else{
				relatedItem+='<div class="item-pic honor-loading-v2"><img class="lazy" data-original="'+item.cardImg+'"></div>';
			}
				relatedItem+='<div class="item-info">';
					relatedItem+='<div class="item-info-bg"></div>';
					relatedItem+='<div class="item-info-cont">';
						relatedItem+='<p class="item-date">'+item.releaseDate+'</p>';
						relatedItem+='<p class="item-tag">'+tagtitle+'</p>';
						relatedItem+='<p class="item-title" title="'+item.title+'">'+item.title+'</p>';
						relatedItem+='<p class="item-desc" title="'+item.description+'">'+item.description+'</p>';
					relatedItem+='</div>';
				relatedItem+='</div>';
			relatedItem+='</a>';
		relatedItem+='</li>';
		//最多展示3个相关新闻
	
			if(i==2){
				$('.related-list-v2 .related-list ul').append(relatedItem);
			}else if(result.length == 1 && i==0){
				$('.related-list-v2 .related-list ul').append(relatedItem);
				$(".related-list-v2 .related-list ul").css("display","inline");
			}else if(result.length == 2 && i==1){
				$('.related-list-v2 .related-list ul').append(relatedItem);
				$(".related-list-v2 .related-list ul").css("display","inline");
				$(".related-list-v2 .related-list ul li").css("display","inline-block");
			}
		
		
	});
	
	$(".related-list-v2 img.lazy").lazyload({effect: "fadeIn"});
	
})();
(function() {
	
	$(function(){
		$('#lateNewsList').on('click','.swiper-slide', function(){
			var url = $(this).find('a').attr('href');
			if (url) location.href = url;
		});
	})
	
	if ($('div[name="latestNewsDataWrapper"]').length < 1) return;
	
	var isFirefox = (navigator.userAgent.indexOf('Firefox') > 0);

	var result = JSON.parse($('div[name="latestNewsDataWrapper"]').text() || "[]");

	var temp = '';
	if ($('#latestNewsBrand').text()) {
		temp = template('latestNewsBrand', {
			list : result
		});
	}

	$('#lateNewsList').html(temp);
	var bodyWidth = document.body.offsetWidth;
	var scrollListWidth = $(window).width() - 200;
	
	var swiper = new Swiper('.brand-news .scrollList .swiper-container', {
		slidesPerView : bodyWidth > 600 ? scrollListWidth / 402 : 1.5,
		spaceBetween : 20,
		freeMode : true,
		pagination : {
			el : '.swiper-pagination',
			clickable : true,
		},
		mousewheel : true,
	});
	
//	clampDesc();
//	
//	window.onresize = function(){
//		clampDesc();
//	}
//	
//	function clampDesc () {
//		if (!isFirefox) {
//			$(".brand-news .inner-third").each(function(){
//				$clamp(this, {clamp : 2});
//			});
//		}
//	}
	
	//滚动条出现两行的问题  需要重新设置silder的宽度
	$(function(){
		var scount = $('.latest-news  .swiper-pagination-bullet').length;
		$('.latest-news .swiper-pagination-bullet').css("width",Math.floor(100/scount)+'%');
		
		
		//判断lastnews div高度超出两行
		var arr = $('.inner-third-desc');
		for(var i=0;i<arr.length;i++){
//			console.log($(arr[i]).height());
			if($(arr[i]).height()>37){
				$(arr[i]).parent().addClass('inner-third-after');
				$(arr[i]).css({"overflow":"hidden","max-height":"37px"})
			}
		}
	})
	
 
})();
﻿$(function() {
	if($(".product-specs-cn").length>0){ 
		var currUrl = location.href;
		var ajaxUrl='';
		if(currUrl.indexOf('.html') !=-1){
			ajaxUrl=currUrl.split('.html')[0]+'/jcr:content.specs.json';
		}else if(currUrl.indexOf('?') != -1){
			ajaxUrl=currUrl.split('?')[0]+'jcr:content.specs.json';
		}else{
			ajaxUrl=currUrl+'jcr:content.specs.json';
		}
		$.ajax({
		    url: ajaxUrl, 
		    dataType: 'json', 
		    type: 'GET',
		    success: function(info) {
		    	var browerWidth = $(window).width();
		    	var data = info.detailMode;
		    	var colorImgPath;
		    	var appearanceImg;
		    	var displayImg;
		    	if(browerWidth <= 768) {
		    		colorImgPath = "mbImgColorCnPath";
		    		appearanceImg = data.mbImgAppearPath;
		    		displayImg = data.mbImgDisplayPath;
		    	} else {
		    		colorImgPath = "imgColorCnPath";
		    		appearanceImg = data.imgAppearPath;
		    		displayImg = data.imgDisplayPath;
		    	}
		    	//颜色
		    	if(data.hideColorsCn) {
		    		$("#colorCn").hide();
		    	} else {
		    		$("#colorCn").find(".colorCnTitle").html(data.colorsCnTitle);
			    	if(data.colorsCn) {
			    		var colorArray = JSON.parse(data.colorsCn);
				    	var colorHtmlArray = [];
				    	var colorHtml;
				    	for(var i = 0; i < colorArray.length; ++i) {
				    		colorHtml = "<div class='colorImg'>" +
				    					"<img src='" + colorArray[i][colorImgPath] + "' title='" + colorArray[i].imgColorCnTitle + "' alt='" + colorArray[i].imgColorCnAlt + "'>" +
				    					"<div class='colorName'>" + colorArray[i].colorCnName +"</div>" +
				    					"</div>";
				    		colorHtmlArray[colorHtmlArray.length] = colorHtml;
				    	}
				    	$("#colorCn").find(".colorCnList").html(colorHtmlArray.join(""));
			    	} else {
			    		$("#colorCn").find(".colorCnList").html("no data");
			    	}
		    	}
		    	
		    	
		    	//版本
		    	if(data.hideEditionCn) {
		    		$("#edition").hide();
		    	} else {
		    		$("#edition").find(".editionTitle").html(data.editionTitle);
			    	if(data.editionList) {
			    		var editionArray = JSON.parse(data.editionList);
				    	var editionHtmlArray = [];
				    	var editionHtml;
				    	for(var k = 0; k < editionArray.length; ++k) {
				    		editionHtml = "<div class='editionInfo'>" +
				    					  editionArray[k].editionInfo +
			    						  "</div>";
				    		editionHtmlArray[editionHtmlArray.length] = editionHtml;
				    	}
				    	$("#edition").find(".editionList").html(editionHtmlArray.join(""));
			    	} else {
			    		$("#edition").find(".editionList").html("no data");
			    	}
			    	
			    	if($(".editionList").find(".editionInfo").length == 2) {
			    		$(".product-specs-cn").find(".editionList").css("justify-content","space-around");
			    	} else if($(".editionList").find(".editionInfo").length == 1) {
			    		$(".product-specs-cn").find(".editionList").css("justify-content","left");
			    	}
		    	}
		    	
		    	
		    	//外观
		    	if(data.hideAppearanceCn) {
		    		$("#appearance").hide();
		    	} else {
		    		$("#appearance").find(".appearanceTitle").html(data.appearanceTitle);
			    	$("#appearance").find(".longInfo").html(data.longInfo);
			    	$("#appearance").find(".widthInfo").html(data.widthInfo);
			    	$("#appearance").find(".thickInfo").html(data.thickInfo);
			    	$("#appearance").find(".appearanceImg").html(
			    			"<img src='" + appearanceImg + "' title='" + data.imgAppearTitle + "' alt='" + data.imgAppearAlt + "'/>"
			    	);
			    	$("#appearance").find(".weightTitle").html(data.weightName);
			    	$("#appearance").find(".weightInfo").html(data.weightInfo);
			    	$("#appearance").find(".marketDateTitle").html(data.marketDateName);
			    	$("#appearance").find(".marketDateInfo").html(data.marketDateInfo);
			    	$("#appearance").find(".appearanceRemark").html(data.appearanceRemark);
		    	}
		    	
		    	
		    	//系统
		    	if(data.hideSystemCn) {
		    		$("#system").hide();
		    	} else {
		    		$("#system").find(".systemTitle").html(data.systemTitle);
			    	$("#system").find(".systemList").html(data.systemInfo);
		    	}
		    	
		    	
		    	//蜂窝网络参数
		    	if(data.hideNetworkCn) {
		    		$("#network").hide();
		    	} else {
		    		$("#network").find(".networkTitle").html(data.networkTitle);
			    	if(data.networkLists) {
			    		var networkArray = JSON.parse(data.networkLists);
				    	var networkHtmlArray = [];
				    	var networkHtml;
				    	for(var l = 0; l < networkArray.length; ++l) {
				    		networkHtml = "<div class='networkInfo contentInfo'>" +
			    						  "<span class='listTitle'>" + networkArray[l].listTitle + "</span>" +
			    						  "<span class='listContent'>" + networkArray[l].listInfo + "</span>" +
			    						  "</div>";
				    		networkHtmlArray[networkHtmlArray.length] = networkHtml;
				    	}
				    	$("#network").find(".networkList").html(networkHtmlArray.join(""));
			    	} else {
			    		$("#network").find(".networkList").html("no data");
			    	}
		    	}
		    	
		    	
		    	//运行参数
		    	if(data.hideRunCn) {
		    		$("#run").hide();
		    	} else {
		    		$("#run").find(".runTitle").html(data.runTitle);
			    	if(data.runLists) {
			    		var runArray = JSON.parse(data.runLists);
				    	var runHtmlArray = [];
				    	var runHtml;
				    	for(var m = 0; m < runArray.length; ++m) {
				    		runHtml = "<div class='runInfo contentInfo'>" +
			    						  "<span class='listTitle'>" + runArray[m].listRunTitle + "</span>" +
			    						  "<span class='listContent'>" + runArray[m].listRunInfo + "</span>" +
			    						  "</div>";
				    		runHtmlArray[runHtmlArray.length] = runHtml;
				    	}
				    	$("#run").find(".runList").html(runHtmlArray.join(""));
			    	} else {
			    		$("#run").find(".runList").html("no data");
			    	}
		    	}
		    	
		    	
		    	//显示参数
		    	if(data.hideDisplayCn) {
		    		$("#display").hide();
		    	} else {
		    		$("#display").find(".displayTitle").html(data.displayTitle);
			    	$("#display").find(".displayImg").html(
		    			"<img src='" + displayImg + "' title='" + data.imgDisplayTitle + "' alt='" + data.imgDisplayAlt + "'/>"
			    	);
			    	$("#display").find(".displaySize").html(data.displaySize);
			    	$("#display").find(".displayInfo").html(data.displayInfo);
		    	}
		    	
		    	
		    	//传感器参数
		    	if(data.hideSensorCn) {
		    		$("#sensor").hide();
		    	} else {
		    		$("#sensor").find(".sensorTitle").html(data.sensorTitle);
			    	if(data.sensorLists) {
			    		var sensorArray = JSON.parse(data.sensorLists);
				    	var sensorHtmlArray = [];
				    	var sensorHtml;
				    	for(var n = 0; n < sensorArray.length; ++n) {
				    		sensorHtml = "<div class='sensorInfo contentInfo'>" +
			    						  "<span class='listTitle'>" + sensorArray[n].listTitle + "</span>" +
			    						  "<span class='listContent'>" + sensorArray[n].listInfo + "</span>" +
			    						  "</div>";
				    		sensorHtmlArray[sensorHtmlArray.length] = sensorHtml;
				    	}
				    	$("#sensor").find(".sensorList").html(sensorHtmlArray.join(""));
			    	} else {
			    		$("#sensor").find(".sensorList").html("no data");
			    	}
		    	}
		    	
		    	
		    	//拍照/摄像
		    	if(data.hidePhotographCn) {
		    		$("#photograph").hide();
		    	} else {
		    		$("#photograph").find(".photographTitle").html(data.photographTitle);
			    	if(data.photographLists) {
			    		var photographArray = JSON.parse(data.photographLists);
				    	var photographHtmlArray = [];
				    	var photographHtml;
				    	for(var b = 0; b < photographArray.length; ++b) {
				    		photographHtml = "<div class='photographInfo contentInfo'>" +
			    						  "<span class='listTitle'>" + photographArray[b].listTitle + "</span>" +
			    						  "<span class='listContent'>" + photographArray[b].listInfo + "</span>" +
			    						  "</div>";
				    		photographHtmlArray[photographHtmlArray.length] = photographHtml;
				    	}
				    	$("#photograph").find(".photographList").html(photographHtmlArray.join(""));
			    	} else {
			    		$("#photograph").find(".photographList").html("no data");
			    	}
		    	}
		    	
		    	
		    	//导航/无线
		    	if(data.hideWirelessCn) {
		    		$("#wireless").hide();
		    	} else {
		    		$("#wireless").find(".wirelessTitle").html(data.wirelessTitle);
			    	if(data.wirelessLists) {
			    		var wirelessArray = JSON.parse(data.wirelessLists);
				    	var wirelessHtmlArray = [];
				    	var wirelessHtml;
				    	for(var d = 0; d < wirelessArray.length; ++d) {
				    		wirelessHtml = "<div class='wirelessInfo contentInfo'>" +
			    						  "<span class='listTitle'>" + wirelessArray[d].listTitle + "</span>" +
			    						  "<span class='listContent'>" + wirelessArray[d].listInfo + "</span>" +
			    						  "</div>";
				    		wirelessHtmlArray[wirelessHtmlArray.length] = wirelessHtml;
				    	}
				    	$("#wireless").find(".wirelessList").html(wirelessHtmlArray.join(""));
			    	} else {
			    		$("#wireless").find(".wirelessList").html("no data");
			    	}
		    	}
		    	
		    	
		    	//电池/待机
		    	if(data.hideBatteryCn) {
		    		$("#battery").hide();
		    	} else {
		    		$("#battery").find(".batteryTitle").html(data.batteryTitle);
			    	if(data.batteryLists) {
			    		var batteryArray = JSON.parse(data.batteryLists);
				    	var batteryHtmlArray = [];
				    	var batteryHtml;
				    	for(var f = 0; f < batteryArray.length; ++f) {
				    		batteryHtml = "<div class='batteryInfo contentInfo'>" +
			    						  "<span class='listTitle'>" + batteryArray[f].listTitle + "</span>" +
			    						  "<span class='listContent'>" + batteryArray[f].listInfo + "</span>" +
			    						  "</div>";
				    		batteryHtmlArray[batteryHtmlArray.length] = batteryHtml;
				    	}
				    	$("#battery").find(".batteryList").html(batteryHtmlArray.join(""));
			    	} else {
			    		$("#battery").find(".batteryList").html("no data");
			    	}
		    	}
		    	
		    	
		    	//接口
		    	if(data.hideInterfaceCn) {
		    		$("#interface").hide();
		    	} else {
		    		$("#interface").find(".interfaceTitle").html(data.interfaceTitle);
			    	if(data.interfaceLists) {
			    		var interfaceArray = JSON.parse(data.interfaceLists);
				    	var interfaceHtmlArray = [];
				    	var interfaceHtml;
				    	for(var h = 0; h < interfaceArray.length; ++h) {
				    		interfaceHtml = "<div class='interfaceInfo contentInfo'>" +
			    						  "<span class='listTitle'>" + interfaceArray[h].listTitle + "</span>" +
			    						  "<span class='listContent'>" + interfaceArray[h].listInfo + "</span>" +
			    						  "</div>";
				    		interfaceHtmlArray[interfaceHtmlArray.length] = interfaceHtml;
				    	}
				    	$("#interface").find(".interfaceList").html(interfaceHtmlArray.join(""));
			    	} else {
			    		$("#interface").find(".interfaceList").html("no data");
			    	}
		    	}
		    	
		    	//其他模块
		    	if(data.otherModularLists) {
		    		var modularLists = JSON.parse(data.otherModularLists);
		    		var modularArray = [];
		    		var modularHtml;
		    		for(var o = 0; o < modularLists.length; ++o) {
		    			modularHtml = "<div class='block'>" +
		    				"<div class='wrap'>" +
		    				"<div class='title'>" + modularLists[o].modularTitle + "</div>" +
		    				"<div class='contentList overInfoList'>" +
		    				modularLists[o].modularInfo +
		    				"</div>" +
		    				"</div>" +
		    				"</div>"
	    				
	    				modularArray[modularArray.length] = modularHtml;		
		    		}
		    		$(".product-specs-cn").append(modularArray.join(""));
		    	}
	    	}
	    })
	}
});
/**
 * 隐私问题组件 V3版本
 * Author：Bruce
 * Time：2019-12-23
 */
(function(){
	$(function(){
		if($('.private-question-component-v3').length==0){
			return;
		}
		var elecSubmitApi = $(".conv3_contact_email.conv3_contact_module").data('elec-submit-api') ? $(".conv3_contact_email.conv3_contact_module").data('elec-submit-api') : "https://consumer-api-sg.huawei.com/cuepf/publicservices/service/privacy/apply";
	    var elecePicApi = $(".conv3_contact_email.conv3_contact_module").data('elec-pic-api') ? $(".conv3_contact_email.conv3_contact_module").data('elec-pic-api') : "https://consumer-api-sg.huawei.com/cuepf/servlet/activity/authImage";
	    var elecSessionApi = $(".conv3_contact_email.conv3_contact_module").data('elec-session-api') ? $(".conv3_contact_email.conv3_contact_module").data('elec-session-api') : "https://consumer-api-sg.huawei.com/cuepf/publicservices/service/validate/sessionuuid";
	    var mktSubmitApi = $(".conv3_contact_email.conv3_contact_module").data('mkt-submit-api') ? $(".conv3_contact_email.conv3_contact_module").data('mkt-submit-api') : "https://consumer.huawei.com/cmkt/servlet/common?method=sendPrivacyImgEmail";
	    var mktPicApi = $(".conv3_contact_email.conv3_contact_module").data('mkt-pic-api') ? $(".conv3_contact_email.conv3_contact_module").data('mkt-pic-api') : "https://consumer.huawei.com/cmkt/servlet/authMage";
	    var mktSessionApi = $(".conv3_contact_email.conv3_contact_module").data('mkt-session-api') ? $(".conv3_contact_email.conv3_contact_module").data('mkt-session-api') : "https://consumer.huawei.com/cmkt/services/service/commonService/sessionuuid";
	    var countrylistJson = $(".conv3_contact_email.conv3_contact_module").data('countrylist-json') ? $(".conv3_contact_email.conv3_contact_module").data('countrylist-json') : "//consumer.huawei.com/content/dam/huawei-cbg-site/en/worldwide/js/privacy-question-region.json";
	    (function() {
	        $.getJSON(countrylistJson, function(result) {
	            var region_area = null;
	            var $ag = result["allsites"]
	            $("#question_area").empty();
	            for (var i = 0; i < $ag.length; i++) {
	                var Submission = $ag[i].Submission ? $ag[i].Submission : "";
	                var contactdpo = $ag[i].ShowDPO ? $ag[i].ShowDPO : "";
	                var huaweihkservice = $ag[i].ShowAddress ? $ag[i].ShowAddress : "";
	                $("#question_area").append("<li style='display: none;' data-dpo='"+contactdpo+"' data-service-address='"+huaweihkservice+"' data-submit='" + Submission + "' data-placeId='" + $ag[i].id + "' data-mkt-placeId='" + $ag[i].cmktId + "' data-earaId='" + $ag[i].earaId + "'>" + $ag[i].site + "</li>")
	                if ($ag[i].cmktId == honorConfig.siteCode) {
	                    $(".question_area span").text($ag[i].site);
	                    $(".question_area li[data-placeId='" + $ag[i].id + "']").addClass("current");
	                    region_area = $ag[i].earaId;
	                }
	            }
	            if (honorConfig.siteCode == "uk" && $("#question_area li.current").attr("data-placeid") == "uk") {
	                $(".private-question-business-Choose li[data-businessid='6']").show();
	            } else {
	                $(".private-question-business-Choose li[data-businessid='6']").hide();
	            }
	            $(".question_area li[data-earaId='" + region_area + "']").show();
	            $("#region_area").empty();
	            var $rg = result["allarea"];
	            if ($rg) {
	                for (var i = 0; i < $rg.length; i++) {
	                    $("#region_area").append("<li data-earaId='" + $rg[i].earaId + "'>" + $rg[i].eara + "</li>");
	                }
	            }
	            if (region_area != null) {
	                $(".region_area_selector span").text($(".region_area_selector li[data-earaId='" + region_area + "']").text());
	                $(".region_area_selector li[data-earaId='" + region_area + "']").addClass("current");
	            }
	
	        });
	    })();
	    $(function() {
	        getCsrf();
	    })
	    /*判断是否为cmkt提交*/
	    function getMktsubmit() {
	        if ($("#question_area li.current").attr("data-submit") == "cmkt" || $(".private-question-subject-Choose li.choocked").attr("data-mkts") == "true") {
	            return true;
	        } else {
	            return false;
	        }
	    };
	
	    function getCsrf() {
	        $.ajax({
	            type: 'get',
	            url: elecSessionApi,
	            success: function(res) {
	                var _csrf = res._csrf;
	                $("#csrf").val(_csrf);
	            }
	        })
	        $.ajax({
	            type: 'get',
	            dataType: "jsonp",
	            jsonp: "jsonp",
	            url: delApi(mktSessionApi),
	            success: function(res) {
	                var sessionuuid = res.sessionuuid;
	                $("#sessionuuid").val(sessionuuid);
	            }
	        })     
	    };
	
	    function identify() {
	        var _csrf = $("#csrf").val();
	        var sessionuuid = $("#sessionuuid").val();
	        if (getMktsubmit()) {
	            $("#authMage").attr("src", delApi(mktPicApi) + '?sessionuuid=' + sessionuuid + '&tm=' + Math.random());
	        } else {
	            $("#authMage").attr("src", elecePicApi + '?_csrf=' + _csrf + '&tm=' + Math.random());
	        }
	    };
	    /*下拉框切换*/
	    $(function() {
	        $(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").find('.select').on('click', function(ev) {
	            var defs = {
	                'tabView': undefined,
	                'tabClass': 'current',
	                'tabChangeTitle': true
	            };
	            var isTabView = function() {
	                return defs.tabView == 'both' || (defs.tabView && defs.tabView.indexOf(viewType()) > -1);
	            };
	            if (isTabView()) return;
	            var thisSelect = $(this),
	                thisOl = thisSelect.find('ol'),
	                siblingsSelect = $(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").find('.select').not($(this));
	            if (thisSelect.hasClass('disable')) return;
	            if (thisOl.data('slide') == 'open') {
	                thisOl.slideUp(250, function() {
	                    thisOl.data('slide', 'close');
	                });
	                thisSelect.find('span').removeClass('active');
	            } else {
	                thisOl.slideDown(250, function() {
	                    thisOl.data('slide', 'open');
	                });
	                thisSelect.find('span').addClass('active');
	            }
	            siblingsSelect.find('ol').slideUp(250, function() {
	                $(this).data('slide', 'close');
	            });
	            siblingsSelect.find('span').removeClass('active');
	        });
	        $(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").off('click.compareItem', 'li').on('click.compareItem', 'li', function(ev) {
	            var defs = {
	                'tabView': undefined,
	                'tabClass': 'current',
	                'tabChangeTitle': true
	            };
	            var isTabView = function() {
	                return defs.tabView == 'both' || (defs.tabView && defs.tabView.indexOf(viewType()) > -1);
	            };
	            var thisLi = $(this),
	                thisSpan = thisLi.parents('.select').eq(0).find('span'),
	                sText = thisLi.text(),
	                spText = thisSpan.text();
	            if (isTabView()) {
	                thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass);
	            } else {
	                thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass).parents('.select').eq(0).find('ol').slideUp(250, function() {
	                    $(this).data('slide', 'close');
	                });
	            }
	            thisSpan.removeClass('active');
	            defs.tabChangeTitle && thisSpan.text(sText);
	            if (sText != spText) selectLifun(thisLi, thisLi.attr('f'));
	            $(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").trigger('selected', {
	                'val': sText,
	                '_mark': thisLi.parents('ol').eq(0).attr('_mark')
	            });
	            partOneChecked () ;
	        });
	    });
	
	
	    /*问题反馈数字*/
	    $("#email_question").keyup(function() {
	        $(".input_number").text($(this).val().length);
	    }).mousemove(function() {
	        $(".input_number").text($(this).val().length);
	    });
	    /*邮箱验证*/
	    window.checkToMailFillContent = function(obj) {
	        var _isErrors = false;
	        if (!$(obj).val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)) {
	            $(obj).next("p").show();
	            _isErrors = true;
	        } else {
	            $(obj).next("p").hide();
	        }
	        return _isErrors;
	    }
	    /*hw账号验证*/
	    window.checkHWidContent = function(obj) {
	        var _isErrors = false;
	        if ($(obj).val() != "") {
	            if($(obj).val().indexOf("@") !=-1){
	                if (!($(obj).val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)) ){
	                    $(obj).next("p").show();
	                    _isErrors = true;
	                }else{
	                    
	                }
	            }else{
	                if (!($(obj).val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)) && !checkHWidPhone($(obj).val())) {
	                    $(obj).next("p").show();
	                    _isErrors = true;
	                } else {
	                }
	            }
	        } else {
	                $(obj).next("p").show();
	                _isErrors = true;
	        }
	        return _isErrors;
	    }
	    /*hw账号电话验证*/
	    function checkHWidPhone(number) {
	        var result = true;
	        if ($("#question_area li.current").attr("data-placeId") && $("#question_area li.current").attr("data-placeId").toUpperCase() == "CN") {
	            var regex = /^1[3456789]\d{9}$/;
	            result = regex.test(number)
	        }
	        return result
	    }
	
	    $(document).on("blur", ".conv3_form_module input, .conv3_form_module textarea", function() {
	        $(this).next("p").hide();
	        $("#email_submit_result_tip,#email_send_result_status").hide();
	        !$(this).val() && $(this).next("p").show();
	        if ($(this).attr('data-name') == 'email') {
	            checkToMailFillContent($(this));
	        }
	        if ($(this).attr('data-name') == 'huawei_ID') {
	            checkHWidContent($(this));
	        }
	        if ($(this).attr('data-name') == 'code') {
	            $("#authMage").next("label").next("p").hide()
	            if ($.trim($(this).val()).length != 4) {
	                $("#authMage").next("label").next("p").show();
	            }
	        }
	    }).on("focus", ".conv3_form_module input", function() {
	        $("#email_submit_result_tip,#email_send_result_status").hide()
	        $(this).siblings("label").addClass("input-label-top");
	        $('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
	    }).on("focus", ".conv3_form_module textarea", function() {
	        $("#email_submit_result_tip,#email_send_result_status").hide()
	        $(this).siblings("label").addClass("comments-input-label-top");
	        $('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
	    }).on("blur", ".conv3_form_module input", function() {
	        if (!$(this).val()) {
	            $(this).siblings("label").removeClass("input-label-top");
	        }
	    }).on("blur", ".conv3_form_module textarea", function() {
	        if (!$(this).val()) {
	            $(this).siblings("label").removeClass("comments-input-label-top");
	        }
	    }).on("click", ".conv3_form_module .input-label, .conv3_form_module .comments-input-label", function() {
	        $(this).siblings("input,textarea").focus();
	    });
	   
	    $("#question_area").on("click", "li", function() {
	        setTimeout(function() {
	            identify();
	        }, 500);
	        if (honorConfig.siteCode == "uk") {          
	            if ($(this).attr('data-placeid') == "uk") {
	                $(".private-question-business-Choose li[data-businessid='6']").show();
	            } else {
	                $(".private-question-business-Choose li[data-businessid='6']").removeClass("current").hide();                          
	            }   
	        }
	        AllClearData();
	    })
	    $("#region_area").on("click","li",function(){			
	         $(".question_area li").hide();   
	         $(".question_area li").removeClass("current");  
	         $(".question_area span").text($(".conv3_contact_email").attr("data-country-text")+" *")	
	         $(".question_area li[data-earaId='"+$(this).attr('data-earaId')+"']").show();       	
		})         
	
		$(".verify-picture #authMage,.verify-picture .hicon-fresh").click(function(){
			identify();
		})
		
	    $("#email_submit").click(emailSubmit);
	    /* emailSubmit 提交*/
	    function emailSubmit() {
	        if($(this).hasClass("disabled")){
	            return;
	        }
	        var email_question_category = $("#question_category").attr("data-hidden") == "true" ? $("#question_category li.current").text() : $("#question_category").val();
	        var email_name = "N/A";
	        var email_surname = "N/A";
	        var email_address = $("#email_address").val();
	        var  private_subject_text= $(".private-question-Choose>li.choocked").attr("title") ;
	        var email_subject = getMktsubmit() ? private_subject_text : $(".private-question-Choose>li.choocked").attr("data-type");
	        var email_question = $("#email_question").val().replace(/"/g, "'").replace("["," ").replace("]"," ");
	        var validate_code = $("#validate_code").val();
	        var businessType = $(".private-question-business-Choose li.choocked").attr('title');
	        var huaweiId = $('#email_huawei_id:visible').length ? $("#email_huawei_id").val() : "";
	        var onlineData = {
	            siteCode: honorConfig.siteCode,
	            countryCode: $("#question_area li.current").attr("data-placeId").toUpperCase(),
	            _csrf: $("#csrf").val(),
	            category: email_question_category,
	            firstName: email_name,
	            lastName: email_surname,
	            email: email_address,
	            subject: email_subject,
	            comments: email_question,
	            validateCode: validate_code,
	            businessType: $(".private-question-business-Choose li.choocked").attr("data-businessid"),
	            huaweiId: huaweiId,
	            applicantRole:"10"  // 荣耀消费者
	        };
	        var mktData = {
	            siteCode: $("#question_area li.current").attr("data-mkt-placeId")+"-h",  //荣耀sitecode
	            country: $("#question_area li.current").text(),
	            area: $("#region_area li.current").text(),
	            sessionuuid: $("#sessionuuid").val(),
	            category: email_question_category,
	            firstName: email_name,
	            lastName: email_surname,
	            email: email_address,
	            subject: email_subject,
	            content: email_question,
	            authCode: validate_code,
	            businessType: businessType,
	            huaweiId: huaweiId
	        };
	        getConfirmationPanel({
	            title: $("#reminderText").val(),
	            content: $("#confirmationContent").val(),
	            okStr: $("#confirmText").val(),
	            cancelStr: $("#cancelText").val(),
	            iconClass: "icon-warin"
	        }, function() {
	            if (getMktsubmit()) {
	                mktDateSubmit(mktData);
	            } else {
	                onlineDateSubmit(onlineData);
	            }
	        }, function() {
	            $('#email_submit').removeClass("s-btn s-disabled");
	        })
	    }
	    var html = "<div class='loading_mask'><img alt='gif' src='/etc/designs/huawei-cbg-site/images/common/img_con_mask_waite.gif'/></div>";
	    /* 平台电子流提交*/
	    function onlineDateSubmit(onlineData) {
	        $("body").append(html)
	        $(".loading_mask").show();
	        if ($("#question_area li.current").attr("data-placeId").toUpperCase() == "UK")
	            onlineData.countryCode = "GB";
	        $.ajax({
	            url: elecSubmitApi,
	            data: JSON.stringify(onlineData),
	            contentType: "application/json; charset=UTF-8",
	            type: "POST",
	            success: function(data) {
	                privacyCallback(data)
	            },
	            error: function(error) {},
	            complete: function() {}
	        });
	    }
	    /* mkt 隐私政策邮件提交*/
	    function mktDateSubmit(mktData) {
	        $("body").append(html)
	        $(".loading_mask").show();
	        $.ajax({
	            url: delApi(mktSubmitApi),
	            data: mktData,
	            type: "POST",
	            success: function(data) {
	                $(".loading_mask").hide();
	                privacyCallback(data)
	            },
	            error: function(error) {},
	            complete: function() {}
	        });
	    }
	
	    /*提交后数据回调*/
	    function privacyCallback(data) {
	        $(".loading_mask").remove();
	        if (data.resCode == "0") {
	            $(".conv3_contact_email input,.conv3_contact_email textarea").not("#csrf").not("#question_category").not("#sessionuuid").val("");
	            if ($("#question_category").attr("data-hidden") == "true") {
	                $("#question_category").prev("span").text($("#selectQueCat").val() + "*");
	            }
	            if ($(".question_area li[data-mkt-placeid='" + honorConfig.siteCode + "']").length) {
	                var currunt_area = $(".question_area li[data-mkt-placeid='" + honorConfig.siteCode + "']").attr("data-earaid")
	                $("#question_area").prev("span").text($(".question_area li[data-mkt-placeid='" + honorConfig.siteCode + "']").text());
	                $(".question_area li[data-mkt-placeid='" + honorConfig.siteCode + "']").addClass("current").siblings('li').removeClass("current");
	
	                $(".question_area li").hide();
	                $(".question_area li[data-earaid='" + currunt_area + "']").show();
	                $(".question_area li[data-mkt-placeid='" + honorConfig.siteCode + "']").addClass("current").siblings('li').removeClass("current");
	                $("#region_area").prev("span").text($(".region_area li[data-earaid='" + currunt_area + "']").text());
	                $(".region_area li[data-earaid='" + currunt_area + "']").addClass("current").siblings('li').removeClass("current");
	            } else {
	                $("#region_area").prev("span").text($("#areaText").val() + "*");
	                $("#question_area").prev("span").text($("#countryText").val() + "*");
	                $(".region_area li").removeClass("current");
	                $(".question_area li").removeClass("current");
	            }
	            if (honorConfig.siteCode == "uk" && $("#question_area li.current").attr("data-placeid") == "uk") {
	                $("#email_business li[data-businessid='6']").show();
	            } else {
	                $("#email_business li[data-businessid='6']").hide();
	            }
	
	            AllClearData();
	
	            getOKResult({
	                title: $("#successfullyText").val(),
	                content: $("#sucessContent").val(),
	                okStr: $("#confirmText").val(),
	                iconClass: "icon-warin"
	            }, function() {})
	        } else if (data.resCode == "91") {
	            $("#email_submit_result_tip").show().text($("#returnCodeTips21").val());                  
	            getOKResult({
	                title: $("#failedText").val(),
	                content: $("#failedContent").val(),
	                okStr: $("#confirmText").val(),
	                iconClass: "icon-warin"
	            }, function() {})
	        } else if (data.resCode == "92") {
	            $("#email_submit_result_tip").show().text($("#returnCodeTips21").val());        
	            getOKResult({
	                title: $("#failedText").val(),
	                content: $("#failedContent").val(),
	                okStr: $("#confirmText").val(),
	                iconClass: "icon-warin"
	            }, function() {})
	        } else {                     
	            getOKResult({
	                title: $("#failedText").val(),
	                content: $("#failedContent").val(),
	                okStr: $("#confirmText").val(),
	                iconClass: "icon-warin"
	            }, function() {})
	        }
	        identify();
	    }
	
	    function selectLifun(obj, type) {
	        if (type == 0) {
	            topSearchFilter(obj)
	        } else if (type == 1) {
	            selectProductCompare(obj)
	        }
	    };
	
	    function delApi(api) {
	        if (window.location.protocol.indexOf("https") > -1) {
	            api = api.replace("http:", "https:");
	        }
	        return api;
	    }
	    /*是否提交弹框*/
	    function getConfirmationPanel(config, okCallback, cancelCallback) {
	        // okStr , cancelStr , title , iconClass 
	        var content =
	            "<div class='s-dialog privacy-warm-tips'>" +
	            "   <div class='s-content-dialog'>" +
	            "       <div class='s-dialog-title'>" +
	            "           <h3><span class='" + config.iconClass + "'></span>" + config.title + "</h3>" +
	            "       </div><div class='s-dialog-content'>" + config.content +
	            "       </div><div class='s-dialog-btn'>" +
	            "           <a title=" + config.cancelStr + " class='s-btn s-cancel-btn'>" + config.cancelStr + "</a>" +
	            "           <a title=" + config.okStr + " class='s-btn s-ok-btn'>" + config.okStr + "</a>" +
	            "       </div>" +
	            "   </div>" +
	            "</div>";
	        $("body").append(content);
	        setTimeout(function() {
	            $(".s-dialog .s-content-dialog").toggleClass("s-show");
	        }, 0);
	        $(".s-dialog .s-ok-btn").click(function() {
	            $(".s-dialog .s-content-dialog").toggleClass("s-show");
	            setTimeout(function() {
	                $("body > .s-dialog").remove();
	                okCallback && okCallback();
	            }, 500);
	        });
	        $(".s-dialog .s-cancel-btn").click(function() {
	            $(".s-dialog .s-content-dialog").toggleClass("s-show");
	            setTimeout(function() {
	                $("body > .s-dialog").remove();
	                cancelCallback && cancelCallback();
	            }, 500);
	        });
	    }
	
	    function getOKResult(config, okCallback) {
	        var content =
	            "<div class='s-dialog privacy-warm-tips'>" +
	            "   <div class='s-content-dialog'>" +
	            "       <div class='s-dialog-title'>" +
	            "           <h3><span class='" + config.iconClass + "'></span>" + config.title + "</h3>" +
	            "       </div><div class='s-dialog-content'>" + config.content +
	            "       </div><div class='s-dialog-btn'>" +
	            "           <a title=" + config.okStr + " class='s-btn s-ok-btn'>" + config.okStr + "</a>" +
	            "       </div>" +
	            "   </div>" +
	            "</div>";
	        $("body").append(content);
	        setTimeout(function() {
	            $(".s-dialog .s-content-dialog").toggleClass("s-show");
	        }, 0);
	        $(".s-dialog .s-ok-btn").click(function() {
	            $(".s-dialog .s-content-dialog").toggleClass("s-show");
	            setTimeout(function() {
	                $("body > .s-dialog").remove();
	                okCallback && okCallback();
	            }, 500);
	        });
	    }
	
	    /* part-one 切换 */
	    $(".private-question-business-continue").on("click", function() {
	        if($(this).hasClass("disabled")){
	            return;
	        };
	        $(this).parents(".private-question-part").removeClass("current");
	        $(".private-question-business-checked .private-question-business-h2").text($(".private-question-business-Choose li.choocked").find(".private-question-business-h2").text());
	        $(".private-question-business-checked .private-question-business-h3").text($(".private-question-business-Choose li.choocked").find(".private-question-business-h3").text());
	        $(".private-question-business-checked").attr("data-businessid",$(".private-question-business-Choose li.choocked").attr("data-businessid"));
	        if( $(".private-question-business-checked").attr("data-businessid") == "1" && $("#question_area li.current").attr("data-placeid")  != "cn"){
	            $(".private-question-part-three").slideDown().addClass("current");
	        }else {
	            $(".private-question-part-two").slideDown().addClass("current");
	        }
	        if($("#question_area li.current").attr("data-dpo")  == "ContactDPO"){
	            $(".private-question-subject-Choose li[data-type='7']" ).show();
	        }else{
	            $(".private-question-subject-Choose li[data-type='7']" ).hide();
	        }
	        if($("#question_area li.current").attr("data-service-address")  == "huaweiHkService"){
	            $(".private-question-service-Choose .hk-service-address").show();
	            $(".private-question-service-Choose .contact-address").hide();
	        }else{
	            $(".private-question-service-Choose .hk-service-address").hide();
	            $(".private-question-service-Choose .contact-address").show();
	        }
	        parttwoChecked();
	        partthreeChecked();
	    })
	    $(".business-change").on("click", function() {
	        AllClearData ();  
	    })
	    function AllClearData() {
	        $(".private-question-part-one").addClass("current");
	        $(".private-question-part-two,.private-question-part-three,.private-question-part-four").hide().removeClass("current").removeClass("noAccount");
	        $(".private-question-subject-Choose li,.private-question-service-Choose li,.my-personal-list li").removeClass("choocked");
	        $(".private-question-business-Choose li").removeClass("choocked");
	        $(".private-question-business-checked .private-question-business-h2").text("");
	        $(".private-question-business-checked .private-question-business-h3").text("");
	        $(".private-question-part-four input,.private-question-part-four textarea").val("");
	        $(".email_address .Validation, .email_huawei_id .Validation").hide();
	        partOneChecked () ;
	    }
	
	    /* part-one活动选择 */
	    $(".private-question-business-Choose li").on("click", function() {
	        if(!$(this).hasClass("choocked")){
	            $(this).addClass("choocked").siblings().removeClass("choocked");
	        }
	        partOneChecked () ;
	
	    })
	
	    function partOneChecked () {
	    	if($(".private-question-business-Choose li.choocked").length> 0  && $("#question_area li.current").text() && $("#region_area li.current").text()){
	            $(".private-question-business-continue").removeClass("disabled");          
	    	}else {
	    		$(".private-question-business-continue").addClass("disabled");     
	    	}
	    }
	
	    /* part-two 切换 */
	    $(".private-question-subject-continue").on("click", function() {
	        if($(this).hasClass("disabled")){
	            return;
	        }
	
	        $(this).parents(".private-question-part").removeClass("current");
	        $(".private-question-subject-checked .private-question-subject-h2").text($(".private-question-subject-Choose li.choocked").find(".private-question-subject-h2").text());
	        $(".private-question-subject-checked .private-question-subject-h3").text($(".private-question-subject-Choose li.choocked").find(".private-question-subject-h3").text());
	        $(".private-question-subject-checked").attr("data-type",$(".private-question-subject-Choose li.choocked").attr("data-type"));
	        if($(".private-question-subject-Choose li.choocked").attr("data-mkts") ){
	            $(".private-question-subject-checked").attr("data-mkts",$(".private-question-subject-Choose li.choocked").attr("data-mkts"));
	        }else {
	            $(".private-question-subject-checked").removeAttr("data-mkts");
	        }
	        $(".private-question-part-four").slideDown().addClass("current");
	        partFourChecked ();
	        setTimeout(function() {
	            identify();
	        }, 500);
	        if( $(".private-question-business-checked").attr("data-businessid") == "4" || $(".private-question-business-checked").attr("data-businessid") == "3" ) {
	            $(".private-question-part-four .email_huawei_id").hide();
	            $(".private-question-part-four .acess-tips").hide();
	        }else {
	            $(".private-question-part-four .email_huawei_id").show();
	            $(".private-question-part-four .acess-tips").show();
	        }
	    })
	    $(".subject-change").on("click", function() {
	        $(this).parents(".private-question-part").addClass("current");
	        $(".private-question-part-four").hide().removeClass("current");
	        $(".email_address .Validation, .email_huawei_id .Validation").hide();
	    })
	
	    /* part-two 主问题类型选择 */
	    $(".private-question-subject-Choose li").on("click", function() {
	        if(!$(this).hasClass("choocked")){
	            $(this).addClass("choocked").siblings().removeClass("choocked");
	        }
	        parttwoChecked ();
	    })
	    function parttwoChecked () {
	        if($(".private-question-subject-Choose li.choocked").length> 0 ){
	                $(".private-question-subject-continue").removeClass("disabled");          
	        }else {
	            $(".private-question-subject-continue").addClass("disabled");     
	        }
	    }
	
	
	    /* part-four 切换 */
	    $(".conv3_contact_email input[placeholder],.conv3_contact_email textarea[placeholder],#email_huawei_id").keyup(function() {
	        partFourChecked ();
	    })
	
	
		function partFourChecked () {
		    var isError = false;
		    $("#email_question,#email_address,#validate_code").each(function() {
		        if($(this).val() == "") {
		            isError = true
		        }        
		    });
		    if($("#email_huawei_id:visible").length != 0){
		        if($("#email_huawei_id").val()==""){
		            isError = true
		        }
		        if($("#email_huawei_id").val() !="" && checkHWidContent($("#email_huawei_id"))) {
		            isError = true
		        }
		    }
		    if(!isError && !checkToMailFillContent($("#email_address"))){     
		        $("#email_submit").removeClass("disabled");   
		    }else{
		        $("#email_submit").addClass("disabled"); 
		    }
		
		}
	
	    /* part-three 切换 */
	    $(".private-question-service-continue").on("click", function() {
	        if($(this).hasClass("disabled")){
	            return;
	        }
	        $(this).parents(".private-question-part").removeClass("current");
	        $(".part-three-title").text($(".private-question-service-Choose>li.choocked").find(".private-question-service-h2").text());
	        if($(".private-question-service-Choose>li.choocked").hasClass("my-personal-options")){
	            var myPersonalTitle =$(".my-personal-title").length > 0 ? '<p class="service-checked-h2">'+$(".my-personal-title").text()+'</p>' :"";
	            $(".part-three-cnt").html(myPersonalTitle+'<p class="service-checked-h2">'+$(".my-personal-list li.choocked").find(".my-personal-h3").text()+'</p>')
	        }else {
	            $(".part-three-cnt").empty();
	        }
	        $(".private-question-subject-checked").attr("data-type",$(".private-question-subject-Choose li.choocked").attr("data-type"));
	
	        if($(".no-have-account.choocked").length > 0 ) {
	            $(".private-question-part-four").addClass("noAccount");
	        }else {
	            $(".private-question-part-four").removeClass("noAccount");
	        }
	        $(".private-question-part-four").slideDown().addClass('current');
	        partFourChecked ();
	        setTimeout(function() {
	            identify();
	        }, 500);
	        if( $(".private-question-business-checked").attr("data-businessid") == "5" || $(".private-question-business-checked").attr("data-businessid") == "3") {
	            $(".private-question-part-four .email_huawei_id").hide();
	            $(".private-question-part-four .acess-tips").hide();
	        }else {
	            if( !$(".private-question-part-four").hasClass("noAccount")){
	                $(".private-question-part-four .email_huawei_id").show();
	                $(".private-question-part-four .acess-tips").show();
	            }else {
	                $(".private-question-part-four .email_huawei_id").hide();
	                $(".private-question-part-four .acess-tips").hide();
	            }
	        }
	    })
	    $(".service-change").on("click", function() {
	        $(this).parents(".private-question-part").addClass("current");
	        $(".private-question-part-four").hide().removeClass("current");
	        $(".private-question-part-four input,.private-question-part-four textarea").val("");
	        $(".email_address .Validation, .email_huawei_id .Validation").hide();
	    })
	   /* part-three 阿斯比格选择 */
	   $(".private-question-service-Choose li").on("click", function() {
	        if(!$(this).hasClass("choocked")){
	            $(this).addClass("choocked").siblings().removeClass("choocked");
	            if(!$(".private-question-service-Choose>li.choocked").hasClass("my-personal-options") ){
	                $(".my-personal-list li").removeClass("choocked");
	            }
	        }
	        partthreeChecked ();
	    })
	    $(".my-personal-list li").on("click", function() {
	        if(!$(this).hasClass("choocked")){
	            $(this).addClass("choocked").siblings().removeClass("choocked");
	        }
	        partthreeChecked ();
	    })
	
	    function partthreeChecked () {
	        if($(".private-question-service-Choose li.choocked").length> 0){
	            if($(".private-question-service-Choose>li.choocked").hasClass("my-personal-options") ){
	                if($(".my-personal-list li.choocked").length > 0 ){
	                    $(".private-question-service-continue").removeClass("disabled");   
	                }else {
	                    $(".private-question-service-continue").addClass("disabled");      
	                }
	            }else {
	                $(".private-question-service-continue").removeClass("disabled");   
	            }
	        }else {
	            $(".private-question-service-continue").addClass("disabled");     
	        }
	   }
	
	
	});
	
}());
(function(){
	$(function(){
		if($('.private-question-component-v2').length==0){
			return;
		}
		var SITE_CODE = window.digitalData.page.pageInfo.siteCode;
		var elecSubmitApi = $(".conv3_contact_email.conv3_contact_module").data('elec-submit-api') ?  $(".conv3_contact_email.conv3_contact_module").data('elec-submit-api') : "https://consumer-api-sg.huawei.com/cuepf/publicservices/service/privacy/apply";
		var elecePicApi = $(".conv3_contact_email.conv3_contact_module").data('elec-pic-api') ? $(".conv3_contact_email.conv3_contact_module").data('elec-pic-api'):"https://consumer-api-sg.huawei.com/cuepf/servlet/activity/authImage";
		var elecSessionApi = $(".conv3_contact_email.conv3_contact_module").data('elec-session-api') ?  $(".conv3_contact_email.conv3_contact_module").data('elec-session-api') : "https://consumer-api-sg.huawei.com/cuepf/publicservices/service/validate/sessionuuid";   
		
		var mktSubmitApi = $(".conv3_contact_email.conv3_contact_module").data('mkt-submit-api') ?  $(".conv3_contact_email.conv3_contact_module").data('mkt-submit-api') :"https://consumer.huawei.com/cmkt/servlet/common?method=sendPrivacyImgEmail";
		var mktPicApi = $(".conv3_contact_email.conv3_contact_module").data('mkt-pic-api') ? $(".conv3_contact_email.conv3_contact_module").data('mkt-pic-api') :"https://consumer.huawei.com/cmkt/servlet/authMage";
		var mktSessionApi = $(".conv3_contact_email.conv3_contact_module").data('mkt-session-api') ?  $(".conv3_contact_email.conv3_contact_module").data('mkt-session-api') :"https://consumer.huawei.com/cmkt/services/service/commonService/sessionuuid";
		
		var countrylistJson = $(".conv3_contact_email.conv3_contact_module").data('countrylist-json') ? $(".conv3_contact_email.conv3_contact_module").data('countrylist-json'):"/content/dam/honor/global/legal/js/privacy-question-region.json";
		
		if($('.private-question-component-v2').length>0){
			
			// 获取国家及地区列表
			getCountryList();
			
			getCsrf();
			
			/*下拉框切换*/
			$(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").find('.select').on('click', function (ev) {
				var defs = { 'tabView': undefined, 'tabClass': 'current', 'tabChangeTitle': true };
				var isTabView = function () { return defs.tabView == 'both' || (defs.tabView && defs.tabView.indexOf(viewType()) > -1);};     
				if (isTabView()) return;
				var thisSelect = $(this),
				thisOl = thisSelect.find('ol'),
				//siblingsSelect = thisSelect.siblings('.select');
				siblingsSelect = $(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").find('.select').not($(this));
				if ( thisSelect.hasClass('disable') ) return;
				if (thisOl.data('slide') == 'open') {
					thisOl.slideUp(250, function () {thisOl.data('slide', 'close');});
					thisSelect.find('span').removeClass('active');
				} else {
					thisOl.slideDown(250, function () {thisOl.data('slide', 'open');});
					thisSelect.find('span').addClass('active');
				}
				siblingsSelect.find('ol').slideUp(250, function () {$(this).data('slide', 'close');});
				siblingsSelect.find('span').removeClass('active');
			});	
			$(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").off('click.compareItem','li').on('click.compareItem','li', function (ev) {
				var defs = { 'tabView': undefined, 'tabClass': 'current', 'tabChangeTitle': true };
				var isTabView = function () { return defs.tabView == 'both' || (defs.tabView && defs.tabView.indexOf(viewType()) > -1);};          
				var thisLi = $(this),
				thisSpan = thisLi.parents('.select').eq(0).find('span'),
				sText = thisLi.text(),
				spText = thisSpan.text();
				if (isTabView()) {
					thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass);
				} else {
					thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass).parents('.select').eq(0).find('ol').slideUp(250, function () { $(this).data('slide', 'close'); });
				}
				thisSpan.removeClass('active');
				defs.tabChangeTitle && thisSpan.text(sText);
				if(sText != spText){
					selectLifun(thisLi,thisLi.attr('f'));
				}
				$(".conv3_question_selector,.question_area_selector,.region_area_selector,.email_subject_selector,.email_business_selector").trigger('selected', { 'val': sText, '_mark': thisLi.parents('ol').eq(0).attr('_mark') });
			});
			
			/* subjectCategory下拉列表点击 
			var html = $(".email_subject>span").html();
			$(".email_subject li").click(function(){
				var type = $(this).attr("date-type");
				if(type == "7"){
					$(this).siblings().hide();
					$(".email_subject i#delete").css("display","block");
				}
			})*/
			
			/* subjectCategory下拉回选按钮 
			$(".email_subject i#delete").click(function(){
				$(this).hide();
				$(".email_subject>span").html(html);
				$(".email_subject li").show();
			})*/
			
			/*问题反馈数字*/
			$("#email_question").keyup(function(){
				$(".input_number").text($(this).val().length);
			}).mousemove(function(){
				$(".input_number").text($(this).val().length);
			});
			
			
			$(document).on("blur",".conv3_form_module input, .conv3_form_module textarea",function(){
				$(this).next("p").hide();
				$("#email_submit_result_tip,#email_send_result_status").hide()
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
				$('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
				!$(this).val() && $(this).next("p").show();
				if($(this).attr('data-name') == 'email'){
					window.checkToMailFillContent($(this));
				}
				if($(this).attr('data-name') == 'huawei_ID'){
					window.checkHWidContent($(this));
				}
				if($(this).attr('data-name') == 'code'){
					$("#authMage").next("label").next("p").hide()
					if($.trim($(this).val()).length != 4){
						$("#authMage").next("label").next("p").show();              
					}
				}
			}).on("focus",".conv3_form_module input",function(){      
				$("#email_submit_result_tip,#email_send_result_status").hide()
				$(this).siblings("label").addClass("input-label-top");
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
			}).on("focus",".conv3_form_module textarea",function(){
				$("#email_submit_result_tip,#email_send_result_status").hide()
				$(this).siblings("label").addClass("comments-input-label-top");
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
			}).on("blur",".conv3_form_module input",function(){
				if(!$(this).val()){
					$(this).siblings("label").removeClass("input-label-top");
				}
			}).on("blur",".conv3_form_module textarea",function(){
				if(!$(this).val()){
					$(this).siblings("label").removeClass("comments-input-label-top");
				}
			}).on("click",".conv3_form_module .input-label, .conv3_form_module .comments-input-label",function(){
				$(this).siblings("input,textarea").focus();
			});
			$("#question_category li").click(function () {
				$("#email_submit_result_tip,#email_send_result_status").hide();
				$("#email_submit_result_tip,#email_send_result_status").hide();
				$(this).parent().next("p").hide();
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
			});	
			$("#question_area").on("click","li",function(){	  
				setTimeout(function(){
					identify();
				},500);  	   
				$("#email_submit_result_tip,#email_send_result_status").hide();
				$("#question_area").next("p").hide();
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
				$('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
				// 选择UK时 展示UK community
				//data-placeid="uk"
				var areaTxt= $(this).attr('data-placeid');
				if(areaTxt=='uk'){
					$("#email_business li[date-businessid='6']").show();
				}else{
					$("#email_business li[date-businessid='6']").hide();
				}
			})
			//默认隐藏DPO
			$(".email_subject li[date-type='7']").hide();
			$("#region_area").on("click","li",function(){	
				$(".question_area li").hide();   
				$(".question_area li").removeClass("current");  
				$(".question_area span").text($(".conv3_contact_email").attr("data-country-text")+" *")	
				$(".question_area li[data-earaId='"+$(this).attr('data-earaId')+"']").show();   
				$(this).parent().next("p").hide();
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
				$('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
				//选择欧洲地区展示DPO
				var earaId=$(this).attr('data-earaId');
				if(earaId=="europe"){
					$(".email_subject li[date-type='7']").show();
				}else{
					$(".email_subject li[date-type='7']").hide();
				}
			})
			//默认隐藏 UK community
			$("#email_business li[date-businessid='6']").hide();
			$("#email_business").on("click","li",function(){      
				var fqaurl = $(this).attr('date-url');
				var businesstype = $(this).attr('date-type');
				if(fqaurl){
					$(".business_fqa").html(fqaurl).show();
				}else{
					$(".business_fqa").html("").hide();
				}	
				if(businesstype=="1"){
					$(".huawei_ID").show();
					$(".huawei_ID").find("label").text($(".conv3_contact_email").attr("data-huaweiID-text")+" *");	
					$("#huawei_ID").attr("date-must","yes");
				}else if(businesstype=="2"){
					$(".huawei_ID").show();
					$("#huawei_ID").attr("date-must","no");
					$(".huawei_ID").find("label").text($(".conv3_contact_email").attr("data-huaweiID-text"));
					$(".huawei_ID").find("p").hide();
				}else{
					$("#huawei_ID").attr("date-must","no");
					$(".huawei_ID").hide();
					$(".huawei_ID").find("label").text($(".conv3_contact_email").attr("data-huaweiID-text")+" *");
					$(".huawei_ID").find("p").hide();
				}
				$(this).parent().next("p").hide();
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
				$('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
			})
			
			$("#email_subject").on("click","li",function(){	  
				setTimeout(function(){
					identify();
				},500);  	   
				$("#email_submit_result_tip,#email_send_result_status").hide();
				$("#email_subject").next("p").hide();
				$('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
				$('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
			})
			
			$("#email_submit").click(emailSubmit);
			
			$('#authMage').click(function(){
				identify();
			})
			
		}
			
		
		// 获取国家及地区列表	
		function getCountryList(){
			$.getJSON(countrylistJson,function(result){
				var region_area = null ;        
				var $ag = result["allsites"]	
				$("#question_area").empty();
				for(var i=0; i < $ag.length; i++){
					var Submission = $ag[i].Submission ? $ag[i].Submission :"";
					$("#question_area").append("<li style='display: none;' data-submit='" + Submission + "' data-placeId='" + $ag[i].id+"' data-mkt-placeId='" + $ag[i].cmktId + "' data-earaId='" + $ag[i].earaId+ "'>" +  $ag[i].site + "</li>")
					if($ag[i].cmktId == SITE_CODE){
						$(".question_area span").text($ag[i].site);						
						$(".question_area li[data-placeId='"+$ag[i].id+"']").addClass("current");                  
						region_area = $ag[i].earaId;
						if($ag[i].id=='uk'){
							$("#email_business li[date-businessid='6']").show();
						}
					}
				}	
				$(".question_area li[data-earaId='"+region_area+"']").show();
				
				$("#region_area").empty();
				var $rg = result["allarea"];
				if($rg){
					for(var i=0; i < $rg.length; i++){
						$("#region_area").append("<li data-earaId='" + $rg[i].earaId+ "'>" +  $rg[i].eara + "</li>");				
					}
				}	
				if(region_area!=null){
					$(".region_area_selector span").text($(".region_area_selector li[data-earaId='"+region_area+"']").text());	
					$(".region_area_selector li[data-earaId='"+region_area+"']").addClass("current");
					//初始判断欧洲地区展示DPO
					var regionText=$(".region_area span").text();
					if(regionText=="Europe"){
						$(".email_subject li[date-type='7']").show();
					}else{
						$(".email_subject li[date-type='7']").hide();
					}
				}
				
			});
		}
		
		/*判断是否为cmkt提交*/
		function getMktsubmit(){
			if($("#question_area li.current").attr("data-submit") == "cmkt" || $("#email_subject li.current").attr("date-mkts") == "true"){                  
		        return true;
		    }else{                 
		        return false;
		    }		    
		};
		function getCsrf(){  
			$.ajax({
			    type:'GET',
			    dataType:"jsonp", 
			    jsonp: "jsonp",
		        url: elecSessionApi,	     
			    success:function(res){
			    	if(res){
			    		var _csrf = res._csrf;		
			    		$("#csrf").val(_csrf);
			    	}
			    }  
			})
		    $.ajax({
			    type:'GET',
		        dataType:"json",    
		        jsonp: "jsonp",
			    url:delApi(mktSessionApi),	           	
			    success:function(res){ 	
			    	if(res){
			    		var sessionuuid = res.sessionuuid;	
			    		$("#sessionuuid").val(sessionuuid);               
			    	}
			    }  
			})    
			setTimeout(function(){identify();},500);
		};
		function identify(){ 
			var _csrf = $("#csrf").val();
		    var sessionuuid = $("#sessionuuid").val();
		   
		    if(getMktsubmit()){
				 $("#authMage").attr("src",delApi(mktPicApi)+'?sessionuuid='+sessionuuid+'&tm='+Math.random());
		    }else{
		         $("#authMage").attr("src",elecePicApi+'?_csrf='+_csrf+'&tm='+Math.random());			
		    }
		};
		
		/*邮箱验证*/
		window.checkToMailFillContent = function(obj){
		    var _isErrors = false;
		    if ( !$(obj).val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/) ){
		        $(obj).next("p").show();
		        _isErrors = true;
		    }else{
		       $(obj).next("p").hide(); 
		    }
		    return _isErrors;
		};
		
		/*hw账号验证*/
		window.checkHWidContent = function(obj){	
		    var _isErrors = false; 
		    if($(obj).val()!=""){
				if (!($(obj).val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)) && !checkHWidPhone($(obj).val()) ){    
		            $(obj).next("p").show();
		            _isErrors = true;
		        }
		    }else{
		        if($("#huawei_ID").attr("date-must") == "yes"){
					$(obj).next("p").show();
		        	_isErrors = true;
		        }else{
					$(obj).next("p").hide(); 
		    	}
			}
		    return _isErrors;
		};
		/*hw账号电话验证*/
		function checkHWidPhone(number) {	  
		    var result = true;
		    if ($("#question_area li.current").attr("data-placeId") && $("#question_area li.current").attr("data-placeId").toUpperCase() == "CN") {
		        var regex = /^1[3456789]\d{9}$/;
		        result = regex.test(number);
		    }
		    return result;
		};
		
		/* emailSubmit 提交*/                                                                                                                    
		function emailSubmit() {
		    if ($("#email_submit").hasClass("s-disabled")) {
		        return;
		    }
			$("#email_submit_result_tip").empty()
			var isError=false;        
			$(".conv3_contact_email input[placeholder],.conv3_contact_email textarea[placeholder]").not("#huawei_ID").each(function(){
				$(this).next("p").hide();        
		        $('#email_submit').text($('#email_submit').attr('data-email-submit')).removeClass("adderror");
		        $('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
			 	if (!$(this).val() && $(this).next("p").length>0 ){
			 		$(this).next("p").show();
			 		isError=true;
			 	}	 		
			 	if($(this).next("p").length>0&&!$(this).next("p").is(':hidden')){
			 	    isError=true;
			 	}
			});       
			if($("#question_category").attr("data-hidden") == "true"){
		    	if (!$("#question_category li.current").text()){
		            $("#question_category").next("p").show();
		            isError=true;
				}
		    }
		    if (!$("#region_area li.current").text()){
				$("#region_area").next("p").show();
				isError=true;
			}
	
		    if (!$("#email_business li.current").text()){
				$("#email_business").next("p").show();
				isError=true;
			}
		    if (!$("#question_area li.current").text()){
				$("#question_area").next("p").show();
				isError=true;
			}
		    if($('.huawei_ID:visible').length){
		        if($("#huawei_ID").attr("date-must") == "yes"){
					if(window.checkHWidContent($("#huawei_ID"))){
		                isError=true;
		            }
		        }else{
		            if(window.checkHWidContent($("#huawei_ID"))){
		                isError=true;
		            }
		        }        
		    }
		    if (!$("#email_subject li.current").text()){
				$("#email_subject").next("p").show();
				isError=true;
			}
			if(window.checkToMailFillContent($("#email_address"))){
			    isError=true;
			}
	
		    if($.trim($("#validate_code").val()).length != 4){        
		    	$("#authMage").next("label").next("p").show();
				isError=true;
		    }
	
			if (isError){ 
		        $('#email_submit').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
		        $("#email_send_result_status").hide();	
			    return;
			} 
	
		    $('#email_submit').addClass("s-btn s-disabled");
		    var email_question_category = $("#question_category").attr("data-hidden")=="true" ? $("#question_category li.current").text():$("#question_category").val();
		    var email_question_area = $("#question_area li.current").text();
		    var email_name = $("#email_name").val();
		    var email_surname = $("#email_surname").val();
		    var email_address = $("#email_address").val();
		    var email_subject = getMktsubmit() ? $("#email_subject li.current").text():$("#email_subject li.current").attr("date-type");
		    var email_question = $("#email_question").val();
		    var validate_code = $("#validate_code").val();
			var businessType = $("#email_business li.current").text();
		    var huaweiId = $('.huawei_ID:visible').length ? $("#huawei_ID").val():"";
		    var onlineData = {
		            siteCode:SITE_CODE,
		            countryCode:$("#question_area li.current").attr("data-placeId").toUpperCase(),
		            _csrf: $("#csrf").val(),
		            category: email_question_category,                
		            firstName: email_name,
		            lastName: email_surname,
		            email: email_address,
		            subject: email_subject,
		            comments: email_question,
		            validateCode: validate_code,
		        	businessType:$("#email_business li.current").attr("date-businessid"),
		            huaweiId:huaweiId,
		            applicantRole:"10"
		        };		
			var mktData = {
		            siteCode:$("#question_area li.current").attr("data-mkt-placeId")+"-h",
		            country:$("#question_area li.current").text(),
		            area:$("#region_area li.current").text(),
		            sessionuuid: $("#sessionuuid").val(),
		            category: email_question_category,                
		            firstName: email_name,
		            lastName: email_surname,
		            email: email_address,
		            subject: email_subject,
		            content: email_question,
		            authCode: validate_code,
		            businessType:businessType,
		            huaweiId:huaweiId
		    };
	    	getConfirmationPanel({
	            title: $("#reminderText").val(),
	            content: $("#confirmationContent").val(),
	            okStr: $("#confirmText").val(),
	            cancelStr: $("#cancelText").val(),
	            iconClass: "icon-warin"
	        }, function() { 
	            if(getMktsubmit()){
					 mktDateSubmit(mktData);
	    		}
	            else{
					onlineDateSubmit(onlineData);
	    		}
	        }, function(){ 
	    		$('#email_submit').removeClass("s-btn s-disabled");
	        })
	
		}
	
		/* 平台电子流提交*/
		function onlineDateSubmit(onlineData){	
		    if($("#question_area li.current").attr("data-placeId").toUpperCase() == "UK"){
		    	onlineData.countryCode="GB";
		    }
		    $.ajax({                    
				url: elecSubmitApi,
				/*data:onlineData,*/
		        data:JSON.stringify(onlineData),
		        contentType: "application/json; charset=UTF-8",
		        type: "POST",
		        dataType : 'json',
		        success: function (data) {
		        	if(data){
		        		privacyCallback(data)
		        	}
		        },
		        error: function (error) {			
		        },
		        complete: function(){}
		    });
		}
		/* mkt 隐私政策邮件提交*/
		function mktDateSubmit(mktData){ 
			  $.ajax({          
		        url: delApi(mktSubmitApi),         
		        data:mktData, 
		        dataType: "json", 
		        type: "POST",
		        success: function (data) {
		        	if(data){
		        		privacyCallback(data);
		        	}
		        },
		        error: function (error) {			
		        },
		        complete: function(){}
		    });
		}
	
		/*提交后数据回调*/
		function privacyCallback(data){
			if (data.resCode == "0") {        
		        $('#email_submit').text($('.conv3_contact_email').attr('data-success-btn-text')).removeClass("adderror");
		        $('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
		        $(".email_address_tips").hide();
		        $(".conv3_contact_email input,.conv3_contact_email textarea").not("#csrf").not("#question_category").not("#sessionuuid").val("");
		        $(".conv3_contact_email .input-label").removeClass("input-label-top");
		        $(".conv3_contact_email .comments-input-label").removeClass("comments-input-label-top");
		        if($("#question_category").attr("data-hidden")=="true"){
					$("#question_category").prev("span").text($("#selectQueCat").val() + "*");
		        }
		        $("#email_business").prev("span").text($("#businessText").val() + " *");
		        $("#email_subject").prev("span").text($("#subjectText").val() + " *");
		        $(".email_business li").removeClass("current");
		        $(".email_subject li").removeClass("current");
		        $(".business_fqa ,.huawei_ID").hide();
		        if($(".question_area li[data-mkt-placeid='"+SITE_CODE+"']").length){
		            var currunt_area = $(".question_area li[data-mkt-placeid='"+SITE_CODE+"']").attr("data-earaid")
		            $("#question_area").prev("span").text($(".question_area li[data-mkt-placeid='"+SITE_CODE+"']").text());
		            $(".question_area li[data-mkt-placeid='"+SITE_CODE+"']").addClass("current").siblings('li').removeClass("current");
	
		            $(".question_area li").hide();
		            $(".question_area li[data-earaid='"+currunt_area+"']").show();
				   $(".question_area li[data-mkt-placeid='"+SITE_CODE+"']").addClass("current").siblings('li').removeClass("current");
		            $("#region_area").prev("span").text($(".region_area li[data-earaid='"+currunt_area+"']").text());
		            $(".region_area li[data-earaid='"+currunt_area+"']").addClass("current").siblings('li').removeClass("current");
		        }else{
		          $("#region_area").prev("span").text($("#areaText").val() + "*");
		           $("#question_area").prev("span").text($("#countryText").val() + "*");
		           $(".region_area li").removeClass("current");
		          $(".question_area li").removeClass("current");
		        }
		       // $("#email_send_result_status").show().css('display','inline-block');
		        $('#email_submit').removeClass("s-btn s-disabled");
		    	getOKResult({
		            title: $("#successfullyText").val(),
		            content: $("#sucessContent").val(),
		            okStr:  $("#confirmText").val(),             
		            iconClass: "icon-warin"
		        }, function() {})
		    }else if(data.resCode == "91"){
				$("#email_submit_result_tip").show().text($("#returnCodeTips21").val());
		        $('#email_submit').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
		        $('#email_submit').removeClass("s-btn s-disabled");
		    	getOKResult({
		            title: $("#failedText").val(),
		            content: $("#failedContent").val(),
		            okStr:  $("#confirmText").val(),             
		            iconClass: "icon-warin"
		        }, function() {})
		    }else if(data.resCode == "92"){
				$("#email_submit_result_tip").show().text($("#returnCodeTips21").val());
		        $('#email_submit').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
		        $('#email_submit').removeClass("s-btn s-disabled");
		        getOKResult({
		            title: $("#failedText").val(),
		            content: $("#failedContent").val(),
		            okStr:  $("#confirmText").val(),             
		            iconClass: "icon-warin"
		        }, function() {})
		    }else {
		        $('#email_submit').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
		        $('#email_submit').removeClass("s-btn s-disabled");
		        getOKResult({
		            title: $("#failedText").val(),
		            content: $("#failedContent").val(),
		            okStr:  $("#confirmText").val(),             
		            iconClass: "icon-warin"
		        }, function() {})
		    }   
			identify();
		};
		function selectLifun(obj,type){
		    if(type == 0){
		        topSearchFilter(obj)
		    }else if(type== 1){
		        selectProductCompare(obj)
		    }
		}; 
		function delApi(api){
			if(window.location.protocol.indexOf("https") > -1){
		        api = api.replace("http:","https:");
		    }
		    return api;
		}
		
		/*是否提交弹框*/
		function  getConfirmationPanel(config, okCallback, cancelCallback) {
			// okStr , cancelStr , title , iconClass 
		    var content =
		        "<div class='s-dialog'>" +
		        "   <div class='s-content-dialog'>" +
		        "       <div class='s-dialog-title'>" +
		        "           <h3><span class='" +config.iconClass+ "'></span>" + config.title+ "</h3>" +
		        "       </div><div class='s-dialog-content'>" + config.content +
		        "       </div><div class='s-dialog-btn'>" +
		        "           <a class='s-btn s-cancel-btn'>" +config.cancelStr+ "</a>" +
		        "           <a class='s-btn s-ok-btn'>" + config.okStr+ "</a>" +
		        "       </div>" +
		        "   </div>" +
		        "</div>";
		    $("body").append(content); 
		    setTimeout(function () {
		        $(".s-dialog .s-content-dialog").toggleClass("s-show");
		    }, 0);
		    $(".s-dialog .s-ok-btn").click(function () {
		        $(".s-dialog .s-content-dialog").toggleClass("s-show");
		        setTimeout(function () {
		            $("body > .s-dialog").remove();
					 okCallback && okCallback();
		        }, 500);           
		    });
		    $(".s-dialog .s-cancel-btn").click(function () {
		        $(".s-dialog .s-content-dialog").toggleClass("s-show");
		        setTimeout(function () {
		            $("body > .s-dialog").remove();
		    			cancelCallback && cancelCallback();
		        }, 500);    
		    });
		};
		
		function  getOKResult(config, okCallback) {
		    var content =
		        "<div class='s-dialog'>" +
		    "   <div class='s-content-dialog'>" +
		    "       <div class='s-dialog-title'>" +
		    "           <h3><span class='" +config.iconClass+ "'></span>" + config.title+ "</h3>" +
		    "       </div><div class='s-dialog-content'>" + config.content +
		    "       </div><div class='s-dialog-btn'>" +          
		    "           <a class='s-btn s-ok-btn'>" + config.okStr+ "</a>" +
		    "       </div>" +
		    "   </div>" +
		    "</div>";
		    $("body").append(content); 
		    setTimeout(function () {
		        $(".s-dialog .s-content-dialog").toggleClass("s-show");
		    }, 0);
		    $(".s-dialog .s-ok-btn").click(function () {
		        $(".s-dialog .s-content-dialog").toggleClass("s-show");
		        setTimeout(function () {
		            $("body > .s-dialog").remove();
					 okCallback && okCallback();
		        }, 500);           
		    });       
		};
	});
	
}());

(function(){
	(function ($) {
		window.viewType = function () {
			var iWinWidth = window.innerWidth || $(window).width();
			return iWinWidth >= 1024 ? 'pc' : (iWinWidth < 768 ? 'mobile' : 'tablet');
		};
		$.fn.addSelector = function (settings) {
			var thisSelector = $(this);
			var defs = { 'tabView': undefined, 'tabClass': 'current', 'tabChangeTitle': true };
			var isTabView = function () { return defs.tabView == 'both' || (defs.tabView && defs.tabView.indexOf(viewType()) > -1);};
			$.extend(defs, settings);
			thisSelector.find('.select').on('click', function (ev) {
				if (isTabView()) return;
				var thisSelect = $(this),
					thisOl = thisSelect.find('ol'),
					siblingsSelect = thisSelect.siblings('.select');
				if ( thisSelect.hasClass('disable') ) return;
				if (thisOl.data('slide') == 'open') {
					thisOl.slideUp(250, function () {thisOl.data('slide', 'close');});
					thisSelect.find('span').removeClass('active');
				} else {
					thisOl.slideDown(250, function () {thisOl.data('slide', 'open');});
					thisSelect.find('span').addClass('active');
				}
				siblingsSelect.find('ol').slideUp(250, function () {$(this).data('slide', 'close');});
				siblingsSelect.find('span').removeClass('active');
	
				ev.stopPropagation();
			});		
			thisSelector.find('.select ol li').off('click.compareItem').on('click.compareItem', function (ev) {
				var thisLi = $(this),
					thisSpan = thisLi.parents('.select').eq(0).find('span'),
					sText = thisLi.text(),
					spText = thisSpan.text();
				if (isTabView()) {
					thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass);
				} else {
					thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass).parents('.select').eq(0).find('ol').slideUp(250, function () { $(this).data('slide', 'close'); });
				}
				thisSpan.removeClass('active');
				defs.tabChangeTitle && thisSpan.text(sText);
				if(sText != spText)	selectLifun(thisLi,thisLi.attr('f'))
				thisSelector.trigger('selected', { 'val': sText, '_mark': thisLi.parents('ol').eq(0).attr('_mark') });
	
				setTimeout(function(){
					$(".conv3_search_wrap .result_news_pc .list li strong").each(function(){
						var title = $(this).find("a");
						if (title.height() > 45 ) {
							$(this).addClass("ellipsis");
						}
					});
					$(".conv3_search_wrap .result_news_pc .list li p").each(function(){
						var descript = $(this).find("span.content");
						if (descript.height() > 65 ) {
							$(this).addClass("ellipsis");
						}
					});
				},500);
				ev.stopPropagation();
				
			});
			$('body').on('click', function () {
				if (isTabView()) return;
				var aSelect = thisSelector.find('.select');
				aSelect.find('ol').slideUp(250, function () {
					$(this).data('slide', 'close');
				});
				aSelect.find('span').removeClass('active');
			});
			if (isTabView()) {
				$(window).on('resize', function () {
					if (isTabView()) {
						thisSelector.find('.select ol').show();
					} else {
						thisSelector.find('.select ol').hide();
					}
				});
			}
			return thisSelector;
		};
	
	})(jQuery);
 
    $(function(){
    	if($('.private-question-component').length>0){

    		$(".conv3_global_selector").addSelector();
    		
    		$("#question_category li").click(function () {
    			$("#question_category li:first-child").parent("ol").prev("span")
    			.text($(this).text());
    		});
    		
    		$("#question_area li").click(function () {
    			$("#question_area li:first-child").parent("ol").prev("span")
    			.text($(this).text());
    		});
    		
    		$(".conv3_global_selector").find('.select ol li').off('click.compareItem').on('click.compareItem', function (ev) {
    			var defs = { 'tabView': undefined, 'tabClass': 'current', 'tabChangeTitle': true };
    			var isTabView = function () { return defs.tabView == 'both' || (defs.tabView && defs.tabView.indexOf(viewType()) > -1);};
    			//$.extend(defs, settings);
    			var thisLi = $(this),
    			thisSpan = thisLi.parents('.select').eq(0).find('span'),
    			sText = thisLi.text(),
    			spText = thisSpan.text();
    			if (isTabView()) {
    				thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass);
    			} else {
    				thisLi.addClass(defs.tabClass).siblings('li').removeClass(defs.tabClass).parents('.select').eq(0).find('ol').slideUp(250, function () { $(this).data('slide', 'close'); });
    			}
    			thisSpan.removeClass('active');
    			defs.tabChangeTitle && thisSpan.text(sText);
    			if(sText != spText)	selectLifun(thisLi,thisLi.attr('f'))
    			$(".conv3_global_selector").trigger('selected', { 'val': sText, '_mark': thisLi.parents('ol').eq(0).attr('_mark') });
    			
    			setTimeout(function(){
    				$(".conv3_search_wrap .result_news_pc .list li strong").each(function(){
    					var title = $(this).find("a");
    					if (title.height() > 45 ) {
    						$(this).addClass("ellipsis");
    					}
    				});
    				$(".conv3_search_wrap .result_news_pc .list li p").each(function(){
    					var descript = $(this).find("span.content");
    					if (descript.height() > 65 ) {
    						$(this).addClass("ellipsis");
    					}
    				});
    			},500);
    			//ev.stopPropagation();
    			
    		});
    		
    		$("#email_question").keyup(function(){
    			$(".input_number").text($(this).val().length);
    		}).mousemove(function(){
    			$(".input_number").text($(this).val().length);
    		});
    		
    		$(document).on("blur",".conv3_form_module input, .conv3_form_module textarea",function(){
    			$(this).next("p").hide();
    			!$(this).val() && $(this).next("p").show();
    			
    			if($(this).attr('data-name') == 'email'){
    				window.checkToMailFillContent($(this));
    			}
    			
    			if($(this).attr('data-name') == 'code'){
    				if($.trim($(this).val()).length != 6 || !$("#validate_code").val().match(/^\d{6}$/) ){
    					$(this).next("p").show();
    				}
    			}
    		}).on("focus",".conv3_form_module input",function(){
    			$(this).siblings("label").addClass("input-label-top");
    		}).on("focus",".conv3_form_module textarea",function(){
    			$(this).siblings("label").addClass("comments-input-label-top");
    		}).on("blur",".conv3_form_module input",function(){
    			if(!$(this).val()){
    				$(this).siblings("label").removeClass("input-label-top");
    			}
    		}).on("blur",".conv3_form_module textarea",function(){
    			if(!$(this).val()){
    				$(this).siblings("label").removeClass("comments-input-label-top");
    			}
    		}).on("click",".conv3_form_module .input-label, .conv3_form_module .comments-input-label",function(){
    			$(this).siblings("input,textarea").focus();
    		});
    		
    		$("#question_category li, #question_area li").click(function () {
    			$(this).parent().next("p").hide();
    		});	
    		
    		$("#email_submit").click(emailSubmit);
    		
    		$("#email_validate").click(emailValidate);
    	}
        
    });
    
    window.checkToMailFillContent = function(obj){
        var _isErrors = false;
        if ( !$(obj).val().match(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/) ){
            $(obj).next("p").show();
            _isErrors = true;
        }else{
            $(obj).next("p").hide(); 
        }
        return _isErrors;
    }
    
    function emailSubmit() {
        $("#email_submit_result_tip").empty()
        var isError=false;
        $(".conv3_contact_email input[placeholder],.conv3_contact_email textarea[placeholder]").each(function(){
            $(this).next("p").hide();
            if (!$(this).val() && $(this).next("p").length>0 ){
                $(this).next("p").show();
                isError=true;
            }	 		
            if($(this).next("p").length>0&&!$(this).next("p").is(':hidden')){
                isError=true;
            }
        });
        
        if (!$("#question_category li.current").text()){
            $("#question_category").next("p").show();
            isError=true;
        }
        
        if (!$("#question_area li.current").text()){
            $("#question_area").next("p").show();
            isError=true;
        }
        
        if(window.checkToMailFillContent($("#email_address"))){
            isError=true;
        }
        
        if($.trim($("#validate_code").val()).length != 6 || !$("#validate_code").val().match(/^\d{6}$/) ){
            $("#validate_code").next("p").show();
            isError=true;
        }
        
        if (isError){ 
            $('#email_submit').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
            $("#email_send_result_status").hide();	
            return;
        }
        var email_question_category = $("#question_category li.current").text();
        var email_question_area = $("#question_area li.current").text();
        var email_name = $("#email_name").val();
        var email_surname = $("#email_surname").val();
        var email_address = $("#email_address").val();
        var email_subject = $("#email_subject").val();
        var email_question = $("#email_question").val();
        var validate_code = $("#validate_code").val();
        
        $.ajax({
            url: deleteHttp(delApi($(".conv3_contact_email.conv3_contact_module").data('submit-api'))),
            data:
            {
                siteCode: "worldwide",
                category: email_question_category,
                area: email_question_area,
                firstName: email_name,
                lastName: email_surname,
                email: email_address,
                subject: email_subject,
                content: email_question,
                authCode: validate_code
            },
            dataType: "jsonp",
            jsonp: "jsonp",
            type: "GET",
            success: function (data) {
                
            },
            error: function (error) {
                //$('#email_submit').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
            },
            complete: function(){}
        });
    }   
    
    function emailValidate() {
        if (!$("#email_address").val() && $(this).next("p").length>0 ){
            $(this).next("p").show();
            return;
        }
        
        if(window.checkToMailFillContent($("#email_address"))){
            $(this).next("p").show();
            return;
        }
        
        var email_address = $("#email_address").val();
        
        $.ajax({
            url: deleteHttp(delApi($(".conv3_contact_email.conv3_contact_module").data('email-validate-api'))),
            data:
            {
                siteCode: "worldwide",
                email: email_address
            },
            dataType: "jsonp",
            jsonp: "jsonp",
            type: "GET",
            success: function (data) {
                if(data.returnCode == 0){
                    $('#email_validate').text($('.conv3_contact_email').attr('data-email-success-message')).removeClass("adderror");
                    $("#email_address_span").text(email_address);
                    $(".email_address_tips").show();
                }else{
                    $('#email_validate').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
                }
            },
            error: function (error) {
                $('#email_validate').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
            },
            complete: function(){}
        });
    }
    
    function deleteHttp(str){   
        if(str != null && typeof str=="string"){
            if(str.indexOf('http:') == 0){
                return  str.substring(5,str.length);
            }else if(str.indexOf('https:') == 0){
                return  str.substring(6,str.length);
            }else{
    			return  str;
            }   
    	}else{
    	  	return str
    	} 
    } 
    
    function delApi(api){
        if(window.location.protocol.indexOf("https") > -1){
            api = api.replace("http:","https:");
        }
        return api;
    } 
    
	function privacyCallback(data){
	    if (data.returnCode == 0) {
	        $('#email_submit').text($('.conv3_contact_email').attr('data-success-btn-text')).removeClass("adderror");
	        $('#email_validate').text($('.conv3_contact_email').attr('data-email-validate-btn-text')).removeClass("adderror");
	        $(".email_address_tips").hide();
	        $(".conv3_contact_email input,.conv3_contact_email textarea").val("");
	        $(".conv3_contact_email .input-label").removeClass("input-label-top");
	        $(".conv3_contact_email .comments-input-label").removeClass("comments-input-label-top");
	        $("#question_category").prev("span").text($("#selectQueCat").val() + "*");
	        $("#question_area").prev("span").text($("#areaText").val() + "*");
	        $("#email_send_result_status").show().css('display','inline-block');
	    }else if(data.returnCode == "2"){
	        $("#email_submit_result_tip").text($("#returnCodeTips2").val());
	    }else if(data.returnCode == "21"){
	        $("#email_submit_result_tip").text($("#returnCodeTips22").val());
	    }else if(data.returnCode == "22"){
	        $("#email_submit_result_tip").text($("#returnCodeTips22").val());
	    }else if(data.returnCode == "23"){
	        $("#email_submit_result_tip").text($("#returnCodeTips23").val());
	    }else {
	        $('#email_submit').text($('.conv3_contact_email').attr('data-error-message')).addClass("adderror");
	    }
	}
}());

/**
 * Gallery Wall
 */
(function(){
	$(function(){
		if($('.product-gallery-component').length>0){
			var viewDetail = $('#viewDetail').val(); 
			var currUrl = location.protocol+"//"+location.host; 
			var currPage = currUrl+location.pathname;
			
			// 渲染图片列表数据
			getGalleryLists();
			function getGalleryLists(){
				var galleryData = $('#productGalleryData').html();
				var data = new Array();
				if(galleryData){
					data = JSON.parse(galleryData);
				}
				if(data.length>0){
					var str1 ='',str2='',str3='';
					for(var i=0;i<data.length;i++){
						var imgsrc = data[i].cardImg;
						if(imgsrc){  
							// 获取图片列表生成轮播图
							var str = '<div class="swiper-slide honor-loading"><img data-src="'+imgsrc+'" data-original="'+imgsrc+'" class="slide-img swiper-lazy" /></div>';
							$('.product-gallery-component .product-gallery-banner .swiper-wrapper').append(str);
						}
						
						// 生成图片id				
						var imgId = hex_md5(currUrl+imgsrc); 
						var endUrl = currPage+'?index='+i+'#'+imgId;
						var loading= imgsrc ? "honor-loading":"";
						
						var html='';
						html+='<p class="item-num">'+(i+1)+'</p>';
						html+='<img class="item-img lazy"  data-original="'+data[i].cardImg+'" alt="'+data[i].cardImgAlt+'" title="'+data[i].cardImgTitle+'"/>';
						html+='<div class="item-detail">';
							if(data[i].authorName){
								html+='<div class="author">';
									html+='<span class="font-User"></span>';
									html+='<span>'+data[i].authorName+'</span>';
								html+='</div>';
							}
							if(viewDetail){
								html+='<button type="button" class="btn btn-detail" data-index="'+i+'">'+viewDetail+'</button>';
							}
							html+='<div class="social-media" data-authorname="'+data[i].authorName+'" data-detail="'+data[i].detailUrl+'" data-ogtitle="'+data[i].ogTitle+'" data-ogdescription="'+data[i].ogDescription+'">';
								html+='<span class="fa fa-facebook-square share-facebook"></span>';
								html+='<span class="fa fa-twitter share-twitter"></span>';
								html+='<span data-clipboard-text="'+endUrl+'" class="fa fa-link flipx share-link"></span> ';
							html+='</div>';
						html+='</div>';
					
						if(i<3){ 
							str1+='<li id="'+imgId+'" class="item-box item-1'+(i+1)+' '+loading+'">';
							str1+=html;
							str1+='</li>';
						}else if(i>2 && i<7){
							str2+='<li id="'+imgId+'" class="item-box item-2'+(i-2)+' '+loading+'">';
							str2+=html;
							str2+='</li>';
						}else{
							str3+='<li id="'+imgId+'" class="item-box item-3'+(i-6)+' '+loading+'">';
							str3+=html;
							str3+='</li>';
						}
					}
					$('.product-gallery-component .gallery-type1').html(str1);
					$('.product-gallery-component .gallery-type2').html(str2);
					$('.product-gallery-component .gallery-type3').html(str3); 
				}
			}   
			// 懒加载
			$(".product-gallery-component .item-img").lazyload({
				"placeholder":lazyload.placeholder
			}).show();
			
			var windowW = utils.windowWidth();
			if(windowW>768){
				// 轮播图切换速度
				var bannerspeed = $('.product-gallery-banner').data('bannerspeed') * 1000;
				var productGalleryBanner = new Swiper ('.product-gallery-component .product-gallery-banner .swiper-container', {
					lazy:true,
					navigation: {
						nextEl: '.product-gallery-banner .swiper-button-next',
						prevEl: '.product-gallery-banner .swiper-button-prev',
					},
					observer:true,
					observeParents:true,  
					speed:bannerspeed
				})  
				
				$('.product-gallery-component .swiper-button-prev,.product-gallery-component .swiper-button-next').click(function(){
					$('.product-gallery-banner .swiper-slide').addClass('honor-loading');
				})
				
				// 判断页面链接中是否含有轮播图标识 index，若有则显示轮播图并跳转到具体图片
				if(utils.getRequest().index){
					$('.product-gallery-banner .swiper-slide').removeClass('honor-loading');
					productGalleryBanner.slideTo(utils.getRequest().index,0);
					$('.product-gallery-banner').css('visibility','visible');
				}
				
				// 点击detail 显示轮播图，并跳转到对应图片
				$('.product-gallery-component .btn-detail').click(function(){
					$('html,body').css('overflow','hidden');
					var slideIndex = $(this).data('index');
					productGalleryBanner.slideTo(slideIndex,0);
					$('.product-gallery-banner').css('visibility','visible');
				})
				// 隐藏轮播图		
				$('.product-gallery-banner .swiper-container .font-Cross').click(function(){
					$('.product-gallery-banner').css('visibility','hidden');
					$('html,body').css('overflow','auto');
				})
			}
			
			// 链接复制成功
			var clipboard = new ClipboardJS('.product-gallery-component .fa-link'); 
			var successBtnW = $('.product-gallery-component #success-tip').outerWidth(); 
			var marginLf = -(successBtnW/2);
			$('#success-tip').css('margin-left',marginLf);
			clipboard.on('success', function(e) { 
				$('#success-tip').show()
				.animate({ 
					'margin-top':'-21px',
					'opacity':'0.9',
					'margin-left':marginLf
				},1000).delay('3000')
				.animate({ 
					'margin-top':'-51px',
					'opacity':'0',
					'margin-left':marginLf
				},1000,function(){
					$('#success-tip').hide();
				}); 
			    e.clearSelection();
			});  
		    
			// Facebook share
			$(".product-gallery-component .share-facebook").click(function() { 
		        var oLink = currUrl+$(this).parent().data('detail');
		        window.open ("https://www.facebook.com/sharer.php?u="+oLink+'&hashtag=‪%23ShotOnHONOR', "newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
			});
		      
			// twitter share
			$(".product-gallery-component .share-twitter").click(function() { 
		        var oLink = $(this).siblings('.share-link').data('clipboard-text');
		        var ogTitle = $(this).parent().data('ogtitle');
		        var ogDescription = $(this).parent().data('ogdescription');
		        var authorName = $(this).parent().data('authorname');
		        window.open('https://twitter.com/intent/tweet?hashtags=ShotOnHONOR &amp;text=' + encodeURIComponent(ogTitle) +' '+ encodeURIComponent(ogDescription) +' &amp;url=' + encodeURIComponent(oLink),"newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
			});			
			
			
		}
	})
	
}());
// 获取当前tab分类名
function getCurrTabName(){
	// 默认值
	var tabName = $(".user-center-top .nav li:nth-child(1)").attr("relative") || 'about';
	
	// 获取当前连接传参
	var hrefstr = window.location.href;
	var hrefArr = [];
	hrefArr = hrefstr.split("#&");
	if (hrefArr.length > 0) {
		if (hrefArr[1] !== undefined && hrefArr[1] !== "undefined" && hrefArr[1] !== "") {
			tabName = hrefArr[1].split("&")[0];
		}
	}
	return tabName;
}

(function() {
	var requestUrl = honorApiUrl;
	//调用
	$(function() {
		var len = $(".user-center-top").length;
		if (len > 0) {
			var relative = getCurrTabName();
			// 非编辑模式 
			var isEdit = $(".user-center-top .top-box").hasClass('edit-mode');
			if(!isEdit){
				getUserInfo();
				showCon();
				
				// 是否显示数据统计
				var hide=$('.user-center-top .right').data('hide') || '';
				if(!hide || hide=="No"){
					getUserPhotosInfo();
				}
			}

			// tab显示隐藏
			function showCon() {
				var el = $('.user-center-top .nav li[relative=' + relative + ']').addClass("cur");
				$(".user-center-"+relative+" .data-box").show();
				if(relative=='favorite'){
					$(".user-center-favorites").siblings().find(".data-box").hide();
				}else if(relative=='inbox'){
					$(".user-center-msg .data-box").show();
					$(".user-center-msg").siblings().find(".data-box").hide();
				}else{
					$(".user-center-"+relative).siblings().find(".data-box").hide();
				}
				//拼接参数到地址栏末尾
				window.location.hash = "&" + relative;
			}
			// 切换导航
			$(".user-center-top .nav li").click(function() {
				relative = $(this).attr("relative");
				$(this).siblings().removeClass("cur");
				$(this).addClass("cur");
				$(".user-center-mygallery .photos .photos-box .box-item").removeAttr("style");
				showCon();
			})

			// 切换导航
			var swiper = new Swiper('.swiper-container', {
				slidesPerView: 'auto',
				spaceBetween: 30,
				slidesPerGroup: 1,
				loopFillGroupWithBlank: false,
				navigation: {
					nextEl: '.rightArrow',
					prevEl: '.leftArrow'
				},
			});
			
			// 获取当前用户的头像和昵称
			function getUserInfo(){
				// 获取用户头像
				var loginHeadURL = decodeURIComponent(utils.getCookie('loginHeadURL')) || ''; 
				if(loginHeadURL && loginHeadURL !='null'){
					$(".user-center-top .user-ico-name .user-avatar").show().attr('src',loginHeadURL);
				} 
				// 获取用户昵称
				var displayName = decodeURIComponent(utils.getCookie('displayName')) || ''; 
				if(displayName && displayName !='null'){
					$(".user-center-top .user-ico-name .left-name").text(displayName);
				}
			}
			
			//获取用户相关数据 照片 被点赞数  日期
			function getUserPhotosInfo() {
				$.ajax({
					url: requestUrl + '/abroad/shootMatch/countUserPhotosPraiseLogin',
					type: 'get',
					dataType: "jsonp",
					success: function(result) {
						if (result.success) {
							var data = result.infoBean;
							var photosNum = data.allPhotosNum ? data.allPhotosNum : 0;
							$('.user-data .photos-data').text(photosNum);
							
							var praiseNum = data.allPraiseNum ? data.allPraiseNum : 0;
							$('.user-data .likes-data').text(praiseNum);
							
							var videoNum = data.videoNum ? data.videoNum : 0;
							$('.user-data .videos-data').text(videoNum);
							
							if (data.firstLogin){
								$('.user-data .joined-time').text(data.firstLogin).show();
							}
						}
					}
				})
			};
		}
	})
})();
var userListData={
	itemRightDis: 12, // item右边距
	itemBottomDis: 12 // item 下边距 
}
/** 瀑布流
 * @param parent 父元素
 * @param box 子元素，需要以瀑布流形式呈现的box
 */
function userCenterNewFilmWaterfall(parent, box) {
  var $parent = $(parent);
  var $box = $(box);
  var boxH = 0;
  // 计算整个页面显示的行数（页面宽/box的宽）
  var parentW = $parent.outerWidth();
  var itemW=0;
  if(galleryPublicData.windowW<=768){
	  itemW = $box.eq(0).outerWidth() + userListData.itemRightDis;
  }else{
	  itemW = $box.eq(0).outerWidth() + (3 * userListData.itemRightDis) / 4;
  }
  var boxW = $box.eq(0).outerWidth() + userListData.itemRightDis;
  // 列数
  var cols = Math.floor(parentW / itemW)
  var hArr = [],maxArr=[];
  for (var i = 0; i < $box.length; i++) {
    if (i < cols) {
      hArr.push($box.eq(i).outerHeight() + userListData.itemBottomDis);
      boxH = Math.max.apply(null, hArr);
    } else {
    	  var minH = Math.min.apply(null, hArr)
          var minIndex = getUserGalleryIndex(hArr, minH);
    	  // 将图片放在上一行最矮的item下
    		  $box.eq(i).css('position', 'absolute')
              .css('top', minH + 'px')
              .css('left', boxW * minIndex + 'px')        
          // 改变数组
          hArr[minIndex] += $box.eq(i).outerHeight() + userListData.itemBottomDis;

          var endMaxH = Math.max.apply(null, hArr);
          boxH = endMaxH;
     
    
    }
  }
  $parent.height(boxH); 
  
}
/** 获取数组最小值的下标
 * @param arr 数组
 * @param val 最小值
 */
function getUserGalleryIndex(arr, val) {
  for (var i in arr) {
    if (arr[i] == val) {
      return i;
    }
  }
}
(function () {
		var requestUrl = honorApiUrl;
		var pageSize=12;
		var pageIndex=1;
		var totalPage=0;
		var windowW = utils.windowWidth();
		var language=window.digitalData.page.pageInfo.siteCode2;	
		if(language.toLowerCase()==="global"){
			language="en";
		}
		//拼接跳转的url
		function jointUrl(url) {
			if (url) {
				//拼跳转到详情页的链接
				var currPath = location.href;
				var prePath = '',
					endPath = '';
				if (currPath.indexOf('content/honor') != -1) {
					//预览环境
					prePath = currPath.split('/content/honor')[0];
					prePath += '/content/honor';
				} else {
					//发布环境
					prePath = location.protocol + '//' + window.location.host;
				}
				if (currPath.indexOf('.html') != -1) {
					//预览环境
					endPath += '.html';
					endPath += currPath.split('.html')[1];
				} else {
					//发布环境
					endPath = '/';
				}
			}
			return prePath + url + endPath;
		}
	
		//执行点赞取消点赞事 的函数
		function executePares(){
			//点赞 取消点赞
			$(".user-center-newfilm .photos .photos-box .photo-desc .photo-actions div i.praise").click(function(){
				  var imgSrc= $(this).children("img").attr("src");
				  var num=+$(this).attr("num");
				  var activityName=$(this).attr("name");
				  var imgId=+$(this).attr("imgid");
				 if($(this).attr("class").indexOf("red")!==-1){
					 delPraise(this,activityName,imgId,num); 
				 }
				 else{
					 addPraise(this,activityName,imgId,num); 
				 }
			})
		}
		//查询用户所有作品 
		function getListUserAllImgInfo(loadType) {
			var dataObj={pageIndex:pageIndex,imgReviewStatus:1,pageSize:pageSize,activityName:'Youth_Photography_Contest'};
			$.ajax({
				url: requestUrl + '/abroad/shootMatch/listUserAllImgInfo',
				data:dataObj,
				type: 'get',
				dataType: "jsonp",
				success: function (result) {
					if (result.success) {
						totalPage=result.infoBean.totalPage;
						var data = result.infoBean.pageList;
						var itemhtml = "";
						if(data.length<=0){
							var noData=$(".user-center-newfilm #nodata").val();
							$(".user-center-newfilm .photos .photos-box").html('<div class="nodata"><img src="/etc/designs/honor-site/assets/icons/edit-white-icon.png" /><p style="margin-top:10px;">'+noData+'</p></div>');
									return false;
						}
						for (var k = 0; k < data.length; k++) {
							 var linkToDetail=data[k].htmlPath;
							 if(+data[k].isGallery===0){
								 linkToDetail=jointUrl(data[k].htmlPath);
							 }
							 itemhtml += '<div class="box-item">';
						        itemhtml += '<div class="img"><a title="'+ data[k].imgThemes+'" href="'+linkToDetail+'"><img  class="lazy" data-original="'+data[k].imgSrc+'" title=' + data[k].imgThemes + ' alt=' + data[k].imgThemes + ' src="' + data[k].imgSrc + '" /></a></div>';
						        itemhtml +='<div class="photo-desc">';
						                itemhtml +='<a title="'+ data[k].imgThemes+'" href="'+linkToDetail+'"><div class="desc">';
						                        itemhtml +='<div class="tilte">'+data[k].imgThemes+'</div>';
						                        itemhtml +='<div class="desc-con">'+data[k].imgContent+'</div>';
						                itemhtml +='</div></a>';
						                itemhtml +='<div class="photo-actions">';
						                        itemhtml +='<div><i  name="'+data[k].activityId+'" imgid="'+data[k].imgId+'" num="'+data[k].praiseNum+'" class="praise '+(+data[k].isPraised===0?" red":"")+' fa fa-heart"></i><span>'+data[k].praiseNum+'</span></div>';
						                        itemhtml +='<div> <i class="fa fa-comment"></i><span>'+data[k].commentNum+'</span></div>';
						                itemhtml +='</div>';
						        itemhtml +='</div>';
						 itemhtml += "</div>";
						}
						if(loadType==="scrollLoad"){
							$(".user-center-newfilm .photos .photos-box").append(itemhtml);
						}
						else{
							$(".user-center-newfilm .photos .photos-box").html(itemhtml);
						}
						executePares();
						
						//图片加载完毕，执行瀑布流渲染
						$('.user-center-newfilm .photos .photos-box .box-item .img img').imagesLoaded()
						.done(function(){
							 $(".user-center-newfilm .photos .photos-box .box-item").removeAttr("style");
							 if(windowW>768){
//								 userCenterNewFilmWaterfall('.user-center-newfilm .photos .photos-box', '.user-center-newfilm .photos .photos-box .box-item');
							 }
						})						
						$('.user-center-newfilm .photos-box .photo-desc .desc').niceScroll({
						    cursorcolor: "#ccc",//#CC0071 光标颜色
						    cursoropacitymax: 1, //改变不透明度非常光标处于活动状态（scrollabar“可见”状态），范围从1到0
						    touchbehavior: false, //使光标拖动滚动像在台式电脑触摸设备
						    cursorwidth: "5px", //像素光标的宽度
						    cursorborder: "0", // 游标边框css定义
						    cursorborderradius: "5px",//以像素为光标边界半径
						    autohidemode: false //是否隐藏滚动条
						});
						//鼠标经过显示
						if(windowW>=1024){
						$(".user-center-newfilm .photos .photos-box .box-item").stop().hover(function(e){
							
							var $thisH=$(this).height();
							e.stopPropagation();
							var $descCon=$(this).children("div.photo-desc").children("a").children("div.desc").children("div.desc-con");
							var $photoActions=$(this).children("div.photo-desc").children("div.photo-actions");
							
							$(this).children("div.photo-desc").children("a").children("div.desc").children("div.author").stop().show();
							$descCon.stop().show();
							$photoActions.stop().show();
							var  descConH=$descCon.height();
							if(descConH>60){
								descConH=60;
							}
							descConH+=$photoActions.height();
							$descCon.css("display","-webkit-box");
							$(this).children("div.photo-desc").attr("style","position:absolute;height: auto;");
							$(this).css("height",$thisH);
		
						}).stop().mouseleave(function(e){
							e.stopPropagation();
							$(this).children("div.img").children("a").children("img").css("height","auto");
							$(this).children("div.photo-desc").children("a").children("div.desc").children("div.author").stop().hide();
							$(this).children("div.photo-desc").children("a").children("div.desc").children("div.desc-con").stop().hide();
							$(this).children("div.photo-desc").children("div.photo-actions").stop().hide();
							
						});
						}
					}
				}
			})
			//点赞 取消点赞
			$(".user-center-newfilm .photos .photos-box .photo-desc .photo-actions div i.praise").click(function(){
				  var imgSrc= $(this).children("img").attr("src");
				  var num=+$(this).attr("num");
				  var activityName=$(this).attr("name");
				  var imgId=+$(this).attr("imgid");
				 if($(this).attr("class").indexOf("red")!==-1){
					 delPraise(this,activityName,imgId,num); 
				 }
				 else{
					 addPraise(this,activityName,imgId,num); 
				 }
			})
		}
		
		 //滚动加载
		$(window).scroll(function(){
		 var scrollTop = $(this).scrollTop();//滚滚动条 距离顶部距离
		 var documentHeight = $(document).height();//内容高度
		 var windowHeight = $(this).height();//可见高度
		 var footerHeight=$(".footer").height();//底部高度
		 if(windowHeight+scrollTop>=documentHeight-footerHeight){
			if(totalPage>pageIndex){
				pageIndex+=1;
				 getListUserAllImgInfo("scrollLoad");
			}
			
			}
	    });	
		
		//添加点赞
		function addPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/shootMatch/addPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							num +=1;
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).addClass("red");
						}
					}
				})
		};
		//删除点赞
		function delPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/shootMatch/delPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							num -=1;
							if(num<0){
								num=0;
							}
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).removeClass("red");
						}
					}
				})
		};
		
		$(function () {
			var len = $(".user-center-newfilm").length;
			// 非编辑模式
			var isEdit = $(".user-center-newfilm .newfilm-box").hasClass('edit-mode');
			if (len > 0 && !isEdit) {
				// 当前Tab展示为 newfilm时
				var tabName = getCurrTabName();
				if (tabName == "newfilm") {
					getListUserAllImgInfo("");
				}
				
				// 导航切换时 查询数据
				$(".user-center-top .nav li[relative='newfilm']").click(function() {
					getListUserAllImgInfo("");
				})
			}
		});
})();
var userListData={
	itemRightDis: 12, // item右边距
	itemBottomDis: 12 // item 下边距 
}
/** 瀑布流
 * @param parent 父元素
 * @param box 子元素，需要以瀑布流形式呈现的box
 */
function userCenterMyGalleryWaterfall(parent, box) {
  var $parent = $(parent);
  var $box = $(box);
  var boxH = 0;
  // 计算整个页面显示的行数（页面宽/box的宽）
  var parentW = $parent.outerWidth();
  var itemW=0;
  if(galleryPublicData.windowW<=768){
	  itemW = $box.eq(0).outerWidth() + userListData.itemRightDis;
  }else{
	  itemW = $box.eq(0).outerWidth() + (3 * userListData.itemRightDis) / 4;
  }
  var boxW = $box.eq(0).outerWidth() + userListData.itemRightDis;
  // 列数
  var cols = Math.floor(parentW / itemW)
  var hArr = [],maxArr=[];
  for (var i = 0; i < $box.length; i++) {
    if (i < cols) {
      hArr.push($box.eq(i).outerHeight() + userListData.itemBottomDis);
      boxH = Math.max.apply(null, hArr);
    } else {
    	  var minH = Math.min.apply(null, hArr)
          var minIndex = getUserGalleryIndex(hArr, minH);
    	  // 将图片放在上一行最矮的item下
    		  $box.eq(i).css('position', 'absolute')
              .css('top', minH + 'px')
              .css('left', boxW * minIndex + 'px')        
          // 改变数组
          hArr[minIndex] += $box.eq(i).outerHeight() + userListData.itemBottomDis;

          var endMaxH = Math.max.apply(null, hArr);
          boxH = endMaxH;
     
    
    }
  }
  $parent.height(boxH); 
  
}
/** 获取数组最小值的下标
 * @param arr 数组
 * @param val 最小值
 */
function getUserGalleryIndex(arr, val) {
  for (var i in arr) {
    if (arr[i] == val) {
      return i;
    }
  }
}
(function () {
	$(function () {
		var len = $(".user-center-mygallery").length;
		if (len == 0){
			return;
		}
		
		var requestUrl = honorApiUrl;
		var pageSize=12;
		var pageIndex=1;
		var totalPage=0;
		var windowW = utils.windowWidth();
		var language=window.digitalData.page.pageInfo.siteCode2;	
		if(language.toLowerCase()==="global"){
			language="en";
		}

		// 非编辑模式
		var isEdit = $(".user-center-mygallery .mygallery-box").hasClass('edit-mode');
		if (!isEdit) {
			// 当前Tab展示为 mygallery时
			var tabName = getCurrTabName();
			if (tabName == "mygallery") {
				getImgStyleList();
				getListUserAllImgInfo("");
				scrollGetDatas();
			}
			
			// 导航切换时 查询数据
			$(".user-center-top .nav li[relative='mygallery']").click(function() {
				pageIndex = 1;
				getImgStyleList();
				getListUserAllImgInfo("");
				scrollGetDatas();
			})
		}
		
		//拼接跳转的url
		function jointUrl(url) {
			if (url) {
				//拼跳转到详情页的链接
				var currPath = location.href;
				var prePath = '',
					endPath = '';
				if (currPath.indexOf('content/honor') != -1) {
					//预览环境
					prePath = currPath.split('/content/honor')[0];
					prePath += '/content/honor';
				} else {
					//发布环境
					prePath = location.protocol + '//' + window.location.host;
				}
				if (currPath.indexOf('.html') != -1) {
					//预览环境
					endPath += '.html';
					endPath += currPath.split('.html')[1];
					if(endPath.indexOf('#&') != -1){
						endPath = endPath.split('#&')[0];
					}
				} else {
					//发布环境
					endPath = '/';
				}
			}
			return prePath + url + endPath;
		}
		//查询用户选择类别列表
		function getImgStyleList(){
			$.ajax({
				url: requestUrl + '/abroad/shootMatch/getImgStyleList',
				data:{lang:language,activityName:"global_all_gallery"},
				async : false,
				type: 'get',
				dataType: "json",
				success:function(result){
					if(result.success){
						var data = result.infoBean,
							$listBox = $(".user-center-mygallery .mygallery-title .menu-list"),
							str="",
							allTxt = $listBox.data('all') || '';
						
						if(allTxt){
							str += '<span filterval="all">'+allTxt+'</span>';
						}
						for(var i=0;i<data.length;i++){
							str+="<span filterval='"+data[i].value+"'>"+data[i].nodeName+"</span>";
						}
						$(".user-center-mygallery .mygallery-title .menu-list").html(str);
						$(".user-center-mygallery .mygallery-title .menu-list span:nth-child(1)").addClass("cur");
						//根据类别查询作品
						$(".user-center-mygallery .mygallery-title .menu-list span").click(function(){
							$(this).siblings().removeClass("cur");
							$(this).addClass("cur");
							getListUserAllImgInfo("");
						})
					}
				}
			})
		};
		//执行点赞取消点赞事 的函数
		function executePares(){
			//点赞 取消点赞
			$(".user-center-mygallery .photos .photos-box .photo-desc .photo-actions div i.praise").click(function(){
				  var imgSrc= $(this).children("img").attr("src");
				  var num=+$(this).attr("num");
				  var activityName=$(this).attr("name");
				  var imgId=+$(this).attr("imgid");
				 if($(this).attr("class").indexOf("red")!==-1){
					 delPraise(this,activityName,imgId,num); 
				 }
				 else{
					 addPraise(this,activityName,imgId,num); 
				 }
			})
		}
		//查询用户所有作品 
		function getListUserAllImgInfo(loadType) {
			var dataObj={lang:language,imgReviewStatus:1,pageIndex:pageIndex,pageSize:pageSize};
			var cate=$(".user-center-mygallery .mygallery-title .menu-list span.cur").attr("filterval");
			if(cate!==undefined&&cate!=="cate"&&cate!==""){
				if(cate.toLowerCase()!=="all"){
					dataObj={lang:language,imgReviewStatus:1,pageIndex:pageIndex,pageSize:pageSize,imgStyle:cate}
				}
			}
			$.ajax({
				url: requestUrl + '/abroad/shootMatch/listUserAllImgInfo',
				data:dataObj,
				type: 'get',
				dataType: "jsonp",
				success: function (result) {
					if (result.success) {
						totalPage=result.infoBean.totalPage;
						var data = result.infoBean.pageList;
						var itemhtml = "";
						if(data.length<=0){
							var noData=$(".user-center-mygallery #nodata").val();
							$(".user-center-mygallery .photos .photos-box").html('<div class="nodata"><img src="/etc/designs/honor-site/assets/icons/edit-white-icon.png" /><p style="margin-top:10px;">'+noData+'</p></div>');
									return false;
						}
						for (var i = 0; i < data.length; i++) {
							 var linkToDetail=data[i].htmlPath;
							 if(+data[i].isGallery===0){
								 var itemPath = data[i].htmlPath;
								 //文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
								 if(data[i].fileType && data[i].fileType=='0' && itemPath && itemPath.indexOf('/photo.') != -1){
									 //因后端存在垃圾数据，这里再次做转换处理
									 itemPath = itemPath.replace('/photo.','/video.');
								 }
								 linkToDetail=jointUrl(itemPath);
							 }
							 itemhtml += '<div class="box-item">';
						        itemhtml += '<div class="img honor-loading-v2 honor-loading-sm"><a title="'+ data[i].imgThemes+'" href="'+linkToDetail+'">';
						        if(utils.windowWidth()>768){
						        	itemhtml += '<img  class="lazy" title="' + data[i].imgThemes + '" alt="' + data[i].imgThemes + '" src="' + data[i].imgSrc + '" />';
						        }else{
						        	itemhtml += '<img  class="lazy" data-original="'+data[i].imgSrc+'" title=' + data[i].imgThemes + ' alt=' + data[i].imgThemes + '/>';
						        }
						        	// 文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
									if(data[i].fileType && data[i].fileType=='0'){
										itemhtml+='<img class="icon-video" src="/etc/designs/honor-site/assets/icons/play-arrow.png">';
									}
						        itemhtml += '</a></div>';
						        itemhtml +='<div class="photo-desc">';
						                itemhtml +='<a title="'+ data[i].imgThemes+'" href="'+linkToDetail+'"><div class="desc">';
						                        itemhtml +='<div class="tilte">'+data[i].imgThemes+'</div>';
						                        itemhtml +='<div class="desc-con">'+data[i].imgContent+'</div>';
						                itemhtml +='</div></a>';
						                itemhtml +='<div class="photo-actions">';
						                        itemhtml +='<div><i  name="'+data[i].activityId+'" imgid="'+data[i].imgId+'" num="'+data[i].praiseNum+'" class="praise '+(+data[i].isPraised===0?" red":"")+' fa fa-heart"></i><span>'+data[i].praiseNum+'</span></div>';
						                        itemhtml +='<div> <i class="fa fa-comment"></i><span>'+data[i].commentNum+'</span></div>';
						                itemhtml +='</div>';
						        itemhtml +='</div>';
						 itemhtml += "</div>";
						}
						if(loadType==="scrollLoad"){
							$(".user-center-mygallery .photos .photos-box").append(itemhtml);
							
						}else{
							$(".user-center-mygallery .photos .photos-box").html(itemhtml);
						}
						
						if(utils.windowWidth()<=768){
							$(".user-center-mygallery .photos .lazy").lazyload({
								"placeholder":lazyload.placeholder
							}); 
						}
						
						executePares();
						
						//图片加载完毕，执行瀑布流渲染
						$('.user-center-mygallery .photos .photos-box .box-item .img img').imagesLoaded()
						.progress(function(instance,image){
							// 当前图片加载完成后，去除loading效果
							if(image.isLoaded){
								$(image.img).parent().parent().removeClass('honor-loading-v2');
							}
							
							if(windowW>768){
								userCenterMyGalleryWaterfall('.user-center-mygallery .photos .photos-box', '.user-center-mygallery .photos .photos-box .box-item');
							}
							
						})
						.done(function(ins,image){
							 $(".user-center-mygallery .photos .photos-box .box-item").removeAttr("style");
							 if(windowW>768){
								 userCenterMyGalleryWaterfall('.user-center-mygallery .photos .photos-box', '.user-center-mygallery .photos .photos-box .box-item');
							 }
							
						})						
						$('.user-center-mygallery .photos-box .photo-desc .desc').niceScroll({
						    cursorcolor: "#ccc",//#CC0071 光标颜色
						    cursoropacitymax: 1, //改变不透明度非常光标处于活动状态（scrollabar“可见”状态），范围从1到0
						    touchbehavior: false, //使光标拖动滚动像在台式电脑触摸设备
						    cursorwidth: "5px", //像素光标的宽度
						    cursorborder: "0", // 游标边框css定义
						    cursorborderradius: "5px",//以像素为光标边界半径
						    autohidemode: false //是否隐藏滚动条
						});
						//鼠标经过显示
						if(windowW>=1024){
						$(".user-center-mygallery .photos .photos-box .box-item").stop().hover(function(e){
							
							var $thisH=$(this).height();
							e.stopPropagation();
							var $descCon=$(this).children("div.photo-desc").children("a").children("div.desc").children("div.desc-con");
							var $photoActions=$(this).children("div.photo-desc").children("div.photo-actions");
							
							$(this).children("div.photo-desc").children("a").children("div.desc").children("div.author").stop().show();
							$descCon.stop().show();
							$photoActions.stop().show();
							var  descConH=$descCon.height();
							if(descConH>60){
								descConH=60;
							}
							descConH+=$photoActions.height();
							$descCon.css("display","-webkit-box");
							$(this).children("div.photo-desc").attr("style","position:absolute;height: auto;");
							$(this).css("height",$thisH);
		
						}).stop().mouseleave(function(e){
							e.stopPropagation();
							$(this).children("div.img").children("a").children("img").css("height","auto");
							$(this).children("div.photo-desc").children("a").children("div.desc").children("div.author").stop().hide();
							$(this).children("div.photo-desc").children("a").children("div.desc").children("div.desc-con").stop().hide();
							$(this).children("div.photo-desc").children("div.photo-actions").stop().hide();
							
						});
						}
					}
				}
			})
			//点赞 取消点赞
			$(".user-center-mygallery .photos .photos-box .photo-desc .photo-actions div i.praise").click(function(){
				  var imgSrc= $(this).children("img").attr("src");
				  var num=+$(this).attr("num");
				  var activityName=$(this).attr("name");
				  var imgId=+$(this).attr("imgid");
				 if($(this).attr("class").indexOf("red")!==-1){
					 delPraise(this,activityName,imgId,num); 
				 }
				 else{
					 addPraise(this,activityName,imgId,num); 
				 }
			})
		}
		
		 //滚动加载
		function scrollGetDatas(){
			$(window).scroll(function(){
			 var scrollTop = $(this).scrollTop();//滚滚动条 距离顶部距离
			 var documentHeight = $(document).height();//内容高度
			 var windowHeight = $(this).height();//可见高度
			 var footerHeight=$(".footer").height();//底部高度
			 if(windowHeight+scrollTop>=documentHeight-footerHeight){
				if(totalPage>pageIndex){
					pageIndex+=1;
					 getListUserAllImgInfo("scrollLoad");
				}
				
				}
		    });	
		}
		
		//添加点赞
		function addPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/shootMatch/addPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							num +=1;
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).addClass("red");
						}
					}
				})
		};
		//删除点赞
		function delPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/shootMatch/delPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							num -=1;
							if(num<0){
								num=0;
							}
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).removeClass("red");
						}

					}
				})
		};
		
		
	});
})();
$(function(){ 
	// 若是publish环境，用户未登录，访问个人中心需要跳转回首页
	var isAuthor = $("#isAuthor").val();
	if (isAuthor == "false") {
		honorData.loginName = decodeURI(utils.getCookie('loginUid'));
		if (honorData.loginName === "" || honorData.loginName === null || honorData.loginName === "null") {
			var url = $(".header .logo-home").attr("href");
			window.location.href = url;
		}
	};

	var len = $(".user-center-msg").length;
	if (len == 0) {
		return;
	}
	// 语言传参
	var language = window.digitalData.page.pageInfo.siteCode2;
	if(language=='global'){
		language='en';
	}
	
	var userCenterJson={
		requestUrl:honorApiUrl,
		pageSize:10,
		msgType:1, 		// 消息类型 	1 Notifications, 2 messages
		pageIndex:0,
		messageIndex:0,
		hasNotice: true,  // 有通知
		hasMsg: true //有消息
	}
	 
	// 非编辑模式 
	var isEdit = $(".user-center-top .top-box").hasClass('edit-mode');
	if(!isEdit){
		// 当前Tab展示为 inbox时
		var tabName = getCurrTabName();
		if (tabName == "inbox") {
			var msgType = utils.getRequest().msgType;
			if(msgType !== "undefined" && msgType !== undefined){
				userCenterJson.msgType = msgType;
			}
			changeTab();
			scrollGetMsg();
		}
		
		// 导航切换时 查询数据
		$(".user-center-top .nav li[relative='inbox']").click(function() {
			userCenterJson.pageIndex = 0;
			changeTab();
			scrollGetMsg();
		})
	}
	
	$(".tab-menu li").click(function(){
		userCenterJson.pageIndex = 0;
		var index = $(this).index();
		if (index == 0) {
			userCenterJson.msgType = 1; 
			userCenterJson.pageIndex = 0;
		} else if(index == 1) {
			userCenterJson.msgType = 2; 
			userCenterJson.messageIndex = 0;
		}
		changeTab();
	})
	
	function changeTab() {
		if(userCenterJson.msgType == '1'){
			$(".tab-menu li").eq(0).addClass("cur").siblings('li').removeClass("cur");
	    	 
	    	 getNotifications(userCenterJson.pageIndex,'reset');
	    	 
	    	 $(".user-center-msg .con-list .not").show();
	    	 $(".user-center-msg .con-list .msg").hide();
	     }else if(userCenterJson.msgType == '2'){
	    	 $(".tab-menu li").eq(1).addClass("cur").siblings('li').removeClass("cur");
	    	 
	    	 getMsgs(userCenterJson.messageIndex,'reset');
	    	 
	    	 $(".user-center-msg .con-list .not").hide();
	    	 $(".user-center-msg .con-list .msg").show();
	     }
	}

	function isShowNameByType(val){
 	   if(+val===1||+val===2||+val===5){
 		return true;   
 	   }
 	   return false;
    }
	
    var isArabic=$("div").hasClass("__arabic__");
    var nodataText = $(".tab-menu li").eq(0).attr("data-nodatatip"),
    	nodataText2 = $(".tab-menu li").eq(1).attr("data-nodatatip");
    
 	// 获取Notifications 列表
 	function getNotifications(pageIndex,type) {
 		userCenterJson.msgType=1;
 		$.ajax({
 			async : false,
 			type : "get",
 			url : userCenterJson.requestUrl+'/abroad/userCenter/getNotifications',
 			data : {
 				lang:language,
 				messageType : userCenterJson.msgType,
 				pageIndex : pageIndex,
 				pageSize : userCenterJson.pageSize
 			},
 			dataType : "jsonp",
 			success : function(result) {
 				if(result.code==='000000'){
 					var data = result.infoBean.pageList;
 					if(data.length===0){
 						userCenterJson.hasNotice = false;
 						if(pageIndex==0){ 
 							var str = "<div class='not-box'><img src=\"/etc/designs/honor-site/assets/icons/edit-white-icon.png\" /><p>"+nodataText+"</p><div>";
 							$(".user-center-msg .con-list .not").html(str);
 							return false;
 						}else{
 							$('.user-center-msg .btn-more').hide();
 						}
 					}
 					if (data.length > 0) {
 						var lihtml = $(".user-center-msg .con-list .not");
 						if(type=='reset'){
 							lihtml.html('');
 						}
 						for (var i = 0; i < data.length; i++) {
	 						var strongHtml="<strong>";
	 						if(data[i].messageStatus===2){
	 							// 已读
	 							strongHtml='<strong class="dashed">';
	 						}
 							var title=data[i].title;
 							if(title.indexOf('{name}')!==-1){
 								var userName=strongHtml+data[i].senderUserName+"</strong>";
 								if(isArabic){
 									userName=" "+data[i].senderUserName+" ";
 									var arr=title.split("{name}");
 									if(arr[1]){
 										userName=strongHtml+data[i].senderUserName+"</strong>";
 									}
 								}
 								title=title.replace("{name}",userName);
 							}
 							
 							var str = '<div class="lists">';
 								str += '<ul>';
	 								str += '<li class="round">';
	 									str += '<i class="'+(data[i].messageStatus===1?"round":"round dashed")+'"></i>';
									str += '</li>';
 									str += '<li class="title" data-activityid="'+data[i].activityId+'" data-status="'+data[i].messageStatus+'" data-id="'+data[i].id+'" data-shooturl="'+data[i].shootUrl+'" data-isgallery="'+data[i].isGallery+'" data-service="'+data[i].serviceAddr+'" >';
 										if(isShowNameByType(data[i].functionType)){
 											str += '<img src="'+data[i].userImage+'">';
 										}
 										var titleTxt = data[i].title.replace("{name}",data[i].senderUserName);
 										str += '<label title="'+titleTxt+'">'+title+'</label>';
 									str += '</li>';
 									str += '<li class="comment-date '+(isShowNameByType(data[i].functionType)?"hasuserimg":"")+'">'+data[i].createTime+'</li>';
 									str += '<li class="img" style="background-image:url('+data[i].shootImage+')"></li>';
 								str += '</ul>';
 							str += '</div>';
 							
 							lihtml.append(str);
 							
 							$(".user-center-msg .con-list .not .title").off().click(function(){
 								var status = $(this).data('status');
 								var shooturl = $(this).data('shooturl');
 								var isGallery = $(this).data('isgallery');
 								var activityId = $(this).data('activityid');
 								if(status=='1'){
 									// 更新未读消息为已读，并跳转到对应页面
	 								var id = $(this).data('id');
	 								var obj = $(this).parent();
	 								var serviceAddr = $(this).data('service');
	 								$(this).find("strong").addClass("dashed");
	 								updateNotMsgStatus(id,obj,shooturl,isGallery,serviceAddr,activityId);
 								}else{
 									// 已读消息直接跳转
 									openPage(shooturl,isGallery,activityId);
 								}
 							})
 						}
 					}
 				}
 			}

 		})
 	}
 	// 获取msg 列表
 	function getMsgs(index,type) {
 		userCenterJson.msgType=2;
 		$.ajax({
 			async : false,
 			type : "get",
 			url :userCenterJson.requestUrl+'/abroad/userCenter/getNotifications',
 			data : {
 				lang:language,
 				messageType : userCenterJson.msgType,
 				pageIndex : index,
 				pageSize : userCenterJson.pageSize
 			},
 			dataType : "jsonp",
 			success : function(result) {
 				if(result.code==='000000'){
 					var data = result.infoBean.pageList;
 					var $msgBox = $(".user-center-msg .con-list .msg");
 					if(data.length===0){
 						userCenterJson.hasMsg = false;
 						if(index==0){ 
 							var str = '<div class="not-box"><img src="/etc/designs/honor-site/assets/icons/edit-white-icon.png" /><p>'+nodataText2+'</p><div>';
 							$msgBox.html(str);
 							return false;
 						}else{
 							$('.user-center-msg .btn-more').hide();
 						}
 					} 
 					if (data.length > 0) {
 						if(type=='reset'){
 							$msgBox.empty();
 						}
 						for (var i = 0; i < data.length; i++) {
 							var str = '';
 							str+='<div class="lists">';
 								str+='<ul data-id="'+ data[i].id+'" data-service="'+data[i].serviceAddr+'" data-flag="close" data-status="'+data[i].messageStatus+'">';
 									str+='<li class="round"><i class="'+(data[i].messageStatus===1?"round":"round dashed")+'"></i></li>';
									str+='<li class="title">';
										str+='<strong title="'+data[i].title+'" class="'+(data[i].messageStatus===2?"dashed":"")+'">'+data[i].title+'</strong>';
									str+='</li>';
									str+='<span class="comment-date">'+data[i].createTime+'</span>';
									str+='<li class="img">';
										str+='<div class="font font-Arrow-up arrow"></div>';
									str+='</li>';
								str+='</ul>';
								str+='<div class="con">'+data[i].message+'</div>';
							str+='</div>';
									
							$msgBox.append(str);
 							
 							$('.msg-box .msg .lists ul').off().click(function(e){
 								utils.stopBubble(e);
 								// flag :close表示闭合  open表示展开状态
 								var flag = $(this).attr('data-flag');
 								if (flag=='open') {
 									$(this).attr('data-flag','close');
 									$(this).find(".arrow").removeClass('flipy');
 									$(this).next().hide();
 								} else {
 									$(this).attr('data-flag','open');
 									$(this).find(".arrow").addClass('flipy');
 									$(this).next().show();
 								}
 								
 								var status = $(this).attr('data-status');
 								if(status=='1'){
 									//更新未读消息为已读
 									var id = $(this).data('id');
 									var serviceAddr = $(this).data('service');
 									$(this).find(".title strong").addClass("dashed");
 									
 									updateNotMsgStatus(id,this,"","",serviceAddr,"");
 								}
 							})
 							
 						}
 					}
 				}
 			}

 		})
 	};
 	
 	//标记全部为已读
 	function  markAllRead(){
 		$.ajax({
 			type : "post",
 			url :userCenterJson.requestUrl+'/abroad/userCenter/updateAllMessageStatusToRead',
 			data : {messageType:userCenterJson.msgType},
 			dataType : "jsonp",
 			success : function(result){
 				if(result.success){
 					if(userCenterJson.msgType===2){
 						$(".user-center-msg .con-list .msg .lists li i.round").addClass("dashed");
 	 					$(".user-center-msg .con-list .msg .lists li strong").addClass("dashed");
 					}
 					else{
 						$(".user-center-msg .con-list .not .lists li i.round").addClass("dashed");
 	 					$(".user-center-msg .con-list .not .lists li strong").addClass("dashed");
 					}
 					var name="gallery-notification";
 					if(+userCenterJson.msgType===2){
 						name="gallery-message";
 					}
 					//更新Header系统消息 
 					getMessageLists(name);
 					getMessageNum();
 				}
 				
 			}
 		})
 	};
 	$(".user-center-msg .tab .tab-edit").click(function(){
 		markAllRead();
 	})
 	
 	// 滚动加载消息列表
 	function scrollGetMsg(){
	 	$(window).scroll(function(){	  
	 		var scrollTop = $(this).scrollTop();//滚动高度
	 		var contentHeight = $(document).height();//内容高度
	 		var windowHeight = $(this).height();//可见高度
	 		var footerHeight=$(".footer").height();//底部高度
	 		if(contentHeight-footerHeight <=windowHeight+scrollTop){
	 			if(userCenterJson.msgType===1 && userCenterJson.hasNotice){
	 				var pageIndex=userCenterJson.pageIndex++
	 				if(pageIndex!==undefined){
	 					getNotifications(userCenterJson.pageIndex);
	 				}
	 			}else if(userCenterJson.msgType===2  && userCenterJson.hasMsg){
	 				var pageIndex= userCenterJson.messageIndex++;
	 				if(pageIndex!==undefined){
	 					getMsgs(userCenterJson.messageIndex);
	 				}
	 			}  
			}
	 	})		    
 	}
	
 	/*
 	 * 更新消息状态为已读
 	 * @param id: 消息id
 	 * @param el: 当前消息对象
 	 * @param hrefUrl: 消息对应 图片/视频详情页路径
 	 * @param isGallery: 图片是否在gallery栏目下上传的（0：是，1：否） 
 	 * @param serviceAddr: 服务器地址
 	 * @param activityId: 活动id，当前用于判断是否为 VisualCraft栏目:HONOR_wallpaper_design_contest
 	 * 
 	 */
 	function updateNotMsgStatus(id,el,hrefUrl,isGallery,serviceAddr,activityId){
 		$.ajax({
 			type : "post",
 			url : userCenterJson.requestUrl+'/abroad/userCenter/updateMessageStatusToRead',
 			data : {id : id,serviceAddr:serviceAddr},
 			dataType : "jsonp",
 			success : function(result) {
 				if(result.code==="000000"){
 					$(el).children("li.round").children("i").addClass("dashed"); 
 					var name="gallery-notification";
 					if(userCenterJson.msgType == '2'){
 						name="gallery-message";
 					}
 					
 					//更新Header系统消息 
 					getMessageLists(name);
 					getMessageNum();
 					
 					// 跳转页面
 					if(hrefUrl){
 						openPage(hrefUrl,isGallery,activityId);
 					}
 				}
 			}
 			
 		}) 
 	};
 	
 	/*
 	 * 跳转到消息所在的图片或视频详情页
 	 * @param hrefUrl: 消息对应 图片/视频详情页路径
 	 * @param isGallery: 图片是否在gallery栏目下上传的（0：是，1：否） 
 	 * @param activityId: 活动id，当前用于判断是否为 VisualCraft栏目:HONOR_wallpaper_design_contest
 	 * 
 	 */
 	function openPage(hrefUrl,isGallery,activityId){
 		//拼跳转到详情页的链接
			var currPath = location.href; 
			var prePath ='',endPath ='';
			if(currPath.indexOf('content/honor')!=-1){
				//预览环境
				prePath = currPath.split('/content/honor')[0];
				prePath+='/content/honor';
			}else{ 
				//发布环境
				prePath=location.protocol+'//'+window.location.host;
			} 
			if(currPath.indexOf('.html')!=-1){
				//预览环境
				endPath +='.html';
				endPath += currPath.split('.html')[1];
				if(endPath.indexOf('#&') != -1){
					endPath = endPath.split('#&')[0];
				}
			}else{
				//发布环境
				endPath ='/';
			} 
			if(isGallery=='0' || activityId=='HONOR_wallpaper_design_contest'){
				window.location.href= prePath+hrefUrl+endPath;
			}else{
				window.location.href= hrefUrl;
			}
 	}
 	
});

(function () {
	$(function () {
		var len = $(".user-center-favorites").length;
		if (len == 0) {
			return;
		}
		
		var language=window.digitalData.page.pageInfo.siteCode2;	
		if(language.toLowerCase()==="global"){
			language="en";
		}
			
		var requestUrl = honorApiUrl;
		var windowW = utils.windowWidth();
		var pageSize=12;
		var pageIndex=1;
		var totalPage=0;
		if(windowW<=768){
			pageSize=8;
		}

		// 非编辑模式
		var isEdit = $(".user-center-favorites .favorite-box").hasClass('edit-mode');
		if(!isEdit){
			// 当前Tab展示为 favorite时
			var tabName = getCurrTabName();
			if (tabName == "favorite") {
				getMyFavorites('click');
				scrollGetDatas();
			}
			
			// 导航切换时 查询数据
			$(".user-center-top .nav li[relative='favorite']").click(function() {
				pageIndex = 1;
				getMyFavorites('click');
				scrollGetDatas();
			})
			
		}
		//拼接跳转的url
		function jointUrl(url) {
			if (url) {
				//拼跳转到详情页的链接
				var currPath = location.href;
				var prePath = '',
					endPath = '';
				if (currPath.indexOf('content/honor') != -1) {
					//预览环境
					prePath = currPath.split('/content/honor')[0];
					prePath += '/content/honor';
				} else {
					//发布环境
					prePath = location.protocol + '//' + window.location.host;
				}
				if (currPath.indexOf('.html') != -1) {
					//预览环境
					endPath += '.html';
					endPath += currPath.split('.html')[1];
				} else {
					//发布环境
					endPath = '/';
				}
			}
			return prePath + url + endPath;
		}
		/*
		 * 查询我收藏的作品
		 * @type 加载类型  scroll：滚动加载，click：点击tab加载
		 */
		function getMyFavorites(type) {
			$.ajax({
				url: requestUrl + '/abroad/shootMatch/listMyFavouriteImageInfo',
				data:{lang:language,pageIndex:pageIndex,pageSize:pageSize},
				type: 'get',
				dataType: "jsonp",
				success: function (result) {
					if (result.success) {
						var data = result.infoBean.pageList;
						if(data.length===0 && pageIndex=='1'){
							$(".user-center-favorites .photos .nodata").show();
							return false;
						}
						totalPage=result.infoBean.totalPage;
						var itemhtml = "";
						for (var i = 0; i < data.length; i++) {
							 var linkToDetail=data[i].htmlPath;
							 if(+data[i].isGallery===0){
								 var itemPath = data[i].htmlPath;
								 //文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
								 if(data[i].fileType && data[i].fileType=='0' && itemPath && itemPath.indexOf('/photo.') != -1){
									 //因后端存在垃圾数据，这里再次做转换处理
									 itemPath = itemPath.replace('/photo.','/video.');
								 }
								 linkToDetail=jointUrl(itemPath);
							 }
							 itemhtml += '<div class="box-item">';
							        itemhtml += '<div class="img honor-loading-v2 honor-loading-sm"><a title="'+ data[i].imgThemes+'" href="'+linkToDetail+'">';
								        if(utils.windowWidth()>768){
								        	itemhtml += '<img class="lazy" title="' + data[i].imgThemes + '" alt="' + data[i].imgThemes + '" src="' + data[i].imgSrc + '" />';
								        }else{
								        	itemhtml += '<img class="lazy" data-original="'+data[i].imgSrc+'" title="' + data[i].imgThemes + '" alt="' + data[i].imgThemes + '" />';
								        }
								        // 文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
										if(data[i].fileType && data[i].fileType=='0'){
											itemhtml+='<img class="icon-video" src="/etc/designs/honor-site/assets/icons/play-arrow.png">';
										}
							        itemhtml += '</a></div>';
							        itemhtml +='<div class="photo-desc">';
							                itemhtml +='<a title="'+ data[i].imgThemes+'" href="'+linkToDetail+'"><div class="desc linear-scroll scroll-sm">';
							                        itemhtml +='<div class="tilte">'+data[i].imgThemes+'</div>';
							                        itemhtml +='<div class="author">'+data[i].nickNameAct+'</div>';
							                        itemhtml +='<div class="desc-con">'+data[i].imgContent+'</div>';
							                itemhtml +='</div></a>';
							                itemhtml +='<div class="photo-actions">';
							                        itemhtml +='<div><i  name="'+data[i].activityId+'" imgid="'+data[i].imgId+'" num="'+data[i].praiseNum+'" class="praise red fa fa-heart"></i><span>'+data[i].praiseNum+'</span></div>';
							                        itemhtml +='<div> <i class="fa fa-comment"></i><span>'+data[i].commentNum+'</span></div>';
							                itemhtml +='</div>';
							        itemhtml +='</div>';
							 itemhtml += "</div>";
						}
						if(type=="scroll"){
							$(".user-center-favorites .photos .photos-box").append(itemhtml);
						}else if(type=="click"){
							$(".user-center-favorites .photos .photos-box").html(itemhtml);
						}
						if(utils.windowWidth()<=768){
							$(".user-center-favorites .photos .lazy").lazyload({
								"placeholder":lazyload.placeholder
							}); 
						}
						
						//图片加载完毕，去除loading效果
						$('.user-center-favorites .photos .photos-box .img img').imagesLoaded()
						.progress(function(instance,image){
							// 当前图片加载完成后，去除loading效果
							if(image.isLoaded){
								$(image.img).parent().parent().removeClass('honor-loading-v2');
							}
						})
						
						//鼠标经过显示
						$(".user-center-favorites .photos .photos-box .box-item").mouseover(function(){
							$(this).children("div.photo-desc").show();
						}).mouseleave(function(){
							$(this).children("div.photo-desc").hide();
						});
					}
				}
			})
		}
		//添加点赞
		function addPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/shootMatch/addPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							num +=1;
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).addClass("red");
						}
					}
				})
		}
		//删除点赞
		function delPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/shootMatch/delPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							num -=1;
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).removeClass("red");
						}

					}
				})
		};
		
		$(window).on("load",function(){
			//点赞 取消点赞
			$(".user-center-favorites .photos .photos-box .photo-desc .photo-actions div i.praise").click(function(){
				  var imgSrc= $(this).children("img").attr("src");
				  var num=+$(this).attr("num");
				  var imgId=+$(this).attr("imgid");
				  var activityName=$(this).attr("name");
				 if($(this).attr("class").indexOf("red")!==-1){
					 delPraise(this,activityName,imgId,num); 
				 }
				 else{
					 addPraise(this,activityName,imgId,num); 
				 }
			})
		})
		
	    //滚动加载
		function scrollGetDatas(){
			$(window).scroll(function(){
			 var scrollTop = $(this).scrollTop();//滚滚动条 距离顶部距离
			 var documentHeight = $(document).height();//内容高度
			 var windowHeight = $(this).height();//可见高度
			 var footerHeight=$(".footer").height();//底部高度
			 if(windowHeight+scrollTop>=documentHeight-footerHeight){
				 if(totalPage>=pageIndex){
					 pageIndex+=1;
					 getMyFavorites('scroll');
				 }
				}
		    })	
		}
	});
})();
(function () {
	
		var requestUrl = honorApiUrl;
		var language=window.digitalData.page.pageInfo.siteCode2;	
		if(language.toLowerCase()==="global"){
			language="en";
		}
		//拼接跳转的url
		function jointUrl(url) {
			if (url) {
				//拼跳转到详情页的链接
				var currPath =window.location.href;
				var prePath = '',
					endPath = '';
				if (currPath.indexOf('content/honor') != -1) {
					//预览环境
					prePath = currPath.split('/content/honor')[0];
					prePath += '/content/honor';
				} else {
					//发布环境
					prePath = location.protocol + '//' + window.location.host;
				}
				if (currPath.indexOf('.html') != -1) {
					//预览环境
					endPath +='.html';
					endPath += currPath.split('.html')[1];
					if(endPath.indexOf('#&') != -1){
						endPath = endPath.split('#&')[0];
					}
				} else {
					//发布环境
					endPath = '/';
				}
			}

			return prePath + url + endPath;
		}
		/* 查询用户作品 根据点赞数量排序
		 * @param type:类型   值为 gallery（默认值）   和visualcraft（视觉艺术）
		 */	
		function getUserPhotosSortByPraise(type) {
			type = type || 'gallery';
			var apiUrl = requestUrl + '/abroad/shootMatch/listUserImgInfoPraiseOrder';
			if(type=='visualcraft'){
				apiUrl = requestUrl + '/abroad/wallpaper/listUserWallPaperImgInfoPraiseOrder';
			}
			$.ajax({
				url: apiUrl,
				data:{lang:language,pageIndex:1,pageSize:6},
				type: 'get',
				dataType: "jsonp",
				success: function (result) {
					if (result.success) {
						var data = result.infoBean.pageList;
						var lihtml = renderingPhotos(data);
						if(type=='visualcraft'){
							lihtml = renderingWorks(data);
						}
						$(".user-center-about .pop-photos .photos-box").html(lihtml);
						$(".user-center-about .box-item .lazy").lazyload({
							"placeholder":lazyload.placeholder
						}); 
					}
				}
			})
		}
		
		// 渲染Gallery栏目相关 点赞Top6作品列表
		function renderingPhotos(data){
			if(data.length=='0'){
				var tip = $('.user-center-about [data-type="gallery"]').data('nodatatip') || '';
				$('.user-center-about .nodata-tip').text(tip);
				$(".user-center-about .nodata").show();
				return false;
			}else{
				$(".user-center-about .nodata").hide();
			}
			var lihtml = "";
			for (var i = 0; i < data.length; i++) {
				var linkToDetail=data[i].htmlPath;
				if(data[i].isGallery=='0'){
					// gallery栏目
					var itemPath = data[i].htmlPath;
					//文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
					if(data[i].fileType && data[i].fileType=='0' && itemPath && itemPath.indexOf('/photo.') != -1){
						//因后端存在垃圾数据，这里再次做转换处理
						itemPath = itemPath.replace('/photo.','/video.');
					}
					linkToDetail=jointUrl(itemPath);
				}
				lihtml += '<div class="box-item">';
					lihtml += '<div class="img"><a title="'+ data[i].imgThemes+'" href="'+linkToDetail+'">';
						lihtml += '<img class="lazy" data-original="'+data[i].imgSrc+'" title="' + data[i].imgThemes + '" alt="' + data[i].imgThemes + '" />';
						// 文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
						if(data[i].fileType && data[i].fileType=='0'){
							lihtml+='<img class="icon-video" src="/etc/designs/honor-site/assets/icons/play-arrow.png">';
						}
					lihtml += '</a></div>';
					lihtml += '<div class="name"><a href="'+linkToDetail+'" title="'+ data[i].imgThemes+'">' + data[i].imgThemes + '</a></div>';
				lihtml += "</div>";
			}
			
			return lihtml;
		}
		// 渲染VisualCraft 点赞Top6作品列表
		function renderingWorks(data){
			if(data.length=='0'){
				var tip = $('.user-center-about [data-type="visualcraft"]').data('nodatatip') || '';
				$('.user-center-about .nodata-tip').text(tip);
				$(".user-center-about .nodata").show();
				return false;
			}else{
				$(".user-center-about .nodata").hide();
			}
			var lihtml = "";
			for (var i = 0; i < data.length; i++) {
				var detailUrl= jointUrl('/visualcraft/'+honorConfig.lang+'/detail.'+data[i].id);
				lihtml += '<div class="box-item">';
					lihtml += '<div class="img"><a title="'+ data[i].title+'" href="'+detailUrl+'">';
						lihtml += '<img class="lazy" data-original="'+data[i].imgSrc+'" title="' + data[i].title + '" alt="' + data[i].title + '" />';
					lihtml += '</a></div>';
					lihtml += '<div class="name"><a href="'+detailUrl+'" title="'+ data[i].title+'">' + data[i].title + '</a></div>';
				lihtml += "</div>";
			}
			return lihtml;
		}
		
		//获取用户昵称和地点
		function getUserDisplayName(){
			// 获取用户昵称
			var displayName = decodeURIComponent(utils.getCookie('displayName')) || ''; 
			if(displayName && displayName!='null'){
				$(".user-center-about .user-info #nickname").text(displayName);
			}
			
			// 获取用户地点
			var nationalCode = decodeURIComponent(utils.getCookie('nationalCode')) || ''; 
			if(nationalCode && nationalCode!='null'){
				$(".user-center-about .user-info #location").text(nationalCode);
			} 
		}
		
		$(function () {
			var len = $(".user-center-about").length;
			var isEdit = $(".user-center-about .about-box").hasClass('edit-mode');
			if (len > 0 && !isEdit) {
				// 当前Tab展示为 About时
				var tabName = getCurrTabName();
				if (tabName == "about") {
					getUserPhotosSortByPraise();
					getUserDisplayName();
				}
				
				// 导航切换时 查询数据
				$(".user-center-top .nav li[relative='about']").click(function() {
					getUserPhotosSortByPraise();
					getUserDisplayName();
					$('.user-center-about .pop-tab li:first-child').addClass('active').siblings().removeClass('active');
				})
				
				// 切换tab
				$('.user-center-about .pop-tab li').click(function(){
					var type = $(this).data('type');
					$(this).addClass('active').siblings().removeClass('active');
					getUserPhotosSortByPraise(type);
				})
				
			}
		
		})

})();
/**
 * Gallery Wall
 */
(function(){
	$(function(){ 
		if($('.gallery-wall').length>0){
			// 获取隐藏标识
			var modeType = $('#modeType').val();
			if(modeType!='edit'){
				$('.gallery-wall .item-box a').each(function(){
					var flag = $(this).hasClass('hidden');
					if(flag){
						$(this).parent().hide();
					}
				})
				$('.gallery-wall .item-img').each(function(){
					var imgsrc = $(this).data('src'); 
					if(imgsrc){
						// 增加loading效果
						$(this).parent().parent().addClass('honor-loading');
					}
				})
			}
			// 懒加载
			$(".gallery-wall .item-img").lazyload({
				"placeholder":lazyload.placeholder
			}).show();
			
			// Photo item链接传参
			$('.gallery-wall .photo-itemlink').each(function(){
				var txt = $.trim($(this).data('title'));
				var currUrl = $(this).attr('href');
				var endUrl ='';
				if(currUrl){
					if(currUrl.indexOf('?')!=-1){
						endUrl = currUrl+'&type='+txt;
					}else{
						endUrl = currUrl+'?type='+txt;
					}
					$(this).attr('href',endUrl);
				}
			})
			
			// 根据月份修改 跳转链接
			$('.gallery-wall .item-month-link').each(function(){
				var year = $(this).data('year') || '2020';
				var month = $(this).data('month');
				var itemLink= $(this).attr('href'); 
				var monthTrans ='';
				switch(month){
					case '01':
						monthTrans= 'January';
						break;
					case '02':
						monthTrans = 'February';
						break;
					case '03':
						monthTrans= 'March';
						break;
					case '04':
						monthTrans = 'April';
						break;
					case '05':
						monthTrans= 'May';
						break;
					case '06':
						monthTrans = 'June';
						break;
					case '07':
						monthTrans= 'July';
						break;
					case '08':
						monthTrans = 'August';
						break;
					case '09':
						monthTrans= 'September';
						break;
					case 10:
						monthTrans = 'October';
						break;
					case 11:
						monthTrans = 'November';
						break;
					case 12:
						monthTrans = 'December';
						break;
				}  
				if(itemLink){
					var endLink =''; 
					if(itemLink.indexOf('?')!=-1){
						endLink = itemLink + '&month='+monthTrans + '&year='+year;
					}else{
						endLink = itemLink + '?month='+monthTrans + '&year='+year;
					}
					$(this).attr('href',endLink);
				}
			})
		}
	})
	
}());
/**
 * 视频弹窗支持
 */
(function() {
	if($('.gallery-wall').length>0){
		window.GalleryWALL = {
			init : function() {
				if ($('.gallery-wall a.video-item-box').length > 0) {
					this.initVideoBox();
					this.initVideoButton();
				}
			},
			initVideoBox : function(videoType, videoRatio, videoURL, videoWebmURL,videoOggURL) {
				var videoHTML;
				if (videoType == 'embed') {
					videoHTML = '<video id="galleryWallVideo" class="video-js vjs-default-skin vjs-big-play-centered" controls autoplay="false" preload="auto" width="100%"><source src="'+ videoURL+ '" type="video/mp4" /><source src="'+ videoWebmURL+ '" type="video/webm" /><source src="'+ videoOggURL + '" type="video/ogg" /></video>';
				} else if (videoType == 'youtube') {
					videoHTML = '<div class="embed-responsive embed-responsive-'+ videoRatio+ '"><iframe class="embed-responsive-item"  src="https://www.youtube.com/embed/'+ videoURL+ '?rel=0&amp;autoplay=1&amp;showinfo=0&amp;loop=1&amp;playlist='+videoURL+'" allowfullscreen></iframe></div>';
				} else if (videoType == 'youku') {
					videoHTML = '<div class="embed-responsive embed-responsive-'+ videoRatio+ '"><iframe src="http://player.youku.com/embed/'+ videoURL + '" allowfullscreen></iframe></div>';
				}
		
				return videoHTML;
			},
		
			initVideoButton : function() {
				var videoPlayer = null;
				var isBlur = false;
				var isIE = true;
		
				if (BrowserDetect.init() == 'Chrome'
						|| BrowserDetect.init() == 'Safari') {
					isIE = false;
				}
		
				$('.gallery-wall a.video-item-box').click(function() {
					// ga code start
					var videoURL = $(this).attr("data-video-source");
					window.dataLayer.push({
						"event" : "video",
						"videoStep" : "play",
						"videoURL" : videoURL
					})
					// ga code end
					if (window.GalleryWALL.checkScreen() == 'x-small' || isIE == true) {
						isBlur = false;
					} else {
						isBlur = true;
					}
		
					if (isBlur != false) {
					}
		
					$('.gallery-wall #video-dialog').modal('show');
		
					if ($(this).data('video-type') != 'embed') {
						var temp = GalleryWALL.initVideoBox($(this).data('video-type'), $(this).data('ratio'),$(this).data('video-source'));
						setTimeout(function() {
							$('.gallery-wall #video-dialog').find('.video-content').empty().html(temp);
						}, 500)
		
					} else {
						var temp = GalleryWALL.initVideoBox($(this).data('video-type'), $(this).data('ratio'),$(this).data('video-source-mp4'),$(this).data('video-source-webm'), $(this).data('video-source-ogg'));
						setTimeout(function() {
							$('.gallery-wall #video-dialog').find('.video-content').empty().html(temp);
						}, 500) 
					}
		
					return false;
				});
		
				$('.gallery-wall #video-dialog .close-video-btn').click(function() {
					try {
						if (videoPlayer != null) {
							videoPlayer.dispose();
						}
					} catch (e) {
					} finally {
						$('.gallery-wall #video-dialog').find('.video-content').empty();
					}
		
					$('.gallery-wall #video-dialog').modal('hide');
		
					return false;
				});
		
				$('.gallery-wall #video-dialog').on('shown.bs.modal',function(e) {
					if (videoPlayer != null) {
						$('.gallery-wall #galleryWallVideo').css('height',$('.gallery-wall #video-dialog .modal-body').height());
					}
					if (!isBlur) {
						$('.gallery-wall .modal-backdrop').css({
							'background-color' : '#000'
						});
					}
				});
				$('.gallery-wall #video-dialog').on('hidden.bs.modal', function(e) {
					if (videoPlayer != null) {
						videoPlayer.dispose();
					}
					$('.gallery-wall #video-dialog').find('.video-content').empty();
		
					if (isBlur) {
						// $('#main, #sideNav, header, footer').foggy(false);
					} else {
						$('.gallery-wall .modal-backdrop').css({
							'background-color' : 'transparent'
						});
					}
				});
		
				$(window).bind('resizeEnd',function() {
					if (videoPlayer != null) {
						$('.gallery-wall #galleryWallVideo').css('height',$('.gallery-wall #video-dialog .modal-body').height());
					}
				});
			},
			checkScreen : function() {
				if ($('.gallery-wall .visible-xs').css('display') == 'block') {
					return 'x-small';
				} else if ($('.gallery-wall .visible-sm').css('display') == 'block') {
					return 'small';
				} else if ($('.gallery-wall .visible-md').css('display') == 'block') {
					return 'medium';
				} else if ($('.gallery-wall .visible-lg').css('display') == 'block') {
					return 'large';
				}
			}
		}
		
		var BrowserDetect = window.BrowserDetect || {};
		
		BrowserDetect.init = function() {
			this.browser = this.searchString(this.dataBrowser) || "Other";
			this.version = this.searchVersion(navigator.userAgent)
					|| this.searchVersion(navigator.appVersion) || "Unknown";
			return this.browser;
		};
		
		BrowserDetect.searchString = function(data) {
			for (var i = 0; i < data.length; i++) {
				var dataString = data[i].string;
				this.versionSearchString = data[i].subString;
				if (dataString.indexOf(data[i].subString) != -1) {
					return data[i].identity;
				}
			}
		};
		
		BrowserDetect.searchVersion = function(dataString) {
			var index = dataString.indexOf(this.versionSearchString);
			if (index == -1)
				return;
			return parseFloat(dataString.substring(index
					+ this.versionSearchString.length + 1));
		};
		
		BrowserDetect.dataBrowser = [ {
			string : navigator.userAgent,
			subString : "Chrome",
			identity : "Chrome"
		}, {
			string : navigator.userAgent,
			subString : "MSIE",
			identity : "Explorer"
		}, {
			string : navigator.userAgent,
			subString : "Firefox",
			identity : "Firefox"
		}, {
			string : navigator.userAgent,
			subString : "Safari",
			identity : "Safari"
		}, {
			string : navigator.userAgent,
			subString : "Opera",
			identity : "Opera"
		} ];
	
	
		GalleryWALL.init();
	
	}
})();
/*
 *  Gallery Public Alert
 *  showUpload：显示图片上传弹窗
 *  hideUpload：隐藏图片上传弹窗
 *  showAlert：显示Gallery提示弹窗
 *  hideAlert：隐藏Gallery提示弹窗
 *  
 */ 

var galleryAlert={
	showUpload:function(){
		//加载字典数据
		getGalleryDic('category');
		getGalleryDic('device');
		getGalleryDic('country');
		
		var scrollTop = $(document).scrollTop() + 50;
		$('.gallery-upload').show();
		$('#uploadPhoto')[0].reset();
		$('.gallery-upload .btn-save').prop('disabled',false);
		$('.gallery-upload select').removeClass('focus');
		
		$('.gallery-upload .imgfile').show();
		$('.gallery-upload .gallery-imgupload .preview-box').hide();
		$('.gallery-upload .gallery-imgupload').css('top', scrollTop).show();
		
		window.dataLayer.push({
			"event": "uploadIntention",
			"pageType": honorConfig.pageType,
			"siteLocation": "header"
		});
	},
	hideUpload:function(){
		$('.gallery-upload,.gallery-upload .gallery-imgupload').hide();
	},
	showAlert:function(type,content){
		type= type || 'login'; 
		if(type!='login'){  
			// 替换文案
			$('.gallery-upload .gallery-alert .alert-content').text(content);
			var btnOK= $('.imgupload-data').data('btnok');
			$('.gallery-upload .gallery-alert .btn-confirm').text(btnOK);
		}else{
			//GA CODE
			var galleryUri=window.digitalData.page.pageInfo.uri;
			window.dataLayer.push({
				"event": "virtualPageview",
				"page": galleryUri+"login_popup_"+honorConfig.pageType+"_login_popup"
			});
			//GA CODE
		}
		$('html,body').addClass('overhidden');
		$('.gallery-upload .honor-loading').hide();
		$('.gallery-upload,.gallery-upload .gallery-alert').show();
		$('.gallery-upload .gallery-alert').attr('data-type',type);
	},
	hideAlert:function(type){
		$('html,body').removeClass('overhidden');
		if(type=='tips'){
			$('.gallery-upload .gallery-alert,.gallery-upload .honor-loading').hide();
		}else{
			$('.gallery-upload,.gallery-upload .honor-loading,.gallery-upload .gallery-alert').hide();
		}
		
		//若是视频上传，则初始化OBS桶
		var rightFileType = $('#rightFileType').val();
    	if(rightFileType=='video'){	
			var cuepServerPath = $('#cuepServerPath').val() || 'https://cuep-sg.test.hihonor.com';
			var obsServerPath = $('#obsServerPath').val() || '';
			HONOROBSSDK.init(cuepServerPath,obsServerPath);
		}
	}
}; 
/**
 * Gallery Imgupload
 */
var $alertData = $('.gallery-upload .imgupload-data');
var alertUpload = {
	alertUploadImg:$alertData.data('alertuploadimg'),
	alertFileType:$alertData.data('alertfiletype'),
	
	alertEnterInfo:$alertData.data('alertenterinfo'),
	alertEnterDesc:$alertData.data('alertenterdesc'),
	
	alertTitleLength:$alertData.data('alerttitlelength'),
	alertContentLength:$alertData.data('alertcontentlength'),
	
	alertSelectCategory: $alertData.data('alertselectcategory'),
	alertSelectDevice:$alertData.data('alertselectdevice'),
	alertSelectCountry:$alertData.data('alertselectcountry'),
	alertEnterLocation:$alertData.data('alertenterlocation'),
	alertCheckTerm:$alertData.data('alertcheckterm'),
	
	selectCategoryTip:$alertData.data('selectcategorytip'),
	selectDeviceTip:$alertData.data('selectdevicetip'),
	selectCountryTip:$alertData.data('selectcountrytip'),
	uploadSuccessTip:$alertData.data('selectsuccesstip') || '',
	uploadFailureTip:$alertData.data('selectfailuretip') || ''
} 

//获取摄影栏目字典
function getGalleryDic(type){ 
	var url = '',alertTip='';
	var galleryLang = window.digitalData.page.category.primaryCategory;
	$(".gallery-upload #lang").val(galleryLang);
	var dataJson = {
		"activityName":"global_all_gallery"
	}
	if(type=='category'){
		url = galleryPublicData.apiUrl+'/abroad/shootMatch/getImgStyleList';
		alertTip= alertUpload.selectCategoryTip;
		dataJson.lang = galleryLang;
	}else if(type=='device'){
		url = galleryPublicData.apiUrl+'/abroad/shootMatch/getImgDivicesList';
		alertTip= alertUpload.selectDeviceTip;
	}else{
		url = galleryPublicData.apiUrl+'/abroad/shootMatch/galleryCountriesList';
		alertTip= alertUpload.selectCountryTip;
	}
	
	$.ajax({
		url : url,
		type : 'GET',
		async : false,
		data:dataJson,
		dataType : 'json',
		success : function(info) { 
			if(info.success){
				var str ='<option value="" selected="selected">'+alertTip+'</option>';
				var data = info.infoBean;
				for(var i = 0;i<data.length;i++){
					str+='<option value="'+data[i].value+'">'+data[i].nodeName+'</option>';
				}
				$('.gallery-upload #'+type).html(str);
			}
		},
		error : function(err) {
			console.log(err);
		}
	})
}
(function(){
	$(function() {
		if ($('.gallery-upload').length > 0) {
			
			//是否启用视频上传
			var isVideoUpload = $('.gallery-upload #enabledVideoUpload').val() || 'no';	
			
			$('.gallery-upload .imgfile label').attr('for', "");
			$('.gallery-upload #file').removeClass('hidden');
	
			// 点击触发选择图片
			$('.gallery-upload .imgfile label,.gallery-upload #imgPreview').click(function() {
				$('.gallery-upload #file').click()
			})
			// 显示图片上传弹窗
			$('.gallery-header .join-now').click(function() { 
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					galleryAlert.showUpload();
				}else{
					galleryAlert.showAlert();
				}
			})
			
			// 预览图片
			$("#file").change(function() {
				var that = this;
				if (that.files[0]) {
					if(isVideoUpload=='no'){
						// 只许图片上传
						imgCheckLists(that,false);
					}else if(isVideoUpload=='yes'){
						//允许图片或视频上传
						var imgTypeArr = ['jpg','jpeg','png'];
						var isImg = utils.checkFileFormat(that.files[0].name,imgTypeArr);
						var videoTypeArr = ['mp4'];
						var isVideo = utils.checkFileFormat(that.files[0].name,videoTypeArr);
						if(!isImg && !isVideo){
							// 格式不正确，校验提示，同时需要清空file的值
							$('#fileType').isValid(function(){});
							resetFileData();
							$('.imgfile .tips').addClass('red');
							return;
						}
						if(isImg){
							imgCheckLists(that,true);
						}
						if(isVideo){
							videoCheckLists(that,true);
						}
						
					}
					
				}
			}) 
			
			// 上传图片
			$('#uploadPhoto').on('validation', function(e, current){
			    var form = this;
			    // form 中是否所有字段都验证通过
			    if(form.isValid){
			    	$('.gallery-upload .btn-save').prop('disabled',false).addClass('active');
			    }else{
			    	$('.gallery-upload .btn-save').prop('disabled','disabled').removeClass('active');
			    }
			});
			
			$('#uploadPhoto').validator({
				focusCleanup: true,
		        stopOnError: false,
		        timely: 2,
		        theme:'default_bottom', 
		        invalidClass: "has-error",
		        bindClassTo: ".form-item",
		        msgWrapper: 'div',
		        msgMaker: function(opt){ 
		        	var str='';
			        str+='<span class="msg-box n-bottom" for="category">';
						str+='<span role="alert" class="msg-wrap n-'+ opt.type +'">';
							str+='<span class="n-msg">' + opt.msg + '</span>';
						str+='</span>';
					str+='</span>';
		            return str;
		        }, 
		        rules:{
		        	rightFileType: function(element) {
		        		//当前上传的文件类型  photo/video
		        		var rightFileType = $('#rightFileType').val();
		        		return rightFileType==element.value;
		            }
		        },
				fields: {
					"file":{
		                rule: "required;",
	                	msg: {
		                    required: alertUpload.alertUploadImg
		                }
		            },
		            "fileType":{
		            	rule:"required;rightFileType;",
		            	msg:{
		            		required: alertUpload.alertFileType,
		            		rightFileType:alertUpload.alertFileType
		            	}
		            },
		            "imgStyle":{
		                rule: "required;",
	                	msg: {
		                    required: alertUpload.alertSelectCategory
		                }
		            },
		            "imgThemes":{
		                rule: "required;length[~40];",
	                	msg: {
		                    required: alertUpload.alertEnterInfo,
		                    length: alertUpload.alertTitleLength
		                }
		            },
		            "imgContent":{
		                rule: "length[~200];",
	                	msg: {
		                    length: alertUpload.alertContentLength
		                }
		            },
		            "divices":{
		                rule: "required;",
	                	msg: {
		                    required: alertUpload.alertSelectDevice
		                }
		            },
		            "userCountries":{
		                rule: "required;",
	                	msg: {
		                    required: alertUpload.alertSelectCountry
		                }
		            },
//		            "location":{
//		                rule: "required;",
//	                	msg: {
//		                    required: alertUpload.alertEnterLocation
//		                }
//		            },
		            "check":{
		                rule: "checked;",
	                	msg: {
		                    checked: alertUpload.alertCheckTerm
		                }
		            }
			    },
			    valid: function(form) {
			    	var me = this;
		        	me.holdSubmit();
		        	//显示loading效果
		        	$(".gallery-upload .loading").show();
		        	
		        	var rightFileType = $('#rightFileType').val();
		        	if(rightFileType=='photo'){
						// 上传图片
						UpladFile(me);
					}else if(rightFileType=='video'){		
						//OBS上传视频
						var fileData = $("#file")[0].files[0];
						// 生成具有唯一性的名称
						var fileName = hex_md5(fileData.name + new Date().getTime())+'.mp4';
						$('#videoName').val(fileName);
						HONOROBSSDK.uploadFile(fileName,fileData,function(){
							//success，obs视频上传成功，继续进行cuep上传
							UpladFile(me);
						},function(){
							//fail，obs视频上传失败，提示稍后重试
							me.holdSubmit(false);
							galleryAlert.showAlert('tips',alertUpload.uploadFailureTip);
						});
						
					}
			    }
			})
			// 切换select当前focus状态
			$('.gallery-upload select').focus(function(){
				$(this).addClass('focus');
			})
			// 隐藏弹窗
			$('.gallery-upload .cancel-upload').click(function() {
				galleryAlert.hideUpload();
			})
			
			// 上传文件方法
			function UpladFile(me) { 
				var formData = null;
				var videoFormData = {
					'imgCountries':$('#uploadPhoto [name="imgCountries"]').val(),
					'activityName':$('#uploadPhoto [name="activityName"]').val(),
					'lang':$('#uploadPhoto [name="lang"]').val(),
					'fileType':$('#uploadPhoto [name="fileType"]').val(),
					'imgStyle':$('#uploadPhoto [name="imgStyle"]').val(),
					'imgThemes':$('#uploadPhoto [name="imgThemes"]').val(),
					'imgContent':$('#uploadPhoto [name="imgContent"]').val(),
					'divices':$('#uploadPhoto [name="divices"]').val(),
					'userCountries':$('#uploadPhoto [name="userCountries"]').val(),
					'location':$('#uploadPhoto [name="location"]').val(),
					'check':$('#uploadPhoto [name="check"]').val()
				}
				var webServer = $('#webServer').val() || 'sg';
				var endApiUrl = galleryPublicData.apiUrl.replace('sg',webServer);
				var finalUrl = '',
					ajaxContentType = 'application/x-www-form-urlencoded; charset=UTF-8',
					ajaxProcessData = true;
				//区分文件类型
				var rightFileType = $('#rightFileType').val();
	        	if(rightFileType=='photo'){
	        		formData = new FormData($('#uploadPhoto')[0]); 
	        		finalUrl = endApiUrl+'/abroad/shootMatch/uploadOriginImage';
	        		ajaxContentType = false;
	        		ajaxProcessData = false;
	        	}else if(rightFileType=='video'){	
	        		videoFormData.imageNames = $('#uploadPhoto [name="imageNames"]').val();
	        		videoFormData.coverPicture = $('#uploadPhoto [name="coverPicture"]').val();
	        		formData = videoFormData;
	        		finalUrl = endApiUrl+'/abroad/shootMatch/submitObsVideo';
				}
				// 调用接口
				$.ajax({
					url : finalUrl,
					type : 'POST',
					data : formData,
					async : true, 
					cache: false,
					contentType: ajaxContentType,
					processData: ajaxProcessData,
					dataType:'json', 
                    xhrFields: {
						withCredentials: true
					},
					crossDomain: true,
					beforeSend: function () {
				        // 禁用按钮防止重复提交 
				        $('.gallery-upload .btn-save').prop('disabled','disabled').removeClass('active');
				    },
					success: function(data) {
						if (data.code == '100007') {
							galleryAlert.showAlert();
						} else if(data.code=='400') {
							galleryAlert.showAlert('tips',data.message);
						}else if(data.code=='200'){
							// ga code 
							var category=$('#uploadPhoto #category').val();
							var device = $('#uploadPhoto #device').val();
							var country=$('#uploadPhoto #country').val();
							window.dataLayer.push({
								"event": "uploadPhoto",
								"pageType": honorConfig.pageType,
								"siteLocation": "gallery_upload",
								"photoCategory":category,
								"honorDevice":device,
								"userCountry":country
							})
							galleryAlert.showAlert('success',alertUpload.uploadSuccessTip);
						}
						me.holdSubmit(false);
						$('.gallery-upload .btn-save').prop('disabled',false).addClass('active');
					},
					complete: function () {
				        $(".gallery-upload .loading").hide();
				    },
					error : function(err) {
						var res =err.responseText;
						if(res){
							var info = res.substring(1,res.length-1);
							var json = JSON.parse(info);
							if(json.code=='100007'){
								galleryAlert.showAlert();
							}else{
								me.holdSubmit(false);
								$('.gallery-upload .btn-save').prop('disabled',false).addClass('active');
								galleryAlert.showAlert('tips',alertUpload.uploadFailureTip);
							}
						}else{
							me.holdSubmit(false);
							$('.gallery-upload .btn-save').prop('disabled',false).addClass('active');
							galleryAlert.showAlert('tips',alertUpload.uploadFailureTip);
						}
						// CUEP上传失败了，需要删除OBS已上传的垃圾文件
						if(rightFileType=='video'){
							var fileName = $('#videoName').val();
							HONOROBSSDK.deleteFile(fileName);
			        	}
					}
				});
			}
		}
	})
	
	// 重置file上传数据
	function resetFileData(){
		$('.gallery-upload .imgfile').show();
		$('.gallery-upload .upload-again').hide();
		//清空file的值
		$('.gallery-upload #file').val('');
		//重置photo上传数据
		$('#imgPreview').hide().children('#currImg').prop('src','');
		//重置video上传数据
		$('#videoPreview').hide().children('#currVideo').prop('src','');
	}
	
	/**
	 * 图片系列校验
	 * 	格式：jpg,jpeg,png
	 * 	大小： Max 20MB
	 * @param fileObj  文件对象
	 * @param isTypeVerified	类型是否已校验：true/false
	 */
	function imgCheckLists(fileObj,isTypeVerified){
		isTypeVerified = isTypeVerified || false;
		// 格式校验
		if(!isTypeVerified){
			var imgTypeArr = ['jpg','jpeg','png'];
			var isImg = utils.checkFileFormat(fileObj.files[0].name,imgTypeArr);
			if(!isImg){
				//格式不正确，校验提示
				$('#fileType').isValid(function(){});
				resetFileData();
				return;
			}else{
				//更新状态位，并更新文件类型选项值的变化，同时执行校验
				$('#rightFileType').val('photo');
				$('#fileType').addClass('focus').find('option[value="photo"]').prop('selected', 'selected');
				$('#fileType').isValid(function(){});
			}
		}
		// 大小校验，单位：MB
		var fileSize  = parseFloat(fileObj.files[0].size/(1024*1024)).toFixed(2);
		if(fileSize>20){
			// 超出20MB，校验提示，清空file的值
			$('#fileType').isValid(function(){});
			resetFileData();
			return;
		}else{
			// 展示图片
			previewImage(fileObj);
		}
		
		//重置video上传数据
		$('#videoPreview').hide().children('#currVideo').prop('src','');

		//更新状态位，并更新文件类型选项值的变化，同时执行校验
		$('#rightFileType').val('photo');
		$('#fileType').addClass('focus').find('option[value="photo"]').prop('selected', 'selected');
		$('#fileType').isValid(function(){});
		
	}
	/**
	 * 视频系列校验
	 * 	格式：mp4
	 * 	大小： Max 200MB
	 * @param fileObj  文件对象
	 * @param isTypeVerified	类型是否已校验：true/false
	 */
	function videoCheckLists(fileObj,isTypeVerified){
		isTypeVerified = isTypeVerified || false;
		// 格式校验
		if(!isTypeVerified){
			var videoTypeArr = ['mp4'];
			var isVideo = utils.checkFileFormat(fileObj.files[0].name,videoTypeArr);
			if(!isVideo){
				// 格式不正确，校验提示，清空file的值
				$('#fileType').isValid(function(){});
				resetFileData();
				return;
			}else{
				//更新状态位，并更新文件类型选项值的变化，同时执行校验
				$('#rightFileType').val('video');
				$('#fileType').addClass('focus').find('option[value="video"]').prop('selected', 'selected');
				$('#fileType').isValid(function(){});
			}
		}
		// 大小校验，单位：MB
		var fileSize  = parseFloat(fileObj.files[0].size/(1024*1024)).toFixed(2);
		if(fileSize>200){
			//超出200MB，校验提示，清空file的值
			$('#fileType').isValid(function(){});
			resetFileData();
			return;
		}else{
			// 展示视频，并获取首帧图片
			previewVideo(fileObj);
		}
		
		//重置photo上传数据
		$('#imgPreview').hide().children('.currImg').prop('src','');
		
		//更新状态位，并更新文件类型选项值的变化，同时执行校验
		$('#rightFileType').val('video');
		$('#fileType').addClass('focus').find('option[value="video"]').prop('selected', 'selected');
		$('#fileType').isValid(function(){});
		
	}
	
	
	/**
	 * 图片上传预览，IE是用了滤镜。
	 * @param fileObj 文件对象
	 */
	function previewImage(fileObj) {
		var MAXWIDTH = 500;
		var MAXHEIGHT = 500;
		var div = document.getElementById('imgPreview');
		if (fileObj.files && fileObj.files[0]) {
			var img = document.getElementById('currImg');
			var reader = new FileReader();
			reader.onload = function(evt) {
				img.src = evt.target.result;
			}
			reader.readAsDataURL(fileObj.files[0]);
		} else {
			// 兼容IE
			var sFilter = 'filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
			fileObj.select();
			// 滤镜document.selection.createRange().text获取不到值得解决办法 添加一行这个
			window.parent.document.body.focus();
			var src = document.selection.createRange().text;
			div.innerHTML = '<img id="currImg">';
			var img = document.getElementById('currImg');
			img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
			var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth,
					img.offsetHeight);
			var status = ('rect:' + rect.top + ',' + rect.left + ',' + rect.width + ',' + rect.height);
			var str = '';
			str += "<div id=divhead style='width:" + rect.width + "px;height:"
					+ rect.height + "px;margin-left:" + rect.left
					+ "px;margin-top:" + rect.top + "px;" + sFilter + src
					+ "\")'></div>";
			str += "<label for='file' class='upload-again'>Upload again</label>";
	
			div.innerHTML = str;
		}
		$('.gallery-upload .imgfile').hide();
		$('.gallery-upload .gallery-imgupload #imgPreview,.gallery-upload .gallery-imgupload .upload-again').show();
	}
	 
	/**
	 * 根据图片与盒子的宽高对比，计算返回合适width、height、left、top距离 maxWidth：盒子宽 maxHeight：盒子高
	 * width：图片实际宽 height：图片实际高
	 */
	function clacImgZoomParam(maxWidth, maxHeight, width, height) {
		var param = {
			top : 0,
			left : 0,
			width : width,
			height : height,
		};
		if (width > maxWidth || height > maxHeight) {
			var rateWidth = width / maxWidth;
			var rateHeight = height / maxHeight;
	
			if (rateWidth > rateHeight) {
				param.width = maxWidth;
				param.height = Math.round(height / rateWidth);
			} else {
				param.width = Math.round(width / rateHeight);
				param.height = maxHeight;
			}
		}
		param.left = Math.round((maxWidth - param.width) / 2);
		param.top = Math.round((maxHeight - param.height) / 2);
		return param;
	}
	
	/**
	 * 视频上传预览，并获取首帧图片，之后初始化OBS桶
	 * @param fileObj 文件对象
	 */
	function previewVideo(fileObj){
		$('.gallery-upload .imgfile').hide();
		
		var fileData = fileObj.files[0];
		var objURL = URL.createObjectURL(fileData);
		$('#currVideo').attr('src',objURL).parent().show();
		$('.gallery-upload .gallery-imgupload .upload-again').show();
		
		//获取首帧图片
		var currVideo = $("#currVideo")[0];
		currVideo.addEventListener('loadeddata',function(){
			window.videoloadeddata = new Date().getTime();
			setTimeout(function(){
				// 获取首帧图片，因视频加载有延迟，故增加了一个0.3s延时
				var canvas = document.createElement("canvas");
				// 首帧图片质量比例，默认1，大小区间  0.01-1 
				var scale = $('#videoPreview').data('ratio') || '1'; 
				canvas.width = currVideo.videoWidth * scale;
				canvas.height = currVideo.videoHeight * scale;
				canvas.getContext('2d').drawImage(currVideo, 0, 0, canvas.width, canvas.height);
				
				var imgsrc = canvas.toDataURL("image/png");
				$('#videoPreviewImg').attr("src",imgsrc);  
				$("#videoImg").val(imgsrc);
			},300)
		});
		
		// 初始化OBS桶
		var cuepServerPath = $('#cuepServerPath').val() || 'https://cuep-sg.test.hihonor.com';
		var obsServerPath = $('#obsServerPath').val() || '';
		HONOROBSSDK.init(cuepServerPath,obsServerPath);
	}
}());
/**
 * Gallery Alert
 */
(function(){ 
	$(function(){ 
		if($('#galleryAlert').length>0){
			// 关闭alert
			$('.gallery-alert .font-Cross').click(function(){
				var type=$('.gallery-upload .gallery-alert').attr('data-type');
				galleryAlert.hideAlert(type);
			})
			
			$('.gallery-alert .btn-confirm').click(function(){
				var type=$('.gallery-upload .gallery-alert').attr('data-type');
				if(type=="login"){
					window.dataLayer.push({
						"event": "accountLogin",
						"pageType": honorConfig.pageType,
						"siteLocation": "gallery_upload"
					});
					//跳转登录
					window.location.href=galleryPublicData.loginUrl;
					
				}else{
					//关闭
					galleryAlert.hideAlert(type);
				}
			})
		}
	}) 
}());
var listData={
	itemRightDis: 12, // item右边距
	itemBottomDis: 14, // item 下边距 
	hasMore: true //是否还有更多数据，默认有 
}


/** 瀑布流
 * @param parent 父元素
 * @param box 子元素，需要以瀑布流形式呈现的box
 */
function galleryWaterfall(parent, box) {
  var $parent = $(parent);
  var $box = $(box);
  var boxH = 0;
  // 计算整个页面显示的行数（页面宽/box的宽）
  var parentW = $parent.outerWidth();
  var itemW=0;
  if(galleryPublicData.windowW<=768){
	  itemW = $box.eq(0).outerWidth() + listData.itemRightDis;
  }else{
	  itemW = $box.eq(0).outerWidth() + (3 * listData.itemRightDis) / 4;
  }
  
  var boxW = $box.eq(0).outerWidth() + listData.itemRightDis;
  // 列数
  var cols = Math.floor(parentW / itemW)

  var hArr = [],maxArr=[];
  for (var i = 0; i < $box.length; i++) {
    if (i < cols) {
      hArr.push($box.eq(i).outerHeight() + listData.itemBottomDis);
      boxH = Math.max.apply(null, hArr);
    } else {
      var minH = Math.min.apply(null, hArr)
      var minIndex = getGalleryIndex(hArr, minH);
      // 将图片放在上一行最矮的item下
      $box.eq(i).css('position', 'absolute')
        .css('top', minH + 'px')
        .css('left', boxW * minIndex + 'px')
      // 改变数组
      hArr[minIndex] += $box.eq(i).outerHeight() + listData.itemBottomDis;

      var endMaxH = Math.max.apply(null, hArr);
      boxH = endMaxH;
    }
  }
  $parent.height(boxH); 
  
}
/** 获取数组最小值的下标
 * @param arr 数组
 * @param val 最小值
 */
function getGalleryIndex(arr, val) {
  for (var i in arr) {
    if (arr[i] == val) {
      return i;
    }
  }
}
/**
 * Gallery Photos Lists
 */ 
(function(){
	$(function(){ 
		if($('.gallery-photos-lists').length>0){
			var windowW = utils.windowWidth();
			// 默认，隐藏footer
			$('.gallery-footer').hide();
			
			// 排序方式，默认latest
			var sortType='latest';
			// 加载更多
			var loadMore = true;
			// 首次请求
			var firstReq = true;
			
		    // data layer javascript
			var dataJson = { 
				pageIndex: 0,   // 当前页码
				pageSize: 6,    // 每页显示个数
				imgStyle:'',	// 图片类型
				lang:window.digitalData.page.category.primaryCategory,
				country:'gallery',
				activityName:'global_all_gallery'
			}
			
			// 查询图片类型
			getImgStyleList();
			
			var show=true;
			$('.nav-category .nav-icon').click(function(){
				if(show){
					$('.gallery-photos-lists .photos-category').stop().addClass('nav-hide');
				}else{
					$('.gallery-photos-lists .photos-category').stop().removeClass('nav-hide');
				}
				show = !show;
			})
			
			$('.nav-category .fa-chevron-right').click(function(){
				show = true;
				$('.gallery-photos-lists .photos-category').stop().removeClass('nav-hide');
			})
			 
			$('.nav-category .nav-sort li').on('click',function(){
				$(this).addClass('active');
				$(this).siblings().removeClass('active');
				
				// 定位到图片列表
				toLists();
				
				$('.gallery-photos-lists .photos-lists').empty();
				sortType=$(this).data('value');
				firstReq = true;
				dataJson.pageIndex = 0;
				getPhotosLists(sortType);
				//GA CODE START
				var uri=window.digitalData.page.pageInfo.uri;
				window.dataLayer.push({
					"event": "virtualPageview",
					"page": uri+dataJson.imgStyle+"/"+sortType
				})
				//GA CODE END
			})
			
			
			$('.gallery-photos-lists .set-love').click(function(){
				$(this).toggleClass('loved');
			})

			//滚动监听 
			$(window).scroll(function() {
				var windowH = utils.windowHeight();
				var scrollTop = $(document).scrollTop();
				
				var $lists = $('.gallery-photos-lists .photos-lists');
				var listsTop = $lists.position().top;
				var listsH = $lists.height();
				
				var flag = (windowH+scrollTop)>(listsTop+listsH);
				
				if(loadMore && flag && !firstReq){ 
					loadMore = false;
					getPhotosLists(sortType);
				}
			}); 
			
			
			//获取摄影栏目 图片分类字典
			function getImgStyleList(){ 
				$.ajax({
					url : galleryPublicData.apiUrl+'/abroad/shootMatch/getImgStyleList',
					type : 'GET',
					async : false,
					data:{
						"activityName":"global_all_gallery",
						"lang":window.digitalData.page.category.primaryCategory
					},
					dataType : 'json',
					success : function(info) { 
						if(info.success){
							var str='';
							var data = info.infoBean;
							//页面传参 type：图片类型
							var type = utils.getRequest().type;
							
							for(var i=0;i<data.length;i++){
								if(type){
									// 有URL传参
									dataJson.imgStyle = type;
									if(type==data[i].value){
										str+='<li class="active" data-value="'+data[i].value+'"><span>'+data[i].nodeName+'</span><span class="icon-ra"></span></li>';
									}else{
										str+='<li data-value="'+data[i].value+'"><span>'+data[i].nodeName+'</span><span class="icon-ra"></span></li>';
									}
								}else{
									// 无URL传参
									if(i==0){
										// 第一个分类
										dataJson.imgStyle=data[i].value;
										str+='<li class="active" data-value="'+data[i].value+'"><span>'+data[i].nodeName+'</span><span class="icon-ra"></span></li>';
									}else{
										str+='<li data-value="'+data[i].value+'"><span>'+data[i].nodeName+'</span><span class="icon-ra"></span></li>';
									} 
								}
							}
							$('.gallery-photos-lists .nav-box ul').html(str);
							
							// 查询latest图片列表
							getPhotosLists(sortType);
							
							$('.nav-category .nav-box li').click(function(){
								$(this).addClass('active');
								$(this).siblings().removeClass('active');
								var imgStyle = $(this).data('value');
								
								// 定位到图片列表
								toLists();
								
								$('.gallery-photos-lists .photos-lists').empty();
								dataJson.pageIndex = 0;
								dataJson.imgStyle= imgStyle;
								$('.gallery-footer').hide();
								getPhotosLists(sortType);
								//GA CODE START
								var uri=window.digitalData.page.pageInfo.uri;
								window.dataLayer.push({
									"event": "virtualPageview",
									"page": uri+dataJson.imgStyle+"/"+sortType
								})
								//GA CODE END
							})
						}
					},
					error : function(err) {
						console.log(err);
					}
				})
			}
			
			// 定位到图片列表
			function toLists(){
				var boxTop = $('.gallery-photos-lists').position().top;
				var endTop = Math.floor(boxTop) -90;
				$('body,html').animate({
					scrollTop: endTop
				}, 800);
			}
			
			//获取摄影栏目图片列表
			var clicktag = 0;
			function getPhotosLists(type){
				if(windowW>768){
					galleryWaterfall('.gallery-photos-lists .photos-lists', '.gallery-photos-lists .photos-lists .photos-item');
				}
				// 默认，按审核时间倒序
				var webServer = $('#webServer').val() || 'sg';
				var endApiUrl = galleryPublicData.apiUrl.replace('sg',webServer);
				var url = endApiUrl+'/abroad/shootMatch/listImgInfoByPopularStyle';
				if(type=='popular'){
					//按点赞数量倒序					
					url = endApiUrl+'/abroad/shootMatch/listMatchImgInfoByPraiseDescStyle';
				}
				// 当前页码加一
				dataJson.pageIndex++;
				
				$.ajax({
					url : url,
					type : 'GET',
					data : dataJson,
					async : false,
					dataType : 'jsonp', 
					success : function(info) {
						if(info.success){
							firstReq = false;
							
							var currPath = location.href;
							var prePath = currPath.split('/gallery/')[0];
							var endPath ='';
							if(currPath.indexOf('.html')!=-1){
								//预览环境
								endPath +='.html';
								endPath += currPath.split('.html')[1];
							}else{
								//发布环境
								endPath ='/';
							} 
							
							var str='';
							var data = info.infoBean.pageList;
							
							//判断第一页数据是否展示了所有数据
							if(dataJson.pageIndex==1 && info.infoBean.total==data.length){
								loadMore = false;
								$('.gallery-footer').show();
							}else{
								loadMore = true;
							} 
							
							if(data.length==0){
								loadMore = false;
								$('.gallery-footer').show();
								return;
							}else{  
								for(var i=0;i<data.length;i++){
									var itemPath = '';
									//图片是否在gallery栏目下上传的（0：是，1：否）
									if(data.isGallery=='0'){
										// Gallery活动
										itemPath = prePath+data[i].htmlPath+endPath;	
									}else{
										// 非Gallery活动
										itemPath = data[i].htmlPath;
										//文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
										if(data[i].fileType && data[i].fileType=='0'){
											// 视频
											if(itemPath && itemPath.indexOf('/photo.')!=-1){
												//有返回链接，需要做转换，因后端存在垃圾数据，这里再次做转换处理
												itemPath = itemPath.replace('/photo.','/video.');
											}
											
											if(!itemPath){
												// 没有返回链接，需拼接
												var lang = window.digitalData.page.category.primaryCategory;
												var id = data[i].imgId;
												itemPath = prePath + '/gallery/'+ lang + '/video.'+ id + endPath;
											}
										}
										
										if(!data[i].fileType || data[i].fileType=='1'){
											// 图片详情路径链接优化
											if(itemPath && itemPath.indexOf('.html')!=-1){
												itemPath = data[i].htmlPath;
											}else{
												itemPath = prePath+data[i].htmlPath+endPath;
											}
											
										}
										
									}
									str+='<div class="photos-item">';
										str+='<a href="'+itemPath+'">';
											var loadingClass=" honor-loading";
											if(galleryPublicData.windowW<768){
												loadingClass=" honor-loading honor-loading-xs";
											}
											str+='<img class="item-img'+loadingClass+'" src="'+data[i].imgSrc+'" alt="" />';
											// 文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
											if(data[i].fileType && data[i].fileType=='0'){
												str+='<img class="icon-video" src="/etc/designs/honor-site/assets/icons/play-arrow.png">';
											}
										str+='</a>';
										str+='<div class="item-info">';
											str+='<a href="'+itemPath+'">';
												str+='<p class="info-title">'+data[i].imgThemes+'</p>';
												str+='<p class="info-author"><span class="fa fa-user-o"></span>&nbsp;&nbsp;'+data[i].nickNameAct+'</p>'; 
												str+='<p class="info-content">'+data[i].imgContent+'</p>';
											str+='</a>';
											str+='<ul class="info-data">';
												// 是否点赞（0：已点赞  1：未点赞）
												if(data[i].isPraised=='0'){
													str+='<li class="set-love" data-Category="'+data[i].imgStyle+'" data-id="'+data[i].imgId+'" data-type="cancel">';
													str+='<span class="fa fa-heart loved"></span>&nbsp;';
												}else{
													str+='<li class="set-love" data-Category="'+data[i].imgStyle+'" data-id="'+data[i].imgId+'" data-type="add">';
													str+='<span class="fa fa-heart"></span>&nbsp;';
												}
													str+='<span class="love-num">'+data[i].praiseNum+'</span>';
												str+='</li>';
												str+='<li>';
													str+='<a href="'+itemPath+'">';
														str+='<span class="fa fa-comment"></span>';
														str+='<span> '+data[i].commentNum+'</span>';
													str+='</a>';
												str+='</li>';
											str+='</ul>';
										str+='</div>';
									str+='</div>';
								}
								$('.gallery-photos-lists .photos-lists').append(str);
								
								//图片加载完毕，执行瀑布流渲染
								$('.gallery-photos-lists .photos-lists .item-img').imagesLoaded()
								.progress(function(instance,image){
									// 当前图片加载完成后，去除loading效果
									if(image.isLoaded){
										$(image.img).removeClass('honor-loading');
									}
									
									if(windowW>768){
										galleryWaterfall('.gallery-photos-lists .photos-lists', '.gallery-photos-lists .photos-lists .photos-item');
									}
									
								})
								.done(function(){
									if(windowW>768){
										galleryWaterfall('.gallery-photos-lists .photos-lists', '.gallery-photos-lists .photos-lists .photos-item');
									}
								})
								
								// 点赞/取消点赞
								$('.gallery-photos-lists .photos-item .set-love').off().click(function(e){
									e.stopPropagation();
									var obj = $(this);
									if (clicktag == 0) {
										clicktag = 1;
										setTimeout(function () {
											if (honorData.loginName!= "" && null != honorData.loginName && honorData.loginName !="null") {
												var imgId = obj.data('id');
												var type = obj.data('type');
												var Category = obj.data('category');
												imgPraise(obj,type,imgId,Category);
											}else{
												galleryAlert.showAlert();
											}
											clicktag = 0;
										}, 300);
									}
								})
								
							} 
							 
						}
					},
					error : function(err) {
						console.log(err);
					}
				}) 
			} 
			
			
			/*
			 * 点赞/取消点赞
			 * @type 	add：点赞， cancel：取消点赞
			 * @imgId 	图片id
			 * @imgSrc 	图片路径
			 */
			function imgPraise(obj,type,imgId,Category){ 
				var url='';
				if(type=="add"){
					url = galleryPublicData.apiUrl+'/abroad/shootMatch/addPraise'
					//GA CODE START
					window.dataLayer.push({
						"event": "photoLike",
						"pageType":honorConfig.pageType,
						"photoCategory":Category
					})
					//GA CODE END
				}else{
					url = galleryPublicData.apiUrl+'/abroad/shootMatch/delPraise'
				}
				$.ajax({
					url : url,
					type : 'POST', 
					data:{
						"activityName":"global_all_gallery",
						"imgId":imgId
					},
					dataType : 'jsonp',
					success : function(info) { 
						if(info.success){ 
							var num = Number(obj.find('.love-num').text());
							//切换选中状态
							obj.find('.fa-heart').toggleClass('loved');
							if(type=='add'){
								obj.data('type','cancel');
								obj.find('.love-num').text(num+1);
							}else{
								if(num<=0){
									num=0;
								}else{
									num=num-1;
								}
								obj.data('type','add');
								obj.find('.love-num').text(num);
							}
							
						}else{
							galleryAlert.showAlert("other",info.resultDesc);
						}
					},
					error : function(err) {
						console.log(err);
					}
				})
			}
			
		}
	}) 
	
}());

/**
 * Gallery Photos Banner
 */
(function(){
	$(function(){
		if($('.gallery-photos-banner').length>0){
			var count=$('.gallery-photos-banner .photos-banner-item:last-child').data('num');
			var $firstItem =$('.gallery-photos-banner .photos-banner-item:first-child');
			$firstItem.addClass('active').data('flag','true');
			
			
			if(galleryPublicData.windowW>768){
				// 懒加载 
		    	$('.gallery-photos-banner .photos-banner-item .item-img').each(function(index){
		    		var src = $(this).data('pc');
		    		$(this).attr('src',src);
		    	})
		    	
		    	var imgLoad = imagesLoaded('.gallery-photos-banner .item1 .item-img');
		    	imgLoad.on('done', function(instance) {
		    		// 加载完成 
		    		$('.gallery-photos-banner .photos-banner-item .item-img').show();
		    		var itemH =$firstItem.find('.item-img').height();
		    		$('.gallery-photos-banner').height(itemH);
		    		$('.gallery-photos-banner .photos-banner-item .item-img').css({
		    			'position':'absolute'
		    		});
		    	})
		    	
		    	var pageWidth = utils.pageWidth();
		    	if(count==1){
		    		// 只有一张图片
		    		$('.gallery-photos-banner .photos-banner-item').width('100%');
		    	}else if(count>1){
		    		// 多张图片,大屏设备 再判断是否移动端
		    		if (endBrowser.versions.mobile || endBrowser.versions.android || endBrowser.versions.ios) {
		    			// 移动端
		    			$('.gallery-photos-banner .photos-banner-item .item-overlay').stop().click(function(e){
		    				e.stopPropagation();
							var num = $(this).parent().data('num');
							if(count==2){ 
								$(this).parent().stop().addClass('active').data('flag','true').animate({"width":"60%"},0,'linear');
								$(this).parent().siblings('.photos-banner-item').stop().removeClass('active').data('flag','false').animate({"width":"40%"},0);
							}else if(count==3){
								$(this).parent().stop().addClass('active').data('flag','true').animate({"width":"60%"},0,'linear');
								$(this).parent().siblings('.photos-banner-item').stop().removeClass('active').data('flag','false').animate({"width":"20%"},0);
							}
						})
		    		}else{
		    			// PC端
		    			$('.gallery-photos-banner .photos-banner-item').stop().hover(function(){
							var num = $(this).data('num');
							if(count==2){ 
								$(this).stop().addClass('active').data('flag','true').animate({"width":"60%"},0,'linear');
								$(this).siblings('.photos-banner-item').removeClass('active').data('flag','false').animate({"width":"40%"},0,'linear');
							}else if(count==3){
								$(this).stop().addClass('active').data('flag','true').animate({"width":"60%"},0);
								$(this).siblings('.photos-banner-item').removeClass('active').data('flag','false').animate({"width":"20%"},0);
							}
						})
		    		}
				} 
		    	$('.gallery-photos-banner .photos-banner-item').click(function(){
	    			// flag 图片点击是否跳转，true：可跳转；false：不可；
	    			var flag = $(this).data('flag');
	    			if(flag=='true'){
	    				var url = $(this).data('href');
	    				if(url){
	    					location.href=url;
	    				}
	    			}
	    		})	
			}else{ 
				// 移动端				
				$('.gallery-photos-banner .photos-banner-item .item-img').each(function(index){
		    		var src = $(this).data('mb');
		    		$(this).attr('src',src);
		    	})
		    	var imgLoad = imagesLoaded('.gallery-photos-banner .item1 .item-img');
		    	imgLoad.on('done', function(instance) {
		    		// 加载完成 
		    		$('.gallery-photos-banner .photos-banner-item .item-img,.gallery-photos-banner .photos-banner-item .item-info').show();
		    		$('.gallery-photos-banner .photos-banner-item').css('min-height','auto');
		    	})
		    	$('.gallery-photos-banner .photos-banner-item').click(function(){
		    		var url = $(this).data('href');
		    		if(url){
		    			location.href=url;
		    		}
	    		})	
			}
			
			
		}
	}) 
}());
(function() {
	$(function() {
		var $photoDetail = $('.gallery-photo-detail .photo-detail');
		if ($photoDetail.length == 0) {
			return;
		}
		
		var getPhotoDetailUrl = window.location.href,
			workType = $photoDetail.data('type');	
		var photoData = {
			activityName: "global_all_gallery",	// 活动名
			imgId: getWorkId(workType),			// 作品ID
			type: workType,			// 作品类型 photo/video，默认photo
			country: "gallery",		// 站点
			imgStyle: "",			// 作品分类
			photoDetailName: '',	// 作品名称
			photoDetailAuthor: '',	// 作品作者
			photoDetailDesc: '',	// 作品描述
			isReply:null , 			// 0 回复 其它值则是评论
			replyNickNameAct: '',	// 被回复人昵称
			replyCldId:'',			// 被回复人id
			requestUrl: galleryPublicData.apiUrl,	 // Server请求链接
			backUrl: getListUrl()	// 列表页链接
		}
		
		if (photoData.imgId) {
			loadImgInfo();
		}

		/*
		 * 获取作品id
		 * @param type：作品类型  photo/video
		 */
		function getWorkId(type){
			var splitStr = '/'+type +'.';
			var id = window.location.href.split(splitStr)[1];
			if (id !== "" && id !== undefined) {
				if (id.indexOf('.html') != -1) {
					id = id.split(".html")[0];
				} else if (id.indexOf('html') != -1) {
					id = id.split("html")[0];
				} else if (id.indexOf('/?') != -1) {
					id = id.split("/?")[0];
				} else if (id.indexOf('?') != -1) {
					id = id.split("?")[0];
				}
				if (id) {
					id = parseInt(id.replace(/[^0-9]/ig, ""));
				}
			}
			return id;
		}
		/*
		 * 获取对应列表页链接
		 */
		function getListUrl(){
			// 组件配置的返回箭头的页面路径值
			var prevPageLink = $('.gallery-photo-detail .prev').data('url') || '';
			if(!prevPageLink){
				// 未配置时，获取链接默认值   photo详情页对应 photos列表，video详情页对应 works列表
				var listName= (workType=='video') ? 'works':'photos';
				var galleryUrl = getPhotoDetailUrl.split(workType+".")[0];
				prevPageLink = galleryUrl + listName;
			}
			return prevPageLink;
		}
		
		var windowH = utils.windowHeight();
		var windowW = utils.windowWidth();
		var minH;

		//左侧图片定位
		function cssLeftImg() {
			//计算放图片的大盒子的高度 用于实现图片垂直居中
			var footH = $(".gallery-footer").height();
			if (windowH <= 768 && windowW > 768) {
				minH = 768;
			} else {
				minH = windowH;
			}
			$(".photo-detail").css("height", minH);
			var detailPaddingH = 100;
			var backArrowH = $(".photo-detail .main .left .prev.font.font-Carousel-arrow-l").outerHeight(true);
			var shareH = $(".photo-detail .main .left .share-site").outerHeight(true);
			var calcH = detailPaddingH + backArrowH + shareH + 50;

			//包含图片的大盒子的高度
			var boxW = $('.photo-detail .left .gallery-photo .gallery-photo-img').width();
			var boxH = minH - calcH;
			$(".photo-detail .left .gallery-photo").css("height", boxH);

			//设置图片高度
			var imgW = $(".photo-detail .left .gallery-photo .gallery-photo-img img").width();
			var imgH = $(".photo-detail .left .gallery-photo .gallery-photo-img img").height();

			var $photoImg = $(".photo-detail .left .gallery-photo .gallery-photo-img img");
			if (imgW > imgH) {
				// 图片宽度大于高度，则宽度设 100%，计算理想的高度  boxW/boxH = imgW/idealH;
				var idealH = imgW * boxH / boxW;
				if (idealH < imgH) {
					// 等比缩放后图片高度 小于图片当前高度
					$photoImg.css({
						"width": "auto",
						"height": "100%"
					});
				} else {
					$photoImg.css({
						"width": "100%",
						"height": "auto"
					});
				}
			} else {
				// 图片高度大于宽度，则高度设100%，计算理想宽度  boxW/boxH = idealW/imgH;
				var idealW = imgH * boxW / boxH;
				if (idealW < imgW) {
					// 等比缩放后图片宽度小于图片当前宽度
					$photoImg.css({
						"width": "100%",
						"height": "auto"
					});
				} else {
					$photoImg.css({
						"width": "auto",
						"height": "100%"
					});
				}
			}
		};
		//右侧评论区的样式
		function cssRightComment() {
			var leftH = $(".photo-detail .main .left").height();
			var authorInfoBoxH = $(".photo-detail .main .right .title-author-info").outerHeight(true);
			var authorDesc = $(".photo-detail .main .right .photo-desc").outerHeight(true);
			var addCommentH = $(".photo-detail .main .right .comments .add-comment").outerHeight(true);

			var commentArrowH = $(".photo-detail .main .right .comments .arrow").outerHeight(true);
			var commentsCon = parseInt(leftH - authorInfoBoxH - authorDesc - addCommentH - commentArrowH - 80);
			//判断PC高度小于768时设置最小高度
			$(".photo-detail .main .right .comments .comments-con").css("height", commentsCon);
			var liLen = $(".photo-detail .main .right .comments .comments-con ul li").length;
			if (windowW > 768 && liLen <= 0) {
				$(".photo-detail .main .right .comments .comments-con").css("line-height", commentsCon + "px");
			}
		};
		//光标聚集评论框 未登录弹出登录提示框
		$("#commentConten").focus(function() {
			if (honorData.loginName === "" || honorData.loginName === null || honorData.loginName === "null") {
				galleryAlert.showAlert();
				return false;
			}
		});

		//弹框
		var modalTitle = $("#modalTitle").val();
		function confirmModal(modalContent) {
			$(".confirm-action-modal .modal-title").html(modalTitle);
			$(".confirm-action-modal .modal-contents").html(modalContent);
			$(".confirm-action-modal").show();
		};
		//取消弹框
		$(".confirm-action-modal .btncancel").click(function() {
			$(".confirm-action-modal .btnok").off("click");

			$(".confirm-action-modal").hide();
		});

		//滚动条优化
		function niceScroll(el) {
			//IE 11以下不执行渲染
			if(utils.IEVersion()!="-1" && utils.IEVersion() < 11){
				return;
			}
			$(el).niceScroll({
				cursorcolor: "#ccc",
				//#ccc 光标颜色
				cursoropacitymax: 1,
				//改变不透明度非常光标处于活动状态（scrollabar“可见”状态），范围从1到0
				touchbehavior: false,
				//使光标拖动滚动像在台式电脑触摸设备
				cursorwidth: "5px",
				//像素光标的宽度
				cursorborder: "0",
				// 游标边框css定义
				cursorborderradius: "5px",
				//以像素为光标边界半径
				autohidemode: false,
				//是否隐藏滚动条
				cursordragontouch: true,
				//使用触屏模式来实现拖拽
				horizrailenabled: false //禁用横向滚动条
			});
		};
		/*
		 * 加载分享的html
		 * @param isPraised
		 * @param heartCount
		 * @param commentCount
		 * @param deivce
		 * @param location
		 * @param isCalDel
		 * 
		 */
		function loadShare(isPraised, heartCount, commentCount, deivce, location, isCalDel) {
			var lovedClass = '',loveType='';
			if (+isPraised === 0) {
				// 点赞数据
				lovedClass = 'red';
				loveType = 'loved'
			}

			$(".photo-detail .share-site .love-data").html('<i count="' + heartCount + '" data-type="'+loveType+'" class="heart fa fa-heart ' + lovedClass + '"></i>' + heartCount);
			$(".photo-detail .share-site .comment-data ").html('<i class="fa fa-comment" num="' + commentCount + '"></i>' + commentCount);
			if (+isCalDel === 0) {
				$(".photo-detail .operate-delete").show();
				
			}
			$(".photo-detail .share-site .device-name span").text(deivce);
			
			//若无拍摄地点，则不显示地点展示
			if(location){
				$(".photo-detail .share-site .location-name span").text(location);
			}else{
				$(".photo-detail .share-site .location-name").remove();
			}
			

			//删除用户图片
			$(".photo-detail .main .share-site i.delete").click(function() {
				var modalContent = $("#deleteImgModalContent").val();
				confirmModal(modalContent);
				$(".confirm-action-modal .btnok").click(function() {
					$(".confirm-action-modal").hide();
					$.ajax({
						type: "post",
						url: photoData.requestUrl + '/abroad/shootMatch/userDelImg',
						dataType: "jsonp",
						data: {
							imgId: photoData.imgId
						},
						success: function(result) {
							if (result.code === "100007") {
								galleryAlert.showAlert();
								return false;
							} else if (result.success) {
								$(".photo-detail").hide();
								$(".nodata").show();
								$(".nodata").height(windowH);
								$(".gallery-header").addClass("alertbg");
								return false;
							} else {
								alert(result.resultDesc);
							}
						}
					})
				})

			});
			
			//增加点赞
			$(".photo-detail .main  .share-site .shares li:nth-child(1) i.heart").click(function() {
				var loveType = $(this).data('type');
				var imgSrc = $(".photo-detail .main .right .photo-name img").attr("src");
				if(loveType=='loved'){
					//已点赞，现在取消
					delPraise(imgSrc);
				}else{
					//未点赞，现在增加
					addPraise(imgSrc);
				}
			});
			
			// 增加点赞
			function addPraise(imgSrc){
				$.ajax({
					type: "post",
					url: photoData.requestUrl + '/abroad/shootMatch/addPraise',
					dataType: "jsonp",
					data: {
						imgSrc: imgSrc,
						imgId: photoData.imgId,
						activityName: photoData.activityName
					},
					success: function(result) {
						if (result.code === "100007") {
							galleryAlert.showAlert();
							return false;
						}
						if (result.success) {
							window.dataLayer.push({
								"event": "photoLike",
								"pageType": honorConfig.pageType,
								"photoCategory": photoData.imgStyle
							})
							getImgCommentNum();
						} 
					}
				})
			}
			
			//删除点赞
			function delPraise(imgSrc) {
				$.ajax({
					type: "post",
					url: photoData.requestUrl + '/abroad/shootMatch/delPraise',
					dataType: "jsonp",
					data: {
						imgSrc: imgSrc,
						imgId: photoData.imgId,
						activityName: photoData.activityName
					},
					success: function(result) {
						if (result.code === "100007") {
							galleryAlert.showAlert();
							return false;
						}
						if (result.success) {
							getImgCommentNum();
						}

					}
				})
			};
		};

		//展开收起 评论列表
		$(".photo-detail .main .right .comments .arrow").click(function() {
			var isHasPackup = $(this).attr("class").indexOf("packup");
			if (isHasPackup > 0) {
				$(this).removeClass("packup");
			} else {
				$(this).addClass("packup");
			}
			$(".photo-detail .main .right .comments .comments-con").toggle();
		})
		//获取用户昵称
		function getUserDisplayName(loginHeadURL) {
			$(".photo-detail .main .right .photo-comments .user-photo").html("<img src='" + loginHeadURL + "' >");
			$.ajax({
				url: photoData.requestUrl + '/abroad/shootMatch/getUserDisplayName',
				type: 'get',
				dataType: "jsonp",
				success: function(result) {
					if (result.success) {
						$(".photo-detail .photo-comments .add-comment .user-photo img").attr("alt", result.displayName);
					}
				}
			})
		};
		//获取图片详情
		function loadImgInfo() {
			$.ajax({
				type: "get",
				url: photoData.requestUrl + '/abroad/shootMatch/getImgInfoById',
				data: {
					imgId: photoData.imgId,
					country: photoData.country,
					activityName: photoData.activityName
				},
				dataType: "jsonp",
				success: function(result) {
					if (result.success) {
						if (result.infoBean === "" || result.infoBean === undefined || !result.infoBean.imgSrc) {
							$(".photo-detail").hide();
							$(".nodata").show();
							$(".nodata").height(windowH);
							$(".gallery-header").addClass("alertbg");
							return false;
						}
						if (result.infoBean !== undefined && result.infoBean !== "") {
							photoData.imgStyle = result.infoBean.imgStyle;
							photoData.photoDetailName = result.infoBean.imgThemes;
							photoData.photoDetailAuthor = result.infoBean.nickNameAct;
							photoData.photoDetailDesc = result.infoBean.imgContent;
							$(".photo-detail .main").css("background-image", "url(" + result.infoBean.imgSrc + ")");
							
							if(photoData.type=='photo'){
								$(".photo-detail .left .gallery-photo .gallery-photo-img").html("<img src=" + result.infoBean.imgSrc + " alt=" + photoData.photoDetailName + " />");
							}else if(photoData.type=='video'){
								$('#videoBox').attr('src',result.infoBean.videoPath)
								.attr('poster',result.infoBean.imgSrc);
							}
							
							$(".photo-detail .main .right .gallery-photo-title").html(photoData.photoDetailName);
							$(".photo-detail .main .right .authorphoto-authorname").html("<img src='" + result.infoBean.userHeadUrl + "' alt='" + photoData.photoDetailAuthor + "' /> " + photoData.photoDetailAuthor + "");
							$(".photo-detail .main .right .photo-desc").html(photoData.photoDetailDesc);
							loadShare(result.infoBean.isPraised, result.infoBean.praiseNum, result.infoBean.commentNum, result.infoBean.divices, result.infoBean.location, result.infoBean.calDel);
							getCommentList(1);
							if (windowW > 768) {
								var imgLoad = imagesLoaded('.photo-detail .left .gallery-photo .gallery-photo-img img');
								imgLoad.on('done', function(instance) {
									cssLeftImg();
									cssRightComment();
								})

							}

							var loginHeadURL = decodeURIComponent(utils.getCookie('loginHeadURL'));
							if (loginHeadURL === null || loginHeadURL === "" || loginHeadURL === "null") {
								loginHeadURL = "/etc/designs/honor-site/assets/gallery/pic01.jpg";
							}
							getUserDisplayName(loginHeadURL);
							//返回到对应的列表页
							photoData.backUrl += "/?type=" + result.infoBean.imgStyle;
							$(".photo-detail .left .prev.font.font-Carousel-arrow-l").attr("href", photoData.backUrl);
							var el = $(".photo-detail .main .right  .photo-desc,.photo-detail .main .right .comments .comments-con");
							niceScroll(el);
						}
					} else {
						$(".photo-detail").hide();
						$(".nodata").show();
						$(".nodata").height(windowH);
						$(".gallery-header").addClass("alertbg");
						return false;
					}
				}
			})
		};
		var pageIndex = 1;
		//查询评论列表
		function getCommentList(pageIndex) {
			var curUserId = utils.getCookie('loginUid');
			$.ajax({
				type: "post",
				url: photoData.requestUrl + '/abroad/shootMatch/queryOneImgComment',
				dataType: "jsonp",
				data: {
					imgId: photoData.imgId,
					country: photoData.country,
					activityName: photoData.activityName,
					pageIndex: pageIndex,
					pageSize: 20
				},
				success: function(result) {
					if (result.success) {
						var comments = result.infoBean.pageList;
						if (result.infoBean.total <= 0) {
							var noData = $("#noCommentContentPrompt").val();
							$(".photo-detail .comments-con").html('<ul></ul><div class="no-comment">' + noData + '</div>');
							if (windowW <= 768) {
								$(".photo-detail .main .right .comments .comments-con .no-comment").css("margin", "30px 0");
							}
						}
						if (comments.length > 0) {
							var liHtml = $(".photo-detail .comments-con ul");
							for (var i = 0; i < comments.length; i++) {
								if (+comments[i].commentStatus === 0) {
									var strli = "<li><div>";
									strli += '<div class="photo-name"><i><img src="' + comments[i].headPictureURL + '" alt="' + comments[i].nickNameAct + '"></i> ' + comments[i].nickNameAct + '</div>';
									strli += '<div class="comment-desc"><div class="deletePrompt">' + comments[i].commentContent + '</div>';
									strli += "<div imgid='" + comments[i].imgId + "' commentId='" + comments[i].commentId + "' class='" + (+comments[i].calDel === 0 ? "font font-Delete delete" : "") + "'></div>";

									if (curUserId !== comments[i].cldId) {
										strli += '<div nicknameact="' + comments[i].nickNameAct + '" replycldId="' + comments[i].cldId + '" class="fa fa-comment comment"></div>';
									}
									strli += "</div></li>";
									liHtml.append(strli);
								}
							}
							$(".photo-detail .comments-con").html(liHtml);
							//点击评论图标事件
							$(".photo-detail .main .right .comments .comments-con .comment-desc div.comment").click(function() {
								photoData.replyNickNameAct = $(this).attr("nicknameact") + " ";
								photoData.replyCldId = $(this).attr("replycldId");
								$(".photo-detail .main .right .comments .comment-input #commentConten").val("@ " + photoData.replyNickNameAct);
								photoData.isReply = 0;
							})
							$(".photo-detail .main .right .comments .comments-con").css("line-height", "normal");
							//删除用户评论
							$(".photo-detail .main .right .comments .comments-con .comment-desc .font-Delete.delete").click(function() {
								var $this = $(this);
								var modalContent = $("#modalContent").val();
								var imgId = $(this).attr("imgid"),
									commentId = $(this).attr("commentid");
								confirmModal(modalContent);
								$(".confirm-action-modal .btnok").click(function() {
									$(".confirm-action-modal").hide();
									$.ajax({
										type: "post",
										url: photoData.requestUrl + '/abroad/shootMatch/delComment',
										dataType: "json",
										xhrFields: {
											withCredentials: true
										},
										data: {
											imgId: photoData.imgId, // 特别注意
											activityName: photoData.activityName,
											commentId: commentId
										},
										success: function(result) {
											if (result.code === "100007") {
												galleryAlert.showAlert();
												return false;
											}
											if (result.success) {
												$this.parent().parent().parent().remove();
												getImgCommentNum();
											}
										}
									})
								})
							});
						}
					}

				}
			})
		};
		//滚动加载
		$(".photo-detail .main .right .comments .comments-con").scroll(function() {
			var divHight = $(".photo-detail .main .right .comments .comments-con").height(); //内容高度
			var scrollHight = $(this)[0].scrollHeight;
			var scrollTop = $(this)[0].scrollTop;
			if (scrollTop + divHight >= scrollHight) {
				pageIndex = +pageIndex + 1;
				getCommentList(pageIndex);
			}
		});
		//添加评论
		$(".photo-detail #addUserComment").click(function() {
			window.dataLayer.push({
				"event": "photoComment",
				"photoCategory": photoData.imgStyle
			})
			var commentContent = $("#commentConten").val();
			var objData = {
				commentContent: commentContent,
				imgId: photoData.imgId,
				activityName: photoData.activityName
			};
			var isCommentStr = "@ " + photoData.replyNickNameAct;
			if (photoData.isReply === 0 && commentContent.indexOf(isCommentStr) != -1) {
				var curUserId = utils.getCookie('loginUid');
				if (curUserId === photoData.replyCldId) {
					var replyCommentPrompt = $(".photo-detail #replyCommentPrompt").val();
					alert(replyCommentPrompt);
					return false;
				}
				objData = {
					commentContent: commentContent,
					imgId: photoData.imgId,
					activityName: photoData.activityName,
					isReply: 0,
					replyCldId: photoData.replyCldId,
					replyNickNameAct: photoData.replyNickNameAct
				};
			}

			$.ajax({
				type: "post",
				url: photoData.requestUrl + '/abroad/shootMatch/addComment',
				dataType: "json",
				xhrFields: {
					withCredentials: true
				},
				data: objData,
				success: function(result) {
					if (result.code === "100007") {
						galleryAlert.showAlert();
						return false;
					}
					if (commentContent === "") {
						alert($(".photo-detail #noContentPrompt").val());
						return false;
					}
					if (result.success) {
						$("#commentConten").val('');
						$(".photo-detail .comments-con ul").html('');
						getCommentList(1);
						getImgCommentNum();
					}
				}
			})
		});

		//获取图片评论数量
		function getImgCommentNum() {
			$.ajax({
				type: "get",
				url: photoData.requestUrl + '/abroad/shootMatch/getImgInfoById',
				data: {
					imgId: photoData.imgId,
					country: photoData.country,
					activityName: photoData.activityName
				},
				dataType: "jsonp",
				success: function(result) {
					if (result.success) {
						if (result.infoBean === "" || result.infoBean === undefined) {
							$(".photo-detail").hide();
							$(".nodata").show();
							$(".nodata").height(windowH);
							$(".gallery-header").addClass("alertbg");
							return false;
						}
						if (result.infoBean !== undefined && result.infoBean !== "") {
							loadShare(result.infoBean.isPraised, result.infoBean.praiseNum, result.infoBean.commentNum, result.infoBean.divices, result.infoBean.location, result.infoBean.calDel);
						}
					}
				}

			})

		};

		/*分享*/
		$(".photo-detail .main .share-site i.icon-share").click(function() {
			$(".photo-detail .share-box").toggleClass('hide-elem');
		})
		var _link = encodeURIComponent(getPhotoDetailUrl);

		//分享到facebook
		$(".photo-detail .main .fa-facebook").click(function() {
			window.dataLayer.push({
				"event": "photoShare",
				"photoCategory": photoData.imgStyle,
				"socialNetwork": "Facebook"
			});
			window.open("https://www.facebook.com/sharer.php?u=" + encodeURIComponent(getPhotoDetailUrl) + '&hashtag=‪%23ShotOnHONOR', "newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
		});
		//分享到twitter
		$(".photo-detail .main .fa-twitter").click(function() {
			window.dataLayer.push({
				"event": "photoShare",
				"photoCategory": photoData.imgStyle,
				"socialNetwork": "Twitter"
			});

			var photoBy = $('#photoBy').val();
			var onHONOR = $('#onHONOR').val();
			var hashtags = encodeURIComponent('#ShotOnHONOR');
			window.open('https://twitter.com/intent/tweet?hashtags=ShotOnHONOR &amp;text=' + encodeURIComponent(photoData.photoDetailName) + ' ' + encodeURIComponent(photoBy) + ' ' + encodeURIComponent(photoData.photoDetailAuthor) + ' ' + encodeURIComponent(onHONOR) + ' ' + encodeURIComponent(getPhotoDetailUrl) + ' &amp;url=' + encodeURIComponent(getPhotoDetailUrl) + '" data-url="' + encodeURIComponent(getPhotoDetailUrl) + '"', "newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
		});
		//分享到qq
		$(".photo-detail .main .fa-qq").click(function() {
			window.dataLayer.push({
				"event": "photoShare",
				"photoCategory": photoData.imgStyle,
				"socialNetwork": "QQ"
			});
			var _shareImgSrc = encodeURIComponent($(".photo-detail .left .gallery-photo .gallery-photo-img img").attr("src"));
			var _title = encodeURIComponent("#荣耀锐影像 " + photoData.photoDetailName);
			var _desc = encodeURIComponent(photoData.photoDetailDesc);
			window.open('//connect.qq.com/widget/shareqq/index.html?url=' + _link + '&title=' + _title + '&desc=' + _desc + '&amp;pics=' + _shareImgSrc + '', 'newwindow', 'height=680, width=700, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no');
		});
		//分享到qzone
		$(".photo-detail .main .fa-qzone").click(function() {
			window.dataLayer.push({
				"event": "photoShare",
				"photoCategory": photoData.imgStyle,
				"socialNetwork": "Qzone"
			});
			var _shareImgSrc = encodeURIComponent($(".photo-detail .left .gallery-photo .gallery-photo-img img").attr("src"));
			var _title = encodeURIComponent("#荣耀锐影像 " + photoData.photoDetailName);
			var _desc = encodeURIComponent(photoData.photoDetailDesc);
			window.open('//sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=' + _link + '&title=' + _title + '&summary=' + _desc + '&pics=' + _shareImgSrc + '', 'newwindow', 'width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		});
		//分享到weibo
		$(".photo-detail .main .fa-weibo").click(function() {
			window.dataLayer.push({
				"event": "photoShare",
				"photoCategory": photoData.imgStyle,
				"socialNetwork": "Weibo"
			});
			var _shareImgSrc = encodeURIComponent($(".photo-detail .left .gallery-photo .gallery-photo-img img").attr("src"));
			var _title = encodeURIComponent("#荣耀锐影像 " + photoData.photoDetailName);
			var _desc = encodeURIComponent(photoData.photoDetailDesc);
			window.open('//service.weibo.com/share/share.php?url=' + _link + '&title=' + _title + '&pic=' + _shareImgSrc + '', 'newwindow', 'width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		});
		//分享到VK
		$(".photo-detail .main .fa-vk").click(function() {
			window.dataLayer.push({
				"event": "photoShare",
				"photoCategory": photoData.imgStyle,
				"socialNetwork": "VK"
			});
			window.open('//vk.com/share.php?url =' + _link + '', 'newwindow', 'width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		});
		//分享到WhatsApp
		$(".photo-detail .main .fa-whatsapp").click(function() {
			window.dataLayer.push({
				"event": "photoShare",
				"photoCategory": photoData.imgStyle,
				"socialNetwork": "WhatsApp"
			});

			window.open('//api.whatsapp.com/send?text=' + _link + '', 'newwindow', 'width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
		});

		
	})

})();
/**
 * Gallery Month Popular
 */
(function(){
	$(function(){
		if($('.gallery-month-popular').length>0){
			var lastDate='';  // 上一次日期
			var marginTopH=0; // 图片上边距
			var windowW = utils.windowWidth();
			var windowH = utils.windowHeight(); 
			var uri=window.digitalData.page.pageInfo.uri;  // URI For GA 
			
			// 图片缩放比例
			var scalPercent = '42%',scalNum = 0.42;
			if(windowW >768 && windowW <= 1440){
				scalPercent = '38%';
				scalNum = 0.38;
			}
			
			// 获取年份，月份数据
			var yearData = [],yearMonthData = [];
			getDateDatas();
			
			// URL传参 当前年月日期
			var currYear = utils.getRequest().year || '';
			var currMonth = utils.getRequest().month || '';
			var currDate = currMonth;
			if(currYear){
				currDate = currYear +'-'+ currDate;
				// 获取年份对应月份数据
				getMonthDatas(currYear);
			}
			
			if(currDate){
				//有年月份传参
				lastDate = currDate;
				//文案切换
				changeDate(currYear,currMonth); 
				//图片切换+动效
				if(windowW >768){
					pcImgAnimate(currDate);
				}else{
					mbImgAnimate(currDate);
				}
			}else{
				// 没有传参，显示最新年月份
				currYear = $('.year-lists li:first-child').data('year');
				// 获取日期列表数据
				getMonthDatas(currYear);
				currMonth = $('.month-lists li:first-child').data('month');
				currDate = currYear +'-'+ currMonth;
				lastDate = currDate;
				
				//文案切换
				changeDate(currYear,currMonth); 
				//图片切换+动效
				if(windowW >768){
					pcImgAnimate(currDate);
				}else{
					mbImgAnimate(currDate);
				}
			}
			
			// 初始化UI
			initUI();
			
			//GA CODE START
			window.dataLayer.push({
			    page:uri+currDate
			})
			//GA CODE END
			
			// 手动选择月份及切换		
			if(windowW >768 && !utils.isMobileEnd()){
				// PC端
				$('.year-choose,.month-choose').stop().mouseenter(function(e){
					e.stopPropagation();
					$(this).find('.curr-date').addClass('active');
					$(this).find('.date-lists').stop().slideDown();
					$('.gallery-month-popular .month-item .img-info').addClass('grey');
				})
				$('.year-choose,.month-choose').stop().mouseleave(function(e){
					e.stopPropagation();
					$(this).find('.curr-date').removeClass('active');
					$(this).find('.date-lists').stop().slideUp();
					$('.gallery-month-popular .month-item .img-info').removeClass('grey');
				})
			} 
			
			if(utils.isMobileEnd()){
				// 移动端
				$('.year-choose,.month-choose').click(function(e){
					var flag = $(this).attr('data-flag');
					if(flag){
						$(this).attr('data-flag','false').find('.date-lists').stop().slideDown();
						$(this).siblings().attr('data-flag','true').find('.date-lists').stop().slideUp();
						if(galleryPublicData.windowW == 1024){
							$('.gallery-month-popular .month-item .img-info').addClass('grey');
						}
					}else{
						$(this).attr('data-flag','true').find('.date-lists').stop().slideUp();
						if(galleryPublicData.windowW == 1024){
							$('.gallery-month-popular .month-item .img-info').removeClass('grey');
						}
					}
				})
			}
			// 年份切换
			$('.date-choose .year-lists').stop().on('click','li',function(e){
				utils.stopBubble(e);
				$('.date-choose').attr('data-flag','true');
				$(this).addClass('active').siblings().removeClass('active');
				$('.date-lists').stop().slideUp();
				currYear = $(this).data("year"); 
				currMonth = $('.date-choose .curr-month').data("month");
				currDate = currYear +'-'+ currMonth;
				if(lastDate != currDate){ 
					changeDate(currYear,'');
				}
				// 切换月份
				getMonthDatas(currYear);

				//GA CODE START
				window.dataLayer.push({
					event:"virtualPageview",
					page:uri+currDate
				})
				//GA CODE END
			})
			// 月份切换
			$('.date-choose .month-lists').stop().on('click','li',function(e){
				utils.stopBubble(e);
				$('.date-choose').attr('data-flag','true');
				$(this).addClass('active');
				$('.date-lists').stop().slideUp();
				currMonth =$(this).data("month"); 
				currDate = currYear +'-'+ currMonth;
				if(lastDate != currDate){
					lastDate = currDate;
					changeDate(currYear,currMonth);
					if(windowW >768){
						pcImgAnimate(currDate);
					}else{
						mbImgAnimate(currDate);
					}
				}
				//GA CODE START
				window.dataLayer.push({
					event:"virtualPageview",
					page:uri+currDate
				})
				//GA CODE END
			})
			
			// 初始化UI
			function initUI(){
				// 初始化图片状态
				$('.gallery-month-popular .month-imgs').height(windowH);
				if(windowW >768){
					marginTopH = -Math.floor(windowH/2);
					$('.gallery-month-popular .pc-img').css('margin-top',marginTopH);
				}
			}
			
			
			// 月份相关文案切换
			function changeDate(currYear,currMonth){
				$('.date-lists li').removeClass('active');
				if(currYear){
					$('.date-lists .'+currYear).addClass('active');
					$('.date-choose .curr-year').attr('data-year',currYear).text(currYear);
				}
				if(currMonth){
					$('.date-lists .'+currMonth).addClass('active');
					var currMonthTxt = $('.date-lists .'+currMonth).text();
					$('.date-choose .curr-month').attr('data-month',currMonth).text(currMonthTxt);
				}
			}
			
			var isArabic=$("div").hasClass("__arabic__");
			// 月份图片切换
			function pcImgAnimate(currDate){
				// 初始化
				if(isArabic){
					$('.month-imgs .item-img.pc-img').css({
						'top': '50%',
				    	'left': '0',
				    	'bottom': '0',
				    	'width': '100%',
				    	'height':'auto',
						'right':'auto', 
						'margin-top':marginTopH
					})
				}else{
					$('.month-imgs .item-img.pc-img').css({
						'top': '50%',
				    	'right': '0',
				    	'bottom': '0',
				    	'width': '100%',
				    	'height':'auto',
						'margin-top':marginTopH
					})
				}
				//切换月份图片 
				var $overlay = $('.gallery-month-popular .month-overlay');
				$overlay.stop().fadeIn(0);
				
				$('.month-imgs .month-item').stop().hide();
				$('.month-imgs .month-item.'+currDate).stop().show();
				
				var $currPcImg = $('.month-imgs .month-item.'+currDate+' img.pc-img');
				var currImg = $currPcImg.data('src');
				$currPcImg.attr('src',currImg);
				$currPcImg.show();
				// 图片加载完成执行
				$currPcImg.imagesLoaded().done(function() {
					// 判断图片是横向图片还是纵向图片
					var flag = isHorizontal($currPcImg);
					if(flag){
						//横向
						var imgH = $currPcImg.height() * scalNum;
						var smallTopH = -Math.floor(imgH/2); 
						if(isArabic){
							$currPcImg.stop().animate({
								'width':scalPercent,
								'left':'15%', 
								'right':'auto',
								'margin-top':smallTopH
							},6000)
						}
						else{
							$currPcImg.stop().animate({
								'width':scalPercent,
								'right':'15%', 
								'margin-top':smallTopH
							},6000)
						}
					}else{
						// 纵向
						var imgW = $currPcImg.width();
						var imgH = $currPcImg.height();
						var endImgH = windowH*0.8;
						var endImgW = imgW *(endImgH/imgH);
						if(isArabic){
							$currPcImg.stop().animate({
								'width':endImgW,
								'height':'80%',
								'top':'10%',
								'left':'15%',
								'margin-top':'0'
							},6000)
						}
						else{
							$currPcImg.stop().animate({
								'width':endImgW,
								'height':'80%',
								'top':'10%',
								'right':'15%',
								'margin-top':'0'
							},6000)
						}
						
					}
					
					$overlay.stop().fadeOut({
						duration: 6000
					}); 
				})
			}
			// 判断图片是横向图片还是纵向图片
			function isHorizontal(img){
				var imgW = img.width();
				var imgH = img.height(); 
				if(imgW/imgH>1){
					//横向图片
					return true;
				}else{
					//纵向图片
					return false;
				} 
			}
			// 移动端动效
			function mbImgAnimate(currDate){
				var $currPcImg = $('.month-imgs .month-item.'+currDate+' img.mb-img');
				var currImg = $currPcImg.data('src');
				$currPcImg.attr('src',currImg);
				$currPcImg.show();
				$('.month-imgs .month-item').stop().hide();
				$('.month-imgs .month-item.'+currDate).stop().show();
			}
			
			// 获取日期数据
			function getDateDatas(){
				var datas = [];
				var monthTranlate = ['January','February','March','April','May','June','July','August','September','October','November','December'];
				$('.gallery-month-popular .item-datas li').each(function(){
					var year = $(this).data('year') || ''; 
					var month = $(this).data('month') || ''; 
					var monthText = $(this).data('text') || month;
					yearData.push(year);
					var data = {
						year:year,
						month:{
							'num':monthTranlate.indexOf(month)+1,
							"name":month,
							"monthText":monthText
						}
					}
					datas.push(data);
				})
				// 获取年份数据
				yearData = yearData.filter(function(ele,index,self){
					return self.indexOf(ele)===index;
				}).sort(function(a,b){return b-a});
				
				//渲染年份列表
				renderingYearLists();

				// 获取年份对应月份数据
				for(var x=0;x<yearData.length;x++){
					var obj = {
						year:0,
						month:[]
					};
					for(var y=0;y<datas.length;y++){
						if(yearData[x]==datas[y].year){
							obj.year =yearData[x];
							obj.month.push(datas[y].month);
						}
					}
					obj.month.sort(function(a,b){
						return b.num-a.num;
					})
					yearMonthData.push(obj);
				}
			}
			// 渲染年份列表
			function renderingYearLists(){
				var yearLists='';
				yearData.forEach(function(ele){
					yearLists +='<li class="'+ele+'" data-year="'+ele+'">'+ele+'</li>';
				})
				$('.year-lists').empty().append(yearLists);
			}
			
			// 获取年份对应月份数据 并渲染出来
			function getMonthDatas(year){
				//此处的文案需要做成配置项
				var changeMonthTxt= $('.date-choose').data('changemonth') || 'Change Month';
				$('.date-choose .curr-month').attr('data-month','').text(changeMonthTxt);
				var endMonthData = yearMonthData.filter(function(ele){
					return ele.year == currYear
				})[0].month;
				var monthLists='';
				endMonthData.forEach(function(ele){
					monthLists +='<li class="'+ele.name+'" data-num="'+ele.num+'" data-month="'+ele.name+'">'+ele.monthText+'</li>';
				})
				$('.month-lists').empty().append(monthLists);
				$('.gallery-month-popular .month-lists').css('height','auto');
				// 美化月份列表高度，列表高度自适应 最高为视窗的80%
				var $list = $('.gallery-month-popular .month-lists');
				var setH = Math.floor(windowH*0.6);
				var currListH = $list.height();
				var endListH = setH>currListH ? currListH : setH;
				$('.gallery-month-popular .month-lists').height(endListH);
			}
		}
	})
}());
/**
 * Gallery Photos Lists
 */ 
(function(){
	$(function(){ 
		if($('.howto-videos').length>0){				
			//复制成功提示框居中显示
			var tipW=$(".howto-videos #success-tip").outerWidth(true);
			var calc='calc((100% - '+ tipW+'px'+')/2)';
			$(".howto-videos #success-tip").css('left',calc);
			
			var data = JSON.parse($('#videosData').html());
			var dataJson = { 
				index: 0,  // 当前页码
				size: 8,   // 每页显示个数
				start:0,   // 数组开始下标
				end:0      // 数组结束下标
			}
			var loadMore=true;
			// 首次请求
			var firstReq = true;
			// 获取How To video列表数据
			getHowtoLists();
			
			//滚动监听 
			$(window).scroll(function() {
				var windowH = utils.windowHeight();
				var scrollTop = $(document).scrollTop();
				
				var $lists = $('.howto-videos ul');
				var listsTop = $lists.position().top;
				var listsH = $lists.height();
				
				var flag = (windowH+scrollTop)>(listsTop+listsH);
				if(loadMore && flag && !firstReq){ 
					loadMore = false;
					getHowtoLists();
				}
			}); 
			
		 
			
			//组装标题
			function joinName(str){
				var arr=str.split('|');
				var newStr="";
				for(var i=0;i<arr.length;i++){
					newStr+=arr[i]+"<br>";
				}
				return newStr;
			}
			
			// 获取How To列表数据
			function getHowtoLists(){
				firstReq = false;
			    var curUrl=window.location.href;
			    
				var localUrl = location.protocol+"//"+location.host; 
				// 计算 请求页面数据
				dataJson.start = dataJson.index * dataJson.size;
				dataJson.end = dataJson.start+dataJson.size;
				var endData= data.slice(dataJson.start,dataJson.end);
				dataJson.index++;
				var str='';
				if(endData.length>0){
					loadMore = true;
					for(var i=0;i<endData.length;i++){
						str+='<li>';
						str+='<img src="'+endData[i].cardImg+'" alt="'+endData[i].cardImgAlt+'"  title="'+endData[i].cardImgTitle+'" />';
						str+='<div class="play"> <img  src="/etc/designs/honor-site/assets/icons/play-arrow.png" /></div>';
						str+='<div class="video-txt">';
						   str+='<p class="txt-white">'+joinName(endData[i].videoTitle)+'</p>';
						   str+='<p class="txt-color">'+joinName(endData[i].videoSubTitle)+'</p>';
						str+='</div>';
						str+='<div class="mb video">';
						   str+='<div class="font font-Cross close"></div>';
						   str+='<div class="share">';
						         str+='<div class="mb icon-share"><img  src="/etc/designs/honor-site/assets/icons/share.png" /></div>';
						         str+='<div class="mb-share-box">';
						             str+=' <div data-showId="'+endData[i].title+'" class="share-boxs" data-shareurl="'+endData[i].detailUrl+'" data-txt="'+endData[i].cardImgTitle+'" data-src="'+endData[i].cardImg+'">';
							             if($(".shareItem a").length>0){
							            	 str+=$(".shareItem").html();
							             }else{
							            	 str+='<a href="javascript:void(0)" class="fa fa-facebook"></a>';
							                 str+='<a href="javascript:void(0)" class="fa fa-twitter"></a>';
							             }
						             str+='</div>';
						             var newUrl = location.protocol+"//"+location.host+location.pathname; 
						             str+='<i data-clipboard-text="'+newUrl+"#@"+endData[i].title+'" class="share-link"></i>';
						         str+='</div>';
						   str+='</div>';
						   str+='<div class="play-video">';
						       str+='<video height="100%" preload="auto"  controls="controls" controlsList="nodownload"  disablePictureInPicture loop="loop">';
						            str+='<source src="'+endData[i].videoPath+'" type="video/mp4">';
						            str+='<source src="'+endData[i].videoPath+'" type="video/webm">';
						            str+='<source src="'+endData[i].videoPath+'" type="video/ogg">';
						       str+='</video>';
						   str+='</div>';
						str+='</div>';
						str+='</li>';
						
					}
					$('.howto-videos ul').append(str);
					eventAction(dataJson.index);
					// 懒加载
			    	$(".howto-item img.lazy").lazyload({
						"placeholder":lazyload.placeholder
					}).show(); 
				}
			}
		}
	}) 	
    function eventAction(index){
    	 var windowH = utils.windowHeight();
	      var windowW = utils.windowWidth();
	  	// 链接复制成功
			var clipboard = new ClipboardJS('.howto-videos li .video .share .share-link'); 
			 clipboard.on('success', function(e) { 
				 if(windowW<=768){
					 $(".howto-videos li").each(function(i,el){
						 $(el).find("div.play-video").hide();
						 $(el).find("div.close").hide();
						 $(el).find("div.share").show().css("width","auto");
						 $(el).find(".video").hide();
						 $(el).find(".mb.video").css("height","auto").show();
						 $(el).find("video").trigger("pause");
					 })
				 }
				
				$('#success-tip').show()			
				.animate({ 
					'margin-top':'-21px',
					'opacity':'0.9'
				},1000).delay('3000')
				.animate({ 
					'margin-top':'-51px',
					'opacity':'0'
				},1000,function(){
					$('#success-tip').hide();
				}); 
			    e.clearSelection();
			});
	      
	      //默认弹框
			var urlStr= window.location.href;
			var showId=urlStr.split("#@")[1];
			if(showId&&index==1){
				var el=$('.howto-videos .share-boxs[data-showid="'+showId+'"]');
				var $video=el.parent("div").parent("div").parent("div.video");
				$video.css("width",windowW);
		  		$video.css("height",windowH);
		  		$video.show();
		  		$video.children("div.play-video").show();
		  		$video.children("div.close").show();
		  		if(windowW<=768){
		  			$video.children("div.share").hide();
		  		}
		  		 $video.children("div.play-video").children("video").trigger("play");
		  		 var wShareBox=$video.children("div.share").children("div").children("div.share-boxs").outerWidth(true);
		  		 var wShareLink=$video.children("div.share").children("div").children("i").outerWidth(true);
		  		 var vwidth=wShareBox+wShareLink;
			     $video.children("div.share").css("width","108px");
			  
			     $(function() {
			    	    var cssShareWidth = setInterval(GetBack,1000);
			    	    function GetBack() {
			    	    	 var vWidth=$video.children("div.play-video").children("video").width();
			    	    	 if(vWidth>1){
								 $video.children("div.share").css("width",vWidth);
								  clearInterval(cssShareWidth);
							 }
			    	    }
			    	  });
           
			}
  	//播放视频
  	$(".howto-videos li").off().click(function(){
  		var $video=$(this).find("div.video");
  		$video.css("width",windowW);
  		$video.css("height",windowH);
  		$video.show();
  		$video.children("div.play-video").show();
  		$video.children("div.close").show();
  		$video.children("div.share").show();
  		$video.children("div.play-video").children("video").trigger("play");
  		var vWidth=$video.children("div.play-video").children("video").width();
  		$video.children("div.share").css("width",vWidth);
  		if(windowW<=768){
  			$video.children("div.share").hide();
  		}  		
  		
  		// GA For Video Click
  		var videoTitle = $(this).find('img').attr('title') || '';
  		window.dataLayer.push({
  			"event": "uaEvent",
  			"eventCategory": "howtoVideo",
  			"eventAction": "click",
  			"eventLabel": videoTitle
		})

  	});
  	//关闭视频弹框
  	$(".howto-videos li .video .close").click(function(e){
  		e.stopPropagation();
  		$(this).hide();
  		$(this).siblings("div.play-video").hide();
  		$(this).siblings("div.share").css("width","auto").hide();
  		$(this).parent("div.video").hide();
  		if(windowW<=768){
  			$(this).parent("div").parent("div").parent("li").css("background-color","rgba(0,0,0,0.9)");
  	  		$(this).parent("div.mb.video").show().css("height","auto");
  	  	    $(this).siblings("div.share").css("width","auto").show();
  		}  	
  		$(this).siblings("div.play-video").children("video").trigger("pause");
  	})	
  		var isArabic=$("div").hasClass("__arabic__");
  	//文本居中
  	  $(".howto-videos li .video-txt").each(function(i,el){
  		 if(!!window.ActiveXObject || "ActiveXObject" in window){
 	      if((i+1)%4==0){
 	    	  $(el).children("p.txt-color").css("color","#e213d7").css("background-image","none");
 	      }
 	   }
  		  var width=$(el).width();
  		  var calcW=(100%-width)/2;
  		  $(el).css("left",calcW);
  		  if(isArabic){
  			 $(el).css("right",calcW);
  		  }
  	  }) 
  	//移动端 显示分享的盒子
  	$(".howto-videos .share .mb.icon-share ").click(function(e){
  		e.stopPropagation();
  		$(this).next("div.mb-share-box").toggle();
  	})	
  	
  //Facebook share
    $(".howto-videos li .video .share-boxs a.fa-facebook").click(function(e) {
    	e.stopPropagation();
      window.dataLayer.push({
        "event": "photoShare",
        "photoCategory": "howtoVideo",
        "socialNetwork": "Facebook"
      });
      var showId=$(this).parent("div.share-boxs").data("showid");
      var currUrl = location.protocol+"//"+location.host; 
      var oLink =currUrl+$(this).parent("div.share-boxs").data("shareurl");
      window.open ("https://www.facebook.com/sharer.php?u="+oLink+'&hashtag=‪%23ShotOnHONOR', "newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
    });
    //分享到twitter
    $(".howto-videos li .video .share-boxs a.fa-twitter").click(function(e) {
    	e.stopPropagation();
      window.dataLayer.push({
        "event": "photoShare",
        "photoCategory": "howtoVideo",
        "socialNetwork": "Twitter"
      });
      var currUrl = location.protocol+"//"+location.host; 
      var oLink =currUrl+$(this).parent("div.share-boxs").data("shareurl");      
      window.open('https://twitter.com/intent/tweet?hashtags=ShotOnHONOR &amp;text='+encodeURIComponent(oLink)+' &amp;url=' + encodeURIComponent(oLink) + '" data-url="' + encodeURIComponent(oLink) + '"',"newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
    });
    
    //分享到qq
    $(".howto-videos li .video .share-boxs a.fa-qq").click(function() {
  	  window.dataLayer.push({
            "event": "photoShare",
            "photoCategory": "howtoVideo",
            "socialNetwork": "QQ"
        });
	  	var currUrl = location.protocol+"//"+location.host; 
	    var oLink =currUrl+$(this).parent("div.share-boxs").data("shareurl");
  	  	var _shareImgSrc = encodeURIComponent(currUrl+$(this).parent("div.share-boxs").data("src"));
	  	var _title=encodeURIComponent($(this).parent("div.share-boxs").data("txt"));
  	  window.open('//connect.qq.com/widget/shareqq/index.html?url=' + oLink +'&title=' + _title +'&pics=' + _shareImgSrc +'','newwindow','height=680, width=700, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no');
    });
    //分享到qzone
    $(".howto-videos li .video .share-boxs a.fa-qzone").click(function() {
  	  window.dataLayer.push({
            "event": "photoShare",
            "photoCategory": "howtoVideo",
            "socialNetwork": "Qzone"
        });
	  	var currUrl = location.protocol+"//"+location.host; 
	    var oLink =currUrl+$(this).parent("div.share-boxs").data("shareurl");
  	    var _shareImgSrc = encodeURIComponent(currUrl+$(this).parent("div.share-boxs").data("src"));
        var _title=encodeURIComponent($(this).parent("div.share-boxs").data("txt"));
  	  window.open('//sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=' + oLink +'&title=' + _title +'&summary=' + _title +'&pics=' + _shareImgSrc +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
    });
    //分享到weibo
    $(".howto-videos li .video .share-boxs a.fa-weibo").click(function() {
  	  window.dataLayer.push({
            "event": "photoShare",
            "photoCategory": "howtoVideo",
            "socialNetwork": "Weibo"
        });
	  	var currUrl = location.protocol+"//"+location.host; 
	    var oLink =currUrl+$(this).parent("div.share-boxs").data("shareurl");
  	  	var _shareImgSrc = encodeURIComponent(currUrl+$(this).parent("div.share-boxs").data("src"));
        var _title=encodeURIComponent($(this).parent("div.share-boxs").data("txt"));
  	  window.open('//service.weibo.com/share/share.php?url=' + oLink +'&title=' + _title +'&pic=' + _shareImgSrc +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
    });
    //分享到VK
    $(".howto-videos li .video .share-boxs a.fa-vk").click(function() {
  	  window.dataLayer.push({
            "event": "photoShare",
            "photoCategory": "howtoVideo",
            "socialNetwork": "VK"
        });
	  	var currUrl = location.protocol+"//"+location.host; 
	    var oLink =currUrl+$(this).parent("div.share-boxs").data("shareurl");
  	  window.open('//vk.com/share.php?url =' + oLink +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
    });
    //分享到WhatsApp
    $(".howto-videos li .video .share-boxs a.fa-whatsapp").click(function() {
  	  window.dataLayer.push({
            "event": "photoShare",
            "photoCategory": "howtoVideo",
            "socialNetwork": "WhatsApp"
        });
	  	var currUrl = location.protocol+"//"+location.host; 
	    var oLink =currUrl+$(this).parent("div.share-boxs").data("shareurl");
  	  window.open('//api.whatsapp.com/send?text=' + oLink +'','newwindow','width=700,height=680,top=0,left=0,toolbar=no,menubar=no,scrollbars=no,location=yes,resizable=no,status=no');
    });
    
    }  	 
}());

(function(){
	$(function(){
		if($('.howto-video-detail').length>0){			
			var showId=$(".howto-video-detail #title").val();
			var repStr=showId+"/"
		     var url=window.location.href.replace(repStr,"")
		        window.location.href=url+"#@"+showId;
		}
	}) 
}());

/**
 * Gallery Photos Lists
 */ 
(function(){
	$(function(){ 
		if($('.gallery-howto-lists').length>0){
			var howtodata = $('#howtoData').html();
			var data = new Array();
			if(howtodata){
				data = JSON.parse(howtodata);
			}
			var dataJson = { 
				index: 0,  // 当前页码
				size: 4,   // 每页显示个数
				start:0,   // 数组开始下标
				end:0      // 数组结束下标
			}
			var loadMore=true;
			// 首次请求
			var firstReq = true;
			
			// 获取How To列表数据
			getHowtoLists();
			
			//滚动监听 
			$(window).scroll(function() {
				var windowH = utils.windowHeight();
				var scrollTop = $(document).scrollTop();
				
				var $lists = $('.gallery-howto-lists .howto-lists');
				var listsTop = $lists.position().top;
				var listsH = $lists.height();
				
				var flag = (windowH+scrollTop)>(listsTop+listsH);
				
				if(loadMore && flag && !firstReq){ 
					loadMore = false;
					getHowtoLists();
				}
			}); 
			
			// 获取How To列表数据
			function getHowtoLists(){
				firstReq = false;
				
				// 计算 请求页面数据
				dataJson.start = dataJson.index * dataJson.size;
				dataJson.end = dataJson.start+dataJson.size;
				var endData= data.slice(dataJson.start,dataJson.end);
				
				dataJson.index++;
				var str='';
				if(endData.length>0){
					loadMore = true;
					for(var i=0;i<endData.length;i++){
						str+='<div class="howto-item">';
						str+='<a href="'+endData[i].url+'">';
						str+='<img class="lazy" data-original="'+endData[i].img+'" title="'+endData[i].cardImgTitle+'" alt="'+endData[i].cardImgAlt+'" />';
						str+='<p class="item-title">'+endData[i].howToTitle+'</p>';
						str+='</a>';
						str+='</div>';
					}
					$('.gallery-howto-lists .howto-lists').append(str);
					
					// 懒加载
			    	$(".howto-item img.lazy").lazyload({
						"placeholder":lazyload.placeholder
					}).show(); 
				}
			}
		}
	}) 
	
	
}());

/**
 * Gallery how to detail
 */ 
(function(){
	$(function(){ 
		if($('.gallery-howto-detail').length>0){
			var currPage = window.location.pathname;
			var commentJson = {
				currUserId: decodeURI(utils.getCookie('loginUid')) || '',
				pageId: hex_md5(currPage),
				activityName: 'gallery_all_blog_comments',
				imgCountries: window.digitalData.page.category.primaryCategory || 'en',
				pageIndex:0,	// 当前页码
				pageSize:4,		// 每页个数
				delId:'', 		// 删除评论的ID
				totalPage:0, 	// 分页个数
				isReply: 1,		// 是否回复评论 0：是；1：否
				replyCldId:'',	// 被回复用户的账号ID
				replyNickNameAct:'' // 被回复用户的昵称
			}
			
			$('.gallery-header').css({
				'background-color':'#0f0f0f'
			})
			
			if(galleryPublicData.windowW>768){
				var src = $('.gallery-howto-detail .box-left .article-img').data('src');
				$('.gallery-howto-detail .box-left .article-img').attr('src',src).show();
			}
			
			// Get Comments
			getComments();
			
			// Login Status
			if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
				// logined
				$('.comment-box .unlogin-tip').hide();
				$('.comment-box .edit-submit').attr('disabled',false);
			}else{
				// unlogin
				$('.comment-box .unlogin-tip').show();
				$('.comment-box .edit-submit').attr('disabled',true);
			}
			
			// Login Url
			$('.gallery-howto-detail .comment-box .to-login').attr('href',galleryPublicData.loginUrl);
			
			// Comment Avator
			var commentAvator = decodeURIComponent(utils.getCookie('loginHeadURL'));
			var commentAvatorAlt = decodeURI(utils.getCookie('displayName'));
            if (commentAvator === null || commentAvator === "" || commentAvator === "null") {
            	commentAvator = "/etc/designs/honor-site/assets/gallery/pic01.jpg";
            	commentAvatorAlt = "author";
            }
            $('.gallery-howto-detail .edit-box .edit-avator').attr('src',commentAvator).attr('alt',commentAvatorAlt);
            
			// Confirm delete
			$('.gallery-howto-detail .delete-alert .btn-confirm').click(function(){
				$('.gallery-howto-detail .delete-alert').hide();
				deleteComment();
			})
			
			// Cancel delete
			$('.gallery-howto-detail .delete-alert .btn-cancel').click(function(){
				$('.gallery-howto-detail .delete-alert').hide();
				
			})
			
			// Submit comment
			$('.gallery-howto-detail .edit-box .edit-submit').click(function(){
				var content = $('.gallery-howto-detail .edit-box .edit-area textarea').val();
				if(content){
					var queryJson = {
						imgId: commentJson.pageId, 
			        	activityName: commentJson.activityName, 
			        	imgCountries: commentJson.imgCountries,
			        	pcImgSrc: currPage,
			        	commentContent: content
					}
					if(commentJson.isReply == '0'){
						queryJson.isReply = commentJson.isReply;
						queryJson.replyCldId = commentJson.replyCldId;
						queryJson.replyNickNameAct = commentJson.replyNickNameAct;
					}
					addComment(queryJson);
				}else{
					$('.gallery-howto-detail .noinp-alert').show();
				}
			})
			
			// Close No Input Alert
			$('.gallery-howto-detail .noinp-alert .btn-confirm').click(function(){
				$('.gallery-howto-detail .noinp-alert').hide();
			})
			
			// Mobile End Show Comment List
			var pageW = utils.pageWidth();
			if(pageW < 768){
				$('.gallery-howto-detail .lists-box .comment-lists').scroll(function(){
					var divH = $(this).height();
					var scrollH = $(this)[0].scrollHeight;
					var scrollTop = $(this)[0].scrollTop;
					if(scrollTop + divH >= scrollH){
						commentJson.pageIndex++;
						if(commentJson.pageIndex >= commentJson.totalPage){
							commentJson.pageIndex = commentJson.totalPage;
						}else{
							getComments('mobile');
						}
					}
				})
			}
			
			/* Add Comment
			 * @param queryJson:请求json 
			 */
			function addComment(queryJson){
				$.ajax({
					 type: "post",
			         url: galleryPublicData.apiUrl + '/abroad/shootMatch/addAEMComment',
			         dataType: "json",
			         xhrFields: {withCredentials: true},
			         data: queryJson,
			         success: function(data) {
			        	 if(data && data.success){
			        		 // clear comment textarea
			        		 $('.gallery-howto-detail .edit-box .edit-area textarea').val('');
			        		 getComments();
			        	 }
			         }
				})
			}
			
			/* Get Comment Lists
			 * @param type 终端类型，默认值：pc，  mobile：移动端
			*/
			function getComments(type){
				type = type || 'pc';
				$.ajax({
					type: "get",
					url: galleryPublicData.apiUrl + '/abroad/shootMatch/queryAEMImgComment',
					dataType: "jsonp",
					data: { 
						imgId: commentJson.pageId, 
						activityName: commentJson.activityName, 
						pageIndex: commentJson.pageIndex, 
						pageSize: commentJson.pageSize
					},
					success: function(data) {
						var total = data.infoBean.total || 0;
						commentJson.totalPage = data.infoBean.totalPage || 0;
						
						if(data && total>0){
							$('.gallery-howto-detail .nodata-tips').hide();
							$('.gallery-howto-detail .lists-box').show();
							
							var listHtml = '';
							var lists = data.infoBean.pageList;
							if(lists){
								listHtml = getListsHtml(lists);
							}
							
							if(type=='pc'){
								$('.gallery-howto-detail .lists-box .comment-lists').empty().html(listHtml);

								// Rendering Pagination
								if(total > commentJson.pageSize){
									var pageStr='';
									for(var i=0;i<commentJson.totalPage;i++){
										if(commentJson.pageIndex==i){
											pageStr += '<li data-index="'+i+'" class="active">'+(i+1)+'</li>'
										}else{
											pageStr += '<li data-index="'+i+'">'+(i+1)+'</li>'
										}
									}
									$('.gallery-howto-detail .lists-box .comment-pagination').empty().html(pageStr);
									
									// Change Page
									$('.gallery-howto-detail .lists-box .comment-pagination li').click(function(){
										$(this).addClass('active').siblings().removeClass('active');
										commentJson.pageIndex = $(this).data('index');
										getComments();
									})
									
								}
							}else if(type=='mobile'){
								$('.gallery-howto-detail .lists-box .comment-lists').append(listHtml);
							}
							
							// Delete Comment
							$('.gallery-howto-detail .item-operate .icon-del').click(function(){
								commentJson.delId = $(this).parent().data('id');
								$('.gallery-howto-detail .delete-alert').show();
							})
							
							// Reply 
							$('.gallery-howto-detail .item-operate .icon-comment').click(function(){
								var nickname=$(this).parent().data('nickname');
								$('.gallery-howto-detail .edit-box .edit-area textarea').val('@'+nickname+' ');
								commentJson.isReply = 0;
								commentJson.replyCldId = $(this).parent().data('cldid');
								commentJson.replyNickNameAct = nickname;
							})
							
						}else{
							$('.gallery-howto-detail .nodata-tips').show();
							$('.gallery-howto-detail .lists-box').hide();
						}
					}
				})
			}
			
			// Get Lists HTML code
			function getListsHtml(lists){
				var str ='';
				for(var i=0;i<lists.length;i++){
					var cldId = lists[i].cldId;
					var calDel = lists[i].calDel;
					str+='<li>';
						str+='<img class="item-avator li-item" src="'+lists[i].headPictureURL+'" alt="'+lists[i].nickName+'" />';
						str+='<div class="item-desc li-item">';
							str+='<p class="item-author">'+lists[i].nickName+'</p>';
							str+='<p class="item-content">'+lists[i].commentContent+'</p>';
						str+='</div>';
						str+='<div class="item-status li-item">';
							var time = lists[i].commentTime;
							if(time.indexOf('.0')!=-1){
								time = time.replace('.0','');
							}
							str+='<p class="item-time">'+time+'</p>';
							// Logined
							if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
								str+='<div class="item-operate" data-cldid="'+cldId+'" data-nickname="'+lists[i].nickName+'" data-id="'+lists[i].commentId+'">';
									if(cldId && cldId==commentJson.currUserId && calDel && calDel=='0'){
										str+='<span class="font font-Delete icon-del"></span>';
									}else if(cldId && cldId != commentJson.currUserId){
										str+='<span class="honorFont-comment icon-comment"></span>';
									}
								str+='</div>';
							}
						str+='</div>';
					str+='</li>';
				}
				return str;
			}
			
			// Delete Comment
			function deleteComment(){
				$.ajax({
					 type: "post",
			         url: galleryPublicData.apiUrl + '/abroad/shootMatch/delAEMComment',
			         dataType: "json",
			         xhrFields: {withCredentials: true},
			         data: { 
			        	 imgId: commentJson.pageId, 
			        	 activityName: commentJson.activityName, 
			        	 commentId:commentJson.delId
		        	 },
			         success: function(data) {
			        	 if(data && data.success){
			        		 getComments();
			        	 }
			         }
				})
			}
		}
	}) 
	
}());

(function(){
	//GA CODE START
	$(".follow-us ul li a").click(function(){
		var socialNetwork=$(this).children("img").attr("alt");
		window.dataLayer.push({
			"event": "socialView",
			"socialNetwork": socialNetwork
		})
	})
	//GA CODE END
}());
/**
 * Gallery Collection Lists
 */ 
(function(){
	$(function(){ 
		if($('.gallery-collection-lists').length>0){
			var isArabic=$("div").hasClass("__arabic__");
			var windowW = utils.windowWidth();
			$('.gallery-footer').hide();
			// 排序方式，默认latest
			var proType=$(".honor-menu .honor-items li.active").data('value');;
			// 加载更多
			var loadMore = true;
			// 首次请求
			var firstReq = true;
			
			var dataJson = { 
				pageIndex: 0,
				pageSize: 6, 
				divices:proType,
				lang:window.digitalData.page.category.primaryCategory,
				country:'gallery',
				activityName:'global_all_gallery'
			}
			
			// 查询图片类型
			getImgProList();
			
			//滚动监听 
			$(window).scroll(function() {
				var scrollTop = $(document).scrollTop();
				var $lists = $('.gallery-collection-lists .photos-lists');
				var listsTop = $lists.position().top;
				var listsH = $lists.height();
				
				var windowH = utils.windowHeight();
				var flag = (windowH+scrollTop)>(listsTop+listsH);
				if(loadMore && flag && !firstReq){ 
					loadMore = false;
					getPhotosLists();
				}
				
			}); 
			
			 
			//获取摄影栏目图片列表
			function getPhotosLists(){
				if(windowW>768){
					galleryWaterfall('.gallery-collection-lists .photos-lists', '.gallery-collection-lists .photos-lists .photos-item');
				}
				// 默认，按审核时间倒序
				var webServer = $('#webServer').val() || 'sg';
				var endApiUrl = galleryPublicData.apiUrl.replace('sg',webServer);
				var url = endApiUrl+'/abroad/shootMatch/listImgInfoByPopularStyle';
				
				// 当前页码加一
				dataJson.pageIndex++;
				
				$.ajax({
					url : url,
					type : 'GET',
					data : dataJson,
					async : false,
					dataType : 'jsonp', 
					success : function(info) {
						if(info.success){
							firstReq = false;
							
							var currPath = location.href;
							var prePath = currPath.split('/gallery/')[0];
							var endPath ='';
							if(currPath.indexOf('.html')!=-1){
								//预览环境
								endPath +='.html';
								endPath += currPath.split('.html')[1];
							}else{
								//发布环境
								endPath ='/';
							} 

							var str='';
							var data = info.infoBean.pageList;
							
							//判断第一页数据是否展示了所有数据
							if(dataJson.pageIndex==1 && info.infoBean.total==data.length){
								loadMore = false;
								$('.gallery-footer').show();
							}else{
								loadMore = true;
							} 
							
							if(data.length==0){
								loadMore = false;
								$('.gallery-footer').show();
								return;
							}else{  
								for(var i=0;i<data.length;i++){
									var itemPath = '';
									//图片是否在gallery栏目下上传的（0：是，1：否）
									if(data.isGallery=='0'){
										// Gallery活动
										itemPath = prePath+data[i].htmlPath+endPath;	
									}else{
										// 非Gallery活动
										itemPath = data[i].htmlPath;
										//文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
										if(data[i].fileType && data[i].fileType=='0'){
											// 视频
											if(itemPath && itemPath.indexOf('/photo.')!=-1){
												//有返回链接，需要做转换，因后端存在垃圾数据，这里再次做转换处理
												itemPath = itemPath.replace('/photo.','/video.');
											}
											
											if(!itemPath){
												// 没有返回链接，需拼接
												var lang = window.digitalData.page.category.primaryCategory;
												var id = data[i].imgId;
												itemPath = prePath + '/gallery/'+ lang + '/video.'+ id + endPath;
											}
										}
										
										if(!data[i].fileType || data[i].fileType=='1'){
											// 图片详情路径链接优化
											if(itemPath && itemPath.indexOf('.html')!=-1){
												itemPath = data[i].htmlPath;
											}else{
												itemPath = prePath+data[i].htmlPath+endPath;
											}
											
										}
									}
									str+='<div class="photos-item">';
										str+='<a href="'+itemPath+'">';
											var loadingClass=" honor-loading";
											if(galleryPublicData.windowW<768){
												loadingClass=" honor-loading honor-loading-xs";
											}
											str+='<div class="img-box">';
												str+='<img class="item-img'+loadingClass+'" src="'+data[i].imgSrc+'" alt="" />';
												// 文件类型（上传视频功能时需要，null:图片,0:视频,1:图片,2:文字）
												if(data[i].fileType && data[i].fileType=='0'){
													str+='<img class="icon-video" src="/etc/designs/honor-site/assets/icons/play-arrow.png">';
												}
											str+='</div>';
											str+='<div class="item-info">';
												str+='<div class="img">';
													str+='<img src='+data[i].userHeadUrl+' alt='+data[i].nickNameAct+' title='+data[i].nickNameAct+' />';
												str+='</div>';
												str+='<div class="text">';
													str+='<p class="info-title">'+data[i].imgThemes+'</p>'; 
													str+='<p class="info-author">'+data[i].nickNameAct+'</p>';
												str+='</div>';
											str+='</div>';
										str+='</a>';
									str+='</div>';
								}
								$('.gallery-collection-lists .photos-lists').append(str);	
								$('.gallery-collection-lists .photos-lists .item-img').imagesLoaded()
								.progress(function(instance,image){
									// 当前图片加载完成后，去除loading效果
									if(image.isLoaded){
										$(image.img).removeClass('honor-loading');
									}
									if(windowW>768){
										galleryWaterfall('.gallery-collection-lists .photos-lists', '.gallery-collection-lists .photos-lists .photos-item');
									}
								})
								.done(function(){
									if(windowW>768){
										galleryWaterfall('.gallery-collection-lists .photos-lists', '.gallery-collection-lists .photos-lists .photos-item');
									}
								})
								
								
							} 
							
						}
					},
					error : function(err) {
						console.log(err);
					}
				}) 
			} 

			// 定位到图片列表
			function toLists(){
				var boxTop = $('.gallery-collection-lists').position().top;
				var endTop = Math.floor(boxTop) -90;
				$('body,html').animate({
					scrollTop: endTop
				}, 800);
			}
			//获取collection列表
			function getImgProList(){ 
				$.ajax({
					url : galleryPublicData.apiUrl+'/abroad/shootMatch/getApprovedImgDivicesList',
					type : 'GET',
					async : false,
					data:{
						"activityName":"global_all_gallery"
					},
					dataType : 'json',
					success : function(info) { 
						if(info.success){
							var str='';
							var data = info.infoBean;
							//页面传参 type：设备类型
							var type = utils.getRequest().type;
							for(var i=0;i<data.length;i++){
								if(type){
									// 有URL传参
									dataJson.divices = type;
									if(type==data[i].value){
										str+='<li class="active" data-value="'+data[i].value+'"><span>'+data[i].node+'</span></li>';
									}else{
										str+='<li data-value="'+data[i].value+'"><span>'+data[i].node+'</span></li>';
									}
								}else{
									// 无URL传参
									if(i==0){
										// 第一个分类
										dataJson.divices=data[i].value;
										str+='<li class="active" data-value="'+data[i].value+'"><span>'+data[i].node+'</span></li>';
									}else{
										str+='<li data-value="'+data[i].value+'"><span>'+data[i].node+'</span></li>';
									} 
								}
								
								
							}
							$('.gallery-collection-lists .honor-items').html(str);

							// 查询latest图片列表
							getPhotosLists(proType);
							
							$('.gallery-collection-lists .honor-items li').click(function(){
								$(this).addClass('active').siblings().removeClass('active');;
								var divices = $(this).data('value');
								divices=divices.replace(/\s*/g,"");
								/* GA Start*/
								var uri=window.digitalData.page.pageInfo.uri;
								window.dataLayer.push({"event":"virtualPageview","page":uri+divices});
								/* GA End */
								
								// 定位到图片列表
								toLists();
								
								$('.gallery-collection-lists .photos-lists').empty();
								var divices = $(this).data('value');
								dataJson.pageIndex = 0;
								dataJson.divices= divices;
								$('.gallery-footer').hide();
								getPhotosLists(proType);
							})
						}
					},
					error : function(err) {
						console.log(err);
					}
				})
			}
			
		}
	}) 
	
}());

(function (a) {
    a.fn.addSelector = function (c) {
        var d = a(this);
        var b = {
            tabView: undefined,
            tabClass: "current",
            tabChangeTitle: true
        };
        var f = function () {
            return b.tabView == "both" || (b.tabView && b.tabView.indexOf(viewType()) > -1)
        };
        a.extend(b, c);
        d.find(".select").on("click", function (k) {
            if (f()) {
                return
            }
            var l = a(this),
                h = l.find("ol"),
                j = l.siblings(".select");
            if (l.hasClass("disable")) {
                return
            }
            if (h.data("slide") == "open") {
                h.slideUp(250, function () {
                    h.data("slide", "close")
                });
                l.find("span").removeClass("active")
            } else {
                h.slideDown(250, function () {
                    h.data("slide", "open")
                });
                l.find("span").addClass("active")
            }
            j.find("ol").slideUp(250, function () {
                a(this).data("slide", "close")
            });
            j.find("span").removeClass("active");
            if (l.parents(".add-contact-info").length > 0) {
                var g = l.parents(".s-selector").siblings(".s-selector");
                g.find("ol").slideUp(250, function () {
                    a(this).data("slide", "close")
                });
                g.find("span").removeClass("active")
            }
            k.stopPropagation()
        });
        d.find(".select ol li").off("click.compareItem").on("click.compareItem", function (l) {
            var g = a(this),
                j = g.parents(".select").eq(0).find("span"),
                h = g.text(),
                k = j.text();
            if (f()) {
                g.addClass(b.tabClass).siblings("li").removeClass(b.tabClass)
            } else {
                g.addClass(b.tabClass).siblings("li").removeClass(b.tabClass);
                g.parents(".select").eq(0).find("ol").slideUp(250, function () {
                    a(this).data("slide", "close")
                })
            }
            j.removeClass("active");
            b.tabChangeTitle && j.text(h);
            d.trigger("selected", {
                val: h,
                _mark: g.parents("ol").eq(0).attr("_mark")
            });
            setTimeout(function () {
                a(".conv3_search_wrap .result_news_pc .list li strong").each(function () {
                    var n = a(this).find("a");
                    if (n.height() > 45) {
                        a(this).addClass("ellipsis")
                    }
                });
                a(".conv3_search_wrap .result_news_pc .list li p").each(function () {
                    var n = a(this).find("span.content");
                    if (n.height() > 65) {
                        a(this).addClass("ellipsis")
                    }
                })
            }, 500);
            l.stopPropagation()
        });
        a("body").on("click", function () {
            if (f()) {
                return
            }
            var g = d.find(".select");
            g.find("ol").slideUp(250, function () {
                a(this).data("slide", "close")
            });
            g.find("span").removeClass("active")
        });
        if (f()) {
            a(window).on("resize", function () {
                if (f()) {
                    d.find(".select ol").show()
                } else {
                    d.find(".select ol").hide()
                }
            })
        }
        return d
    }
})(jQuery);

(function () {
    $(".conv3_hotline_area").each(function (b) {
    	console.log($(this).text())
        $(".select_hotlinearea_btn ol").append($("<li></li>").text($(this).text()))
    });
    var a = $(".conv3_hotline_content .conv3_global_selector, .product_kv .conv3_global_selector, .search_module .conv3_global_selector");
    if (a.get(0) && typeof (a.addSelector) == "function") {
        a.addSelector().on("selected", function (b, c) {
            $(".conv3_hotline_country_list").hide();
            $(".conv3_hotline_country_list").each(function () {
                if (c.val == $(this).data("area")) {
                    $(this).show()
                }
            })
        })
    }
    $(".conv3_hotline_country").on("click", function () {
        var b = $(window).width() || window.innerWidth;
        if (b < 768) {
            $(".conv3_hotline_country_list .col-md-9").slideUp();
            $(".conv3_hotline_country.active").removeClass("active");
            $(this).parent().next(".col-md-9").toggle()
        }
        $(this).parent().parent().find(".col-md-9").is(":visible") ? $(this).addClass("active") : $(this).removeClass("active")
    });
    $(window).on("resize", function () {
        $(window).width() > 767 && $(".conv3_hotline_country_list .col-md-9").show()
    })
})();

/*!
 *	Themes Work Detail Info Component By Bruce
 * 	v1.0.0 (2020-01-09 19:41)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
    $(function(){
        if($('.themes-work-detail-info').length>0){
        	var pageName = $('.themes-work-detail-info .rg-info').data('title');
        	var workTitle = '',workDesc='';
        	var imgId = utils.getAEMUrlId(pageName);
        	if(!imgId){
        		return;
        	}
        	$.ajax({
				 type: "get",
		         url: themesBaseData.apiUrl + '/abroad/wallpaper/getWapperImgInfoById',
		         dataType: "json",
		         data: { 
		        	 imgId:imgId , 
	        	 },
		         success: function(data) {
		        	 if(data && data.success){
		        		 var info = data.infoBean;
		        		 workTitle = info.title || '';
		        		 workDesc = info.workDescription || '';
		        		 var dowImgSrc;
		        		 var dowPressImgSrc;
		        		 if(info.dowImgSrc) {
		        			 dowImgSrc = info.dowImgSrc;
		        		 } else {
		        			 dowImgSrc = "";
		        		 }
		        		 if(info.dowPressImgSrc) {
		        			 dowPressImgSrc = info.dowPressImgSrc;
		        		 } else {
		        			 dowPressImgSrc = "";
		        		 }
		        		 var downLoadImgUrl;
		        		 if(window.navigator.msSaveOrOpenBlob) {
		        			 downLoadImgUrl = info.dowPressImgSrc;
		        		 } else {
		        			 downLoadImgUrl = info.dowBase64imgPath;
		        		 }
		        		 $('.themes-work-detail-info .title').text(info.title);
		        		 $('.themes-work-detail-info .btn-download').attr({
		        			 'download':info.title + ".png",
		        			 'data-url':downLoadImgUrl
		        		 })
		        		 
		        		 $('.themes-work-detail-info .content').text(info.workDescription);
		        		 $('.themes-work-detail-info .lf-img img').attr({
		        			 'src':dowPressImgSrc,
		        			 'title':info.title,
		        			 'alt':info.title
		        		 })
		        		 $('.themes-work-detail-info .deginer .item-content').text(info.nickNameAct);
		        		 $('.themes-work-detail-info .bio .item-content').text(info.authorIntroduction);

		        		 // Avator
		        		 var avatar = info.upHeadUrl || '';
		        		 var avatarAlt = info.authorName || 'author';
		        		 if (!avatar) {
		        			 avatar = "/etc/designs/honor-site/assets/gallery/pic01.jpg";
		        		 }
		        		 $('.themes-work-detail-info .avatar').attr({
		        			 'src':avatar,
		        			 'alt':avatarAlt
	        			 });
		        	 }
		         }
			})
        	
            
            // Download
			$('.themes-work-detail-info .btn-download').click(function(){
				honorData.loginName = decodeURI(utils.getCookie('loginUid'));
				var that = $(this);
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					// 已登录，展示下载链接
					var downloadUrl = that.attr('data-url') || '';
					var downloadName = that.attr('data-download');
					if(!downloadUrl){
						return;
					}
					that.attr('href',downloadUrl);
					// 统计下载数
					$.ajax({
						 type: "post",
				         url: themesBaseData.apiUrl + '/abroad/wallpaper/updateWallpaperdownloadTimes',
				         dataType: "json",
				         xhrFields: {withCredentials: true},
				         data: { 
				        	 imgId: imgId
			        	 },
				         success: function(data) {
				        	 if(data.code=='200'){
				        		 // 统计成功
				        	 }
				         }
					})
					
					//GA CODE
					var wallpapersName=$(".themes-work-detail-info .work-info .title").text();
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Wallpapers Detail Page",
						"eventAction": wallpapersName,
						"eventLabel": "Download"
					})
				}else{
					// 未登录
					themesAlert.show();
				}
			})
            
            var currPageUrl = window.location.href;
            var hashtag = encodeURIComponent($('.themes-work-detail-info .rg-info').data('tagforshare') || '');
            
            //分享到 facebook
            $(".themes-work-detail-info .fa-facebook").click(function() {
              window.open ("https://www.facebook.com/sharer.php?u="+encodeURIComponent(currPageUrl)+"&hashtag=‪%23"+hashtag+"", "newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
              
              //GA CODE
              var wallpapersName=$(".themes-work-detail-info .work-info .title").text();
              window.dataLayer.push({
            	  "event": "uaEvent",
            	  "eventCategory": "Wallpapers Detail Page",
            	  "eventAction": wallpapersName,
            	  "eventLabel": "Share+facebook"
              })
            });
            //分享到twitter
            $(".themes-work-detail-info .fa-twitter").click(function() {
             window.open('https://twitter.com/intent/tweet?hashtags='+hashtag+' &amp;text=' + encodeURIComponent(workTitle) +' '+ encodeURIComponent(workDesc) +' '+ encodeURIComponent(currPageUrl) +' &amp;url=' + encodeURIComponent(currPageUrl) + '" data-url="' + encodeURIComponent(currPageUrl) + '"',"newwindow", "height=320, width=400, top=100, left=800, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
             
             //GA CODE
             var wallpapersName=$(".themes-work-detail-info .work-info .title").text();
             window.dataLayer.push({
           	  "event": "uaEvent",
           	  "eventCategory": "Wallpapers Detail Page",
           	  "eventAction": wallpapersName,
           	  "eventLabel": "Share+twitter"
             })
            });
        }
    });
}());

/*!
 *	Themes Work Comment Component By Bruce
 * 	v1.0.0 (2020-01-09 19:41)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
    $(function(){
        if($('.themes-work-comment').length>0){
        	var pageName = $('.themes-work-comment .comment-box').data('title');
        	var pageSize = $('.themes-work-comment .comment-box').data('pagesize') || 4;
        	var imgId = utils.getAEMUrlId(pageName);
        	if(!imgId){
        		return;
        	}
			var commentJson = {
				currUserId: decodeURI(utils.getCookie('loginUid')) || '',
				pageId: imgId,
				activityName: 'wallpaper_design_contest',
				imgCountries: themesBaseData.lang,
				pageIndex:1,	// 当前页码
				pageSize:pageSize,	// 每页个数
				delId:'', 		// 删除评论的ID
				totalPage:0, 	// 分页个数
				isReply: 1,		// 是否回复评论 0：是；1：否
				replyCldId:'',	// 被回复用户的账号ID
				replyNickNameAct:'' // 被回复用户的昵称
			}
			
			// Get Comments
			getComments();
			
			// Login Status
			if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
				// logined
				$('.comment-box .unlogin-tip').hide();
				$('.comment-box .edit-submit').attr('disabled',false);
			}else{
				// unlogin
				$('.comment-box .unlogin-tip').show();
				$('.comment-box .edit-submit').attr('disabled',true);
			}
			
			// Login Url
			$('.themes-work-comment .comment-box .to-login').attr('href',themesBaseData.loginUrl);
            
			// Confirm delete
			$('.themes-work-comment .delete-alert .btn-confirm').click(function(){
				$('.themes-work-comment .delete-alert').hide();
				deleteComment();
			})
			
			// Cancel delete
			$('.themes-work-comment .delete-alert .btn-cancel').click(function(){
				$('.themes-work-comment .delete-alert').hide();
				
			})
			
			// Submit comment
			$('.themes-work-comment .edit-box .edit-submit').click(function(){
				var content = $('.themes-work-comment .edit-box .edit-area textarea').val();
				if(content){
					var queryJson = {
						imgId: commentJson.pageId, 
			        	activityName: commentJson.activityName, 
			        	commentContent: content
					}
					if(commentJson.isReply == '0'){
						queryJson.isReply = commentJson.isReply;
						queryJson.replyCldId = commentJson.replyCldId;
						queryJson.replyNickNameAct = commentJson.replyNickNameAct;
					}
					addComment(queryJson);
				}else{
					$('.themes-work-comment .noinp-alert').show();
				}
			})
			
			// Close No Input Alert
			$('.themes-work-comment .noinp-alert .btn-confirm').click(function(){
				$('.themes-work-comment .noinp-alert').hide();
			})
			
			// Mobile End Show Comment List
			var pageW = utils.pageWidth();
			if(pageW < 768){
				$('.themes-work-comment .lists-box .comment-lists').scroll(function(){
					var divH = $(this).height();
					var scrollH = $(this)[0].scrollHeight;
					var scrollTop = $(this)[0].scrollTop;
					if(scrollTop + divH >= scrollH){
						commentJson.pageIndex++;
						if(commentJson.pageIndex >= commentJson.totalPage){
							commentJson.pageIndex = commentJson.totalPage;
						}else{
							getComments('show');
						}
					}
				})
			}
			
			// Load More Comments
			$('.themes-work-comment .load-more').click(function(){
				commentJson.pageIndex++;
				getComments('show');
			})
			
			/* Add Comment
			 * @param queryJson:请求json 
			 */
			function addComment(queryJson){
				$.ajax({
					 type: "post",
			         url: themesBaseData.apiUrl + '/abroad/wallpaper/addWallpaperComment',
			         dataType: "json",
			         xhrFields: {withCredentials: true},
			         data: queryJson,
			         success: function(data) {
			        	 if(data.success){
			        		//GA CODE
			        		 var wallpapersName=$(".themes-work-detail-info .work-info .title").text();
			        		 var commentContent=$('.themes-work-comment .edit-box .edit-area textarea').val();
			        		 window.dataLayer.push({
			        			 "event": "uaEvent",
			        			 "eventCategory": "Wallpapers Detail Page",
			        			 "eventAction": wallpapersName,
			        			 "eventLabel": "comment +"+commentContent
			        		 })
			        		 
			        		 // clear comment textarea
			        		 $('.themes-work-comment .edit-box .edit-area textarea').val('');
			        		 getComments('add'); 
			        	 }
			         }
				})
			}
			
			/* Get Comment Lists
			 * @param type 操作类别，默认show：分页查询；add:添加；
			*/
			function getComments(type){
				type = type || 'show';
				var currPageIndex = commentJson.pageIndex;
				var currPageSize = commentJson.pageSize;
				if(type=='add'){
					// 新增评论
					currPageIndex = 1;
					currPageSize = 1;
				}
				$.ajax({
					type: "get",
					url: themesBaseData.apiUrl + '/abroad/wallpaper/queryOneImgComment',
					dataType: "jsonp",
					data: { 
						imgId: commentJson.pageId, 
						activityName: commentJson.activityName, 
						pageIndex: currPageIndex, 
						pageSize: currPageSize
					},
					success: function(data) {
						var total = data.infoBean.total || 0;
						commentJson.totalPage = data.infoBean.totalPage || 0;
						
						if(data && total>0){
							$('.themes-work-comment .nodata-tips').hide();
							$('.themes-work-comment .lists-box').show();
							
							var listHtml = '';
							var lists = data.infoBean.pageList;
							if(lists.length>0){
								listHtml = getListsHtml(lists);
								if(type=='show'){
									$('.themes-work-comment .lists-box .comment-lists').append(listHtml);
									if(total>pageSize){
										//当总评论数大于每页个数时，才显示loadmore
										$('.themes-work-comment .load-more').css('display','flex');
									}
								}else if(type=="add"){
									$('.themes-work-comment .lists-box .comment-lists').prepend(listHtml);
								}
							}else{
								$('.themes-work-comment .load-more').hide();
							}
							
							// Delete Comment
							$('.themes-work-comment .item-operate .icon-del').click(function(){
								commentJson.delId = $(this).parent().data('id');
								$('.themes-work-comment .delete-alert').show();
							})
							
							// Reply 
							$('.themes-work-comment .item-operate .icon-comment').click(function(){
								var nickname=$(this).parent().data('nickname');
								$('.themes-work-comment .edit-box .edit-area textarea').val('@'+nickname+' ');
								commentJson.isReply = 0;
								commentJson.replyCldId = $(this).parent().data('cldid');
								commentJson.replyNickNameAct = nickname;
								
								// 页面滚动到评论区，并进行评论
								var boxTop = $('.themes-work-comment .comment-box').position().top-70;
								$('body,html').animate({
							        scrollTop: boxTop
							    }, 800);
								$('.themes-work-comment .comment-box textarea').focus()
							})
							
						}else{
							$('.themes-work-comment .nodata-tips').show();
							$('.themes-work-comment .lists-box,.themes-work-comment .load-more').hide();
						}
					}
				})
			}
			
			// Get Lists HTML code
			function getListsHtml(lists){
				var str ='';
				for(var i=0;i<lists.length;i++){
					var cldId = lists[i].cldId;
					var calDel = lists[i].calDel;
					var time = lists[i].commentTime;
					if(time.indexOf('.0')!=-1){
						time = time.replace('.0','');
					}
					str+='<li id="comment'+lists[i].commentId+'" data-id="'+lists[i].commentId+'">';
						str+='<p class="app-item-time li-item">'+time+'</p>';
						str+='<div class="item-desc li-item">';
							str+='<p class="item-author">'+lists[i].nickNameAct+'</p>';
							str+='<p class="item-content">'+lists[i].commentContent+'</p>';
						str+='</div>';
						str+='<div class="item-status li-item">';
							str+='<p class="item-time">'+time+'</p>';
							// Logined
							if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
								str+='<div class="item-operate" data-cldid="'+cldId+'" data-nickname="'+lists[i].nickNameAct+'" data-id="'+lists[i].commentId+'">';
									if(cldId && cldId==commentJson.currUserId && calDel && calDel=='0'){
										str+='<span class="font font-Delete icon-del"></span>';
									}else if(cldId && cldId != commentJson.currUserId){
										str+='<span class="honorFont-comment icon-comment"></span>';
									}
								str+='</div>';
							}
						str+='</div>';
					str+='</li>';
				}
				return str;
			}
			
			// Delete Comment`
			function deleteComment(obj){
				$.ajax({
					 type: "post",
			         url: themesBaseData.apiUrl + '/abroad/wallpaper/delWallpaperComment',
			         dataType: "json",
			         xhrFields: {withCredentials: true},
			         data: { 
			        	 imgId: commentJson.pageId, 
			        	 activityName: commentJson.activityName, 
			        	 commentId:commentJson.delId
		        	 },
			         success: function(data) {
			        	 if(data.success){
			        		 $('#comment'+commentJson.delId).remove();
			        	 }
			         }
				})
			}
        }
    });
}());

/*!
 *	Themes Other Works By Bruce
 * 	v1.0.0 (2020-01-09 19:41)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
    $(function(){
        if($('.themes-other-works').length>0){
        	var pageName = $('.themes-other-works .component-lists').data('title');
        	var imgId = utils.getAEMUrlId(pageName);
        	if(!imgId){
        		return;
        	}
        	var userId = ''; //设计师ID
        	// Pagination Data
			var pageData={
				pageIndex:0,	// 页码
				pageSize: 6,	// 每页个数
				totalPage:0		// 分页个数
			}
        	
        	// 获取图片用户ID
        	getImgUserID();
        	function getImgUserID(){
        		$.ajax({
        			type: "get",
	   		        url: themesBaseData.apiUrl + '/abroad/wallpaper/getWapperImgInfoById',
	   		        dataType: "json",
	   		        data: { 
	   		        	imgId:imgId 
	   	        	},
	   		        success: function(data) {
	   		        	if(data && data.success){
	   		        		userId = data.infoBean.userId;
	   		        		$(".component-lists").attr("data-type", data.infoBean.category);
	   		        		getOtherWorks(userId);
	   		        	}
		        	}
        		})
        	}
        	/*
        	 * 获取当前作者同类的其他作品
        	 * @param userId:当前设计师ID
        	 * @param endType:终端类型  默认值：pc，  mobile：移动端
        	 */
        	function getOtherWorks(userId,endType){
        		endType = endType || 'pc';
        		var category = $(".component-lists").attr("data-type");
        		var data;
        		if(category) {
        			data = {
    					imgId: imgId, 
						userId: userId, 
						activityName: 'wallpaper_design_contest', 
						category: 1,
						pageIndex: pageData.pageIndex,  
						pageSize: pageData.pageSize
        			}
        		} else {
        			data = {
    					imgId: imgId, 
						userId: userId, 
						activityName: 'wallpaper_design_contest', 
						pageIndex: pageData.pageIndex,
						pageSize: pageData.pageSize
        			}
        		}
	        	$.ajax({
					type: "get",
					url: themesBaseData.apiUrl + '/abroad/wallpaper/listWallpaperDesignImageInfo',
					dataType: "jsonp",
					data: data,
					success: function(data) {
						var total = data.infoBean.total || 0;
						pageData.totalPage = data.infoBean.totalPage || 0;
						if(data && total>0){
							var info = data.infoBean.pageList;
							showWorkLists(info,endType,total);
						}
					}
	        	})
        	}
        	/*
        	 * 渲染作品列表
        	 * @param info:作品列表数据
        	 * @param endType:终端类型  默认值：pc，  mobile：移动端
        	 * @param total:作品数据总数
        	 */
        	function showWorkLists(info,endType,total){
        		var str ='';
        		var $lists = $('.themes-other-works .component-lists');
        		var like = $lists.data('like'),
        		designBy = $lists.data('designby'),
        		downloads = $lists.data('downloads');
        		for(var i=0;i<info.length;i++){
	        		str+='<div class="work-item">';
	        			var currId= info[i].id;
	        			var currPage = window.location.href;
	        			var detailUrl = currPage.split(imgId)[0]+currId+currPage.split(imgId)[1];
        				var loveClass = info[i].isPraised=='1' ? 'fa-heart-o love' : 'fa-heart love loved';
    					str+='<div class="item-bg"></div>';
						str+='<div class="work-box">';
							str+='<a class="work-box-img" href="'+detailUrl+'">';
								str+='<img class="lazy work-img" data-original="'+info[i].imgSrc+'" alt="'+info[i].title+'" title="'+info[i].title+'" />';
								str+='<div class="work-info">';
									str+='<div class="info-lf info-item">';
										str+='<p class="work-title" title="'+info[i].title+'">'+info[i].title+'</p>';
										str+='<p class="work-author">';
											str+='<span class="author-txt">'+designBy+':</span>';
											str+='<span class="author-name" title="'+info[i].nickNameAct+'">'+info[i].nickNameAct+'</span>';
										str+='</p>';
									str+='</div>';
									str+='<div class="info-rg info-item">';
										str+='<div class="rg-item data-like">';
											str+='<span class="data-icon icon-love fa ' + loveClass + '" data-id="'+currId+'"></span>';
											str+='<div class="data-box">';
												str+='<p class="like-num" id="likeNum'+currId+'">'+info[i].liked+'</p>';
												str+='<p class="like-txt">'+like+'</p>';
											str+='</div>';
										str+='</div>';
										str+='<div class="rg-item data-download">';
											str+='<span class="data-icon icon-download honorFont-download"></span>';
											str+='<div class="data-box">';
												str+='<p class="download-num">'+info[i].downloadTimes+'</p>';
												str+='<p class="download-txt">'+downloads+'</p>';
											str+='</div>';
										str+='</div>';
									str+='</div>';
								str+='</div>';
							str+='</a>';
						str+='</div>';
					str+='</div>';
        		}

        		if(endType=='pc'){
        			$('.themes-other-works .component-lists').empty().html(str);
        			// Rendering Pagination
					if(total > pageData.pageSize){
						renderingPagination();
					}
				}else if(endType=='mobile'){
					$('.themes-other-works .component-lists').append(str);
					if(total > pageData.pageSize){
						$('.themes-other-works .load-more').show();
					}
				}
        		// 按照设计稿 图片长宽比适配各分辨率
        		$('.themes-other-works .component-lists .work-item').each(function(){
        			var currW = $(this).width();
        			var workInfoHeight = $(this).find(".work-info").height();
        			var currH = 460;
        			currH = workInfoHeight - 3 + currW/1.99;
        			$(this).css({
        				'height':currH,
        				'min-height':'auto'
					});
        		})
				$(".themes-other-works .lazy").lazyload({
				      "placeholder":lazyload.placeholder
				}); 
				
				// 点赞/取消点赞 先判断是否登录
				$('.themes-other-works .work-item .love').click(function(){
					var that = $(this);
					honorData.loginName = decodeURI(utils.getCookie('loginUid'));
					var that = $(this);
					if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
						// 已登录
						var workId = that.data('id');
						// 设置点赞  type:类型   set：点赞，cancel：取消点赞
						var type = that.hasClass('loved') ? 'cancel' : 'set';
						setLoved(type,workId,that);
					}else{
						// 未登录
						themesAlert.show();
					}
					return false;
				})
        	}
        	
        	// 渲染分页数据
        	function renderingPagination(){
        		var pageStr='';
				for(var i=0;i<pageData.totalPage;i++){
					if(pageData.pageIndex==i){
						pageStr += '<li data-index="'+i+'" class="active"><span>'+(i+1)+'</span></li>'
					}else{
						pageStr += '<li data-index="'+i+'"><span>'+(i+1)+'</span></li>'
					}
				}
				$('.themes-other-works .works-pagination').show();
				$('.themes-other-works .works-pagination .works-page').empty().html(pageStr);

				var $prev = $('.themes-other-works .prev-page');
				var $next = $('.themes-other-works .next-page');
				if(pageData.pageIndex == 0){
					$prev.addClass('disabled');	
					$next.removeClass('disabled');	
				}else if(pageData.pageIndex == (pageData.totalPage-1)){
					$prev.removeClass('disabled');	
					$next.addClass('disabled');
				}else{
					$prev.removeClass('disabled');
					$next.removeClass('disabled');
				}
				
				// Change Page
				$('.themes-other-works .works-pagination li').click(function(){
					$(this).addClass('active').siblings().removeClass('active');
					pageData.pageIndex = $(this).data('index');
					getOtherWorks(userId);
				})
				
				// Prev Page
				$prev.unbind().click(function(){
					if($prev.hasClass('disabled')){
						return;
					}
					if(Number(pageData.pageIndex) >= 1){
						--pageData.pageIndex;
					}else{
						pageData.pageIndex = 1;
					}
					getOtherWorks(userId);
				})
				
				// Next Page
				$next.unbind().click(function(){
					if($next.hasClass('disabled')){
						return;
					}
					if(pageData.pageIndex < pageData.totalPage){
						++pageData.pageIndex;
					}else{
						pageData.pageIndex = pageData.totalPage;
					}
					getOtherWorks(userId);
				})
				// Mobile View More 
				$('.themes-other-works .load-more').click(function(){
					if(pageData.pageIndex < (pageData.totalPage-1)){
						++pageData.pageIndex;
						getOtherWorks(userId,'mobile');
					}else{
						pageData.pageIndex = pageData.totalPage-1;
						$(this).hide();
					}
				})
        	}
        	
        	
        	/*
        	 * 点赞/取消点赞
        	 * @param type:类型   set：点赞，cancel：取消点赞
        	 * @param workId:作品ID
        	 * @param obj:当前对象
        	 */
        	function setLoved(type,workId,obj){
        		var apiName = (type=="set")? 'addWallpaperPraise':'delWallpaperPraise';
        		$.ajax({
					type: "post",
					url: themesBaseData.apiUrl + '/abroad/wallpaper/'+apiName,
					dataType: "json",
					xhrFields: {withCredentials: true},
					data: { 
						imgId: workId, 
						activityName: 'wallpaper_design_contest'
					},
					success: function(data) {
						if(data.success){
							var $likeNum = $('#likeNum'+workId);
							var currNum = Number($.trim($likeNum.text()));
							if(type=='set'){
								obj.addClass('loved');
								obj.addClass('fa-heart');
								obj.removeClass('fa-heart-o');
								$likeNum.text(++currNum);
							}else{
								obj.removeClass('loved');
								obj.removeClass('fa-heart');
								obj.addClass('fa-heart-o');
								$likeNum.text(--currNum);
							}
						}
					}
				})
        	}
        	
        }
    });
}());

/*!
 *	Themes List Wallpapers Template Component By Xudongming
 * 	themes-list-wallpapers-template - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.themes-list-wallpapers-template').length>0){

		}
	})
}());
/*!
 *	Themes List Template Component By Xudongming
 * 	themes-list-template - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.themes-list-template').length>0){
			$(".themes-list-template .themeTemplate .templatesContent .content .downLoadLeft a,.themes-list-template .themeTemplate .templatesContent .content .downLoadRight a").click(function(){
				var templateName=$(this).find(".btnTitle").text() || "template";
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Categories Page+"+honorConfig.pageType,
					"eventAction": "Template",
					"eventLabel": "Download+"+templateName
				})
			})
		}
	})
}());
/*!
 *	Themes List Wallpapers Template Component By Xudongming
 * 	themes-list-wallpapers-template - v1.0.0 (2019-07-08T09:00:00+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.themes-list-all-works').length>0){

		}
	})
}());
/*!
 *	Themes Home Content Component By Bruce
 * 	v1.0.0 (2019-09-09T17:29:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
(function(){
	$(function(){
		if($('.themes-home-content').length>0){
			var $bannerImg = $('.themes-home-content .banner-img');
			var bannerImg="";
			//item-theme item-wallpaper item-app 隐藏消除margin
			var itemTheme = $(".item-purpose").find(".item-theme").length;
			var itemWallpaper = $(".item-culture").find(".item-wallpaper").length;
			var itemApp = $(".item-values").find(".item-app").length;
			if($(".add-configure-content ").length == 0) {
				$(".themes-home-content").find(".item-live").css("margin-bottom", 0);
			}
			if(utils.windowWidth()>768){
				// PC End 
				bannerImg = $bannerImg.data('pc');
				if(itemTheme > 0 && itemWallpaper == 0 && itemApp == 0) {
					$(".themes-home-content").find(".item-theme").css("margin-bottom","100px");
				}
				
				if(itemTheme > 0 && itemWallpaper == 0 && itemApp == 0 && $(".add-configure-content ").length > 0) {
					$(".themes-home-content").find(".item-theme").css("margin-bottom","200px");
				}
				
				if(itemWallpaper > 0 && itemApp == 0) {
					$(".themes-home-content").find(".item-wallpaper").css("margin-bottom","100px");
				}
				
				if(itemWallpaper > 0 && itemApp == 0 && $(".add-configure-content ").length > 0) {
					$(".themes-home-content").find(".item-wallpaper").css("margin-bottom","200px");
				}
				
				if(itemTheme == 0 && itemWallpaper == 0 && itemApp == 0) {
					$(".themes-home-content").find(".item-about").css("margin-bottom","60px");
				}
				if(itemTheme == 0 && itemWallpaper == 0 && itemApp == 0 && $(".add-configure-content ").length > 0) {
					$(".themes-home-content").find(".item-about").css("margin-bottom", "200px");
				}
				var bodyWidth = $("body").width();
				if(itemTheme == 0 && itemWallpaper == 0 && itemApp == 0 && $(".add-configure-content ").length > 0 && bodyWidth <= 1440) {
					$(".themes-home-content").find(".item-about").css("margin-bottom", 0);
				}
				if(itemTheme == 0 && itemWallpaper == 0 && itemApp == 0 && $(".add-configure-content ").length > 0 && bodyWidth <= 1024) {
					$(".themes-home-content").find(".item-about").css("margin-bottom", "-80px");
				}
				
				$(".themes-home-content").find(".item-live:last").find(".item-box").css("margin-bottom","20px");
			}else{
				bannerImg = $bannerImg.data('mb');
				if(itemTheme > 0 && itemWallpaper == 0 && itemApp == 0) {
					$(".themes-home-content").find(".item-theme").css("margin-bottom","120px");
				}
				
				if(itemWallpaper > 0 && itemApp == 0) {
					$(".themes-home-content").find(".item-wallpaper").css("margin-bottom","120px");
				}
				
				if(itemWallpaper > 0 && itemApp == 0 && $(".add-configure-content ").length > 0) {
					$(".themes-home-content").find(".item-wallpaper").css("margin-bottom","230px");
				}
				
				if(itemTheme == 0 && itemWallpaper > 0) {
					$(".themes-home-content").find(".item-about").css("margin-bottom","574px");
				}
				
				if(itemApp > 0 && $(".add-configure-content ").length > 0) {
					$(".themes-home-content").find(".item-app").css("margin-bottom","360px");
				}
				
				if(itemTheme == 0 && itemWallpaper == 0 && itemApp == 0 && $(".add-configure-content ").length > 0) {
					$(".themes-home-content").find(".item-about").css("margin-bottom","100px");
				}
				
				if(itemTheme == 0 && itemWallpaper == 0 && itemApp == 0 && $(".add-configure-content ").length > 0 && utils.windowWidth() <= 320) {
					$(".themes-home-content").find(".item-about").css("margin-bottom","60px");
				}
				
				if(itemApp > 0) {
					$(".themes-home-content").find(".item-app").css("margin-bottom","90px");
				}
				
				if(itemWallpaper > 0) {
					if(utils.windowWidth() > 414) {
						$(".item-wallpaper").find(".item-img-box").css({"width": "440px","top": "-521px"});
						if(itemTheme > 0) {
							$(".themes-home-content").find(".item-theme").css("margin-bottom","574px");
						}
					} else {
						var itemWallpaperWidth = 320*utils.windowWidth()/360;
						var itemWallpaperTop = itemWallpaperWidth/0.844;
						$(".item-wallpaper").find(".item-img-box").css({"width":itemWallpaperWidth + "px","top": "-" + itemWallpaperTop + "px"});
					}
				}
			}
			$bannerImg.attr('src',bannerImg);
			var imgLoad = imagesLoaded($bannerImg);
	        imgLoad.on('done', function(instance) {
	        	// 加载完成 
	        	$bannerImg.show();
	        })
			
			// Click Join Now Button
			$('.themes-home-content .join-now').click(function(){
				honorData.loginName = decodeURI(utils.getCookie('loginUid'));
				if (honorData.loginName!= "" && null != honorData.loginName  && honorData.loginName !="null") {
					//GA code
					window.dataLayer.push({
						"event": "uaEvent",
						"eventCategory": "Homepage",
						"eventAction": "HONOR THEMES",
						"eventLabel": "Join Now"
					})
					// 已登录		 
					var uploadPage = $(this).data('url') || '';
					window.location.href= uploadPage;
				}else{
					// 未登录
					themesAlert.show();
				}
				
				
			})
			
			//GA CODE
			$(".themes-home-content .item-article .btn-explore").click(function(){
				var featuredName=$(this).parent(".item-article").children(".item-title").text();
				window.dataLayer.push({
					"event": "uaEvent",
					"eventCategory": "Homepage",
					"eventAction": "Explore",
					"eventLabel": featuredName
				})
			})
			
		}
	})
}());
/*!
 *	Themes Home Content Component By Bruce
 * 	v1.0.0 (2019-09-09T17:29:30+0800)
 * 	Copyright 2019-2020 hihonor.com
 */
$(function(){
	if($('.themes-home-add-configuration').length>0){
		var bodyWidth = $("body").width();
		if(bodyWidth <= 768) {
			var picWidth = $(".size_360style").find(".item-img-box").width();
			var picTop = picWidth/0.84;
			$(".size_360style").find(".item-img-box").css("top", "-" + picTop + "px");
			$(".themes-home-add-configuration").find(".size_520style").each(function(){
				if($(this).index() > 0) {
					$(this).css("margin-top","334px");
				}
			})
			$(".themes-home-add-configuration").find(".size_360style").each(function(){
				if($(this).index() > 0) {
					$(this).css("margin-top","280px");
				}
			})
			
			if(bodyWidth <= 375) {
				$(".themes-home-add-configuration").find(".size_360style").each(function(){
					if($(this).index() > 0) {
						$(this).css("margin-top","240px");
					}
				})
			}
			
			if(bodyWidth <= 360) {
				$(".themes-home-add-configuration").find(".size_360style").each(function(){
					if($(this).index() > 0) {
						$(this).css("margin-top","225px");
					}
				})
			}
			
			if(bodyWidth <= 320) {
				$(".themes-home-add-configuration").find(".size_360style").each(function(){
					if($(this).index() > 0) {
						$(this).css("margin-top","205px");
					}
				})
			}
		}
		
		//GA CODE
		$(".themes-home-add-configuration .btn-explore").click(function(){
			var featuredName=$(this).parent(".item-article").children(".item-title").text();
			window.dataLayer.push({
				"event": "uaEvent",
				"eventCategory": "Homepage",
				"eventAction": "Explore",
				"eventLabel": featuredName
			})
		})
		
	}
})
var productUcgReviewConsumer = {
	$selector: $('.c05-product-ucg-review-consumer'),
	init: function () {
		if (this.$selector.length) {
			this.reviewSlider();
		}
	},
	reviewSlider: function () {
		var w = window.innerWidth ? window.innerWidth : $(window).width();

		if (w < 1024) {
			
			new Swiper('.c05-product-ucg-review-consumer .swiper-container', {
				loop: true,
				pagination: {
					el: '.c05-product-ucg-review-consumer .swiper-pagination',
					type: 'bullets',
					clickable: true,
				},
			});
		}
	}

};

$(function () {
	productUcgReviewConsumer.init();
});
var productUcgReviewPro = {
	$selector: $('.c06-product-ucg-review-pro'),
	init: function () {
		if (this.$selector.length) {
			
			
			$(".detail-card img.lazy", ".c06-product-ucg-review-pro").each(function(i){
				//移动端加载MB图片
				if($(window).width()<768){
					var mbsrc=$(".detail-card img.lazy").eq(i).data("mb");
					if(mbsrc){
						$(".detail-card img.lazy").eq(i).attr("data-original",mbsrc);
					}
				}
				
				// 加载后移除动画图片
				var img=$(".detail-card img.lazy").eq(i);
				var imgLoad = imagesLoaded(img);
			    imgLoad.on('done', function(instance) {
			        // 加载完成 
			        img.parent().removeClass('honor-loading-v2');
			    });
			})
			
			//懒加载调用
			$(".c06-product-ucg-review-pro .detail-card img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
			
		}
	}
};

$(function () {
	productUcgReviewPro.init();
});
(function(){
	$(function(){
		var productListList = {
			$selector: $('.product-list-cn'),
			$colornavItem: null,
			$productBox: $('.product-list-cn .product-lists'),
			$products:null,
			allProductDatas:$(".product-list-cn .product-list-data-holder").data("products") || [],
			sortAllProductDatas: [],  // 排序后全部数据
			currPageDatas: [],		// 当前页面数据
			pageNum:1,	// 当前页码
			pageSize:8,	// 每页个数
			isFirstReq:true,	// 是否首次请求
			isLoadMore:true,	// 是否记载更多
			isSort:false,		// 是否排序
			cancelSort:false,	// 取消排序
			sorts: {
				"timeToMarket": "-",
				"productPrice": "-",
				"screenSize": "-"
			},
			init: function () {
				if (this.$selector.length) {
					// 初始化排序数据
					this.sortAllProductDatas = this.allProductDatas.map(function(item){
						return item;
					})

					// 获取当前数据
					this.getCurrPageData();
					// 排序
					this.handleSortButtons();
					// 滚动加载数据
					this.scrollPage();
				}
			},
			getCurrPageData:function(allDatas){
				// 获取当前页数据
				
				var allDatas = [];
				// 判断是否是排序后的数据
				if(this.isSort){
					// 排序
					allDatas = this.sortAllProductDatas;
				}else{
					// 未排序
					allDatas = this.allProductDatas;
				}
				
				var startIndex = (this.pageNum-1) * this.pageSize;
				var endIndex = this.pageNum * this.pageSize;
				endIndex = endIndex > allDatas.length ? allDatas.length : endIndex; 
				
				this.currPageDatas = allDatas.slice(startIndex,endIndex);
				this.renderingLists(this.currPageDatas);
				
				this.isFirstReq = false;
			},
			scrollPage:function(){
				//滚动监听,当显示当前页最后一个产品时，加载下一页的数据
				var that = this;
				$(window).scroll(function() {
					var windowH = utils.windowHeight();
					var scrollTop = $(document).scrollTop();
					var listsTop = that.$productBox.position().top;
					var listsH = that.$productBox.height();
					
					var flag = (windowH+scrollTop)>(listsTop+listsH);
					
					if(that.isLoadMore && flag && !that.isFirstReq){
						// 加载 
						that.pageNum++;
						that.getCurrPageData();
					}
				}); 
				
			},
			renderingLists:function(productDatas){
				// 渲染产品列表
				if(productDatas.length>0){
					var str= '';
					for(var i=0;i<productDatas.length;i++){
						str+='<li class="product-list gradient-shadow" data-time="'+productDatas[i].timeToMarket+'" data-price="'+productDatas[i].productPrice+'" data-size="'+productDatas[i].screenSize+'">';
							str+='<div class="gradient-shadow__hover">';
								str+='<div class="product-card" data-id="0">';
									var colors= productDatas[i].colorsCn;
									var detailPage = productDatas[i].detailPage ?productDatas[i].detailPage :'javascript:void(0);', 
										marketingName = productDatas[i].marketingName ? productDatas[i].marketingName : '',
										slogan = productDatas[i].slogan ? productDatas[i].slogan : '';
										
									str+='<a class="img-container" href="'+detailPage+'">';
									if(colors instanceof Array){
										for(var j=0;j<colors.length;j++){
											var aClass = (j==0) ? 'active' : '',
												cnListImg = colors[j].cnListImg ? colors[j].cnListImg : '',
												cnListImgAlt = colors[j].cnListImgAlt ? colors[j].cnListImgAlt : '',
												cnListImgTitle = colors[j].cnListImgTitle ? colors[j].cnListImgTitle : '';
											str+='<img class="product-image lazy '+ aClass +' img'+j+'" data-original="'+cnListImg+'" title="'+cnListImgAlt+'" alt="'+cnListImgTitle+'">';
										}
									}
									str+='</a>';
									str+='<ul class="colornav-items">';
									if(colors instanceof Array){
										for(var j=0;j<colors.length;j++){
											var aClass = (j==0) ? 'active' : '';
											if(colors[j].color){
												var currIndex = colors[j].color.lastIndexOf('/');
												var currColor = colors[j].color.slice(currIndex+1,colors[j].color.length);
												str+='<li class="colornav-item '+ aClass +'" data-color="img'+j+'" style="background-color: #'+currColor+';"></li>';
											}
										}
									}
									str+='</ul>';
									str+='<div class="card-content">';
										str+='<p class="card-title">'+marketingName+'</p>';
										str+='<p class="card-text">'+slogan+'</p>';
									str+='</div>';
									var btnView = this.$productBox.data("view") || '';
									str+='<a href="'+productDatas[i].detailPage+'" class="btn-buy gradient-border">'+btnView+'</a>';
								str+='</div>';
							str+='</div>';
						str+='</li>';
					}
					if(this.isSort && this.pageNum ==1){
						// 点击排序
						this.$productBox.html(str);
					}else if(this.cancelSort){
						// 取消排序
						this.cancelSort = false;
						this.$productBox.empty().append(str);
					}else{
						// 正常加载
						this.$productBox.append(str);
					}
					
					this.$products = this.$productBox.find('.product-list');
					this.$colornavItem = this.$productBox.find('.colornav-item');
					
					// 图片懒加载
					this.$products.find(".lazy").lazyload({
					      "placeholder":lazyload.placeholder
					}); 
					
					// 切换颜色
					this.changePhoneColor();
				}else{
					this.isLoadMore = false;
				}
			},
			changePhoneColor: function () {
				// 切换产品颜色
				this.$colornavItem.click(function () {
					var $this = $(this);
					var color = $this.data().color;
					var $imgBox = $this.parent().siblings('.img-container').find("."+color);

					$this.addClass("active").siblings(".active").removeClass("active");
					$imgBox.addClass('active').attr('src',$imgBox.data('original'))
					.siblings().removeClass('active');
				})
			},
			handleSortButtons: function () {
				// 排序交互
				var that = this;
				$(".product-list-cn .sort-btn").click(function () {
					var type = $(this).data('option');
					for (var s in that.sorts) {
						if (s !== type)
							that.sorts[s] = '-';
					};

					$(this).siblings().removeClass('product-list__up product-list__down');
					
					if (that.sorts[type] == '-') {
						$(this).addClass('product-list__down');
						that.sorts[type] = 'down';
					} else if (that.sorts[type] == 'down') {
						$(this).removeClass('product-list__down').addClass('product-list__up');
						that.sorts[type] = 'up';
					} else {
						$(this).removeClass('product-list__up product-list__down');
						that.sorts[type] = '-';
					}
					that.sortProducts(type);
				});
			},
			sortProducts: function (type) {
				// 获取排序数据
				var that = this;
				if (that.sorts[type] === '-') {
					// 取消排序
					that.sortAllProductDatas = that.allProductDatas.map(function(item){
						return item;
					})
					that.isSort = false;
					that.cancelSort = true;
				}else{
					// 排序
					that.isSort = true;
					this.cancelSort = false;
					if(type=="timeToMarket"){
						that.sortAllProductDatas.sort(function (a, b) {
							var aTime = new Date(a.timeToMarket).getTime();
							var bTime = new Date(b.timeToMarket).getTime();
							if (that.sorts[type] === 'up') {
								return aTime - bTime;
							} else if (that.sorts[type] === 'down') {
								return bTime - aTime;
							}
						});
					}else{
						that.sortAllProductDatas.sort(function (a, b) {
							if (that.sorts[type] === 'up') {
								return a[type] - b[type];
							} else if (that.sorts[type] === 'down') {
								return b[type] - a[type];
							}
						});
					}
				}
				
				this.pageNum = 1;
				this.isFirstReq = true;
				this.isLoadMore = true;

				// 获取当前数据
				this.getCurrPageData();
			}
		};

		productListList.init();
	})
}());
(function(){
	$(function(){
		var productListChoice = {
			$selector: $('.product-list-banner-cn'),
			$radio: $(".product-list-banner-cn .radio"),

			init: function() {
				if(this.$selector.length) {
					$(".radio-0").parent().addClass("radio-selected");
					$("#product-0").addClass("is-display");
					this.showRightBg($("#product-0 .product-list-cover img"));
					this.productRadioSelect();
					
				}
			},
			productRadioSelect: function() {
				that = this;
				this.$radio.click(function() {
					$this = $(this);
					$this.siblings().removeClass('radio-selected');
					$this.addClass('radio-selected');
					$inputId = $(this).find("i").prop("class").split("-")[1];
					// change cover photo
					$currentIntro = $(".product-intro").filter(".is-display");
					$currentIntro.removeClass("is-display");
					$("#product-"+$inputId).addClass("is-display");
					that.showRightBg($("#product-"+$inputId+" .product-list-cover img"));
				})
			},
			showRightBg:function(obj){
				// 显示对应背景图片，默认显示PC端图片，移动端且配置MB图片时，才显示MB图片
				var bgImg = obj.data('pc');
				if(utils.windowWidth()<=768 && obj.data('mb')){
					bgImg = obj.data('mb');
				}
				obj.attr('src',bgImg);
				var imgLoad = imagesLoaded(obj);
		        imgLoad.on('done', function(instance) {
		        	// 加载完成 
		        	obj.css('visibility','visible');
		        })
			}
		};

		productListChoice.init();

	})
}());

var c29ProductDetailComponent20 = {
	$selector: $('.c29-product-detail-component20'),
	$window: $(window),

	classActiveImage: 'pdc20__image--active',

	init: function() {
		if(this.$selector.length) {
			
			$(".c29-product-detail-component20 img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
			// Initialize ScrollMagic
			if (innerWidth > 1199) {
				setTimeout(this.initScrollMagic.bind(this), 100);
	
				this.$timeline = this.$selector.find('.pdc20__timeline');
				this.$images = this.$selector.find('.pdc20__image');
				this.imagesLength = this.$images.length;
				this.CURRENT_BEFORE = 0;

				$.each(this.$images, function(index, image) {
					if (index === 0) {
						return $(image).css({ 'opacity': '0.99', 'z-index': '0' });
					}

					$(image).css({ 'opacity': '0.01', 'z-index': '0' });
				});
				
				return this.$window.on('scroll', this.changeImage.bind(this));
			}

			// Initialize Swiper
			var swiperOptions = {
				loop: false,
				speed: 600,
				effect: 'fade',
				autoplay: false,
				spaceBetween: 10,
				// slidesPerView: 1.02,
				centeredSlides: true,
			};

			this.mySwiper = new Swiper('.pdc20__image-wrap', swiperOptions);
			
			
		}
		
	},

	changeImage: function() {
		if (!this.scene) return;
		var current = Math.floor(this.scene.progress() * this.imagesLength);

		// Prevent functions to being called every time on scroll
		if (this.CURRENT_BEFORE === current) return;
		if (current > -1 && current < this.imagesLength) {
			this.moveItems(current);
		}
		this.CURRENT_BEFORE = current;
	},

	moveItems: function(num) {
		var _self = this;
		$.each(this.$timeline, function(index, timeline) {
			$(timeline).css({ 'transform': 'translateX(-'+ num * 100+'%)' });
			$(_self.$images[index]).css({ 'opacity': '0.01', 'z-index': '0' });
		});

		$(this.$images[num]).css({ 'opacity': '0.99', 'z-index': '1' });
	},

	initScrollMagic: function() {
		this.ctrl = new ScrollMagic.Controller();
		this.scene = new ScrollMagic.Scene({
			triggerElement: '.pdc20__image-wrap',
			triggerHook: 0.065,
			duration: this.imagesLength + '00%'
		})
		.setPin('.pdc20__image-wrap')
		.addTo(this.ctrl);
	}
};

$(function() {
	if(!c29ProductDetailComponent20.$selector.parent(".component-wcmmode").hasClass("true")){
		c29ProductDetailComponent20.init();
	}
});

var c26ProductDetailComponent17 = {
	$selector: $('.c26-product-detail-component17'),
	$window: $(window),

	init: function() {
		if(this.$selector.length) {
			setTimeout(this.initScrollMagic.bind(this), 100);

			this.$imageContainer = this.$selector.find('.pdc17__image-container');
			this.$timeline = this.$selector.find('.pdc17__timeline');
			this.imagesLength = this.$imageContainer.length;
			this.CURRENT_BEFORE = 0;

			this.$window.on('scroll', this.changeImage.bind(this));
			if (innerWidth <= 768) {
				this.recalculateImageHeight();
				this.$window.on('resize', this.recalculateImageHeight.bind(this));
			}
			
			this.$selector.find("img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
	},

	recalculateImageHeight: function() {
		var _self = this;

		setTimeout(function() {
			var imageWidth = _self.$imageContainer.width() / 0.7143;
			$('.pdc17__set-image-height').height(imageWidth);
		}, 200);
	},

	changeImage: function() {
		if (!this.scene) return;
		var current = Math.floor(this.scene.progress() * this.imagesLength);

		// Prevent functions to being called every time on scroll
		if (this.CURRENT_BEFORE === current) return;
		this.CURRENT_BEFORE = current;

		if (current > -1 && current < this.imagesLength) {
			this.moveItems(current);
		}
	},

	moveItems: function(num) {
		var _self = this;
		$.each(this.$imageContainer, function(index, item) {
			$(item).css({
				'transform': 'translateY(-'+ num * 100+'%)'
			});
			$(_self.$timeline[index]).css({
				'transform': 'translateY(-'+ num * 100+'%)'
			});
		});
	},

	initScrollMagic: function() {
		/**
		 * We need to calculate the empty space (which is not covered by the selector) in percentage
		 * and divide it by 2 so we get the point where our selector needs to start (to be fixed).
		 * Because the MagiScroll.Scene offset works from 0 - 1 (0-100%), we need to devide it by 200
		 * to get the percentage number between 0 - 1.
		 */
		this.sceneOffset = (100 - this.$selector.height() * 100 / this.$window.outerHeight()) / 200;
		this.ctrl = new ScrollMagic.Controller();
		this.scene = new ScrollMagic.Scene({
			triggerElement: '.c26-product-detail-component17',
			triggerHook: this.sceneOffset,
			duration: this.imagesLength + '00%'
		})
		.setPin('.c26-product-detail-component17')
		.addTo(this.ctrl);
	}
};

$(function() {
	if(!c26ProductDetailComponent17.$selector.parent(".component-wcmmode").hasClass("true")){
		c26ProductDetailComponent17.init();
	}
});

$(function(){
	if($(".product-detail-11-cn ").length > 0) {
		function init() {
			var screenWidth = $("window").width();
			var originSpeed;;
			$(".product-detail-11-cn").find(".pc_pic").each(function(i) {
				originSpeed = i*200 + 300;
				$(this).parents(".aos").attr("data-aos-delay", originSpeed);
			});
		}
		
		setTimeout(function() {
			init();
		},1000);
	}
});
(function(){
	if($('.product-detail-10-cn').length>0){
		var c30ProductDetailComponent21 = {
			$selector: $('.c30-product-detail-component21'),
			$imgs: $('.product-detail-component21__img'),
			breakPoint: 992,
			currentMode: innerWidth < 992 ? 'mobile' : 'pc',
			init: function() {
				var _ = this;
				if(this.$selector.length) {
					this.imgInit();
					$(window).resize(function() {
						if (_.currentMode == 'pc' && innerWidth < _.breakPoint) {
		                    _.currentMode = 'mobile';
		                    _.imgInit();
		                } else if (_.currentMode == 'mobile' && innerWidth >= _.breakPoint) {
		                    _.currentMode = 'pc';
		                    _.imgInit();
		                }
					});
				}
			},
			imgInit: function() {
		        var _ = this;
		        this.$imgs.each(function() {
		            var url = innerWidth < _.breakPoint ? $(this).data('mob') : $(this).data('pc');
		            $(this).attr('data-original', url);
		        });
		        $(".product-detail-10-cn img.lazy").lazyload({
					"placeholder":lazyload.placeholder
				});
		    }
		};

		c30ProductDetailComponent21.init();
	}
})();
$(function() {
	if($(".product-detail-09-cn").length > 0) {
		function addBackgroundPic() {
			var screenWidth = $(window).width();
			if(screenWidth <= 768) {
				$(".product-detail-09-cn").find(".background-pc").removeClass("lazy");
			} else {
				$(".product-detail-09-cn").find(".background-mb").removeClass("lazy");
			}
			//懒加载调用
			$(".product-detail-09-cn img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
		
		addBackgroundPic();
	}
})
$(function(){
	if($(".product-detail-08-cn").length > 0) {
		var productDetail08CN = {
			$selector: $('.product-detail-08-cn'),
			breakPoint: 1200,
		    mySwiper: null,
		    currentMode: innerWidth < 1200 ? 'mobile' : 'pc',

			init: function() {
				var _ = this;
				if(this.$selector.length) {
					if (innerWidth < _.breakPoint) 
						this.swiperInit();

		            $(window).resize(function() {
		                if (_.currentMode == 'pc' && innerWidth < _.breakPoint) {
		                    _.currentMode = 'mobile';
		                    _.swiperInit();
		                }
		            });
				}
			},
			swiperInit: function() {
				var CONTAINER = '.product-detail-component10__container',
		            options = {
						slidesPerView: 'auto'
					};

				this.mySwiper = new Swiper(CONTAINER, options);
		    }
		};

		productDetail08CN.init();
		
		function addPic() {
			var screenWidth = $(window).width();
			if(screenWidth <= 768) {
				$(".product-detail-08-cn").find(".pc_pic").removeClass("lazy");
				$(".product-detail-08-cn").each(function(){
					var picLength = $(this).find(".picli").length;
					if(picLength == 2) {
						$(this).find(".picli").css({"flex": "1 1 50%","width":"auto"});
					} else if(picLength == 3) {
						$(this).find(".picli").css({"flex": "none","width":"42%"});
					}
				});
			} else {
				$(".product-detail-08-cn").find(".mb_pic").removeClass("lazy");
			}
			//懒加载调用
			setTimeout(function() {
				$(".product-detail-08-cn img.lazy").lazyload({
					"placeholder":lazyload.placeholder
				});
			},500);
		}
		
		addPic();
		
		$(".product-detail-08-cn").each(function() {
			var picLength = $(this).find(".picli").length;
			if(picLength == 2) {
				$(this).addClass("secondPart");
			} else if (picLength == 1) {
				$(this).addClass("oncePart");
			}
		});
	}
});

(function(){
	$(function(){
		
		var productDetail07CN = {
			$selector: $('.product-detail-07-cn'),
			
			init: function() {
				if(this.$selector.length) {
					var compName = 'product-detail-07-cn';
					if (window[compName]) return;
					window[compName] = true;
					
					this.isPlaying = false;
					this.$videoButton = this.$selector.find('.product-detail-component7__btn');
					this.$video = this.$selector.find('.product-detail-component7__video');

					this.$videoButton.on('click', this.buttonController.bind(this));
					this.$video.on('play pause', this.videoControllers.bind(this));
				}
			},
			/*// 1.0本版本不开放此功能
			scrollPage:function(){
				// 视频进入视窗区域自动播放
				
				// 视频离开视窗区域暂停播放
				
			},*/
			toggleButtonStatus: function() {
				this.isPlaying
					? this.$videoButton.addClass('product-detail-component7__btn--is-playing')
					: this.$videoButton.removeClass('product-detail-component7__btn--is-playing');
			},

			videoControllers: function(event) {
				this.isPlaying = event.type === 'play';

				this.toggleButtonStatus.call(this);
			},

			buttonController: function() {
				this.isPlaying = !this.isPlaying;
				var video = $(event.currentTarget).parents('.product-detail-07-cn').find('.product-detail-component7__video')[0];

				this.toggleButtonStatus.call(this);
				this.isPlaying ? video.play() : video.pause();
			}
		};

		productDetail07CN.init();

	})
}());
(function(){
	$(function(){
		if($('.product-detail-06-cn').length>0) {
			$('.product-detail-06-cn').each(function(index){
				// 多个轮播图组件使用时，设置不同class区分
				var indexClass='product-detail-06-cn-'+index;
				$(this).addClass(indexClass);
				
				var productDetail06CN = {
					$selector: $('.product-detail-06-cn-'+index),
					$selectorEdit: $('.product-detail-06-cn-'+index).find('.product-detail-component6-edit'),
					$slides: $('.product-detail-06-cn-'+index).find('.product-detail-component6__slide'),
					slideNum: $('.product-detail-06-cn-'+index).find('.product-detail-component6').data('num'),
					breakPoint: 1200,
					mySwiper: null,
					isFirstShow: true, // 首次显示

					init: function() {
						var that = this;

						// 图片区分PC和Mobile，按需加载
						if (innerWidth < that.breakPoint) {
							that.$selector.find('.pc-img').removeClass('swiper-lazy');
						}else{
							that.$selector.find('.mb-img').removeClass('swiper-lazy');
						}
						
						// 判断是否进入视窗区域
						var flag = that.isInWindow();
						if(flag){
							that.isFirstShow = false;
							that.iconInit();
							that.swiperInit();
						}
						// 滚动监听
						that.scrollPage();
						
					},
					swiperInit: function() {
						var CONTAINER = '.product-detail-06-cn-'+index+' .product-detail-component6__container',
							PAGINATION = CONTAINER + ' .swiper-pagination',
							BGIMG = CONTAINER + ' .product-detail-component6__img',
							INFO = '.product-detail-component6__info',
							SLIDE = '.swiper-slide',
							ACTIVE_SLIDE = '.swiper-slide-active',
							options = {};
						
						var that = this;
						if (innerWidth < that.breakPoint) {
							options = {
								spaceBetween: 15,
								slidesPerView: 1.2,
								loop: false,
								speed: 800,
								lazy:true,
								centeredSlides: true,
								pagination: {
									el: PAGINATION,
									type: 'bullets',
									clickable: false
								},
								on: {
									init: function() {
										that.$selector.find(ACTIVE_SLIDE).find(INFO).css('opacity', 1);
									},
									slideChangeTransitionStart: function() {
										that.$selector.find(SLIDE).find(INFO).css('opacity', 0);
									},
									slideChangeTransitionEnd: function() {
										that.$selector.find(ACTIVE_SLIDE).find(INFO).css('opacity', 1);
									},
									lazyImageReady: function(slideEl, imageEl){
										$(slideEl).find('.mb-img').show();
								    }
								}
							};
						} else {
							options = {
								spaceBetween: 0,
								loop: true,
								speed: 800,
								effect: 'fade',
								loopedSlides: that.slideNum,  
								lazy:true,
								autoplay: {
									delay: 3000,
									disableOnInteraction: false
								},
								pagination: {
									el: PAGINATION,
									type: 'bullets',
									clickable: true
								},
								navigation: {
									nextEl: '.swiper-button-next',
									prevEl: '.swiper-button-prev',
								},
								on:{
									lazyImageReady: function(slideEl, imageEl){
										$(slideEl).find('.pc-img').show();
								    }
								}
							};
						}
						setTimeout(function() {
							if (that.mySwiper) {
								that.mySwiper.destroy();
							}
							that.mySwiper = new Swiper(CONTAINER, options);
						},500)
						
					},
					iconInit: function() {
						var that = this;
						that.$slides.each(function(index) {
							var iconEl = $(this).find('.product-detail-component6__icon'),
								iconUrl = innerWidth < that.breakPoint ? iconEl.data('mob') : iconEl.data('pc');

							iconEl.attr('src', iconUrl);
						});
					},
					isInWindow:function(){
						// 是否进入视窗区域
						var windowH = utils.windowHeight();
						var scrollTop = $(document).scrollTop();
						var listsTop = this.$selector.position().top;

						var flag = (windowH+scrollTop) > listsTop;
						return flag;
					},
					scrollPage:function(){
						//滚动监听，当轮播图进入视窗区域，加载轮播图
						var that = this;
						$(window).scroll(function() {
							var flag = that.isInWindow();
							if(that.isFirstShow && flag && !that.mySwiper){
								that.iconInit();
								that.swiperInit();
								that.isFirstShow = false;
							}
						}); 
						
					},
				};

				productDetail06CN.init();
			})
		}
	})
}());
var c15ProductDetailComponent6 = {
	$selector: $('.c15-product-detail-component6'),

	init: function() {
		if(this.$selector.length) {
			lineAnimation(this.$selector);
			
			$(".c15-product-detail-component6 img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
			
			if($(window).width()<=768){
				$.each($(".c15-product-detail-component6"), function(i) {
					
					var mbsrc=$(".c15-product-detail-component6").eq(i).find(".pdc6__image-wrap img.lazy").data("mb");
					if(mbsrc){
						$(".c15-product-detail-component6").eq(i).find(".pdc6__image-wrap img.lazy").attr("data-original",mbsrc);
					}

				})
			}
		}
	}
};

$(function() {
	c15ProductDetailComponent6.init();
});

(function(){
	$(function(){
		if($('.product-detail-04-cn').length>0) {
			$('.product-detail-04-cn').each(function(index){
				// 图片懒加载
				var $lazyImg = $(this).find(".product-detail-component4 .pdc4__image-wrap .lazy");
				if(utils.windowWidth()<=768){
					var mbImg = $lazyImg.data('mb');
					if(mbImg){
						$lazyImg.attr('data-original',mbImg);
					}
				}
				$(this).find(".product-detail-component4 .lazy").lazyload({
					"placeholder":lazyload.placeholder
				}); 
				
			})
		}
	})
}());
var c12ProductDetailComponent3 = {
	$selector: $('.c12-product-detail-component3'),
	$switchCircle: $('.js-switch-circle'),
	$image: $('.pdc3__image'),

	activeImage: 'pdc3__image--active',
	activeCircle: 'pdc3__switch-item--active',

	init: function() {
		if(this.$selector.length) {
			$.each($(".c12-product-detail-component3"), function(i,item) {
				$(this).find(".pdc3__image-wrapper img").eq(0).addClass("pdc3__image--active");
				$(this).find(".pdc3__switch-list li.pdc3__switch-item").eq(0).addClass("pdc3__switch-item--active");
			});
			var compName = 'c12-product-detail-component3';
			if (window[compName]) return;
			window[compName] = true;

			lineAnimation(this.$selector);
			if (this.$switchCircle){
				this.$switchCircle.on('click', this.changeImage.bind(this));
			} 
			
			$.each($(".c12-product-detail-component3 .pdc3__image-wrapper img.pdc3__image"), function(i) {
				if($(window).width()<768){
					var mbsrc=$(".c12-product-detail-component3 .pdc3__image-wrapper img.pdc3__image").eq(i).data("mb");
					if(mbsrc){
						$(".c12-product-detail-component3 .pdc3__image-wrapper img.pdc3__image").eq(i).attr("src",mbsrc);
					}
				}
			});
			
			//懒加载调用
//			$(".c12-product-detail-component3 .pdc3__image-wrapper img.lazy").lazyload({
//				"placeholder":lazyload.placeholder
//			});
			
			
		}
	},

	changeImage: function() {
		var _self = this;
		var $circle = $(event.currentTarget);
		var $cirlcesParent = $circle.parent().siblings();
		var circleIndex = $circle.parent().index();
		var $images = $circle.parent().parent().parent().find('.pdc3__image');
		//懒加载调用
		$(".c12-product-detail-component3 .pdc3__image-wrapper img.lazy").lazyload({
			"placeholder":lazyload.placeholder
		});
		$.each($images, function(index, image) {
			$($cirlcesParent[index]).removeClass(_self.activeCircle);
			$(image).removeClass(_self.activeImage);
		});
		$($images[circleIndex]).addClass(_self.activeImage);
		$circle.parent().addClass(_self.activeCircle);
	}
};

$(function() {
	c12ProductDetailComponent3.init();
});

var c11ProductDetailComponent2 = {
	$selector: $('.c11-product-detail-component2'),

	init: function() {
		if(this.$selector.length) {
			var compName = 'c11-product-detail-component2';
			if (window[compName]) return;
			window[compName] = true;

			lineAnimation(this.$selector);
			
			if($(window).width()<=768){
				$.each($(".c11-product-detail-component2"), function(i,item) {
					var mbsrc=$(".c11-product-detail-component2").eq(i).find(".pdc2__image-wrap img.lazy").data("mb");
					if(mbsrc){
						$(".c11-product-detail-component2").eq(i).find(".pdc2__image-wrap img.lazy").attr("data-original",mbsrc);
					}
				})
			}
			
			//懒加载调用
			$(".c11-product-detail-component2 img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
	}
};

$(function() {
	c11ProductDetailComponent2.init();
});

var c11ProductDetailComponent2InverseBlack = { // this name should be written in camelCase
	$selector: $('.c11-product-detail-component2-inverse-black'),

	init: function() {
		if(this.$selector.length) {

			var compName = 'c11-product-detail-component2-inverse-black';
			if (window[compName]) return;
			window[compName] = true;

			lineAnimation(this.$selector);
			
			if($(window).width()<768){
				$.each($(".c11-product-detail-component2-inverse-black"), function(i,item) {
					var mbsrc=$(".c11-product-detail-component2-inverse-black").eq(i).find(".pdc2__image-wrap img.lazy").data("mb");
					if(mbsrc){
						$(".c11-product-detail-component2-inverse-black").eq(i).find(".pdc2__image-wrap img.lazy").attr("data-original",mbsrc);
					}
				})
			}
			
			//懒加载调用
			$(".c11-product-detail-component2-inverse-black img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
	}
};

$(function() {
	c11ProductDetailComponent2InverseBlack.init();
});
var c11ProductDetailComponent2InverseWhite = { // this name should be written in camelCase
	$selector: $('.c11-product-detail-component2-inverse-white'),

	init: function() {
		if(this.$selector.length) {

			var compName = 'c11-product-detail-component2-inverse-white';
			if (window[compName]) return;
			window[compName] = true;

			lineAnimation(this.$selector);
			
			if($(window).width()<768){
				$.each($(".c11-product-detail-component2-inverse-white"), function(i,item) {
					var mbsrc=$(".c11-product-detail-component2-inverse-white").eq(i).find(".pdc2__image-wrap img.lazy").data("mb");
					if(mbsrc){
						$(".c11-product-detail-component2-inverse-white").eq(i).find(".pdc2__image-wrap img.lazy").attr("data-original",mbsrc);
					}
				})
				
			}
			
			//懒加载调用
			$(".c11-product-detail-component2-inverse-white img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
	}
};

$(function() {
	c11ProductDetailComponent2InverseWhite.init();
});

"use strict";
var imageZoomPan = function(imgID, resultID) {
	var img, lens, result, cx, cy;
	img = document.getElementById(imgID);
	result = document.getElementById(resultID);
	
	if (!img || !result) return;
	// create lens:
	lens = document.createElement('DIV');
	lens.setAttribute('class', 'img-zoom-lens');
	img.parentElement.insertBefore(lens, img.nextSibling); // inserts after
	// calculate the ratio between result DIV and lens:
	cx = result.offsetWidth / lens.offsetWidth;
	cy = result.offsetHeight / lens.offsetHeight;
	// set background properties for the result DIV:
	result.style.backgroundImage = 'url("' + img.src + '")';
	result.style.backgroundSize = (img.width * cx) + 'px ' + (img.height * cy) + 'px';
	// execute a function when someone moves the cursor over the image, or the lens:
	lens.addEventListener('mousemove', moveLens);
	img.addEventListener('mousemove', moveLens);
	// and also for touch screens:
	lens.addEventListener('touchmove', moveLens);
	img.addEventListener('touchmove', moveLens);

	function moveLens(e) {
		var pos, x, y;
		e.preventDefault();
		pos = getCursorPos(e);
		// calculate the position of the lens:
		x = pos.x - (lens.offsetWidth / 2);
		y = pos.y - (lens.offsetHeight / 2);
		// prevent the lens from being positioned outside the image:
		if (x > img.width - lens.offsetWidth) {x = img.width - lens.offsetWidth;}
		if (x < 0) {x = 0;}
		if (y > img.height - lens.offsetHeight) {y = img.height - lens.offsetHeight;}
		if (y < 0) {y = 0;}
		// set the position of the lens:
		lens.style.left = x + 'px';
		lens.style.top = y + 'px';
		// display what the lens 'sees':
		result.style.backgroundPosition = '-' + (x * cx) + 'px -' + (y * cy) + 'px';
	}

	function getCursorPos(e) {
		var a, x = 0, y = 0;
		e = e || window.event;
		// get the x and y positions of the image:
		a = img.getBoundingClientRect();
		// calculate the cursor's x and y coordinates, relative to the image:
		x = e.pageX - a.left;
		y = e.pageY - a.top;
		// consider any page scrolling:
		x = x - window.pageXOffset;
		y = y - window.pageYOffset;
		return {x : x, y : y};
	}
};

(function(){
	if($('.product-detail-01-cn').length>0){
		var width_window = $(window).width();
		var c28ProductDetailComponent19 = {
				init: function() {
					if (width_window > 973) {
						$(".pc_pic_19").each(function() {
							var noUseMagnifier = $(this).parents(".product-detail-01-cn").find(".noUseMagnifier").text();
							var thisId = $(this).attr("id");
							var resultId = $(this).siblings(".pdc19__image-results").attr("id");
							if(!noUseMagnifier) {
								imageZoomPan(thisId, resultId);
							}
						});
					}
				}
			};

		
		var c27ProductDetailComponent18 = {
			init: function() {
				if (width_window > 973) {
					$(".pc_pic_18").each(function() {
						var noUseMagnifier = $(this).parents(".product-detail-01-cn").find(".noUseMagnifier").text();
						var thisId = $(this).attr("id");
						var resultId = $(this).siblings(".pdc18__image-results").attr("id");
						if(!noUseMagnifier) {
							imageZoomPan(thisId, resultId);
						}
					});
				}
			}
		};

		
		function usePic() {
			if($(".c27-product-detail-component18").length > 0) {
				c27ProductDetailComponent18.init();
			}
			
			if($(".c28-product-detail-component19").length > 0) {
				c28ProductDetailComponent19.init();
			}
		}
		
		//图片路径添加
		function imgSrcAdd() {
			if(width_window > 768) {
				$.each($(".product-detail-01-cn"), function() {
					var imgSrc = $(this).find(".pc_pic").attr("data-origin");
					$(this).find(".pc_pic").attr("src", imgSrc);
					setTimeout(function(){
						usePic();
					},1000);
				});
			} else {
				$.each($(".product-detail-01-cn"), function(i,item) {
					var imgSrc = $(this).find(".mb_pic").attr("data-origin");
					$(this).find(".mb_pic").attr("src", imgSrc);
					setTimeout(function(){
						usePic();
					},1000);
				});
			}
			//懒加载调用
			$(".product-detail-01-cn img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
		imgSrcAdd();
		
		window.onresize = function() {
			imgSrcAdd();
			setTimeout(function() {
				globalScript.translateAnimation();
			}, 10);
		}
	}
})();
var c10ProductDetailComponent1 = {
	CONTAINER: '.product-detail-component1',
	$selector: $('.c10-product-detail-component1'),
	$selectorVideo: $('.c17-product-detail-component8'),
	scrollController: null,
	parallaxObj: null,
	breakPoint: 1200,
	currentMode: innerWidth <= 1200 ? 'mobile' : 'pc',
	videoPlay: false,

	init: function() {
		var _ = this;
		if(this.$selector.length) {
			innerWidth < _.breakPoint ? this.initScrollMobile() : this.initScroll();

			$(window).resize(function() {
				if (_.currentMode == 'pc' && innerWidth < _.breakPoint) {
					_.scrollController.destroy();
					_.switchVideo('back');
					_.videoPlay = false;
					$(window).unbind('scroll');
                    _.currentMode = 'mobile';
                    _.initScrollMobile()
                } else if (_.currentMode == 'mobile' && innerWidth >= _.breakPoint) {
                    _.currentMode = 'pc';
                    _.initScroll();
                }
			});
			
			if($(window).width()<=768){
				var mbsrc=$(".c10-product-detail-component1 .product-detail-component1__wrapper").data("mb");
				if(mbsrc){
					$(".c10-product-detail-component1 .product-detail-component1__wrapper").css("background-image","url("+mbsrc+")");
				}
			}
		}
	},
	switchVideo: function(type) {
		var _ = this,
			$video = $(this.CONTAINER + '__video');
		if (type == 'to') {
			$(this.CONTAINER + '__phone-origin').fadeOut();
			$video.fadeIn(function(){
				$(this)[0].play();
			});
		} else {
			$video[0].pause();
			$video[0].currentTime = 0;
			$video.fadeOut();
			$(this.CONTAINER + '__phone-origin').fadeIn();
		}
	},
	initScrollMobile: function() {
		var _ = this;
		$(this.CONTAINER).fadeIn(); 
		$(this.CONTAINER + '__line-path').css('opacity', 0);
		$(this.CONTAINER + '__title-info h1').addClass('text-visible');
		$(this.CONTAINER + '__title-info h4').delay(500).queue(function(){
			$(this).addClass('text-visible').dequeue();
		});
		$(this.CONTAINER + '__phone' +', '+ this.CONTAINER + '__phone1').delay(1000).queue(function(){
			$(this).addClass('visible').dequeue();
		});
		$(this.CONTAINER + '__feature').delay(2500).queue(function(){
			$(_.CONTAINER + '__line-path').addClass('active');
			$(this).addClass('text-visible').dequeue();
		});
		$(this.CONTAINER + '__desc').delay(3000).queue(function(){
			$(this).addClass('text-visible').dequeue();
		});
	},
	clearClass: function(el, className) {
		el.hasClass(className) && el.removeClass(className);
	},
	initScroll: function() {
		var _ = this,
			parallaxScene = document.getElementById('parallax-scene'),
			innerHeight = document.documentElement.clientHeight;
		var scaleSize;
			if(innerHeight <= 768) {
				scaleSize = 1.20;
			} else {
				scaleSize = innerWidth * 0.8 / 660;
			}

		_.clearClass($(this.CONTAINER + '__title-info h1'), 'text-visible');
		_.clearClass($(this.CONTAINER + '__title-info h4'), 'text-visible');
		_.clearClass($(this.CONTAINER + '__feature'), 'text-visible');
		_.clearClass($(this.CONTAINER + '__desc'), 'text-visible');
		_.clearClass($(this.CONTAINER + '__phone'), 'visible');
		_.clearClass($(this.CONTAINER + '__phone1'), 'visible');
		
		!_.parallaxObj && (_.parallaxObj = new Parallax(parallaxScene));

		$(this.CONTAINER + '__phone').delay(500).queue(function(){
			$(this).addClass('visible').dequeue();
		});
		$(this.CONTAINER + '__phone1').delay(800).queue(function(){
			$(this).addClass('visible').dequeue();
			if(innerHeight <= 768) {
				$(_.CONTAINER + '__phone').attr('data-1200', 'opacity: 1; transform: rotate(90deg) translateY(40px) scale('+scaleSize+');');
			} else {
				$(_.CONTAINER + '__phone').attr('data-1200', 'opacity: 1; transform: rotate(90deg) translateY(0) scale('+scaleSize+');');
			}
			var equipmentType = "";
			var agent = navigator.userAgent.toLowerCase();
			var android = agent.indexOf("android");
			var ipad = agent.indexOf("ipad");
			if((android == -1) && ipad == -1 && $("body").width() >= 768) {
				_.scrollController = skrollr.init({forceHeight: false});
			}
		});
		$(this.CONTAINER + '__title-info h1,' + this.CONTAINER + '__title-info h4,' + this.CONTAINER + '__desc,' + this.CONTAINER + '__feature').delay(800).queue(function(){
			$(this).addClass('text-visible').dequeue();
		});

		$(_.CONTAINER + '__line-path').delay(1200).queue(function(){
			$(this).addClass('active').dequeue();
		});
		
		if($(window).scrollTop()>=$(_.CONTAINER).height()){
			!$(_.CONTAINER).hasClass('release') && $(_.CONTAINER).addClass('release');
		}else{
			$('body,html').animate({scrollTop:0},10);
		}
		
		$(window).scroll(function(){
			if ($(this).scrollTop() >= 700){
				if (!_.videoPlay) {
					_.videoPlay = !_.videoPlay;
					_.switchVideo('to');
				} 
			} else {
				if (_.videoPlay) {
					_.videoPlay = !_.videoPlay;
					_.switchVideo('back');
				} 
			}

			if ($(window).scrollTop() >= $(_.CONTAINER).offset().top + $(_.CONTAINER).outerHeight() - innerHeight) {
				$('.product-detail-component1__container, .product-detail-component1__bg, .product-detail-component1__line-container').css(
					'top', $(_.CONTAINER).outerHeight() - innerHeight + 'px'
				)

				!$(_.CONTAINER).hasClass('release') && $(_.CONTAINER).addClass('release');	  
			} else {
				$('.product-detail-component1__container, .product-detail-component1__bg, .product-detail-component1__line-container').css(
					'top', 'auto'
				)
				$(_.CONTAINER).hasClass('release') && $(_.CONTAINER).removeClass('release');
			}
		});
	}
};

$(function() {
	c10ProductDetailComponent1.init();
});
$(function() {
	if($(".product-comparison-cn").length > 0) {
		//设置comparison__sticky top值
		function setStickyTop() {
			var hoMiddleHeight = $(".ho-middle").height();
			$(".comparison__sticky").css("top", hoMiddleHeight + "px");
		}
		
		setStickyTop();
		
		var n13ProductComparisonDropdown = {
			$selector: $('.n13-product-comparison-dropdown'),
			$comparisonDots: $('.js-comparison-dot'),

			$stickyPlaceholder: $('.comparison__sticky-placeholder'),
			$sticky: $('.comparison__sticky'),
			$thumbnail: $('.comparison__item-thumbnail'),

			stickyClass: 'comparison--has-sticky',
			thumbnailActive: 'comparison__item-thumbnail--active',
			dotActive: 'comparison__dot--active',

			init: function() {
				if(this.$selector.length) {
					$(".product-comparison-cn").on("click", '.js-comparison-dot', this.changeImageThumbnail.bind(this));

					$(window).on('scroll', this.toggleSticky.bind(this));
					$(window).on('resize', this.calculateStickyHeight.bind(this));
				}
			},

			calculateStickyHeight: function() {
				var height = this.$sticky.height();
				this.$stickyPlaceholder.height(height);
			},

			changeImageThumbnail: function(event) {
				var $dot = $(event.currentTarget);
				var $parentNode = $dot.parent().parent();
				var $thumbnail = $parentNode.find('.comparison__item-thumbnail');

				$dot.siblings().removeClass(this.dotActive);
				$.each($thumbnail, function(index, image) {
					$(image).removeClass(this.thumbnailActive);
				}.bind(this));
				$($thumbnail[$dot.index()]).addClass(this.thumbnailActive);
				$dot.addClass(this.dotActive);
			},
			
			changeSticHeight: function() {
				$(".product-comparison-cn").find(".comparison__select-button").css("height", "auto");
				setTimeout(function(){
					var listHeightArray = [];
		    		$(".product-comparison-cn").find(".comparison__select-button").each(function() {
		    			listHeightArray[listHeightArray.length] = $(this).height();
		    		});
		    		var maxHeight = Math.max.apply(null,listHeightArray);
		    		$(".product-comparison-cn").find(".comparison__select-button").css("height", maxHeight + 20 + "px");
				},100);
			},

			toggleSticky: function() {
				var OFFSET = 50;
				var stickyHeight = this.$stickyPlaceholder.height();
				var scrollTop = $(event.target).scrollTop();

				if (scrollTop - OFFSET > stickyHeight) {
					if (this.$selector.hasClass(this.stickyClass)) return;

					this.$sticky.hide();
					this.$selector.addClass(this.stickyClass);
					this.changeSticHeight();
					this.$sticky.slideDown(150);
				} else {
					if (!this.$selector.hasClass(this.stickyClass)) return;

					this.$selector.removeClass(this.stickyClass);
					this.changeSticHeight();
					this.$sticky.show();
					this.calculateStickyHeight.call(this);
				}
			}
		};
		
		var n14ProductComparisonSelect = {
			$selector: $('.n14-product-comparison-select'),
			
			itemActive: 'comparison__select-item--active',
			buttonActive: 'js-button-active',
			
			init: function() {
				if($('.n14-product-comparison-select').length > 0) {
					var compName = 'n14-product-comparison-select';
					if (window[compName]) return;
					window[compName] = true;

					this.$dropdownItems = this.$selector.find('.comparison__select-item');
					this.$comparisonButton = this.$selector.find('.js-comparison-button');
					this.$overlay = this.$selector.find('.comparison__overlay');
					$(".product-comparison-cn").on('click', ".comparison__select-button", function(e) {
						$(this).toggleClass('js-button-active');
						$(this).siblings(".comparison__select-content").fadeToggle();
						$(this).parents(".comparison__item").siblings(".comparison__item").find(".comparison__select-button").removeClass("js-button-active");
						$(this).parents(".comparison__item").siblings(".comparison__item").find(".comparison__select-content").fadeOut();
						return false;
					});
					$(".product-comparison-cn").on('click', '.comparison__select-item', function(e) {
						if (!$(this).hasClass("comparison__select-item--active")) {
							var urlName = $(this).data("url");
							var activeNameArray = [];
							$(this).parents(".comparison__item").siblings(".comparison__item").each(function() {
								var thisName = $(this).find(".comparison__select-item--active").data("url");
								activeNameArray.push(thisName);
							});
							if(activeNameArray.indexOf(urlName) == -1) {
								var $dropdownItems = $(this).parent().children();
								var $itemDropdownButton = $(this).parents(".n14-product-comparison-select").find('.js-button-active');
								var itemText = $(this).text();

								for (var s = 0; s < $dropdownItems.length; s++) {
									$($dropdownItems[s]).removeClass('js-button-active');
								}
								
								$itemDropdownButton.addClass('js-button-active');
								$(this).addClass("comparison__select-item--active");
								$(this).siblings(".comparison__select-item").removeClass("comparison__select-item--active");
								$(this).parents(".comparison__item").siblings(".comparison__item").find(".comparison__select-button").removeClass("js-button-active");
								$(this).parents(".comparison__item").siblings(".comparison__item").find(".comparison__select-content").fadeOut();
								var windowWidth = $(window).width();
								if(windowWidth > 768) {
									$itemDropdownButton.html(itemText);
									$(this).parents(".comparison__select").find(".confirmBtn").trigger("click");
								}
							}
							
							
						}
						return false;
					});
					$(document).on("click",function(){
						$(".comparison__item").find(".comparison__select-button").removeClass("js-button-active");
						$(".comparison__item").find(".comparison__select-content").fadeOut();
					})
				}
			}
		};
		
		function ajaxUrlComfirm() {
			var firstProductPath = $(".firstProductPath").text();
			var secondProductPath = $(".secondProductPath").text();
			var thirdProductPath = $(".thirdProductPath").text();
			var firstProduct;
			var secondProduct;
			var thirdProduct;
			var currUrl = location.href;
			
			if(firstProductPath) {
				var firstProductArray = firstProductPath.split("/");
				firstProduct = firstProductArray[firstProductArray.length - 1];
				var firstProductAjaxUrl;
				if(currUrl.indexOf('.html') !=-1){
					firstProductAjaxUrl=currUrl.split('.html')[0].slice(0,currUrl.split('.html')[0].lastIndexOf("/")) + "/" + firstProduct + '/spec/jcr:content.specs.json';
				}else if(currUrl.indexOf('?') != -1){
					firstProductAjaxUrl=currUrl.split('?')[0].slice(0,currUrl.split('?')[0].lastIndexOf("/")) + "/" + firstProduct + '/spec/jcr:content.specs.json';
				}else{
					firstProductAjaxUrl=(currUrl.slice(0,currUrl.lastIndexOf("/"))).slice(0,currUrl.slice(0,currUrl.lastIndexOf("/")).lastIndexOf("/")) + "/" + firstProduct + '/spec/jcr:content.specs.json';
				}
			}
			
			if(secondProductPath) {
				var secondProductArray = secondProductPath.split("/");
				secondProduct = secondProductArray[secondProductArray.length - 1];
				var secondProductAjaxUrl;
				if(currUrl.indexOf('.html') !=-1){
					secondProductAjaxUrl=currUrl.split('.html')[0].slice(0,currUrl.split('.html')[0].lastIndexOf("/")) + "/" + secondProduct + '/spec/jcr:content.specs.json';
				}else if(currUrl.indexOf('?') != -1){
					secondProductAjaxUrl=currUrl.split('?')[0].slice(0,currUrl.split('?')[0].lastIndexOf("/")) + "/" + secondProduct + '/spec/jcr:content.specs.json';
				}else{
					secondProductAjaxUrl=(currUrl.slice(0,currUrl.lastIndexOf("/"))).slice(0,currUrl.slice(0,currUrl.lastIndexOf("/")).lastIndexOf("/")) + "/" + secondProduct + '/spec/jcr:content.specs.json';
				}
			}
			
			if(thirdProductPath) {
				var thirdProductArray = thirdProductPath.split("/");
				thirdProduct = thirdProductArray[thirdProductArray.length - 1];
				var thirdProductAjaxUrl;
				if(currUrl.indexOf('.html') !=-1){
					thirdProductAjaxUrl=currUrl.split('.html')[0].slice(0,currUrl.split('.html')[0].lastIndexOf("/")) + "/" + thirdProduct + '/spec/jcr:content.specs.json';
				}else if(currUrl.indexOf('?') != -1){
					thirdProductAjaxUrl=currUrl.split('?')[0].slice(0,currUrl.split('?')[0].lastIndexOf("/")) + "/" + thirdProduct + '/spec/jcr:content.specs.json';
				}else{
					thirdProductAjaxUrl=(currUrl.slice(0,currUrl.lastIndexOf("/"))).slice(0,currUrl.slice(0,currUrl.lastIndexOf("/")).lastIndexOf("/")) + "/" + thirdProduct + '/spec/jcr:content.specs.json';
				}
			}
			
			var obj = {}
			obj.firstProductAjaxUrl = firstProductAjaxUrl;
			obj.secondProductAjaxUrl = secondProductAjaxUrl;
			obj.thirdProductAjaxUrl = thirdProductAjaxUrl;
			obj.firstProduct = firstProduct;
			obj.secondProduct = secondProduct;
			obj.thirdProduct = thirdProduct;
			obj.currUrl = currUrl;
			return obj;
		}
		
		var ajaxurlComplete = ajaxUrlComfirm();
		
		function addProductList(ajaxUrl,productNum,productName) {
			if(ajaxUrl) {
				$.ajax({
				    url: ajaxUrl, 
				    dataType: 'json', 
				    type: 'GET',
				    success: function(info) {
				    	var data = info.detailMode;
				    	if(data) {
				    		//价格按钮填充
				    		var cnProductPriceHtml;
				    		var buyNowPath;
				    		var buyNowHtml;
				    		if(data.cnProductPrice) {
				    			cnProductPriceHtml = '<h3 class="comparison__item-price-wrap">' +
													'<span class="comparison__item-price-currency">￥</span>' +
													'<span class="comparison__item-price">' + data.cnProductPrice + '</span>' +
													'<span class="comparison__item-price-from">起</span>' +
													'</h3>';
				    		} else {
				    			cnProductPriceHtml = "";
				    		}
				    		if(data.buyNowPath) {
				    			buyNowPath = data.buyNowPath;
				    		} else {
				    			buyNowPath = "javascript:void(0);";
				    		}
				    		if(data.buyNowTitle) {
				    			buyNowHtml = '<div class="comparison__item-button-wrap">' +
											'<a href="' + buyNowPath + '" class="comparison__item-button">' + data.buyNowTitle + '</a>' +
											'</div>';
				    		} else {
				    			buyNowHtml = "";
				    		}
				    		
				    		var confirmBtnText;
				    		if(data.confirmBtn) {
				    			confirmBtnText = data.confirmBtn;
				    		} else {
				    			confirmBtnText = "确认";
				    		}
				    		$(".comparison__list" + " ." + productNum).html(
				    				'<div class="n14-product-comparison-select product-comparison-select" data-component="n14-product-comparison-select">' +
									'<div class="comparison__select">' +
										'<button type="button" class="comparison__select-button js-comparison-button"></button>' +
										'<div class="comparison__select-content">' +
										'<ul class="comparison__select-list">' +
										'</ul>' +
										'<div class="comparison__item-button-wrap">' +
										'<button type="button" class="comparison__item-button confirmBtn">' + confirmBtnText + '</button>' +
										'</div>' +
										'</div>' +
										'</div>' +
										'<div class="comparison__overlay"></div>' +
										'</div>' +
										'<div class="comparison__item-thumbnail-wrap">' +
										'</div>' +
										'<div class="comparison__dots-wrap hide-on-mobile">' +
										'</div>' +
										'<div class="comparison__footer">' +
										cnProductPriceHtml +
										buyNowHtml +
										'</div>'
				    		);
				    		
				    		var windowWidth = $(window).width();
				    		if(windowWidth  > 768 || $("." + productNum).find(".comparison__select-button").text() == "") {
				    			addAllProductList(productNum,productName);
				    		}
				    		setTimeout(function() {
				    			n14ProductComparisonSelect.init();
								n13ProductComparisonDropdown.init();
				    		},1000);
				    		
				    		var listHeightArray = [];
				    		$(".product-comparison-cn").find(".comparison__select-button").each(function() {
				    			listHeightArray[listHeightArray.length] = $(this).height();
				    		});
				    		
				    		var maxHeight = Math.max.apply(null,listHeightArray);
				    		$(".product-comparison-cn").find(".comparison__select-button").css("height", maxHeight + 20 + "px");
				    		
				    		//手机图片
				    		$(".comparison__list" + " ." + productNum).find(".comparison__item-thumbnail-wrap").html("");
				    		$(".comparison__list" + " ." + productNum).find(".comparison__dots-wrap").html("");
				    		if(data.colorsCn) {
				    			var colorList = JSON.parse(data.colorsCn);
					    		var colorArray = [];
					    		var colorHtml;
					    		var colorDotHtml;
					    		var colorDotArray = [];
					    		var pointColor;
					    		var activeDot;
					    		for(var e = 0; e < colorList.length; ++e) {
					    			colorHtml = "<img title='" + colorList[e].cnListImgTitle + "' class='comparison__item-thumbnail' src='" + colorList[e].cnListImg + "' alt='" + colorList[e].cnListImgAlt + "'>";
					    			colorArray[colorArray.length] = colorHtml;
					    			if(colorList[e].color) {
					    				pointColor = colorList[e].color.split("/")[colorList[e].color.split("/").length - 1];
					    			} else {
					    				pointColor = '';
					    			}
					    			
					    			if(e == 0) {
					    				activeDot = ' comparison__dot--active';
					    			} else {
					    				activeDot = '';
					    			}
					    			if(pointColor) {
					    				colorDotHtml = '<span class="comparison__dot comparison__dot--blue js-comparison-dot' + activeDot + '" style="background-color:#' + pointColor + '"></span>';
					    			} else {
					    				colorDotHtml = '<span class="comparison__dot comparison__dot--blue js-comparison-dot' + activeDot + '"></span>';
					    			}
					    			
					    			colorDotArray[colorDotArray.length] = colorDotHtml;
					    		}
					    		
					    		$(".comparison__list" + " ." + productNum).find(".comparison__item-thumbnail-wrap").html(colorArray.join(""));
					    		$(".comparison__list" + " ." + productNum).find(".comparison__dots-wrap").html(colorDotArray.join(""));
					    		$(".comparison__list" + " ." + productNum).find(".comparison__item-thumbnail:first").addClass("comparison__item-thumbnail--active");
				    		}
				    		
				    		setTimeout(function() {
				    			//屏幕尺寸
					    		$(".screenSize").find("." + productNum).html("");
					    		if(data.displaySize) {
					    			$(".screenSize").find("." + productNum).html(
					    				"<ul class='details__row-list'>" +
											"<li class='details__row-item'>" + data.displaySize + "</li>" +
										"</ul>"
						    		);
					    		}
					    		
					    		
					    		//外观
					    		$(".appearance").find(".details__row-title").text("");
					    		$(".appearance").find("." + productNum).html("");
					    		if(data.appearanceTitle) {
					    			$(".appearance").find(".details__row-title").text(data.appearanceTitle);
						    		$(".appearance").find("." + productNum).html(
					    				"<ul class='details__row-list'>" +
										"<li class='details__row-item'>" + data.longInfo + "</li>" +
										"<li class='details__row-item'>" + data.thickInfo + "</li>" +
										"<li class='details__row-item'>" + data.widthInfo + "</li>" +
										"<li class='details__row-item'>" + data.weightName + data.weightInfo + "</li>" +
										"<li class='details__row-item'>" + data.marketDateName + data.marketDateInfo + "</li>" +
										"</ul>" +
										"<div class='details__row-note-wrap'>" +
										"<span class='details__row-note'>" + data.appearanceRemark + "</span>" +
										"</div>"
						    		);
					    		}
					    		
					    		//运行参数
					    		$(".run").find(".details__row-title").text("");
					    		$(".run").find("." + productNum).html("");
					    		if(data.runLists) {
					    			$(".run").find(".details__row-title").text(data.runTitle);
						    		var runLists = JSON.parse(data.runLists);
						    		var runListArray = [];
						    		var runListHtml;
						    		for(var i = 0; i < runLists.length; ++i) {
						    			runListHtml = "<li class='details__row-item'><span class='listTitle'>" + runLists[i].listRunTitle + "</span>" + ":" + runLists[i].listRunInfo + "</li>";
						    			runListArray[runListArray.length] = runListHtml;
						    		}
						    		$(".run").find("." + productNum).html(
					    				"<ul class='details__row-list'>" +
					    				runListArray.join("") +
					    				"</ul>"
						    		);
					    		}
					    		
					    		//拍照/摄像
					    		$(".photograph").find(".details__row-title").text("");
					    		$(".photograph").find("." + productNum).html("");
					    		if(data.photographLists) {
					    			$(".photograph").find(".details__row-title").text(data.photographTitle);
						    		var photographLists = JSON.parse(data.photographLists);
						    		var photographListsArray = [];
						    		var photographListsHtml;
						    		for(var k = 0; k < photographLists.length; ++k) {
						    			photographListsHtml = "<li class='details__row-item'><span class='listTitle'>" + photographLists[k].listTitle + "</span>" + ":" + photographLists[k].listInfo + "</li>";
						    			photographListsArray[photographListsArray.length] = photographListsHtml;
						    		}
						    		$(".photograph").find("." + productNum).html(
					    				"<ul class='details__row-list'>" +
					    				photographListsArray.join("") +
					    				"</ul>"
						    		);
					    		}
					    		
					    		
					    		//系统
					    		$(".system").find(".details__row-title").text("");
					    		$(".system").find("." + productNum).html("");
					    		if(data.systemInfo) {
					    			$(".system").find(".details__row-title").text(data.systemTitle);
						    		$(".system").find("." + productNum).html(
					    				"<ul class='details__row-list'>" +
										"<li class='details__row-item'>" + data.systemInfo + "</li>" +
										"</ul>"
						    		);
					    		}
					    		
					    		
					    		//网络参数
					    		$(".network").find(".details__row-title").text("");
					    		$(".network").find("." + productNum).html("");
					    		if(data.networkLists) {
					    			$(".network").find(".details__row-title").text(data.networkTitle);
						    		var networkLists = JSON.parse(data.networkLists);
						    		var networkListsArray = [];
						    		var networkListsHtml;
						    		for(var n = 0; n < networkLists.length; ++n) {
						    			networkListsHtml = "<li class='details__row-item'><span class='listTitle'>" + networkLists[n].listTitle + "</span>" + ":" + networkLists[n].listInfo + "</li>";
						    			networkListsArray[networkListsArray.length] = networkListsHtml;
						    		}
						    		$(".network").find("." + productNum).html(
					    				"<ul class='details__row-list'>" +
					    				networkListsArray.join("") +
					    				"</ul>"
						    		);
					    		}
				    		},1000);
				    		
				    		setTimeout(function(){
				    			$(".product-comparison-cn").find(".comparison__sticky-placeholder").css("height",$(".comparison__sticky").height() + "px");
				    		},500);
				    	}
				    },
				    error: function() {
			    		$(".comparison__list" + " ." + productNum).hide();
			    		$(".c09-product-comparison-details").find("." + productNum).hide();
				    }
			    })
			} else {
	    		$(".comparison__list" + " ." + productNum).hide();
	    		$(".c09-product-comparison-details").find("." + productNum).hide();
			}
		}
		
		//添加产品
		function addFinalList() {
			var windowWidth = $(window).width();
			if($(".changeh4").length == 0) {
				addProductList(ajaxurlComplete.firstProductAjaxUrl, "productOne",ajaxurlComplete.firstProduct);
				addProductList(ajaxurlComplete.secondProductAjaxUrl, "productTwo",ajaxurlComplete.secondProduct);
				if(windowWidth >= 991.98) {
					addProductList(ajaxurlComplete.thirdProductAjaxUrl, "productThree",ajaxurlComplete.thirdProduct);
				}
			} else {
				if($(".comparison__list").find(".productOne").find(".comparison__item-thumbnail").length == 0) {
					addProductList(ajaxurlComplete.firstProductAjaxUrl, "productOne",ajaxurlComplete.firstProduct);
				}
			
				if($(".comparison__list").find(".productTwo").find(".comparison__item-thumbnail").length == 0) {
					addProductList(ajaxurlComplete.secondProductAjaxUrl, "productTwo",ajaxurlComplete.secondProduct);
				}
				
				if(windowWidth >= 991.98) {
					if($(".comparison__list").find(".productThree").find(".comparison__item-thumbnail").length == 0) {
						addProductList(ajaxurlComplete.thirdProductAjaxUrl, "productThree",ajaxurlComplete.thirdProduct);
					}
				}
			}
		}
		
		addFinalList();
		
		//添加产品列表
		function addAllProductList(productNum,productUrl) {
			var productList = $('.product-list-data-holder').data('products');
			var productHtml;
			var productArray = [];
			for(var h = 0; h < productList.length; ++h) {
				var productUrlName = productList[h].siteAdminPath.split("/")[productList[h].siteAdminPath.split("/").length - 1];
				var activeSelect;
				if(productUrl) {
					if(productUrl == productUrlName) {
						var windowWidth = $(window).width();
						if(windowWidth > 768) {
							$(".comparison__list" + " ." + productNum).find(".comparison__select-button").html(productList[h].productName);
							activeSelect = "comparison__select-item--active ";
						} else {
							if(!$(".comparison__list" + " ." + productNum).find(".comparison__select-button").text()) {
								$(".comparison__list" + " ." + productNum).find(".comparison__select-button").html(productList[h].productName);
								activeSelect = "comparison__select-item--active ";
							}
						}
					} else {
						activeSelect = "";
					}
				}
				productHtml = "<li class='" + activeSelect + "comparison__select-item' data-url='" + productUrlName + "'>" +
							"<span class='comparison__select-text'>" + productList[h].productName + "</span>" +
							"</li>";
				productArray[productArray.length] = productHtml;
			}
			
			$(".comparison__list" + " ." + productNum).find(".comparison__select-list").html(productArray.join(""));
		}
		
		
		//确认按钮
		$(".product-comparison-cn").on("click", ".confirmBtn", function() {
			var urlName = $(this).parents(".comparison__select").find(".comparison__select-item--active").data("url");
			var activeNameArray = [];
			$(this).parents(".comparison__item").siblings(".comparison__item").each(function() {
				var thisName = $(this).find(".comparison__select-item--active").data("url");
				activeNameArray.push(thisName);
			});
			
			var currUrl = ajaxurlComplete.currUrl;
			if(activeNameArray.indexOf(urlName) == -1) {
				var ajaxUrl;
				if(currUrl.indexOf('.html') !=-1){
					ajaxUrl=currUrl.split('.html')[0].slice(0,currUrl.split('.html')[0].lastIndexOf("/")) + "/" + urlName + '/spec/jcr:content.specs.json';
				}else if(currUrl.indexOf('?') != -1){
					ajaxUrl=currUrl.split('?')[0].slice(0,currUrl.split('.html')[0].lastIndexOf("/")) + "/" + urlName + '/spec/jcr:content.specs.json';
				}else{
					ajaxUrl=(currUrl.slice(0,currUrl.lastIndexOf("/"))).slice(0,currUrl.slice(0,currUrl.lastIndexOf("/")).lastIndexOf("/")) + "/" + urlName + '/spec/jcr:content.specs.json';
				}
				var productNumData = $(this).parents(".comparison__item").attr("class");
				var productNum = productNumData.split(" ")[productNumData.split(" ").length - 1];
				addProductList(ajaxUrl,productNum,urlName);
				var windowWidth = $(window).width();
				if(windowWidth <= 768) {
					addAllProductList(productNum,urlName);
				}
			}
		});
		
		window.onresize = function() {
			if($(".changeh4").length > 0) {
				var windowWidth = $(window).width();
				var ajaxurlComplete = ajaxUrlComfirm();
				if($(".comparison__list").find(".productOne").find(".comparison__item-thumbnail").length == 0) {
					addProductList(ajaxurlComplete.firstProductAjaxUrl, "productOne",ajaxurlComplete.firstProduct);
				}
			
				if($(".comparison__list").find(".productTwo").find(".comparison__item-thumbnail").length == 0) {
					addProductList(ajaxurlComplete.secondProductAjaxUrl, "productTwo",ajaxurlComplete.secondProduct);
				}
				
				if(windowWidth >= 991.98) {
					if($(".comparison__list").find(".productThree").find(".comparison__item-thumbnail").length == 0) {
						addProductList(ajaxurlComplete.thirdProductAjaxUrl, "productThree",ajaxurlComplete.thirdProduct);
					}
				}
			}
		}
	}
})
var c03PcCampaignListSection = { // this name should be written in camelCase
	$selector: $('.c03-pc-campaign-list-section'),

	init: function() {
		if(this.$selector.length) {
			var ua = window.navigator.userAgent;
			var isIE = /MSIE|Trident/.test(ua);
			if ( isIE ) {
				$('body').addClass('ie');
			}
			
			$(".campaign__column img.lazy", ".c03-pc-campaign-list-section").each(function(i){
				//移动端加载MB图片
				if($(window).width()<768){
					var mbsrc=$(".campaign__column img.lazy").eq(i).data("mb");
					if(mbsrc){
						$(".campaign__column img.lazy").eq(i).attr("data-original",mbsrc);
					}
				}
				
				// 加载后移除动画图片
				var img=$(".campaign__column img.lazy").eq(i);
				var imgLoad = imagesLoaded(img);
			    imgLoad.on('done', function(instance) {
			        // 加载完成 
			        img.parent().removeClass('honor-loading-v2');
			    });
			})
			
			//懒加载调用
			$(".c03-pc-campaign-list-section .campaign__column img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
			
		}
	}
};

$(function() {
	c03PcCampaignListSection.init();
});

var c02PcProductsSection = { // this name should be written in camelCase
	$selector: $('.c02-pc-products-section'),

	init: function() {
		if(this.$selector.length) {
			var ua = window.navigator.userAgent;
			var isIE = /MSIE|Trident/.test(ua);
			if ( isIE ) {
				$('body').addClass('ie');
			}
			$(".c02-pc-products-section .products__column img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
			
			
			$(".products__column img.lazy", ".c02-pc-products-section").each(function(i){
				if($(window).width()<768){
					var mbsrc=$(".products__column img.lazy").eq(i).data("mb");
					if(mbsrc){
						$(".products__column img.lazy").eq(i).attr("data-original",mbsrc);
					}
				}
				
				var img=$(".products__column img.lazy").eq(i);
				var imgLoad = imagesLoaded(img);
		        imgLoad.on('done', function(instance) {
		        	// 加载完成 
		        	img.parent().removeClass('honor-loading-v2');
		        });
			})
			
		}
	}
};

$(function() {
	c02PcProductsSection.init();
});

/*!
 * CN DIY Image Component By Bruce
 *  v1.0.0 (2020-02-12 10:41)
 *  Copyright 2019-2020 hihonor.com
 */
$(function(){
    if($('.diy-video-cn').length>0){
    	// 是否显示Footer组件
    	var hideFooter = $('.diy-video-cn .content').data('hidefooter') || false;
    	if(hideFooter){
    		$('.footer').hide();
    	}
    	
    	// UI优化
    	$('body.honor-v2 > div >.content').css('max-width','100%');
    	
    	// 组件背景设置
    	var componentBg = '';
    	if(utils.windowWidth()>768){
    		componentBg= $('.diy-video-cn .content').data('pcbgimg');
    	}else{
    		componentBg= $('.diy-video-cn .content').data('mbbgimg');
    	}
    	if(componentBg){
    		$('.diy-video-cn .content').css('background-image','url('+componentBg+')');
    	}
    	// Section
    	$('.diy-video-cn .section .section-content').each(function(){
    		var $curr = $(this);
    		var pcImg = $curr.data('pcbgimg');
    		var mbImg = $curr.data('mbbgimg');
    		var sectionBg = '';
    		if(utils.windowWidth()>768){
    			sectionBg = pcImg;
    		}else{
    			sectionBg = mbImg;
    		}
    		if(sectionBg){
    			$curr.css({
    				'background-image':'url('+sectionBg+')',
    				'background-color':'transparent'
    			})
    		}
    	})
    	
    	
    	// item内图片优化
    	$('.diy-video-cn .item img').each(function(){
    		var $curr = $(this);
    		var pcImg = $curr.data('pcimg');
    		
    		if(pcImg){
    			// 当item中有图片时，去除最小宽高限制
    			$curr.parent().parent().parent().css({
    				'min-width':'auto',
    				'min-height':'auto'
    			})
    		}
    		$(".diy-video-cn .item img.lazy").lazyload({
	      	      "placeholder":lazyload.placeholder
			});
    		
    	})
    	
    	
    	window.DiyVideo = {
				init : function() {
					if ($('.diy-video-cn .section .item').length > 0) {
						this.initVideoBox();
						this.initVideoButton();
						
						 
						//移动端滚动监听视频播放
						if(utils.windowWidth()<=768){
							$(document).scroll(function() {
								//遍历当前页面所有视频item
								$.each($(".diy-video-cn .section .item"),function(i,item){
									var sTop=$(window).scrollTop();
									var elMove = $(".diy-video-cn .section .item").eq(i).offset().top-100;
									var vh = $(".diy-video-cn .section .item").eq(i).height();
									//判断第一个视频可视区域执行播放，其他视频暂停
									if(sTop>=elMove && sTop<=vh+elMove){
										$(".diy-video-cn .section .item").eq(i).find("video").trigger('play');
									}else{
										$(".diy-video-cn .section .item").eq(i).find("video").trigger('pause');
									}
								});
								
							});
						}
					}
				},
				initVideoBox : function(videoType, videoRatio, videoURL, videoWebmURL,videoOggURL) {
					var videoHTML;
					if (videoType == 'embed') {
						videoHTML = '<video id="diyVideo" class="video-js vjs-default-skin vjs-big-play-centered" controls autoplay="false" preload="auto" width="100%"><source src="'+ videoURL+ '" type="video/mp4" /><source src="'+ videoWebmURL+ '" type="video/webm" /><source src="'+ videoOggURL + '" type="video/ogg" /></video>';
					} else if (videoType == 'youtube') {
						videoHTML = '<div class="embed-responsive embed-responsive-'+ videoRatio+ '"><iframe class="embed-responsive-item"  src="https://www.youtube.com/embed/'+ videoURL+ '?rel=0&amp;autoplay=1&amp;showinfo=0&amp;loop=1&amp;playlist='+videoURL+'" allowfullscreen></iframe></div>';
					} else if (videoType == 'youku') {
						videoHTML = '<div class="embed-responsive embed-responsive-'+ videoRatio+ '"><iframe src="https://player.youku.com/embed/'+ videoURL + '" allowfullscreen></iframe></div>';
					}
			
					return videoHTML;
				},
			
				initVideoButton : function() {
					var videoPlayer = null;
					var isBlur = false;
					var isIE = true;
			
					if (BrowserDetect.init() == 'Chrome'
							|| BrowserDetect.init() == 'Safari') {
						isIE = false;
					}
			
					$('.diy-video-cn a.diy_video_pc').click(function() {
						if (window.DiyVideo.checkScreen() == 'x-small' || isIE == true) {
							isBlur = false;
						} else {
							isBlur = true;
						}
			
						if (isBlur != false) {
						}
			
						$('.diy-video-cn #video-dialog').modal('show');
			
						if ($(this).data('video-type') != 'embed') {
							var temp = DiyVideo.initVideoBox($(this).data('video-type'), $(this).data('ratio'),$(this).data('video-source'));
							setTimeout(function() {
								$('.diy-video-cn #video-dialog').find('.video-content').empty().html(temp);
							}, 500)
			
						} else {
							var temp = DiyVideo.initVideoBox($(this).data('video-type'), $(this).data('ratio'),$(this).data('video-source-mp4'),$(this).data('video-source-webm'), $(this).data('video-source-ogg'));
							setTimeout(function() {
								$('.diy-video-cn #video-dialog').find('.video-content').empty().html(temp);
							}, 500) 
						}
			
						return false;
					});
			
					$('.diy-video-cn #video-dialog .close-video-btn').click(function() {
						try {
							if (videoPlayer != null) {
								videoPlayer.dispose();
							}
						} catch (e) {
						} finally {
							$('.diy-video-cn #video-dialog').find('.video-content').empty();
						}
			
						$('.diy-video-cn #video-dialog').modal('hide');
			
						return false;
					});
			
					$('.diy-video-cn #video-dialog').on('shown.bs.modal',function(e) {
						if (videoPlayer != null) {
							$('.diy-video-cn #diyVideo').css('height',$('.diy-video-cn #video-dialog .modal-body').height());
						}
						if (!isBlur) {
							$('.diy-video-cn .modal-backdrop').css({
								'background-color' : '#000'
							});
						}
					});
					$('.diy-video-cn #video-dialog').on('hidden.bs.modal', function(e) {
						if (videoPlayer != null) {
							videoPlayer.dispose();
						}
						$('.diy-video-cn #video-dialog').find('.video-content').empty();
			
						if (!isBlur) {
							$('.diy-video-cn .modal-backdrop').css({
								'background-color' : 'transparent'
							});
						}
					});
			
					$(window).bind('resizeEnd',function() {
						if (videoPlayer != null) {
							$('.diy-video-cn #diyVideo').css('height',$('.diy-video-cn #video-dialog .modal-body').height());
						}
					});
				},
				checkScreen : function() {
					if ($('.diy-video-cn .visible-xs').css('display') == 'block') {
						return 'x-small';
					} else if ($('.diy-video-cn .visible-sm').css('display') == 'block') {
						return 'small';
					} else if ($('.diy-video-cn .visible-md').css('display') == 'block') {
						return 'medium';
					} else if ($('.diy-video-cn .visible-lg').css('display') == 'block') {
						return 'large';
					}
				}
			}
    	
    	var BrowserDetect = window.BrowserDetect || {};
		
		BrowserDetect.init = function() {
			this.browser = this.searchString(this.dataBrowser) || "Other";
			this.version = this.searchVersion(navigator.userAgent)
					|| this.searchVersion(navigator.appVersion) || "Unknown";
			return this.browser;
		};
		
		BrowserDetect.searchString = function(data) {
			for (var i = 0; i < data.length; i++) {
				var dataString = data[i].string;
				this.versionSearchString = data[i].subString;
				if (dataString.indexOf(data[i].subString) != -1) {
					return data[i].identity;
				}
			}
		};
		
		BrowserDetect.searchVersion = function(dataString) {
			var index = dataString.indexOf(this.versionSearchString);
			if (index == -1)
				return;
			return parseFloat(dataString.substring(index
					+ this.versionSearchString.length + 1));
		};
		
		BrowserDetect.dataBrowser = [ {
			string : navigator.userAgent,
			subString : "Chrome",
			identity : "Chrome"
		}, {
			string : navigator.userAgent,
			subString : "MSIE",
			identity : "Explorer"
		}, {
			string : navigator.userAgent,
			subString : "Firefox",
			identity : "Firefox"
		}, {
			string : navigator.userAgent,
			subString : "Safari",
			identity : "Safari"
		}, {
			string : navigator.userAgent,
			subString : "Opera",
			identity : "Opera"
		} ];
		
		DiyVideo.init();
    }
});
/*!
 * CN DIY Image Component By Bruce
 *  v1.0.0 (2020-02-12 10:41)
 *  Copyright 2019-2020 hihonor.com
 */
$(function(){
    if($('.diy-image-cn').length>0){
    	// 是否显示Footer组件
    	var hideFooter = $('.diy-image-cn .content').data('hidefooter') || false;
    	if(hideFooter){
    		$('.footer').hide();
    	}
    	
    	// 判断是否启用 移动端左右边距配置
    	var enableMbPadding = $('.diy-image-cn .content').data('enablembpadding') || false;
    	if(enableMbPadding && utils.windowWidth()<=768){
    		$('.diy-image-cn .ho-middle-v2').addClass('enabled');
    	}
    	
    	// UI优化
    	$('body.honor-v2 > div >.content').css('max-width','100%');
    	
    	var isPCEnd = utils.windowWidth()>768;
    	var isAuthor = $('.diy-image-cn .content').hasClass('author-mode');
    	// 组件背景设置
    	var componentBg = '',componentMbBgColor='';
    	var $content = $('.diy-image-cn .content');
    	if(isPCEnd){
    		componentBg= $content.data('pcbgimg');
    	}else{
    		componentBg= $content.data('mbbgimg');
    		// 当配置移动端背景颜色时使用
    		componentMbBgColor = $content.data('mbbgcolor');
    		if(componentMbBgColor){
    			$content.css('background-color',componentMbBgColor);
    		}
    	}
    	if(componentBg){
    		$content.css('background-image','url('+componentBg+')');
    	}
    	
    	function GetPercent(num) {
		    num = parseFloat(num);
		    if (isNaN(num)) {
		        return "-";
		    }
		    return (parseFloat(1/num).toFixed(6)*100.00 + "%");
		}
    	
    	// Section
    	$('.diy-image-cn .section .section-content').each(function(index){
    		var $curr = $(this);
    		var pcImg = $curr.data('pcbgimg');
    		var mbImg = $curr.data('mbbgimg');
    		var sectionBg = '';
    		if(isPCEnd){
    			sectionBg = pcImg;
    		}else{
    			sectionBg = mbImg;
    			// 当配置移动端背景颜色时使用
    			var sectionMbBgColor = $curr.data('mbbgcolor');
    			if(sectionMbBgColor){
    				$curr.css('background-color',sectionMbBgColor);
    			}
    		}
    		if(sectionBg){
    			$curr.css({
    				'background-image':'url('+sectionBg+')'
    			})
    		}
    		
    		// item设置等分或者自定义宽度
    		var rowsForPC = $curr.attr('data-rowsforpc') || 1;
    		var rowsForMobile = $curr.attr('data-rowsformobile') || 1;
    		
    		var percentForPC = GetPercent(rowsForPC);
    		var percentForMB = GetPercent(rowsForMobile);
    		
    		var itemTypeForPC= $curr.data('itemtypeforpc') || 'none';
    		var itemTypeForMB= $curr.data('itemtype') || 'sameWidth';
    		if(isPCEnd){
    			if(itemTypeForPC=='sameWidthForPC'){
    				$(this).children('.item').css('width',percentForPC);
    			}else if(itemTypeForPC=='customWidthForPC'){
    				$curr.find('.item').each(function(){
    					var $item = $(this);
    					var customWidth = $item.children('a').data('customwidth') ? $item.children('a').data('customwidth') : percentForPC;
    					$item.css('width',customWidth);
    				})
    			}
    		}else{
    			if(itemTypeForMB=='sameWidth'){
    				$(this).children('.item').css('width',percentForMB);
    			}else if(itemTypeForMB=='customWidth'){
    				$curr.find('.item').each(function(){
    					var $item = $(this);
    					var customWidth = $item.children('a').data('customwidth') ? $item.children('a').data('customwidth') : percentForMB;
    					$item.css('width',customWidth);
    				})
    			}
    			
    		}
    	})
    	
    	// item link优化
    	$('.diy-image-cn .item .item-link').each(function(){
    		var target = $(this).data('target');
    		if(!target){
    			$(this).removeAttr('target');
    		}
    	})
    	
    	// 资产下载
		$('.diy-image-cn .download-link').on('click',function(){
			if (honorData.loginName!= "" && null != honorData.loginName && honorData.loginName !="null") {
				// 已登录，直接下载		
				var url = $(this).attr('data-url');
				$(this).attr('href',url);
			}else{
				//登录提示
				$('.diy-image-cn .login-overlay').show();
				$('body').addClass("overhidden");
			}
		})
		// 关闭登录提示
		$('.diy-image-cn .tip-cancel').on('click',function(){
			$('.login-overlay').hide();
			$('body').removeClass("overhidden");
		})
		// 跳转登录
		$('.diy-image-cn .tip-login').on('click',function(){
			window.location.href = honorConfig.endLoginUrl;
		});
    	
    	// item内图片优化
    	$('.diy-image-cn .item img').each(function(){
    		var $curr = $(this);
    		var pcImg = $curr.data('pcimg');
    		var mbImg = $curr.data('mbimg');
    		var src = '';
    		if(isPCEnd){
    			src = pcImg;
    		}else{
    			src = mbImg;
    		}
    		if(src){
    			$curr.attr('data-original',src).parent().parent().css({
    				'min-width':'auto',
    				'min-height':'auto'
    			});
    			// 当item中有图片时，去除最小宽高限制
    			$curr.parent().parent().parent().css({
    				'min-width':'auto',
    				'min-height':'auto'
    			})
    		}else{
    			if(!isAuthor){
    				$curr.parent().parent().remove();
    			}
    		}
    		
    	})
    	
    	$(".diy-image-cn .item .lazy").show().lazyload({
    	      "placeholder":lazyload.placeholder,
    	      effect: 'fadeIn'
    	}); 
    	
    }
});
var c42BrandVideo = {
	$selector: $('.c42-brand-video'),
	init: function() {
		if(this.$selector.length) {
			if($(window).width()<768){
				
				var mbbg=this.$selector.children("video").data("mbbg");
				var mbvideo=this.$selector.children("video").data("mb");
				if(mbvideo){
					this.$selector.children("video.brand__video").attr("poster",mbbg);
					this.$selector.children("video.brand__video").attr("src",mbvideo);
				}
				
			}
		}
		
	}
};

$(function() {
	c42BrandVideo.init();
});


var c45BrandSlogan = {
	init: function() {
		if($(".c45-brand-slogan").length>0){
			$(".c45-brand-slogan img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
			
			if($(window).width()<768){
				var mbsrc=$(".c45-brand-slogan img.lazy").data("mb");
				if(mbsrc){
					$(".c45-brand-slogan img.lazy").attr("data-original",mbsrc);
				}
			}
		}
	}
};

$(function() {
	c45BrandSlogan.init();
});

var c44BrandEvent = {
	$selector: $('.c44-brand-event'),

	init: function() {
		if(this.$selector.length) {
			this.breakpoint = window.matchMedia( '(min-width:768px)' );
			this.mySwiper = null;

			this.breakpointChecker();
			this.breakpoint.addListener(this.breakpointChecker.bind(this));
			
			$(".c44-brand-event img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
	},

	breakpointChecker: function() {
		// for larger devices
		if (this.breakpoint.matches) {
			// clean up old instances and inline styles when available
			if (this.mySwiper !== null) this.mySwiper.destroy( true, true );
			return;
		}

		// fire small viewport version of swiper
		return this.initSwiper();
	},

	initSwiper: function() {
		this.mySwiper = new Swiper('.c44-brand-event .c44-be__swiper-container', {
			slidesPerView: 1.1,
			centeredSlides: false,
			spaceBetween: 10,
			speed: 800,
			loop: false,
			autoplay: {
				disableOnInteraction: false
			},
			lazy: {
			    loadPrevNext: true,
		    },
			pagination: {
				el: '.c44-brand-event .c44-be__swiper-pagination',
				type: 'bullets',
				clickable: true,
			}
		});
	}
};

$(function() {
	c44BrandEvent.init();
});

var c43BrandCategory = {
	init: function() {
		if($(".c43-brand-category").length>0){
			$(".c43-bc__side:odd .row").addClass("row--reverse");
			
			$(".c43-brand-category img.lazy").lazyload({
				"placeholder":lazyload.placeholder
			});
		}
	}
};

$(function() {
	c43BrandCategory.init();
});

(function(){
	$(function(){
		var relatedProductCN = {
			$selector: $('.related-product-cn'),
			$listBox: $('.related-product-cn .swiper-wrapper'),
			total: Number($('.related-product-cn .related-data').data('num') || '0'),
			init: function() {
				var that = this;
				if(that.$selector.length) {
					if(that.total>0){
						// Get the URL of each product
						that.getProductUrl();
						// Mobile
						if (utils.windowWidth() < 1024 &&that.total>1){
							window.onload= function(){
								setTimeout(function() {
									that.newsContentSlider();
								}, 1000);
							}
						}
					}
				}
			},
			getProductUrl : function(){
				// Get the URL of each product
				var that = this;
				this.$selector.find('.related-data li').each(function(i){
					// 判断是否是 荣耀中国 生产环境
			        var isCNSite = (location.hostname=='www.honor.cn');
					var currUrl = location.protocol+'//'+location.host+$.trim($(this).data('url'));
					var ajaxUrl = ''; 
					if(utils.isAuthor()){
						ajaxUrl = currUrl+'/jcr:content.specs.json';
					}else{
						if(isCNSite){
				        	ajaxUrl = currUrl.split('/content/honor/cn')[1]+'/jcr:content.specs.json';
				        }else{
				        	ajaxUrl = currUrl.split('/content/honor')[1]+'/jcr:content.specs.json';
				        }
					}
					that.renderingLists(ajaxUrl);
				})
			},
			renderingLists:function(ajaxUrl){
				// Rendering product list	
				var that = this;
				$.ajax({
				    url: ajaxUrl, 
				    dataType: 'json', 
				    type: 'GET',
				    success: function(info) {
				    	var data = info.detailMode;
				    	if(info && !$.isEmptyObject(data)){
				    		var defaultImage = data.cnDefaultImage ? data.cnDefaultImage :'',
		    					defaultImgTitle = data.cnDefaultImgTitle ? data.cnDefaultImgTitle :'',
    							defaultImgAlt = data.cnDefaultImgAlt ? data.cnDefaultImgAlt :'',
    							marketingName = data.cnMarketingName ? data.cnMarketingName :'',
			    				slogan = data.cnSlogan ? data.cnSlogan :'',
	    						detailPage = data.cnDetailPage ? data.cnDetailPage:'',
								detailBtnText = data.cnDetailPageBtnText ? data.cnDetailPageBtnText:'';
				    		var str='';
				    		str+='<div class="swiper-slide">';
				    			str+='<div class="gradient-shadow">';
				    				str+='<ul class="news-product">';
				    					str+='<li class="news-product__img-wrap">';
				    					if (utils.windowWidth() < 1024 && that.total>1){
				    						str+='<img data-src="'+defaultImage+'" class="news-product__img swiper-lazy" title="'+defaultImgTitle+'" alt="'+defaultImgAlt+'">';
				    					}else{
				    						str+='<img data-original="'+defaultImage+'" class="news-product__img lazy" title="'+defaultImgTitle+'" alt="'+defaultImgAlt+'">';
				    					}
		    							str+='</li>';
	    								str+='<li class="news-product__content">';
    										str+='<h3 class="news-product__title">'+marketingName+'</h3>';
    										str+='<span class="news-product__text">'+slogan+'</span>';
    										if(detailBtnText){
    											str+='<div class="gradient-border center">';
    												// 获取正确的url
    												detailPage = utils.getSuitedUrl(detailPage);
    												
    												str+='<a class="gradient-border__link" href="'+detailPage+'"><span class="gradient-border__text">'+detailBtnText+'</span></a>';
    											str+='</div>';
    										}
										str+='</li>';
									str+='</ul>';
									str+='<div class="gradient-shadow__hover"></div>';
								str+='</div>';
							str+='</div>';
							that.$listBox.append(str);
							// 移动端，单张图
							if(utils.windowWidth() < 1024 && that.total==1){
								$('.related-product-cn .news-product__img').show();
							}
							// 图片懒加载
							that.$listBox.find(".lazy").lazyload({
							      "placeholder":lazyload.placeholder
							}); 
							
				    	}
				    }
				})
			},
			newsContentSlider: function() {
				var that = this;
				var mySwiper = new Swiper('.related-product-cn .swiper-container', {
					speed: 800,
					loop: true,
					autoplay:true,
					effect: 'fade',
					lazy:{
						loadPrevNext: true
					},
					observer:true,
					observeParents:true,
					pagination: {
						el: '.related-product-cn .swiper-pagination',
						type: 'bullets',
						clickable: true,
					},
					on:{
						lazyImageReady: function(slideEl, imageEl){
							$(slideEl).find('.news-product__img').show();
					    }
					}
				});
			}
		};

		relatedProductCN.init();
			
	}); 
}());
(function(){
	$(function(){
		var preNextArticleCN = {
			$selector: $('.pre-next-article-cn'),
			$window: $(window),
			$box: $('.campaign__box'),
			isFirst:true, // 首次出现在视窗范围
			total: $('.pre-next-article-cn .swiper-container').data('total') || '0',

			init: function() {
				if(this.$selector.length) {
					this.$spinner = this.$selector.find('.c03-spinner');

					var ua = window.navigator.userAgent;
					var isIE = /MSIE|Trident/.test(ua);
					if ( isIE ) {
						$('body').addClass('ie');
					}

					// Keep these listeners
					if (this.$box) this.$box.hover(this.openBoxContent, this.closeBoxContent);
					if (this.total>1 && innerWidth < 992) {
						this.initSwiper();
					}
					
					this.srollPage();
				}
			},
			showRightImgAndVideo:function(){
				//资源懒加载 + 图片按照终端按需加载
				var that = this;
				var isPC = utils.windowWidth()>768;
				that.$selector.find('.bg-img').each(function(i){
					// 加载对应图片
					var $curr = $(this);
					var imgSrc = '';
					if(isPC){
						imgSrc = $(this).data('pc');
					}else{
						imgSrc = $(this).data('mb');
					}
					$(this).attr('src',imgSrc);
					
					var imgLoad = imagesLoaded($curr);
			        imgLoad.on('done', function(instance) {
			        	// 加载完成 
			        	$curr.css('visibility','visible');
			        })
				})
				
			},
			srollPage: function(){
				// 图片视频懒加载 + 图片按照终端按需加载
				var that = this;
				var windowH = utils.windowHeight();
				var listsTop = that.$selector.position().top;
				var scrollTop = $(document).scrollTop();
				var flag = (windowH+scrollTop)>listsTop;
				if(flag && that.isFirst){
					that.showRightImgAndVideo();
					that.isFirst = false;
				}
				
				$(window).scroll(function() {
					currScrollTop = $(document).scrollTop();
					flag = (windowH+currScrollTop)>listsTop;
					if(flag && that.isFirst){
						that.showRightImgAndVideo();
						that.isFirst = false;
					}
				}); 
			},

			openBoxContent: function() {
				var box = event.currentTarget;
				var height = box.scrollHeight;

				box.style.maxHeight = height + 'px';
			},

			closeBoxContent: function() {
				var box = event.currentTarget;

				box.style.maxHeight = '170px';
			},

			initSwiper: function() {
				var mySwiper = new Swiper('.pre-next-article-cn .swiper-container', {
					spaceBetween: 0,
					speed: 800,
					loop: false,
					pagination: {
						el: '.pre-next-article-cn .swiper-pagination',
						type: 'bullets',
						clickable: true,
					},
				});
			}
		};

		preNextArticleCN.init();

	}); 
}());
(function(){
	$(function(){
		var articleDetailCN = {
			$selector: $('.article-detail-cn'),
			init: function() {
				var that = this;
				var outboundUrl=$("#outboundLink").val();
				if(that.$selector.length) {
					if(outboundUrl && window.location.hostname!="mktcloud.hihonor.com" && window.location.hostname!="mktcloud-uat.test.hihonor.com" && window.location.hostname!="localhost"){
						window.location.href = outboundUrl;
					}
				}
			}
		};

		articleDetailCN.init();
			
	}); 
}());
(function () {
	$(function () {
		var len = $(".user-center-myworks").length;
		if (len == 0) {
			return;
		}
		
		var language=window.digitalData.page.pageInfo.siteCode2;	
		if(language.toLowerCase()==="global"){
			language="en";
		}
			
		var requestUrl = honorApiUrl;
		var windowW = utils.windowWidth();
		var pageSize=12;
		var pageIndex=1;
		var totalPage=0;
		if(windowW<=768){
			pageSize=8;
		}

		// 非编辑模式
		var isEdit = $(".user-center-myworks .myworks-box").hasClass('edit-mode');
		if(!isEdit){
			// 当前Tab展示为 favorite时
			var tabName = getCurrTabName();
			if (tabName == "myworks") {
				getMyWorks('click');
				scrollGetDatas();
			}
			
			// 导航切换时 查询数据
			$(".user-center-top .nav li[relative='myworks']").click(function() {
				pageIndex = 1;
				getMyWorks('click');
				scrollGetDatas();
			})
			
		}
		//拼接跳转的url
		function jointUrl(url) {
			if (url) {
				//拼跳转到详情页的链接
				var currPath = location.href;
				var prePath = '',
					endPath = '';
				if (currPath.indexOf('content/honor') != -1) {
					//预览环境
					prePath = currPath.split('/content/honor')[0];
					prePath += '/content/honor';
				} else {
					//发布环境
					prePath = location.protocol + '//' + window.location.host;
				}
				if (currPath.indexOf('.html') != -1) {
					//预览环境
					endPath += '.html';
					endPath += currPath.split('.html')[1];
					if(endPath.indexOf('#&') != -1){
						endPath = endPath.split('#&')[0];
					}
				} else {
					//发布环境
					endPath = '/';
				}
			}
			return prePath + url + endPath;
		}
		/*
		 * 查询我收藏的作品
		 * @type 加载类型  scroll：滚动加载，click：点击tab加载
		 */
		function getMyWorks(type) {
			$.ajax({
				url: requestUrl + '/abroad/wallpaper/listUserAllWallpaperImgInfo',
				data:{lang:language,pageIndex:pageIndex,pageSize:pageSize},
				type: 'get',
				dataType: "jsonp",
				success: function (result) {
					if (result.success) {
						var data = result.infoBean.pageList;
						if(data.length===0 && pageIndex=='1'){
							$(".user-center-myworks .photos .nodata").show();
							return false;
						}
						totalPage=result.infoBean.totalPage;
						var itemhtml = "";
						for (var i = 0; i < data.length; i++) {
							 var linkToDetail=jointUrl(data[i].htmlPath);
							 itemhtml += '<div class="box-item">';
							        itemhtml += '<div class="img honor-loading-v2 honor-loading-sm"><a title="'+ data[i].title+'" href="'+linkToDetail+'">';
								        if(utils.windowWidth()>768){
								        	itemhtml += '<img class="lazy" title="' + data[i].title + '" alt="' + data[i].title + '" src="' + data[i].imgSrc + '" />';
								        }else{
								        	itemhtml += '<img class="lazy" data-original="'+data[i].imgSrc+'" title="' + data[i].title + '" alt="' + data[i].title + '" />';
								        }
							        itemhtml += '</a></div>';
							        itemhtml +='<div class="photo-desc">';
							                itemhtml +='<a title="'+ data[i].title+'" href="'+linkToDetail+'"><div class="desc linear-scroll scroll-sm">';
							                        itemhtml +='<div class="tilte">'+data[i].title+'</div>';
							                        itemhtml +='<div class="desc-con">'+data[i].workDescription+'</div>';
							                itemhtml +='</div></a>';
							                itemhtml +='<div class="photo-actions">';
							                        itemhtml +='<div><i data-ispraised="'+data[i].isPraised+'" name="'+data[i].activityId+'" imgid="'+data[i].id+'" num="'+data[i].liked+'" class="praise '+(+data[i].isPraised===0?" red":"")+' fa fa-heart"></i><span>'+data[i].liked+'</span></div>';
							                        itemhtml +='<div> <i class="fa fa-comment"></i><span>'+data[i].commentNum+'</span></div>';
							                itemhtml +='</div>';
							        itemhtml +='</div>';
							 itemhtml += "</div>";
						}
						if(type=="scroll"){
							$(".user-center-myworks .photos .photos-box").append(itemhtml);
						}else if(type=="click"){
							$(".user-center-myworks .photos .photos-box").html(itemhtml);
						}
						if(utils.windowWidth()<=768){
							$(".user-center-myworks .photos .lazy").lazyload({
								"placeholder":lazyload.placeholder
							}); 
						}
						
						//图片加载完毕，去除loading效果
						$('.user-center-myworks .photos .photos-box .img img').imagesLoaded()
						.progress(function(instance,image){
							// 当前图片加载完成后，去除loading效果
							if(image.isLoaded){
								$(image.img).parent().parent().removeClass('honor-loading-v2');
							}
						})

						//点赞 取消点赞
						$(".user-center-myworks .photo-desc .photo-actions .praise").unbind().click(function(){
							var imgSrc= $(this).children("img").attr("src");
							var num=+$(this).attr("num");
							var imgId=+$(this).attr("imgid");
							var activityName=$(this).attr("name");
							if($(this).attr("class").indexOf("red")!==-1){
								// 已点赞
								delPraise(this,activityName,imgId,num); 
							}else{
								// 未点赞
								addPraise(this,activityName,imgId,num); 
							}
						})
						
						
						//鼠标经过显示
						if(windowW>=1024){
							$(".user-center-myworks .photos .photos-box .box-item").stop().hover(function(e){
								e.stopPropagation();
								var $thisH=$(this).height();
								$(this).css("height",$thisH);
								$(this).children(".photo-desc").addClass('ho-active');
							}).stop().mouseleave(function(e){
								e.stopPropagation();
								$(this).children(".photo-desc").removeClass('ho-active');
							});
						}
					}
				}
			})
		}
		//添加点赞
		function addPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/wallpaper/addWallpaperPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							num +=1;
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).addClass("red");
						}
					}
				})
		}
		//删除点赞
		function delPraise(el,activityName,imgId,num){
			activityName=activityName.replace("HONOR_","");
			 $.ajax({
					type:"post",
					url:requestUrl+'/abroad/wallpaper/delWallpaperPraise',
					dataType: "jsonp", 
					data:{imgId:imgId,activityName:activityName},
					success:function(result){
						if(result.code==="100007"){
							 window.location.href=honorConfig.endLoginUrl;
							 return false;
						}
						if(result.success){
							if(num>0){
								num -=1;
							}
							$(el).siblings("span").html(num);
							$(el).attr("num",num);
							$(el).removeClass("red");
						}

					}
				})
		};
		
	    //滚动加载
		function scrollGetDatas(){
			$(window).scroll(function(){
			 var scrollTop = $(this).scrollTop();//滚滚动条 距离顶部距离
			 var documentHeight = $(document).height();//内容高度
			 var windowHeight = $(this).height();//可见高度
			 var footerHeight=$(".footer").height();//底部高度
			 if(windowHeight+scrollTop>=documentHeight-footerHeight){
				 if(totalPage>=pageIndex){
					 pageIndex+=1;
					 getMyWorks('scroll');
				 }
				}
		    })	
		}
	});
})();
